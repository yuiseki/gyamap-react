(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))f(_);new MutationObserver(_=>{for(const w of _)if(w.type==="childList")for(const I of w.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&f(I)}).observe(document,{childList:!0,subtree:!0});function l(_){const w={};return _.integrity&&(w.integrity=_.integrity),_.referrerPolicy&&(w.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?w.credentials="include":_.crossOrigin==="anonymous"?w.credentials="omit":w.credentials="same-origin",w}function f(_){if(_.ep)return;_.ep=!0;const w=l(_);fetch(_.href,w)}})();var Qw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $v(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jv={exports:{}},Ud={},qv={exports:{}},Lt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cc=Symbol.for("react.element"),eb=Symbol.for("react.portal"),tb=Symbol.for("react.fragment"),nb=Symbol.for("react.strict_mode"),ib=Symbol.for("react.profiler"),rb=Symbol.for("react.provider"),ob=Symbol.for("react.context"),sb=Symbol.for("react.forward_ref"),ab=Symbol.for("react.suspense"),lb=Symbol.for("react.memo"),ub=Symbol.for("react.lazy"),x_=Symbol.iterator;function cb(n){return n===null||typeof n!="object"?null:(n=x_&&n[x_]||n["@@iterator"],typeof n=="function"?n:null)}var Zv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gv=Object.assign,Wv={};function Ll(n,o,l){this.props=n,this.context=o,this.refs=Wv,this.updater=l||Zv}Ll.prototype.isReactComponent={};Ll.prototype.setState=function(n,o){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,o,"setState")};Ll.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function Xv(){}Xv.prototype=Ll.prototype;function jm(n,o,l){this.props=n,this.context=o,this.refs=Wv,this.updater=l||Zv}var qm=jm.prototype=new Xv;qm.constructor=jm;Gv(qm,Ll.prototype);qm.isPureReactComponent=!0;var w_=Array.isArray,Hv=Object.prototype.hasOwnProperty,Zm={current:null},Kv={key:!0,ref:!0,__self:!0,__source:!0};function Yv(n,o,l){var f,_={},w=null,I=null;if(o!=null)for(f in o.ref!==void 0&&(I=o.ref),o.key!==void 0&&(w=""+o.key),o)Hv.call(o,f)&&!Kv.hasOwnProperty(f)&&(_[f]=o[f]);var u=arguments.length-2;if(u===1)_.children=l;else if(1<u){for(var U=Array(u),D=0;D<u;D++)U[D]=arguments[D+2];_.children=U}if(n&&n.defaultProps)for(f in u=n.defaultProps,u)_[f]===void 0&&(_[f]=u[f]);return{$$typeof:Cc,type:n,key:w,ref:I,props:_,_owner:Zm.current}}function hb(n,o){return{$$typeof:Cc,type:n.type,key:o,ref:n.ref,props:n.props,_owner:n._owner}}function Gm(n){return typeof n=="object"&&n!==null&&n.$$typeof===Cc}function db(n){var o={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(l){return o[l]})}var b_=/\/+/g;function hf(n,o){return typeof n=="object"&&n!==null&&n.key!=null?db(""+n.key):o.toString(36)}function id(n,o,l,f,_){var w=typeof n;(w==="undefined"||w==="boolean")&&(n=null);var I=!1;if(n===null)I=!0;else switch(w){case"string":case"number":I=!0;break;case"object":switch(n.$$typeof){case Cc:case eb:I=!0}}if(I)return I=n,_=_(I),n=f===""?"."+hf(I,0):f,w_(_)?(l="",n!=null&&(l=n.replace(b_,"$&/")+"/"),id(_,o,l,"",function(D){return D})):_!=null&&(Gm(_)&&(_=hb(_,l+(!_.key||I&&I.key===_.key?"":(""+_.key).replace(b_,"$&/")+"/")+n)),o.push(_)),1;if(I=0,f=f===""?".":f+":",w_(n))for(var u=0;u<n.length;u++){w=n[u];var U=f+hf(w,u);I+=id(w,o,l,U,_)}else if(U=cb(n),typeof U=="function")for(n=U.call(n),u=0;!(w=n.next()).done;)w=w.value,U=f+hf(w,u++),I+=id(w,o,l,U,_);else if(w==="object")throw o=String(n),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return I}function Fh(n,o,l){if(n==null)return n;var f=[],_=0;return id(n,f,"","",function(w){return o.call(l,w,_++)}),f}function pb(n){if(n._status===-1){var o=n._result;o=o(),o.then(function(l){(n._status===0||n._status===-1)&&(n._status=1,n._result=l)},function(l){(n._status===0||n._status===-1)&&(n._status=2,n._result=l)}),n._status===-1&&(n._status=0,n._result=o)}if(n._status===1)return n._result.default;throw n._result}var Zi={current:null},rd={transition:null},fb={ReactCurrentDispatcher:Zi,ReactCurrentBatchConfig:rd,ReactCurrentOwner:Zm};Lt.Children={map:Fh,forEach:function(n,o,l){Fh(n,function(){o.apply(this,arguments)},l)},count:function(n){var o=0;return Fh(n,function(){o++}),o},toArray:function(n){return Fh(n,function(o){return o})||[]},only:function(n){if(!Gm(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Lt.Component=Ll;Lt.Fragment=tb;Lt.Profiler=ib;Lt.PureComponent=jm;Lt.StrictMode=nb;Lt.Suspense=ab;Lt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fb;Lt.cloneElement=function(n,o,l){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var f=Gv({},n.props),_=n.key,w=n.ref,I=n._owner;if(o!=null){if(o.ref!==void 0&&(w=o.ref,I=Zm.current),o.key!==void 0&&(_=""+o.key),n.type&&n.type.defaultProps)var u=n.type.defaultProps;for(U in o)Hv.call(o,U)&&!Kv.hasOwnProperty(U)&&(f[U]=o[U]===void 0&&u!==void 0?u[U]:o[U])}var U=arguments.length-2;if(U===1)f.children=l;else if(1<U){u=Array(U);for(var D=0;D<U;D++)u[D]=arguments[D+2];f.children=u}return{$$typeof:Cc,type:n.type,key:_,ref:w,props:f,_owner:I}};Lt.createContext=function(n){return n={$$typeof:ob,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:rb,_context:n},n.Consumer=n};Lt.createElement=Yv;Lt.createFactory=function(n){var o=Yv.bind(null,n);return o.type=n,o};Lt.createRef=function(){return{current:null}};Lt.forwardRef=function(n){return{$$typeof:sb,render:n}};Lt.isValidElement=Gm;Lt.lazy=function(n){return{$$typeof:ub,_payload:{_status:-1,_result:n},_init:pb}};Lt.memo=function(n,o){return{$$typeof:lb,type:n,compare:o===void 0?null:o}};Lt.startTransition=function(n){var o=rd.transition;rd.transition={};try{n()}finally{rd.transition=o}};Lt.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Lt.useCallback=function(n,o){return Zi.current.useCallback(n,o)};Lt.useContext=function(n){return Zi.current.useContext(n)};Lt.useDebugValue=function(){};Lt.useDeferredValue=function(n){return Zi.current.useDeferredValue(n)};Lt.useEffect=function(n,o){return Zi.current.useEffect(n,o)};Lt.useId=function(){return Zi.current.useId()};Lt.useImperativeHandle=function(n,o,l){return Zi.current.useImperativeHandle(n,o,l)};Lt.useInsertionEffect=function(n,o){return Zi.current.useInsertionEffect(n,o)};Lt.useLayoutEffect=function(n,o){return Zi.current.useLayoutEffect(n,o)};Lt.useMemo=function(n,o){return Zi.current.useMemo(n,o)};Lt.useReducer=function(n,o,l){return Zi.current.useReducer(n,o,l)};Lt.useRef=function(n){return Zi.current.useRef(n)};Lt.useState=function(n){return Zi.current.useState(n)};Lt.useSyncExternalStore=function(n,o,l){return Zi.current.useSyncExternalStore(n,o,l)};Lt.useTransition=function(){return Zi.current.useTransition()};Lt.version="18.2.0";qv.exports=Lt;var $e=qv.exports;const Wm=$v($e);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mb=$e,gb=Symbol.for("react.element"),yb=Symbol.for("react.fragment"),_b=Object.prototype.hasOwnProperty,vb=mb.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xb={key:!0,ref:!0,__self:!0,__source:!0};function Jv(n,o,l){var f,_={},w=null,I=null;l!==void 0&&(w=""+l),o.key!==void 0&&(w=""+o.key),o.ref!==void 0&&(I=o.ref);for(f in o)_b.call(o,f)&&!xb.hasOwnProperty(f)&&(_[f]=o[f]);if(n&&n.defaultProps)for(f in o=n.defaultProps,o)_[f]===void 0&&(_[f]=o[f]);return{$$typeof:gb,type:n,key:w,ref:I,props:_,_owner:vb.current}}Ud.Fragment=yb;Ud.jsx=Jv;Ud.jsxs=Jv;jv.exports=Ud;var kt=jv.exports,Zf={},Qv={exports:{}},gr={},e0={exports:{}},t0={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function o(Xe,ht){var ct=Xe.length;Xe.push(ht);e:for(;0<ct;){var It=ct-1>>>1,Bt=Xe[It];if(0<_(Bt,ht))Xe[It]=ht,Xe[ct]=Bt,ct=It;else break e}}function l(Xe){return Xe.length===0?null:Xe[0]}function f(Xe){if(Xe.length===0)return null;var ht=Xe[0],ct=Xe.pop();if(ct!==ht){Xe[0]=ct;e:for(var It=0,Bt=Xe.length,zi=Bt>>>1;It<zi;){var Tn=2*(It+1)-1,Di=Xe[Tn],Ut=Tn+1,si=Xe[Ut];if(0>_(Di,ct))Ut<Bt&&0>_(si,Di)?(Xe[It]=si,Xe[Ut]=ct,It=Ut):(Xe[It]=Di,Xe[Tn]=ct,It=Tn);else if(Ut<Bt&&0>_(si,ct))Xe[It]=si,Xe[Ut]=ct,It=Ut;else break e}}return ht}function _(Xe,ht){var ct=Xe.sortIndex-ht.sortIndex;return ct!==0?ct:Xe.id-ht.id}if(typeof performance=="object"&&typeof performance.now=="function"){var w=performance;n.unstable_now=function(){return w.now()}}else{var I=Date,u=I.now();n.unstable_now=function(){return I.now()-u}}var U=[],D=[],ue=1,ie=null,pe=3,Ce=!1,ke=!1,Pe=!1,qe=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,te=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function le(Xe){for(var ht=l(D);ht!==null;){if(ht.callback===null)f(D);else if(ht.startTime<=Xe)f(D),ht.sortIndex=ht.expirationTime,o(U,ht);else break;ht=l(D)}}function Ee(Xe){if(Pe=!1,le(Xe),!ke)if(l(U)!==null)ke=!0,gi(Ze);else{var ht=l(D);ht!==null&&En(Ee,ht.startTime-Xe)}}function Ze(Xe,ht){ke=!1,Pe&&(Pe=!1,re(We),We=-1),Ce=!0;var ct=pe;try{for(le(ht),ie=l(U);ie!==null&&(!(ie.expirationTime>ht)||Xe&&!_t());){var It=ie.callback;if(typeof It=="function"){ie.callback=null,pe=ie.priorityLevel;var Bt=It(ie.expirationTime<=ht);ht=n.unstable_now(),typeof Bt=="function"?ie.callback=Bt:ie===l(U)&&f(U),le(ht)}else f(U);ie=l(U)}if(ie!==null)var zi=!0;else{var Tn=l(D);Tn!==null&&En(Ee,Tn.startTime-ht),zi=!1}return zi}finally{ie=null,pe=ct,Ce=!1}}var Fe=!1,Ae=null,We=-1,bt=5,st=-1;function _t(){return!(n.unstable_now()-st<bt)}function mi(){if(Ae!==null){var Xe=n.unstable_now();st=Xe;var ht=!0;try{ht=Ae(!0,Xe)}finally{ht?qt():(Fe=!1,Ae=null)}}else Fe=!1}var qt;if(typeof te=="function")qt=function(){te(mi)};else if(typeof MessageChannel<"u"){var Kn=new MessageChannel,qn=Kn.port2;Kn.port1.onmessage=mi,qt=function(){qn.postMessage(null)}}else qt=function(){qe(mi,0)};function gi(Xe){Ae=Xe,Fe||(Fe=!0,qt())}function En(Xe,ht){We=qe(function(){Xe(n.unstable_now())},ht)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Xe){Xe.callback=null},n.unstable_continueExecution=function(){ke||Ce||(ke=!0,gi(Ze))},n.unstable_forceFrameRate=function(Xe){0>Xe||125<Xe?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):bt=0<Xe?Math.floor(1e3/Xe):5},n.unstable_getCurrentPriorityLevel=function(){return pe},n.unstable_getFirstCallbackNode=function(){return l(U)},n.unstable_next=function(Xe){switch(pe){case 1:case 2:case 3:var ht=3;break;default:ht=pe}var ct=pe;pe=ht;try{return Xe()}finally{pe=ct}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Xe,ht){switch(Xe){case 1:case 2:case 3:case 4:case 5:break;default:Xe=3}var ct=pe;pe=Xe;try{return ht()}finally{pe=ct}},n.unstable_scheduleCallback=function(Xe,ht,ct){var It=n.unstable_now();switch(typeof ct=="object"&&ct!==null?(ct=ct.delay,ct=typeof ct=="number"&&0<ct?It+ct:It):ct=It,Xe){case 1:var Bt=-1;break;case 2:Bt=250;break;case 5:Bt=1073741823;break;case 4:Bt=1e4;break;default:Bt=5e3}return Bt=ct+Bt,Xe={id:ue++,callback:ht,priorityLevel:Xe,startTime:ct,expirationTime:Bt,sortIndex:-1},ct>It?(Xe.sortIndex=ct,o(D,Xe),l(U)===null&&Xe===l(D)&&(Pe?(re(We),We=-1):Pe=!0,En(Ee,ct-It))):(Xe.sortIndex=Bt,o(U,Xe),ke||Ce||(ke=!0,gi(Ze))),Xe},n.unstable_shouldYield=_t,n.unstable_wrapCallback=function(Xe){var ht=pe;return function(){var ct=pe;pe=ht;try{return Xe.apply(this,arguments)}finally{pe=ct}}}})(t0);e0.exports=t0;var wb=e0.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n0=$e,mr=wb;function Me(n){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var i0=new Set,ac={};function ca(n,o){Tl(n,o),Tl(n+"Capture",o)}function Tl(n,o){for(ac[n]=o,n=0;n<o.length;n++)i0.add(o[n])}var Ro=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gf=Object.prototype.hasOwnProperty,bb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,S_={},E_={};function Sb(n){return Gf.call(E_,n)?!0:Gf.call(S_,n)?!1:bb.test(n)?E_[n]=!0:(S_[n]=!0,!1)}function Eb(n,o,l,f){if(l!==null&&l.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return f?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function Tb(n,o,l,f){if(o===null||typeof o>"u"||Eb(n,o,l,f))return!0;if(f)return!1;if(l!==null)switch(l.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function Gi(n,o,l,f,_,w,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=f,this.attributeNamespace=_,this.mustUseProperty=l,this.propertyName=n,this.type=o,this.sanitizeURL=w,this.removeEmptyString=I}var fi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){fi[n]=new Gi(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var o=n[0];fi[o]=new Gi(o,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){fi[n]=new Gi(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){fi[n]=new Gi(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){fi[n]=new Gi(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){fi[n]=new Gi(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){fi[n]=new Gi(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){fi[n]=new Gi(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){fi[n]=new Gi(n,5,!1,n.toLowerCase(),null,!1,!1)});var Xm=/[\-:]([a-z])/g;function Hm(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var o=n.replace(Xm,Hm);fi[o]=new Gi(o,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var o=n.replace(Xm,Hm);fi[o]=new Gi(o,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var o=n.replace(Xm,Hm);fi[o]=new Gi(o,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){fi[n]=new Gi(n,1,!1,n.toLowerCase(),null,!1,!1)});fi.xlinkHref=new Gi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){fi[n]=new Gi(n,1,!1,n.toLowerCase(),null,!0,!0)});function Km(n,o,l,f){var _=fi.hasOwnProperty(o)?fi[o]:null;(_!==null?_.type!==0:f||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(Tb(o,l,_,f)&&(l=null),f||_===null?Sb(o)&&(l===null?n.removeAttribute(o):n.setAttribute(o,""+l)):_.mustUseProperty?n[_.propertyName]=l===null?_.type===3?!1:"":l:(o=_.attributeName,f=_.attributeNamespace,l===null?n.removeAttribute(o):(_=_.type,l=_===3||_===4&&l===!0?"":""+l,f?n.setAttributeNS(f,o,l):n.setAttribute(o,l))))}var Uo=n0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Oh=Symbol.for("react.element"),al=Symbol.for("react.portal"),ll=Symbol.for("react.fragment"),Ym=Symbol.for("react.strict_mode"),Wf=Symbol.for("react.profiler"),r0=Symbol.for("react.provider"),o0=Symbol.for("react.context"),Jm=Symbol.for("react.forward_ref"),Xf=Symbol.for("react.suspense"),Hf=Symbol.for("react.suspense_list"),Qm=Symbol.for("react.memo"),rs=Symbol.for("react.lazy"),s0=Symbol.for("react.offscreen"),T_=Symbol.iterator;function Uu(n){return n===null||typeof n!="object"?null:(n=T_&&n[T_]||n["@@iterator"],typeof n=="function"?n:null)}var Sn=Object.assign,df;function Xu(n){if(df===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);df=o&&o[1]||""}return`
`+df+n}var pf=!1;function ff(n,o){if(!n||pf)return"";pf=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(D){var f=D}Reflect.construct(n,[],o)}else{try{o.call()}catch(D){f=D}n.call(o.prototype)}else{try{throw Error()}catch(D){f=D}n()}}catch(D){if(D&&f&&typeof D.stack=="string"){for(var _=D.stack.split(`
`),w=f.stack.split(`
`),I=_.length-1,u=w.length-1;1<=I&&0<=u&&_[I]!==w[u];)u--;for(;1<=I&&0<=u;I--,u--)if(_[I]!==w[u]){if(I!==1||u!==1)do if(I--,u--,0>u||_[I]!==w[u]){var U=`
`+_[I].replace(" at new "," at ");return n.displayName&&U.includes("<anonymous>")&&(U=U.replace("<anonymous>",n.displayName)),U}while(1<=I&&0<=u);break}}}finally{pf=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?Xu(n):""}function Cb(n){switch(n.tag){case 5:return Xu(n.type);case 16:return Xu("Lazy");case 13:return Xu("Suspense");case 19:return Xu("SuspenseList");case 0:case 2:case 15:return n=ff(n.type,!1),n;case 11:return n=ff(n.type.render,!1),n;case 1:return n=ff(n.type,!0),n;default:return""}}function Kf(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case ll:return"Fragment";case al:return"Portal";case Wf:return"Profiler";case Ym:return"StrictMode";case Xf:return"Suspense";case Hf:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case o0:return(n.displayName||"Context")+".Consumer";case r0:return(n._context.displayName||"Context")+".Provider";case Jm:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case Qm:return o=n.displayName||null,o!==null?o:Kf(n.type)||"Memo";case rs:o=n._payload,n=n._init;try{return Kf(n(o))}catch{}}return null}function Ib(n){var o=n.type;switch(n.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=o.render,n=n.displayName||n.name||"",o.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Kf(o);case 8:return o===Ym?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function xs(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function a0(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function kb(n){var o=a0(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,o),f=""+n[o];if(!n.hasOwnProperty(o)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var _=l.get,w=l.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return _.call(this)},set:function(I){f=""+I,w.call(this,I)}}),Object.defineProperty(n,o,{enumerable:l.enumerable}),{getValue:function(){return f},setValue:function(I){f=""+I},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function Uh(n){n._valueTracker||(n._valueTracker=kb(n))}function l0(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var l=o.getValue(),f="";return n&&(f=a0(n)?n.checked?"true":"false":n.value),n=f,n!==l?(o.setValue(n),!0):!1}function md(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Yf(n,o){var l=o.checked;return Sn({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function C_(n,o){var l=o.defaultValue==null?"":o.defaultValue,f=o.checked!=null?o.checked:o.defaultChecked;l=xs(o.value!=null?o.value:l),n._wrapperState={initialChecked:f,initialValue:l,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function u0(n,o){o=o.checked,o!=null&&Km(n,"checked",o,!1)}function Jf(n,o){u0(n,o);var l=xs(o.value),f=o.type;if(l!=null)f==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(f==="submit"||f==="reset"){n.removeAttribute("value");return}o.hasOwnProperty("value")?Qf(n,o.type,l):o.hasOwnProperty("defaultValue")&&Qf(n,o.type,xs(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(n.defaultChecked=!!o.defaultChecked)}function I_(n,o,l){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var f=o.type;if(!(f!=="submit"&&f!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+n._wrapperState.initialValue,l||o===n.value||(n.value=o),n.defaultValue=o}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function Qf(n,o,l){(o!=="number"||md(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var Hu=Array.isArray;function vl(n,o,l,f){if(n=n.options,o){o={};for(var _=0;_<l.length;_++)o["$"+l[_]]=!0;for(l=0;l<n.length;l++)_=o.hasOwnProperty("$"+n[l].value),n[l].selected!==_&&(n[l].selected=_),_&&f&&(n[l].defaultSelected=!0)}else{for(l=""+xs(l),o=null,_=0;_<n.length;_++){if(n[_].value===l){n[_].selected=!0,f&&(n[_].defaultSelected=!0);return}o!==null||n[_].disabled||(o=n[_])}o!==null&&(o.selected=!0)}}function em(n,o){if(o.dangerouslySetInnerHTML!=null)throw Error(Me(91));return Sn({},o,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function k_(n,o){var l=o.value;if(l==null){if(l=o.children,o=o.defaultValue,l!=null){if(o!=null)throw Error(Me(92));if(Hu(l)){if(1<l.length)throw Error(Me(93));l=l[0]}o=l}o==null&&(o=""),l=o}n._wrapperState={initialValue:xs(l)}}function c0(n,o){var l=xs(o.value),f=xs(o.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),o.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),f!=null&&(n.defaultValue=""+f)}function P_(n){var o=n.textContent;o===n._wrapperState.initialValue&&o!==""&&o!==null&&(n.value=o)}function h0(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tm(n,o){return n==null||n==="http://www.w3.org/1999/xhtml"?h0(o):n==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Nh,d0=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,l,f,_){MSApp.execUnsafeLocalFunction(function(){return n(o,l,f,_)})}:n}(function(n,o){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=o;else{for(Nh=Nh||document.createElement("div"),Nh.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Nh.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;o.firstChild;)n.appendChild(o.firstChild)}});function lc(n,o){if(o){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=o;return}}n.textContent=o}var Ju={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Pb=["Webkit","ms","Moz","O"];Object.keys(Ju).forEach(function(n){Pb.forEach(function(o){o=o+n.charAt(0).toUpperCase()+n.substring(1),Ju[o]=Ju[n]})});function p0(n,o,l){return o==null||typeof o=="boolean"||o===""?"":l||typeof o!="number"||o===0||Ju.hasOwnProperty(n)&&Ju[n]?(""+o).trim():o+"px"}function f0(n,o){n=n.style;for(var l in o)if(o.hasOwnProperty(l)){var f=l.indexOf("--")===0,_=p0(l,o[l],f);l==="float"&&(l="cssFloat"),f?n.setProperty(l,_):n[l]=_}}var Mb=Sn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function nm(n,o){if(o){if(Mb[n]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(Me(137,n));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(Me(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(Me(61))}if(o.style!=null&&typeof o.style!="object")throw Error(Me(62))}}function im(n,o){if(n.indexOf("-")===-1)return typeof o.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rm=null;function eg(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var om=null,xl=null,wl=null;function M_(n){if(n=Pc(n)){if(typeof om!="function")throw Error(Me(280));var o=n.stateNode;o&&(o=qd(o),om(n.stateNode,n.type,o))}}function m0(n){xl?wl?wl.push(n):wl=[n]:xl=n}function g0(){if(xl){var n=xl,o=wl;if(wl=xl=null,M_(n),o)for(n=0;n<o.length;n++)M_(o[n])}}function y0(n,o){return n(o)}function _0(){}var mf=!1;function v0(n,o,l){if(mf)return n(o,l);mf=!0;try{return y0(n,o,l)}finally{mf=!1,(xl!==null||wl!==null)&&(_0(),g0())}}function uc(n,o){var l=n.stateNode;if(l===null)return null;var f=qd(l);if(f===null)return null;l=f[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(n=n.type,f=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!f;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(Me(231,o,typeof l));return l}var sm=!1;if(Ro)try{var Nu={};Object.defineProperty(Nu,"passive",{get:function(){sm=!0}}),window.addEventListener("test",Nu,Nu),window.removeEventListener("test",Nu,Nu)}catch{sm=!1}function Ab(n,o,l,f,_,w,I,u,U){var D=Array.prototype.slice.call(arguments,3);try{o.apply(l,D)}catch(ue){this.onError(ue)}}var Qu=!1,gd=null,yd=!1,am=null,zb={onError:function(n){Qu=!0,gd=n}};function Db(n,o,l,f,_,w,I,u,U){Qu=!1,gd=null,Ab.apply(zb,arguments)}function Lb(n,o,l,f,_,w,I,u,U){if(Db.apply(this,arguments),Qu){if(Qu){var D=gd;Qu=!1,gd=null}else throw Error(Me(198));yd||(yd=!0,am=D)}}function ha(n){var o=n,l=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,o.flags&4098&&(l=o.return),n=o.return;while(n)}return o.tag===3?l:null}function x0(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function A_(n){if(ha(n)!==n)throw Error(Me(188))}function Rb(n){var o=n.alternate;if(!o){if(o=ha(n),o===null)throw Error(Me(188));return o!==n?null:n}for(var l=n,f=o;;){var _=l.return;if(_===null)break;var w=_.alternate;if(w===null){if(f=_.return,f!==null){l=f;continue}break}if(_.child===w.child){for(w=_.child;w;){if(w===l)return A_(_),n;if(w===f)return A_(_),o;w=w.sibling}throw Error(Me(188))}if(l.return!==f.return)l=_,f=w;else{for(var I=!1,u=_.child;u;){if(u===l){I=!0,l=_,f=w;break}if(u===f){I=!0,f=_,l=w;break}u=u.sibling}if(!I){for(u=w.child;u;){if(u===l){I=!0,l=w,f=_;break}if(u===f){I=!0,f=w,l=_;break}u=u.sibling}if(!I)throw Error(Me(189))}}if(l.alternate!==f)throw Error(Me(190))}if(l.tag!==3)throw Error(Me(188));return l.stateNode.current===l?n:o}function w0(n){return n=Rb(n),n!==null?b0(n):null}function b0(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var o=b0(n);if(o!==null)return o;n=n.sibling}return null}var S0=mr.unstable_scheduleCallback,z_=mr.unstable_cancelCallback,Bb=mr.unstable_shouldYield,Fb=mr.unstable_requestPaint,Ln=mr.unstable_now,Ob=mr.unstable_getCurrentPriorityLevel,tg=mr.unstable_ImmediatePriority,E0=mr.unstable_UserBlockingPriority,_d=mr.unstable_NormalPriority,Ub=mr.unstable_LowPriority,T0=mr.unstable_IdlePriority,Nd=null,uo=null;function Nb(n){if(uo&&typeof uo.onCommitFiberRoot=="function")try{uo.onCommitFiberRoot(Nd,n,void 0,(n.current.flags&128)===128)}catch{}}var Hr=Math.clz32?Math.clz32:jb,Vb=Math.log,$b=Math.LN2;function jb(n){return n>>>=0,n===0?32:31-(Vb(n)/$b|0)|0}var Vh=64,$h=4194304;function Ku(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function vd(n,o){var l=n.pendingLanes;if(l===0)return 0;var f=0,_=n.suspendedLanes,w=n.pingedLanes,I=l&268435455;if(I!==0){var u=I&~_;u!==0?f=Ku(u):(w&=I,w!==0&&(f=Ku(w)))}else I=l&~_,I!==0?f=Ku(I):w!==0&&(f=Ku(w));if(f===0)return 0;if(o!==0&&o!==f&&!(o&_)&&(_=f&-f,w=o&-o,_>=w||_===16&&(w&4194240)!==0))return o;if(f&4&&(f|=l&16),o=n.entangledLanes,o!==0)for(n=n.entanglements,o&=f;0<o;)l=31-Hr(o),_=1<<l,f|=n[l],o&=~_;return f}function qb(n,o){switch(n){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zb(n,o){for(var l=n.suspendedLanes,f=n.pingedLanes,_=n.expirationTimes,w=n.pendingLanes;0<w;){var I=31-Hr(w),u=1<<I,U=_[I];U===-1?(!(u&l)||u&f)&&(_[I]=qb(u,o)):U<=o&&(n.expiredLanes|=u),w&=~u}}function lm(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function C0(){var n=Vh;return Vh<<=1,!(Vh&4194240)&&(Vh=64),n}function gf(n){for(var o=[],l=0;31>l;l++)o.push(n);return o}function Ic(n,o,l){n.pendingLanes|=o,o!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,o=31-Hr(o),n[o]=l}function Gb(n,o){var l=n.pendingLanes&~o;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=o,n.mutableReadLanes&=o,n.entangledLanes&=o,o=n.entanglements;var f=n.eventTimes;for(n=n.expirationTimes;0<l;){var _=31-Hr(l),w=1<<_;o[_]=0,f[_]=-1,n[_]=-1,l&=~w}}function ng(n,o){var l=n.entangledLanes|=o;for(n=n.entanglements;l;){var f=31-Hr(l),_=1<<f;_&o|n[f]&o&&(n[f]|=o),l&=~_}}var Jt=0;function I0(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var k0,ig,P0,M0,A0,um=!1,jh=[],ds=null,ps=null,fs=null,cc=new Map,hc=new Map,ss=[],Wb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function D_(n,o){switch(n){case"focusin":case"focusout":ds=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":fs=null;break;case"pointerover":case"pointerout":cc.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":hc.delete(o.pointerId)}}function Vu(n,o,l,f,_,w){return n===null||n.nativeEvent!==w?(n={blockedOn:o,domEventName:l,eventSystemFlags:f,nativeEvent:w,targetContainers:[_]},o!==null&&(o=Pc(o),o!==null&&ig(o)),n):(n.eventSystemFlags|=f,o=n.targetContainers,_!==null&&o.indexOf(_)===-1&&o.push(_),n)}function Xb(n,o,l,f,_){switch(o){case"focusin":return ds=Vu(ds,n,o,l,f,_),!0;case"dragenter":return ps=Vu(ps,n,o,l,f,_),!0;case"mouseover":return fs=Vu(fs,n,o,l,f,_),!0;case"pointerover":var w=_.pointerId;return cc.set(w,Vu(cc.get(w)||null,n,o,l,f,_)),!0;case"gotpointercapture":return w=_.pointerId,hc.set(w,Vu(hc.get(w)||null,n,o,l,f,_)),!0}return!1}function z0(n){var o=ea(n.target);if(o!==null){var l=ha(o);if(l!==null){if(o=l.tag,o===13){if(o=x0(l),o!==null){n.blockedOn=o,A0(n.priority,function(){P0(l)});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function od(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var l=cm(n.domEventName,n.eventSystemFlags,o[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var f=new l.constructor(l.type,l);rm=f,l.target.dispatchEvent(f),rm=null}else return o=Pc(l),o!==null&&ig(o),n.blockedOn=l,!1;o.shift()}return!0}function L_(n,o,l){od(n)&&l.delete(o)}function Hb(){um=!1,ds!==null&&od(ds)&&(ds=null),ps!==null&&od(ps)&&(ps=null),fs!==null&&od(fs)&&(fs=null),cc.forEach(L_),hc.forEach(L_)}function $u(n,o){n.blockedOn===o&&(n.blockedOn=null,um||(um=!0,mr.unstable_scheduleCallback(mr.unstable_NormalPriority,Hb)))}function dc(n){function o(_){return $u(_,n)}if(0<jh.length){$u(jh[0],n);for(var l=1;l<jh.length;l++){var f=jh[l];f.blockedOn===n&&(f.blockedOn=null)}}for(ds!==null&&$u(ds,n),ps!==null&&$u(ps,n),fs!==null&&$u(fs,n),cc.forEach(o),hc.forEach(o),l=0;l<ss.length;l++)f=ss[l],f.blockedOn===n&&(f.blockedOn=null);for(;0<ss.length&&(l=ss[0],l.blockedOn===null);)z0(l),l.blockedOn===null&&ss.shift()}var bl=Uo.ReactCurrentBatchConfig,xd=!0;function Kb(n,o,l,f){var _=Jt,w=bl.transition;bl.transition=null;try{Jt=1,rg(n,o,l,f)}finally{Jt=_,bl.transition=w}}function Yb(n,o,l,f){var _=Jt,w=bl.transition;bl.transition=null;try{Jt=4,rg(n,o,l,f)}finally{Jt=_,bl.transition=w}}function rg(n,o,l,f){if(xd){var _=cm(n,o,l,f);if(_===null)Cf(n,o,f,wd,l),D_(n,f);else if(Xb(_,n,o,l,f))f.stopPropagation();else if(D_(n,f),o&4&&-1<Wb.indexOf(n)){for(;_!==null;){var w=Pc(_);if(w!==null&&k0(w),w=cm(n,o,l,f),w===null&&Cf(n,o,f,wd,l),w===_)break;_=w}_!==null&&f.stopPropagation()}else Cf(n,o,f,null,l)}}var wd=null;function cm(n,o,l,f){if(wd=null,n=eg(f),n=ea(n),n!==null)if(o=ha(n),o===null)n=null;else if(l=o.tag,l===13){if(n=x0(o),n!==null)return n;n=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null);return wd=n,null}function D0(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ob()){case tg:return 1;case E0:return 4;case _d:case Ub:return 16;case T0:return 536870912;default:return 16}default:return 16}}var us=null,og=null,sd=null;function L0(){if(sd)return sd;var n,o=og,l=o.length,f,_="value"in us?us.value:us.textContent,w=_.length;for(n=0;n<l&&o[n]===_[n];n++);var I=l-n;for(f=1;f<=I&&o[l-f]===_[w-f];f++);return sd=_.slice(n,1<f?1-f:void 0)}function ad(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function qh(){return!0}function R_(){return!1}function yr(n){function o(l,f,_,w,I){this._reactName=l,this._targetInst=_,this.type=f,this.nativeEvent=w,this.target=I,this.currentTarget=null;for(var u in n)n.hasOwnProperty(u)&&(l=n[u],this[u]=l?l(w):w[u]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?qh:R_,this.isPropagationStopped=R_,this}return Sn(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=qh)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=qh)},persist:function(){},isPersistent:qh}),o}var Rl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sg=yr(Rl),kc=Sn({},Rl,{view:0,detail:0}),Jb=yr(kc),yf,_f,ju,Vd=Sn({},kc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ag,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ju&&(ju&&n.type==="mousemove"?(yf=n.screenX-ju.screenX,_f=n.screenY-ju.screenY):_f=yf=0,ju=n),yf)},movementY:function(n){return"movementY"in n?n.movementY:_f}}),B_=yr(Vd),Qb=Sn({},Vd,{dataTransfer:0}),e2=yr(Qb),t2=Sn({},kc,{relatedTarget:0}),vf=yr(t2),n2=Sn({},Rl,{animationName:0,elapsedTime:0,pseudoElement:0}),i2=yr(n2),r2=Sn({},Rl,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),o2=yr(r2),s2=Sn({},Rl,{data:0}),F_=yr(s2),a2={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},l2={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},u2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function c2(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=u2[n])?!!o[n]:!1}function ag(){return c2}var h2=Sn({},kc,{key:function(n){if(n.key){var o=a2[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=ad(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?l2[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ag,charCode:function(n){return n.type==="keypress"?ad(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ad(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),d2=yr(h2),p2=Sn({},Vd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),O_=yr(p2),f2=Sn({},kc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ag}),m2=yr(f2),g2=Sn({},Rl,{propertyName:0,elapsedTime:0,pseudoElement:0}),y2=yr(g2),_2=Sn({},Vd,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),v2=yr(_2),x2=[9,13,27,32],lg=Ro&&"CompositionEvent"in window,ec=null;Ro&&"documentMode"in document&&(ec=document.documentMode);var w2=Ro&&"TextEvent"in window&&!ec,R0=Ro&&(!lg||ec&&8<ec&&11>=ec),U_=String.fromCharCode(32),N_=!1;function B0(n,o){switch(n){case"keyup":return x2.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function F0(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var ul=!1;function b2(n,o){switch(n){case"compositionend":return F0(o);case"keypress":return o.which!==32?null:(N_=!0,U_);case"textInput":return n=o.data,n===U_&&N_?null:n;default:return null}}function S2(n,o){if(ul)return n==="compositionend"||!lg&&B0(n,o)?(n=L0(),sd=og=us=null,ul=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return R0&&o.locale!=="ko"?null:o.data;default:return null}}var E2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function V_(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!E2[n.type]:o==="textarea"}function O0(n,o,l,f){m0(f),o=bd(o,"onChange"),0<o.length&&(l=new sg("onChange","change",null,l,f),n.push({event:l,listeners:o}))}var tc=null,pc=null;function T2(n){H0(n,0)}function $d(n){var o=dl(n);if(l0(o))return n}function C2(n,o){if(n==="change")return o}var U0=!1;if(Ro){var xf;if(Ro){var wf="oninput"in document;if(!wf){var $_=document.createElement("div");$_.setAttribute("oninput","return;"),wf=typeof $_.oninput=="function"}xf=wf}else xf=!1;U0=xf&&(!document.documentMode||9<document.documentMode)}function j_(){tc&&(tc.detachEvent("onpropertychange",N0),pc=tc=null)}function N0(n){if(n.propertyName==="value"&&$d(pc)){var o=[];O0(o,pc,n,eg(n)),v0(T2,o)}}function I2(n,o,l){n==="focusin"?(j_(),tc=o,pc=l,tc.attachEvent("onpropertychange",N0)):n==="focusout"&&j_()}function k2(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return $d(pc)}function P2(n,o){if(n==="click")return $d(o)}function M2(n,o){if(n==="input"||n==="change")return $d(o)}function A2(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var Yr=typeof Object.is=="function"?Object.is:A2;function fc(n,o){if(Yr(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var l=Object.keys(n),f=Object.keys(o);if(l.length!==f.length)return!1;for(f=0;f<l.length;f++){var _=l[f];if(!Gf.call(o,_)||!Yr(n[_],o[_]))return!1}return!0}function q_(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Z_(n,o){var l=q_(n);n=0;for(var f;l;){if(l.nodeType===3){if(f=n+l.textContent.length,n<=o&&f>=o)return{node:l,offset:o-n};n=f}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=q_(l)}}function V0(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?V0(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function $0(){for(var n=window,o=md();o instanceof n.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)n=o.contentWindow;else break;o=md(n.document)}return o}function ug(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}function z2(n){var o=$0(),l=n.focusedElem,f=n.selectionRange;if(o!==l&&l&&l.ownerDocument&&V0(l.ownerDocument.documentElement,l)){if(f!==null&&ug(l)){if(o=f.start,n=f.end,n===void 0&&(n=o),"selectionStart"in l)l.selectionStart=o,l.selectionEnd=Math.min(n,l.value.length);else if(n=(o=l.ownerDocument||document)&&o.defaultView||window,n.getSelection){n=n.getSelection();var _=l.textContent.length,w=Math.min(f.start,_);f=f.end===void 0?w:Math.min(f.end,_),!n.extend&&w>f&&(_=f,f=w,w=_),_=Z_(l,w);var I=Z_(l,f);_&&I&&(n.rangeCount!==1||n.anchorNode!==_.node||n.anchorOffset!==_.offset||n.focusNode!==I.node||n.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(_.node,_.offset),n.removeAllRanges(),w>f?(n.addRange(o),n.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),n.addRange(o)))}}for(o=[],n=l;n=n.parentNode;)n.nodeType===1&&o.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<o.length;l++)n=o[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var D2=Ro&&"documentMode"in document&&11>=document.documentMode,cl=null,hm=null,nc=null,dm=!1;function G_(n,o,l){var f=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;dm||cl==null||cl!==md(f)||(f=cl,"selectionStart"in f&&ug(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),nc&&fc(nc,f)||(nc=f,f=bd(hm,"onSelect"),0<f.length&&(o=new sg("onSelect","select",null,o,l),n.push({event:o,listeners:f}),o.target=cl)))}function Zh(n,o){var l={};return l[n.toLowerCase()]=o.toLowerCase(),l["Webkit"+n]="webkit"+o,l["Moz"+n]="moz"+o,l}var hl={animationend:Zh("Animation","AnimationEnd"),animationiteration:Zh("Animation","AnimationIteration"),animationstart:Zh("Animation","AnimationStart"),transitionend:Zh("Transition","TransitionEnd")},bf={},j0={};Ro&&(j0=document.createElement("div").style,"AnimationEvent"in window||(delete hl.animationend.animation,delete hl.animationiteration.animation,delete hl.animationstart.animation),"TransitionEvent"in window||delete hl.transitionend.transition);function jd(n){if(bf[n])return bf[n];if(!hl[n])return n;var o=hl[n],l;for(l in o)if(o.hasOwnProperty(l)&&l in j0)return bf[n]=o[l];return n}var q0=jd("animationend"),Z0=jd("animationiteration"),G0=jd("animationstart"),W0=jd("transitionend"),X0=new Map,W_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ss(n,o){X0.set(n,o),ca(o,[n])}for(var Sf=0;Sf<W_.length;Sf++){var Ef=W_[Sf],L2=Ef.toLowerCase(),R2=Ef[0].toUpperCase()+Ef.slice(1);Ss(L2,"on"+R2)}Ss(q0,"onAnimationEnd");Ss(Z0,"onAnimationIteration");Ss(G0,"onAnimationStart");Ss("dblclick","onDoubleClick");Ss("focusin","onFocus");Ss("focusout","onBlur");Ss(W0,"onTransitionEnd");Tl("onMouseEnter",["mouseout","mouseover"]);Tl("onMouseLeave",["mouseout","mouseover"]);Tl("onPointerEnter",["pointerout","pointerover"]);Tl("onPointerLeave",["pointerout","pointerover"]);ca("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ca("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ca("onBeforeInput",["compositionend","keypress","textInput","paste"]);ca("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ca("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ca("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),B2=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yu));function X_(n,o,l){var f=n.type||"unknown-event";n.currentTarget=l,Lb(f,o,void 0,n),n.currentTarget=null}function H0(n,o){o=(o&4)!==0;for(var l=0;l<n.length;l++){var f=n[l],_=f.event;f=f.listeners;e:{var w=void 0;if(o)for(var I=f.length-1;0<=I;I--){var u=f[I],U=u.instance,D=u.currentTarget;if(u=u.listener,U!==w&&_.isPropagationStopped())break e;X_(_,u,D),w=U}else for(I=0;I<f.length;I++){if(u=f[I],U=u.instance,D=u.currentTarget,u=u.listener,U!==w&&_.isPropagationStopped())break e;X_(_,u,D),w=U}}}if(yd)throw n=am,yd=!1,am=null,n}function cn(n,o){var l=o[ym];l===void 0&&(l=o[ym]=new Set);var f=n+"__bubble";l.has(f)||(K0(o,n,2,!1),l.add(f))}function Tf(n,o,l){var f=0;o&&(f|=4),K0(l,n,f,o)}var Gh="_reactListening"+Math.random().toString(36).slice(2);function mc(n){if(!n[Gh]){n[Gh]=!0,i0.forEach(function(l){l!=="selectionchange"&&(B2.has(l)||Tf(l,!1,n),Tf(l,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[Gh]||(o[Gh]=!0,Tf("selectionchange",!1,o))}}function K0(n,o,l,f){switch(D0(o)){case 1:var _=Kb;break;case 4:_=Yb;break;default:_=rg}l=_.bind(null,o,l,n),_=void 0,!sm||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(_=!0),f?_!==void 0?n.addEventListener(o,l,{capture:!0,passive:_}):n.addEventListener(o,l,!0):_!==void 0?n.addEventListener(o,l,{passive:_}):n.addEventListener(o,l,!1)}function Cf(n,o,l,f,_){var w=f;if(!(o&1)&&!(o&2)&&f!==null)e:for(;;){if(f===null)return;var I=f.tag;if(I===3||I===4){var u=f.stateNode.containerInfo;if(u===_||u.nodeType===8&&u.parentNode===_)break;if(I===4)for(I=f.return;I!==null;){var U=I.tag;if((U===3||U===4)&&(U=I.stateNode.containerInfo,U===_||U.nodeType===8&&U.parentNode===_))return;I=I.return}for(;u!==null;){if(I=ea(u),I===null)return;if(U=I.tag,U===5||U===6){f=w=I;continue e}u=u.parentNode}}f=f.return}v0(function(){var D=w,ue=eg(l),ie=[];e:{var pe=X0.get(n);if(pe!==void 0){var Ce=sg,ke=n;switch(n){case"keypress":if(ad(l)===0)break e;case"keydown":case"keyup":Ce=d2;break;case"focusin":ke="focus",Ce=vf;break;case"focusout":ke="blur",Ce=vf;break;case"beforeblur":case"afterblur":Ce=vf;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ce=B_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ce=e2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ce=m2;break;case q0:case Z0:case G0:Ce=i2;break;case W0:Ce=y2;break;case"scroll":Ce=Jb;break;case"wheel":Ce=v2;break;case"copy":case"cut":case"paste":Ce=o2;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ce=O_}var Pe=(o&4)!==0,qe=!Pe&&n==="scroll",re=Pe?pe!==null?pe+"Capture":null:pe;Pe=[];for(var te=D,le;te!==null;){le=te;var Ee=le.stateNode;if(le.tag===5&&Ee!==null&&(le=Ee,re!==null&&(Ee=uc(te,re),Ee!=null&&Pe.push(gc(te,Ee,le)))),qe)break;te=te.return}0<Pe.length&&(pe=new Ce(pe,ke,null,l,ue),ie.push({event:pe,listeners:Pe}))}}if(!(o&7)){e:{if(pe=n==="mouseover"||n==="pointerover",Ce=n==="mouseout"||n==="pointerout",pe&&l!==rm&&(ke=l.relatedTarget||l.fromElement)&&(ea(ke)||ke[Bo]))break e;if((Ce||pe)&&(pe=ue.window===ue?ue:(pe=ue.ownerDocument)?pe.defaultView||pe.parentWindow:window,Ce?(ke=l.relatedTarget||l.toElement,Ce=D,ke=ke?ea(ke):null,ke!==null&&(qe=ha(ke),ke!==qe||ke.tag!==5&&ke.tag!==6)&&(ke=null)):(Ce=null,ke=D),Ce!==ke)){if(Pe=B_,Ee="onMouseLeave",re="onMouseEnter",te="mouse",(n==="pointerout"||n==="pointerover")&&(Pe=O_,Ee="onPointerLeave",re="onPointerEnter",te="pointer"),qe=Ce==null?pe:dl(Ce),le=ke==null?pe:dl(ke),pe=new Pe(Ee,te+"leave",Ce,l,ue),pe.target=qe,pe.relatedTarget=le,Ee=null,ea(ue)===D&&(Pe=new Pe(re,te+"enter",ke,l,ue),Pe.target=le,Pe.relatedTarget=qe,Ee=Pe),qe=Ee,Ce&&ke)t:{for(Pe=Ce,re=ke,te=0,le=Pe;le;le=sl(le))te++;for(le=0,Ee=re;Ee;Ee=sl(Ee))le++;for(;0<te-le;)Pe=sl(Pe),te--;for(;0<le-te;)re=sl(re),le--;for(;te--;){if(Pe===re||re!==null&&Pe===re.alternate)break t;Pe=sl(Pe),re=sl(re)}Pe=null}else Pe=null;Ce!==null&&H_(ie,pe,Ce,Pe,!1),ke!==null&&qe!==null&&H_(ie,qe,ke,Pe,!0)}}e:{if(pe=D?dl(D):window,Ce=pe.nodeName&&pe.nodeName.toLowerCase(),Ce==="select"||Ce==="input"&&pe.type==="file")var Ze=C2;else if(V_(pe))if(U0)Ze=M2;else{Ze=k2;var Fe=I2}else(Ce=pe.nodeName)&&Ce.toLowerCase()==="input"&&(pe.type==="checkbox"||pe.type==="radio")&&(Ze=P2);if(Ze&&(Ze=Ze(n,D))){O0(ie,Ze,l,ue);break e}Fe&&Fe(n,pe,D),n==="focusout"&&(Fe=pe._wrapperState)&&Fe.controlled&&pe.type==="number"&&Qf(pe,"number",pe.value)}switch(Fe=D?dl(D):window,n){case"focusin":(V_(Fe)||Fe.contentEditable==="true")&&(cl=Fe,hm=D,nc=null);break;case"focusout":nc=hm=cl=null;break;case"mousedown":dm=!0;break;case"contextmenu":case"mouseup":case"dragend":dm=!1,G_(ie,l,ue);break;case"selectionchange":if(D2)break;case"keydown":case"keyup":G_(ie,l,ue)}var Ae;if(lg)e:{switch(n){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else ul?B0(n,l)&&(We="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(We="onCompositionStart");We&&(R0&&l.locale!=="ko"&&(ul||We!=="onCompositionStart"?We==="onCompositionEnd"&&ul&&(Ae=L0()):(us=ue,og="value"in us?us.value:us.textContent,ul=!0)),Fe=bd(D,We),0<Fe.length&&(We=new F_(We,n,null,l,ue),ie.push({event:We,listeners:Fe}),Ae?We.data=Ae:(Ae=F0(l),Ae!==null&&(We.data=Ae)))),(Ae=w2?b2(n,l):S2(n,l))&&(D=bd(D,"onBeforeInput"),0<D.length&&(ue=new F_("onBeforeInput","beforeinput",null,l,ue),ie.push({event:ue,listeners:D}),ue.data=Ae))}H0(ie,o)})}function gc(n,o,l){return{instance:n,listener:o,currentTarget:l}}function bd(n,o){for(var l=o+"Capture",f=[];n!==null;){var _=n,w=_.stateNode;_.tag===5&&w!==null&&(_=w,w=uc(n,l),w!=null&&f.unshift(gc(n,w,_)),w=uc(n,o),w!=null&&f.push(gc(n,w,_))),n=n.return}return f}function sl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function H_(n,o,l,f,_){for(var w=o._reactName,I=[];l!==null&&l!==f;){var u=l,U=u.alternate,D=u.stateNode;if(U!==null&&U===f)break;u.tag===5&&D!==null&&(u=D,_?(U=uc(l,w),U!=null&&I.unshift(gc(l,U,u))):_||(U=uc(l,w),U!=null&&I.push(gc(l,U,u)))),l=l.return}I.length!==0&&n.push({event:o,listeners:I})}var F2=/\r\n?/g,O2=/\u0000|\uFFFD/g;function K_(n){return(typeof n=="string"?n:""+n).replace(F2,`
`).replace(O2,"")}function Wh(n,o,l){if(o=K_(o),K_(n)!==o&&l)throw Error(Me(425))}function Sd(){}var pm=null,fm=null;function mm(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var gm=typeof setTimeout=="function"?setTimeout:void 0,U2=typeof clearTimeout=="function"?clearTimeout:void 0,Y_=typeof Promise=="function"?Promise:void 0,N2=typeof queueMicrotask=="function"?queueMicrotask:typeof Y_<"u"?function(n){return Y_.resolve(null).then(n).catch(V2)}:gm;function V2(n){setTimeout(function(){throw n})}function If(n,o){var l=o,f=0;do{var _=l.nextSibling;if(n.removeChild(l),_&&_.nodeType===8)if(l=_.data,l==="/$"){if(f===0){n.removeChild(_),dc(o);return}f--}else l!=="$"&&l!=="$?"&&l!=="$!"||f++;l=_}while(l);dc(o)}function ms(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return n}function J_(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(o===0)return n;o--}else l==="/$"&&o++}n=n.previousSibling}return null}var Bl=Math.random().toString(36).slice(2),lo="__reactFiber$"+Bl,yc="__reactProps$"+Bl,Bo="__reactContainer$"+Bl,ym="__reactEvents$"+Bl,$2="__reactListeners$"+Bl,j2="__reactHandles$"+Bl;function ea(n){var o=n[lo];if(o)return o;for(var l=n.parentNode;l;){if(o=l[Bo]||l[lo]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(n=J_(n);n!==null;){if(l=n[lo])return l;n=J_(n)}return o}n=l,l=n.parentNode}return null}function Pc(n){return n=n[lo]||n[Bo],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function dl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(Me(33))}function qd(n){return n[yc]||null}var _m=[],pl=-1;function Es(n){return{current:n}}function hn(n){0>pl||(n.current=_m[pl],_m[pl]=null,pl--)}function ln(n,o){pl++,_m[pl]=n.current,n.current=o}var ws={},Ai=Es(ws),tr=Es(!1),oa=ws;function Cl(n,o){var l=n.type.contextTypes;if(!l)return ws;var f=n.stateNode;if(f&&f.__reactInternalMemoizedUnmaskedChildContext===o)return f.__reactInternalMemoizedMaskedChildContext;var _={},w;for(w in l)_[w]=o[w];return f&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=o,n.__reactInternalMemoizedMaskedChildContext=_),_}function nr(n){return n=n.childContextTypes,n!=null}function Ed(){hn(tr),hn(Ai)}function Q_(n,o,l){if(Ai.current!==ws)throw Error(Me(168));ln(Ai,o),ln(tr,l)}function Y0(n,o,l){var f=n.stateNode;if(o=o.childContextTypes,typeof f.getChildContext!="function")return l;f=f.getChildContext();for(var _ in f)if(!(_ in o))throw Error(Me(108,Ib(n)||"Unknown",_));return Sn({},l,f)}function Td(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ws,oa=Ai.current,ln(Ai,n),ln(tr,tr.current),!0}function ev(n,o,l){var f=n.stateNode;if(!f)throw Error(Me(169));l?(n=Y0(n,o,oa),f.__reactInternalMemoizedMergedChildContext=n,hn(tr),hn(Ai),ln(Ai,n)):hn(tr),ln(tr,l)}var Po=null,Zd=!1,kf=!1;function J0(n){Po===null?Po=[n]:Po.push(n)}function q2(n){Zd=!0,J0(n)}function Ts(){if(!kf&&Po!==null){kf=!0;var n=0,o=Jt;try{var l=Po;for(Jt=1;n<l.length;n++){var f=l[n];do f=f(!0);while(f!==null)}Po=null,Zd=!1}catch(_){throw Po!==null&&(Po=Po.slice(n+1)),S0(tg,Ts),_}finally{Jt=o,kf=!1}}return null}var fl=[],ml=0,Cd=null,Id=0,kr=[],Pr=0,sa=null,zo=1,Do="";function Js(n,o){fl[ml++]=Id,fl[ml++]=Cd,Cd=n,Id=o}function Q0(n,o,l){kr[Pr++]=zo,kr[Pr++]=Do,kr[Pr++]=sa,sa=n;var f=zo;n=Do;var _=32-Hr(f)-1;f&=~(1<<_),l+=1;var w=32-Hr(o)+_;if(30<w){var I=_-_%5;w=(f&(1<<I)-1).toString(32),f>>=I,_-=I,zo=1<<32-Hr(o)+_|l<<_|f,Do=w+n}else zo=1<<w|l<<_|f,Do=n}function cg(n){n.return!==null&&(Js(n,1),Q0(n,1,0))}function hg(n){for(;n===Cd;)Cd=fl[--ml],fl[ml]=null,Id=fl[--ml],fl[ml]=null;for(;n===sa;)sa=kr[--Pr],kr[Pr]=null,Do=kr[--Pr],kr[Pr]=null,zo=kr[--Pr],kr[Pr]=null}var fr=null,pr=null,mn=!1,Wr=null;function ex(n,o){var l=Mr(5,null,null,0);l.elementType="DELETED",l.stateNode=o,l.return=n,o=n.deletions,o===null?(n.deletions=[l],n.flags|=16):o.push(l)}function tv(n,o){switch(n.tag){case 5:var l=n.type;return o=o.nodeType!==1||l.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(n.stateNode=o,fr=n,pr=ms(o.firstChild),!0):!1;case 6:return o=n.pendingProps===""||o.nodeType!==3?null:o,o!==null?(n.stateNode=o,fr=n,pr=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(l=sa!==null?{id:zo,overflow:Do}:null,n.memoizedState={dehydrated:o,treeContext:l,retryLane:1073741824},l=Mr(18,null,null,0),l.stateNode=o,l.return=n,n.child=l,fr=n,pr=null,!0):!1;default:return!1}}function vm(n){return(n.mode&1)!==0&&(n.flags&128)===0}function xm(n){if(mn){var o=pr;if(o){var l=o;if(!tv(n,o)){if(vm(n))throw Error(Me(418));o=ms(l.nextSibling);var f=fr;o&&tv(n,o)?ex(f,l):(n.flags=n.flags&-4097|2,mn=!1,fr=n)}}else{if(vm(n))throw Error(Me(418));n.flags=n.flags&-4097|2,mn=!1,fr=n}}}function nv(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;fr=n}function Xh(n){if(n!==fr)return!1;if(!mn)return nv(n),mn=!0,!1;var o;if((o=n.tag!==3)&&!(o=n.tag!==5)&&(o=n.type,o=o!=="head"&&o!=="body"&&!mm(n.type,n.memoizedProps)),o&&(o=pr)){if(vm(n))throw tx(),Error(Me(418));for(;o;)ex(n,o),o=ms(o.nextSibling)}if(nv(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(Me(317));e:{for(n=n.nextSibling,o=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(o===0){pr=ms(n.nextSibling);break e}o--}else l!=="$"&&l!=="$!"&&l!=="$?"||o++}n=n.nextSibling}pr=null}}else pr=fr?ms(n.stateNode.nextSibling):null;return!0}function tx(){for(var n=pr;n;)n=ms(n.nextSibling)}function Il(){pr=fr=null,mn=!1}function dg(n){Wr===null?Wr=[n]:Wr.push(n)}var Z2=Uo.ReactCurrentBatchConfig;function Zr(n,o){if(n&&n.defaultProps){o=Sn({},o),n=n.defaultProps;for(var l in n)o[l]===void 0&&(o[l]=n[l]);return o}return o}var kd=Es(null),Pd=null,gl=null,pg=null;function fg(){pg=gl=Pd=null}function mg(n){var o=kd.current;hn(kd),n._currentValue=o}function wm(n,o,l){for(;n!==null;){var f=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,f!==null&&(f.childLanes|=o)):f!==null&&(f.childLanes&o)!==o&&(f.childLanes|=o),n===l)break;n=n.return}}function Sl(n,o){Pd=n,pg=gl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&o&&(er=!0),n.firstContext=null)}function zr(n){var o=n._currentValue;if(pg!==n)if(n={context:n,memoizedValue:o,next:null},gl===null){if(Pd===null)throw Error(Me(308));gl=n,Pd.dependencies={lanes:0,firstContext:n}}else gl=gl.next=n;return o}var ta=null;function gg(n){ta===null?ta=[n]:ta.push(n)}function nx(n,o,l,f){var _=o.interleaved;return _===null?(l.next=l,gg(o)):(l.next=_.next,_.next=l),o.interleaved=l,Fo(n,f)}function Fo(n,o){n.lanes|=o;var l=n.alternate;for(l!==null&&(l.lanes|=o),l=n,n=n.return;n!==null;)n.childLanes|=o,l=n.alternate,l!==null&&(l.childLanes|=o),l=n,n=n.return;return l.tag===3?l.stateNode:null}var os=!1;function yg(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ix(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Lo(n,o){return{eventTime:n,lane:o,tag:0,payload:null,callback:null,next:null}}function gs(n,o,l){var f=n.updateQueue;if(f===null)return null;if(f=f.shared,jt&2){var _=f.pending;return _===null?o.next=o:(o.next=_.next,_.next=o),f.pending=o,Fo(n,l)}return _=f.interleaved,_===null?(o.next=o,gg(f)):(o.next=_.next,_.next=o),f.interleaved=o,Fo(n,l)}function ld(n,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194240)!==0)){var f=o.lanes;f&=n.pendingLanes,l|=f,o.lanes=l,ng(n,l)}}function iv(n,o){var l=n.updateQueue,f=n.alternate;if(f!==null&&(f=f.updateQueue,l===f)){var _=null,w=null;if(l=l.firstBaseUpdate,l!==null){do{var I={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};w===null?_=w=I:w=w.next=I,l=l.next}while(l!==null);w===null?_=w=o:w=w.next=o}else _=w=o;l={baseState:f.baseState,firstBaseUpdate:_,lastBaseUpdate:w,shared:f.shared,effects:f.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=o:n.next=o,l.lastBaseUpdate=o}function Md(n,o,l,f){var _=n.updateQueue;os=!1;var w=_.firstBaseUpdate,I=_.lastBaseUpdate,u=_.shared.pending;if(u!==null){_.shared.pending=null;var U=u,D=U.next;U.next=null,I===null?w=D:I.next=D,I=U;var ue=n.alternate;ue!==null&&(ue=ue.updateQueue,u=ue.lastBaseUpdate,u!==I&&(u===null?ue.firstBaseUpdate=D:u.next=D,ue.lastBaseUpdate=U))}if(w!==null){var ie=_.baseState;I=0,ue=D=U=null,u=w;do{var pe=u.lane,Ce=u.eventTime;if((f&pe)===pe){ue!==null&&(ue=ue.next={eventTime:Ce,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var ke=n,Pe=u;switch(pe=o,Ce=l,Pe.tag){case 1:if(ke=Pe.payload,typeof ke=="function"){ie=ke.call(Ce,ie,pe);break e}ie=ke;break e;case 3:ke.flags=ke.flags&-65537|128;case 0:if(ke=Pe.payload,pe=typeof ke=="function"?ke.call(Ce,ie,pe):ke,pe==null)break e;ie=Sn({},ie,pe);break e;case 2:os=!0}}u.callback!==null&&u.lane!==0&&(n.flags|=64,pe=_.effects,pe===null?_.effects=[u]:pe.push(u))}else Ce={eventTime:Ce,lane:pe,tag:u.tag,payload:u.payload,callback:u.callback,next:null},ue===null?(D=ue=Ce,U=ie):ue=ue.next=Ce,I|=pe;if(u=u.next,u===null){if(u=_.shared.pending,u===null)break;pe=u,u=pe.next,pe.next=null,_.lastBaseUpdate=pe,_.shared.pending=null}}while(1);if(ue===null&&(U=ie),_.baseState=U,_.firstBaseUpdate=D,_.lastBaseUpdate=ue,o=_.shared.interleaved,o!==null){_=o;do I|=_.lane,_=_.next;while(_!==o)}else w===null&&(_.shared.lanes=0);la|=I,n.lanes=I,n.memoizedState=ie}}function rv(n,o,l){if(n=o.effects,o.effects=null,n!==null)for(o=0;o<n.length;o++){var f=n[o],_=f.callback;if(_!==null){if(f.callback=null,f=l,typeof _!="function")throw Error(Me(191,_));_.call(f)}}}var rx=new n0.Component().refs;function bm(n,o,l,f){o=n.memoizedState,l=l(f,o),l=l==null?o:Sn({},o,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var Gd={isMounted:function(n){return(n=n._reactInternals)?ha(n)===n:!1},enqueueSetState:function(n,o,l){n=n._reactInternals;var f=qi(),_=_s(n),w=Lo(f,_);w.payload=o,l!=null&&(w.callback=l),o=gs(n,w,_),o!==null&&(Kr(o,n,_,f),ld(o,n,_))},enqueueReplaceState:function(n,o,l){n=n._reactInternals;var f=qi(),_=_s(n),w=Lo(f,_);w.tag=1,w.payload=o,l!=null&&(w.callback=l),o=gs(n,w,_),o!==null&&(Kr(o,n,_,f),ld(o,n,_))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var l=qi(),f=_s(n),_=Lo(l,f);_.tag=2,o!=null&&(_.callback=o),o=gs(n,_,f),o!==null&&(Kr(o,n,f,l),ld(o,n,f))}};function ov(n,o,l,f,_,w,I){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(f,w,I):o.prototype&&o.prototype.isPureReactComponent?!fc(l,f)||!fc(_,w):!0}function ox(n,o,l){var f=!1,_=ws,w=o.contextType;return typeof w=="object"&&w!==null?w=zr(w):(_=nr(o)?oa:Ai.current,f=o.contextTypes,w=(f=f!=null)?Cl(n,_):ws),o=new o(l,w),n.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Gd,n.stateNode=o,o._reactInternals=n,f&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=_,n.__reactInternalMemoizedMaskedChildContext=w),o}function sv(n,o,l,f){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,f),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,f),o.state!==n&&Gd.enqueueReplaceState(o,o.state,null)}function Sm(n,o,l,f){var _=n.stateNode;_.props=l,_.state=n.memoizedState,_.refs=rx,yg(n);var w=o.contextType;typeof w=="object"&&w!==null?_.context=zr(w):(w=nr(o)?oa:Ai.current,_.context=Cl(n,w)),_.state=n.memoizedState,w=o.getDerivedStateFromProps,typeof w=="function"&&(bm(n,o,w,l),_.state=n.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(o=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),o!==_.state&&Gd.enqueueReplaceState(_,_.state,null),Md(n,l,_,f),_.state=n.memoizedState),typeof _.componentDidMount=="function"&&(n.flags|=4194308)}function qu(n,o,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(Me(309));var f=l.stateNode}if(!f)throw Error(Me(147,n));var _=f,w=""+n;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===w?o.ref:(o=function(I){var u=_.refs;u===rx&&(u=_.refs={}),I===null?delete u[w]:u[w]=I},o._stringRef=w,o)}if(typeof n!="string")throw Error(Me(284));if(!l._owner)throw Error(Me(290,n))}return n}function Hh(n,o){throw n=Object.prototype.toString.call(o),Error(Me(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n))}function av(n){var o=n._init;return o(n._payload)}function sx(n){function o(re,te){if(n){var le=re.deletions;le===null?(re.deletions=[te],re.flags|=16):le.push(te)}}function l(re,te){if(!n)return null;for(;te!==null;)o(re,te),te=te.sibling;return null}function f(re,te){for(re=new Map;te!==null;)te.key!==null?re.set(te.key,te):re.set(te.index,te),te=te.sibling;return re}function _(re,te){return re=vs(re,te),re.index=0,re.sibling=null,re}function w(re,te,le){return re.index=le,n?(le=re.alternate,le!==null?(le=le.index,le<te?(re.flags|=2,te):le):(re.flags|=2,te)):(re.flags|=1048576,te)}function I(re){return n&&re.alternate===null&&(re.flags|=2),re}function u(re,te,le,Ee){return te===null||te.tag!==6?(te=Rf(le,re.mode,Ee),te.return=re,te):(te=_(te,le),te.return=re,te)}function U(re,te,le,Ee){var Ze=le.type;return Ze===ll?ue(re,te,le.props.children,Ee,le.key):te!==null&&(te.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===rs&&av(Ze)===te.type)?(Ee=_(te,le.props),Ee.ref=qu(re,te,le),Ee.return=re,Ee):(Ee=fd(le.type,le.key,le.props,null,re.mode,Ee),Ee.ref=qu(re,te,le),Ee.return=re,Ee)}function D(re,te,le,Ee){return te===null||te.tag!==4||te.stateNode.containerInfo!==le.containerInfo||te.stateNode.implementation!==le.implementation?(te=Bf(le,re.mode,Ee),te.return=re,te):(te=_(te,le.children||[]),te.return=re,te)}function ue(re,te,le,Ee,Ze){return te===null||te.tag!==7?(te=ra(le,re.mode,Ee,Ze),te.return=re,te):(te=_(te,le),te.return=re,te)}function ie(re,te,le){if(typeof te=="string"&&te!==""||typeof te=="number")return te=Rf(""+te,re.mode,le),te.return=re,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case Oh:return le=fd(te.type,te.key,te.props,null,re.mode,le),le.ref=qu(re,null,te),le.return=re,le;case al:return te=Bf(te,re.mode,le),te.return=re,te;case rs:var Ee=te._init;return ie(re,Ee(te._payload),le)}if(Hu(te)||Uu(te))return te=ra(te,re.mode,le,null),te.return=re,te;Hh(re,te)}return null}function pe(re,te,le,Ee){var Ze=te!==null?te.key:null;if(typeof le=="string"&&le!==""||typeof le=="number")return Ze!==null?null:u(re,te,""+le,Ee);if(typeof le=="object"&&le!==null){switch(le.$$typeof){case Oh:return le.key===Ze?U(re,te,le,Ee):null;case al:return le.key===Ze?D(re,te,le,Ee):null;case rs:return Ze=le._init,pe(re,te,Ze(le._payload),Ee)}if(Hu(le)||Uu(le))return Ze!==null?null:ue(re,te,le,Ee,null);Hh(re,le)}return null}function Ce(re,te,le,Ee,Ze){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return re=re.get(le)||null,u(te,re,""+Ee,Ze);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case Oh:return re=re.get(Ee.key===null?le:Ee.key)||null,U(te,re,Ee,Ze);case al:return re=re.get(Ee.key===null?le:Ee.key)||null,D(te,re,Ee,Ze);case rs:var Fe=Ee._init;return Ce(re,te,le,Fe(Ee._payload),Ze)}if(Hu(Ee)||Uu(Ee))return re=re.get(le)||null,ue(te,re,Ee,Ze,null);Hh(te,Ee)}return null}function ke(re,te,le,Ee){for(var Ze=null,Fe=null,Ae=te,We=te=0,bt=null;Ae!==null&&We<le.length;We++){Ae.index>We?(bt=Ae,Ae=null):bt=Ae.sibling;var st=pe(re,Ae,le[We],Ee);if(st===null){Ae===null&&(Ae=bt);break}n&&Ae&&st.alternate===null&&o(re,Ae),te=w(st,te,We),Fe===null?Ze=st:Fe.sibling=st,Fe=st,Ae=bt}if(We===le.length)return l(re,Ae),mn&&Js(re,We),Ze;if(Ae===null){for(;We<le.length;We++)Ae=ie(re,le[We],Ee),Ae!==null&&(te=w(Ae,te,We),Fe===null?Ze=Ae:Fe.sibling=Ae,Fe=Ae);return mn&&Js(re,We),Ze}for(Ae=f(re,Ae);We<le.length;We++)bt=Ce(Ae,re,We,le[We],Ee),bt!==null&&(n&&bt.alternate!==null&&Ae.delete(bt.key===null?We:bt.key),te=w(bt,te,We),Fe===null?Ze=bt:Fe.sibling=bt,Fe=bt);return n&&Ae.forEach(function(_t){return o(re,_t)}),mn&&Js(re,We),Ze}function Pe(re,te,le,Ee){var Ze=Uu(le);if(typeof Ze!="function")throw Error(Me(150));if(le=Ze.call(le),le==null)throw Error(Me(151));for(var Fe=Ze=null,Ae=te,We=te=0,bt=null,st=le.next();Ae!==null&&!st.done;We++,st=le.next()){Ae.index>We?(bt=Ae,Ae=null):bt=Ae.sibling;var _t=pe(re,Ae,st.value,Ee);if(_t===null){Ae===null&&(Ae=bt);break}n&&Ae&&_t.alternate===null&&o(re,Ae),te=w(_t,te,We),Fe===null?Ze=_t:Fe.sibling=_t,Fe=_t,Ae=bt}if(st.done)return l(re,Ae),mn&&Js(re,We),Ze;if(Ae===null){for(;!st.done;We++,st=le.next())st=ie(re,st.value,Ee),st!==null&&(te=w(st,te,We),Fe===null?Ze=st:Fe.sibling=st,Fe=st);return mn&&Js(re,We),Ze}for(Ae=f(re,Ae);!st.done;We++,st=le.next())st=Ce(Ae,re,We,st.value,Ee),st!==null&&(n&&st.alternate!==null&&Ae.delete(st.key===null?We:st.key),te=w(st,te,We),Fe===null?Ze=st:Fe.sibling=st,Fe=st);return n&&Ae.forEach(function(mi){return o(re,mi)}),mn&&Js(re,We),Ze}function qe(re,te,le,Ee){if(typeof le=="object"&&le!==null&&le.type===ll&&le.key===null&&(le=le.props.children),typeof le=="object"&&le!==null){switch(le.$$typeof){case Oh:e:{for(var Ze=le.key,Fe=te;Fe!==null;){if(Fe.key===Ze){if(Ze=le.type,Ze===ll){if(Fe.tag===7){l(re,Fe.sibling),te=_(Fe,le.props.children),te.return=re,re=te;break e}}else if(Fe.elementType===Ze||typeof Ze=="object"&&Ze!==null&&Ze.$$typeof===rs&&av(Ze)===Fe.type){l(re,Fe.sibling),te=_(Fe,le.props),te.ref=qu(re,Fe,le),te.return=re,re=te;break e}l(re,Fe);break}else o(re,Fe);Fe=Fe.sibling}le.type===ll?(te=ra(le.props.children,re.mode,Ee,le.key),te.return=re,re=te):(Ee=fd(le.type,le.key,le.props,null,re.mode,Ee),Ee.ref=qu(re,te,le),Ee.return=re,re=Ee)}return I(re);case al:e:{for(Fe=le.key;te!==null;){if(te.key===Fe)if(te.tag===4&&te.stateNode.containerInfo===le.containerInfo&&te.stateNode.implementation===le.implementation){l(re,te.sibling),te=_(te,le.children||[]),te.return=re,re=te;break e}else{l(re,te);break}else o(re,te);te=te.sibling}te=Bf(le,re.mode,Ee),te.return=re,re=te}return I(re);case rs:return Fe=le._init,qe(re,te,Fe(le._payload),Ee)}if(Hu(le))return ke(re,te,le,Ee);if(Uu(le))return Pe(re,te,le,Ee);Hh(re,le)}return typeof le=="string"&&le!==""||typeof le=="number"?(le=""+le,te!==null&&te.tag===6?(l(re,te.sibling),te=_(te,le),te.return=re,re=te):(l(re,te),te=Rf(le,re.mode,Ee),te.return=re,re=te),I(re)):l(re,te)}return qe}var kl=sx(!0),ax=sx(!1),Mc={},co=Es(Mc),_c=Es(Mc),vc=Es(Mc);function na(n){if(n===Mc)throw Error(Me(174));return n}function _g(n,o){switch(ln(vc,o),ln(_c,n),ln(co,Mc),n=o.nodeType,n){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:tm(null,"");break;default:n=n===8?o.parentNode:o,o=n.namespaceURI||null,n=n.tagName,o=tm(o,n)}hn(co),ln(co,o)}function Pl(){hn(co),hn(_c),hn(vc)}function lx(n){na(vc.current);var o=na(co.current),l=tm(o,n.type);o!==l&&(ln(_c,n),ln(co,l))}function vg(n){_c.current===n&&(hn(co),hn(_c))}var wn=Es(0);function Ad(n){for(var o=n;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Pf=[];function xg(){for(var n=0;n<Pf.length;n++)Pf[n]._workInProgressVersionPrimary=null;Pf.length=0}var ud=Uo.ReactCurrentDispatcher,Mf=Uo.ReactCurrentBatchConfig,aa=0,bn=null,Xn=null,ri=null,zd=!1,ic=!1,xc=0,G2=0;function ki(){throw Error(Me(321))}function wg(n,o){if(o===null)return!1;for(var l=0;l<o.length&&l<n.length;l++)if(!Yr(n[l],o[l]))return!1;return!0}function bg(n,o,l,f,_,w){if(aa=w,bn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,ud.current=n===null||n.memoizedState===null?K2:Y2,n=l(f,_),ic){w=0;do{if(ic=!1,xc=0,25<=w)throw Error(Me(301));w+=1,ri=Xn=null,o.updateQueue=null,ud.current=J2,n=l(f,_)}while(ic)}if(ud.current=Dd,o=Xn!==null&&Xn.next!==null,aa=0,ri=Xn=bn=null,zd=!1,o)throw Error(Me(300));return n}function Sg(){var n=xc!==0;return xc=0,n}function ao(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ri===null?bn.memoizedState=ri=n:ri=ri.next=n,ri}function Dr(){if(Xn===null){var n=bn.alternate;n=n!==null?n.memoizedState:null}else n=Xn.next;var o=ri===null?bn.memoizedState:ri.next;if(o!==null)ri=o,Xn=n;else{if(n===null)throw Error(Me(310));Xn=n,n={memoizedState:Xn.memoizedState,baseState:Xn.baseState,baseQueue:Xn.baseQueue,queue:Xn.queue,next:null},ri===null?bn.memoizedState=ri=n:ri=ri.next=n}return ri}function wc(n,o){return typeof o=="function"?o(n):o}function Af(n){var o=Dr(),l=o.queue;if(l===null)throw Error(Me(311));l.lastRenderedReducer=n;var f=Xn,_=f.baseQueue,w=l.pending;if(w!==null){if(_!==null){var I=_.next;_.next=w.next,w.next=I}f.baseQueue=_=w,l.pending=null}if(_!==null){w=_.next,f=f.baseState;var u=I=null,U=null,D=w;do{var ue=D.lane;if((aa&ue)===ue)U!==null&&(U=U.next={lane:0,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null}),f=D.hasEagerState?D.eagerState:n(f,D.action);else{var ie={lane:ue,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null};U===null?(u=U=ie,I=f):U=U.next=ie,bn.lanes|=ue,la|=ue}D=D.next}while(D!==null&&D!==w);U===null?I=f:U.next=u,Yr(f,o.memoizedState)||(er=!0),o.memoizedState=f,o.baseState=I,o.baseQueue=U,l.lastRenderedState=f}if(n=l.interleaved,n!==null){_=n;do w=_.lane,bn.lanes|=w,la|=w,_=_.next;while(_!==n)}else _===null&&(l.lanes=0);return[o.memoizedState,l.dispatch]}function zf(n){var o=Dr(),l=o.queue;if(l===null)throw Error(Me(311));l.lastRenderedReducer=n;var f=l.dispatch,_=l.pending,w=o.memoizedState;if(_!==null){l.pending=null;var I=_=_.next;do w=n(w,I.action),I=I.next;while(I!==_);Yr(w,o.memoizedState)||(er=!0),o.memoizedState=w,o.baseQueue===null&&(o.baseState=w),l.lastRenderedState=w}return[w,f]}function ux(){}function cx(n,o){var l=bn,f=Dr(),_=o(),w=!Yr(f.memoizedState,_);if(w&&(f.memoizedState=_,er=!0),f=f.queue,Eg(px.bind(null,l,f,n),[n]),f.getSnapshot!==o||w||ri!==null&&ri.memoizedState.tag&1){if(l.flags|=2048,bc(9,dx.bind(null,l,f,_,o),void 0,null),oi===null)throw Error(Me(349));aa&30||hx(l,o,_)}return _}function hx(n,o,l){n.flags|=16384,n={getSnapshot:o,value:l},o=bn.updateQueue,o===null?(o={lastEffect:null,stores:null},bn.updateQueue=o,o.stores=[n]):(l=o.stores,l===null?o.stores=[n]:l.push(n))}function dx(n,o,l,f){o.value=l,o.getSnapshot=f,fx(o)&&mx(n)}function px(n,o,l){return l(function(){fx(o)&&mx(n)})}function fx(n){var o=n.getSnapshot;n=n.value;try{var l=o();return!Yr(n,l)}catch{return!0}}function mx(n){var o=Fo(n,1);o!==null&&Kr(o,n,1,-1)}function lv(n){var o=ao();return typeof n=="function"&&(n=n()),o.memoizedState=o.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:n},o.queue=n,n=n.dispatch=H2.bind(null,bn,n),[o.memoizedState,n]}function bc(n,o,l,f){return n={tag:n,create:o,destroy:l,deps:f,next:null},o=bn.updateQueue,o===null?(o={lastEffect:null,stores:null},bn.updateQueue=o,o.lastEffect=n.next=n):(l=o.lastEffect,l===null?o.lastEffect=n.next=n:(f=l.next,l.next=n,n.next=f,o.lastEffect=n)),n}function gx(){return Dr().memoizedState}function cd(n,o,l,f){var _=ao();bn.flags|=n,_.memoizedState=bc(1|o,l,void 0,f===void 0?null:f)}function Wd(n,o,l,f){var _=Dr();f=f===void 0?null:f;var w=void 0;if(Xn!==null){var I=Xn.memoizedState;if(w=I.destroy,f!==null&&wg(f,I.deps)){_.memoizedState=bc(o,l,w,f);return}}bn.flags|=n,_.memoizedState=bc(1|o,l,w,f)}function uv(n,o){return cd(8390656,8,n,o)}function Eg(n,o){return Wd(2048,8,n,o)}function yx(n,o){return Wd(4,2,n,o)}function _x(n,o){return Wd(4,4,n,o)}function vx(n,o){if(typeof o=="function")return n=n(),o(n),function(){o(null)};if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function xx(n,o,l){return l=l!=null?l.concat([n]):null,Wd(4,4,vx.bind(null,o,n),l)}function Tg(){}function wx(n,o){var l=Dr();o=o===void 0?null:o;var f=l.memoizedState;return f!==null&&o!==null&&wg(o,f[1])?f[0]:(l.memoizedState=[n,o],n)}function bx(n,o){var l=Dr();o=o===void 0?null:o;var f=l.memoizedState;return f!==null&&o!==null&&wg(o,f[1])?f[0]:(n=n(),l.memoizedState=[n,o],n)}function Sx(n,o,l){return aa&21?(Yr(l,o)||(l=C0(),bn.lanes|=l,la|=l,n.baseState=!0),o):(n.baseState&&(n.baseState=!1,er=!0),n.memoizedState=l)}function W2(n,o){var l=Jt;Jt=l!==0&&4>l?l:4,n(!0);var f=Mf.transition;Mf.transition={};try{n(!1),o()}finally{Jt=l,Mf.transition=f}}function Ex(){return Dr().memoizedState}function X2(n,o,l){var f=_s(n);if(l={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null},Tx(n))Cx(o,l);else if(l=nx(n,o,l,f),l!==null){var _=qi();Kr(l,n,f,_),Ix(l,o,f)}}function H2(n,o,l){var f=_s(n),_={lane:f,action:l,hasEagerState:!1,eagerState:null,next:null};if(Tx(n))Cx(o,_);else{var w=n.alternate;if(n.lanes===0&&(w===null||w.lanes===0)&&(w=o.lastRenderedReducer,w!==null))try{var I=o.lastRenderedState,u=w(I,l);if(_.hasEagerState=!0,_.eagerState=u,Yr(u,I)){var U=o.interleaved;U===null?(_.next=_,gg(o)):(_.next=U.next,U.next=_),o.interleaved=_;return}}catch{}finally{}l=nx(n,o,_,f),l!==null&&(_=qi(),Kr(l,n,f,_),Ix(l,o,f))}}function Tx(n){var o=n.alternate;return n===bn||o!==null&&o===bn}function Cx(n,o){ic=zd=!0;var l=n.pending;l===null?o.next=o:(o.next=l.next,l.next=o),n.pending=o}function Ix(n,o,l){if(l&4194240){var f=o.lanes;f&=n.pendingLanes,l|=f,o.lanes=l,ng(n,l)}}var Dd={readContext:zr,useCallback:ki,useContext:ki,useEffect:ki,useImperativeHandle:ki,useInsertionEffect:ki,useLayoutEffect:ki,useMemo:ki,useReducer:ki,useRef:ki,useState:ki,useDebugValue:ki,useDeferredValue:ki,useTransition:ki,useMutableSource:ki,useSyncExternalStore:ki,useId:ki,unstable_isNewReconciler:!1},K2={readContext:zr,useCallback:function(n,o){return ao().memoizedState=[n,o===void 0?null:o],n},useContext:zr,useEffect:uv,useImperativeHandle:function(n,o,l){return l=l!=null?l.concat([n]):null,cd(4194308,4,vx.bind(null,o,n),l)},useLayoutEffect:function(n,o){return cd(4194308,4,n,o)},useInsertionEffect:function(n,o){return cd(4,2,n,o)},useMemo:function(n,o){var l=ao();return o=o===void 0?null:o,n=n(),l.memoizedState=[n,o],n},useReducer:function(n,o,l){var f=ao();return o=l!==void 0?l(o):o,f.memoizedState=f.baseState=o,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:o},f.queue=n,n=n.dispatch=X2.bind(null,bn,n),[f.memoizedState,n]},useRef:function(n){var o=ao();return n={current:n},o.memoizedState=n},useState:lv,useDebugValue:Tg,useDeferredValue:function(n){return ao().memoizedState=n},useTransition:function(){var n=lv(!1),o=n[0];return n=W2.bind(null,n[1]),ao().memoizedState=n,[o,n]},useMutableSource:function(){},useSyncExternalStore:function(n,o,l){var f=bn,_=ao();if(mn){if(l===void 0)throw Error(Me(407));l=l()}else{if(l=o(),oi===null)throw Error(Me(349));aa&30||hx(f,o,l)}_.memoizedState=l;var w={value:l,getSnapshot:o};return _.queue=w,uv(px.bind(null,f,w,n),[n]),f.flags|=2048,bc(9,dx.bind(null,f,w,l,o),void 0,null),l},useId:function(){var n=ao(),o=oi.identifierPrefix;if(mn){var l=Do,f=zo;l=(f&~(1<<32-Hr(f)-1)).toString(32)+l,o=":"+o+"R"+l,l=xc++,0<l&&(o+="H"+l.toString(32)),o+=":"}else l=G2++,o=":"+o+"r"+l.toString(32)+":";return n.memoizedState=o},unstable_isNewReconciler:!1},Y2={readContext:zr,useCallback:wx,useContext:zr,useEffect:Eg,useImperativeHandle:xx,useInsertionEffect:yx,useLayoutEffect:_x,useMemo:bx,useReducer:Af,useRef:gx,useState:function(){return Af(wc)},useDebugValue:Tg,useDeferredValue:function(n){var o=Dr();return Sx(o,Xn.memoizedState,n)},useTransition:function(){var n=Af(wc)[0],o=Dr().memoizedState;return[n,o]},useMutableSource:ux,useSyncExternalStore:cx,useId:Ex,unstable_isNewReconciler:!1},J2={readContext:zr,useCallback:wx,useContext:zr,useEffect:Eg,useImperativeHandle:xx,useInsertionEffect:yx,useLayoutEffect:_x,useMemo:bx,useReducer:zf,useRef:gx,useState:function(){return zf(wc)},useDebugValue:Tg,useDeferredValue:function(n){var o=Dr();return Xn===null?o.memoizedState=n:Sx(o,Xn.memoizedState,n)},useTransition:function(){var n=zf(wc)[0],o=Dr().memoizedState;return[n,o]},useMutableSource:ux,useSyncExternalStore:cx,useId:Ex,unstable_isNewReconciler:!1};function Ml(n,o){try{var l="",f=o;do l+=Cb(f),f=f.return;while(f);var _=l}catch(w){_=`
Error generating stack: `+w.message+`
`+w.stack}return{value:n,source:o,stack:_,digest:null}}function Df(n,o,l){return{value:n,source:null,stack:l??null,digest:o??null}}function Em(n,o){try{console.error(o.value)}catch(l){setTimeout(function(){throw l})}}var Q2=typeof WeakMap=="function"?WeakMap:Map;function kx(n,o,l){l=Lo(-1,l),l.tag=3,l.payload={element:null};var f=o.value;return l.callback=function(){Rd||(Rd=!0,Lm=f),Em(n,o)},l}function Px(n,o,l){l=Lo(-1,l),l.tag=3;var f=n.type.getDerivedStateFromError;if(typeof f=="function"){var _=o.value;l.payload=function(){return f(_)},l.callback=function(){Em(n,o)}}var w=n.stateNode;return w!==null&&typeof w.componentDidCatch=="function"&&(l.callback=function(){Em(n,o),typeof f!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),l}function cv(n,o,l){var f=n.pingCache;if(f===null){f=n.pingCache=new Q2;var _=new Set;f.set(o,_)}else _=f.get(o),_===void 0&&(_=new Set,f.set(o,_));_.has(l)||(_.add(l),n=pS.bind(null,n,o,l),o.then(n,n))}function hv(n){do{var o;if((o=n.tag===13)&&(o=n.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return n;n=n.return}while(n!==null);return null}function dv(n,o,l,f,_){return n.mode&1?(n.flags|=65536,n.lanes=_,n):(n===o?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(o=Lo(-1,1),o.tag=2,gs(l,o,1))),l.lanes|=1),n)}var eS=Uo.ReactCurrentOwner,er=!1;function ji(n,o,l,f){o.child=n===null?ax(o,null,l,f):kl(o,n.child,l,f)}function pv(n,o,l,f,_){l=l.render;var w=o.ref;return Sl(o,_),f=bg(n,o,l,f,w,_),l=Sg(),n!==null&&!er?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~_,Oo(n,o,_)):(mn&&l&&cg(o),o.flags|=1,ji(n,o,f,_),o.child)}function fv(n,o,l,f,_){if(n===null){var w=l.type;return typeof w=="function"&&!Dg(w)&&w.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(o.tag=15,o.type=w,Mx(n,o,w,f,_)):(n=fd(l.type,null,f,o,o.mode,_),n.ref=o.ref,n.return=o,o.child=n)}if(w=n.child,!(n.lanes&_)){var I=w.memoizedProps;if(l=l.compare,l=l!==null?l:fc,l(I,f)&&n.ref===o.ref)return Oo(n,o,_)}return o.flags|=1,n=vs(w,f),n.ref=o.ref,n.return=o,o.child=n}function Mx(n,o,l,f,_){if(n!==null){var w=n.memoizedProps;if(fc(w,f)&&n.ref===o.ref)if(er=!1,o.pendingProps=f=w,(n.lanes&_)!==0)n.flags&131072&&(er=!0);else return o.lanes=n.lanes,Oo(n,o,_)}return Tm(n,o,l,f,_)}function Ax(n,o,l){var f=o.pendingProps,_=f.children,w=n!==null?n.memoizedState:null;if(f.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},ln(_l,dr),dr|=l;else{if(!(l&1073741824))return n=w!==null?w.baseLanes|l:l,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:n,cachePool:null,transitions:null},o.updateQueue=null,ln(_l,dr),dr|=n,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},f=w!==null?w.baseLanes:l,ln(_l,dr),dr|=f}else w!==null?(f=w.baseLanes|l,o.memoizedState=null):f=l,ln(_l,dr),dr|=f;return ji(n,o,_,l),o.child}function zx(n,o){var l=o.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(o.flags|=512,o.flags|=2097152)}function Tm(n,o,l,f,_){var w=nr(l)?oa:Ai.current;return w=Cl(o,w),Sl(o,_),l=bg(n,o,l,f,w,_),f=Sg(),n!==null&&!er?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~_,Oo(n,o,_)):(mn&&f&&cg(o),o.flags|=1,ji(n,o,l,_),o.child)}function mv(n,o,l,f,_){if(nr(l)){var w=!0;Td(o)}else w=!1;if(Sl(o,_),o.stateNode===null)hd(n,o),ox(o,l,f),Sm(o,l,f,_),f=!0;else if(n===null){var I=o.stateNode,u=o.memoizedProps;I.props=u;var U=I.context,D=l.contextType;typeof D=="object"&&D!==null?D=zr(D):(D=nr(l)?oa:Ai.current,D=Cl(o,D));var ue=l.getDerivedStateFromProps,ie=typeof ue=="function"||typeof I.getSnapshotBeforeUpdate=="function";ie||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(u!==f||U!==D)&&sv(o,I,f,D),os=!1;var pe=o.memoizedState;I.state=pe,Md(o,f,I,_),U=o.memoizedState,u!==f||pe!==U||tr.current||os?(typeof ue=="function"&&(bm(o,l,ue,f),U=o.memoizedState),(u=os||ov(o,l,u,f,pe,U,D))?(ie||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=f,o.memoizedState=U),I.props=f,I.state=U,I.context=D,f=u):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),f=!1)}else{I=o.stateNode,ix(n,o),u=o.memoizedProps,D=o.type===o.elementType?u:Zr(o.type,u),I.props=D,ie=o.pendingProps,pe=I.context,U=l.contextType,typeof U=="object"&&U!==null?U=zr(U):(U=nr(l)?oa:Ai.current,U=Cl(o,U));var Ce=l.getDerivedStateFromProps;(ue=typeof Ce=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(u!==ie||pe!==U)&&sv(o,I,f,U),os=!1,pe=o.memoizedState,I.state=pe,Md(o,f,I,_);var ke=o.memoizedState;u!==ie||pe!==ke||tr.current||os?(typeof Ce=="function"&&(bm(o,l,Ce,f),ke=o.memoizedState),(D=os||ov(o,l,D,f,pe,ke,U)||!1)?(ue||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(f,ke,U),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(f,ke,U)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||u===n.memoizedProps&&pe===n.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||u===n.memoizedProps&&pe===n.memoizedState||(o.flags|=1024),o.memoizedProps=f,o.memoizedState=ke),I.props=f,I.state=ke,I.context=U,f=D):(typeof I.componentDidUpdate!="function"||u===n.memoizedProps&&pe===n.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||u===n.memoizedProps&&pe===n.memoizedState||(o.flags|=1024),f=!1)}return Cm(n,o,l,f,w,_)}function Cm(n,o,l,f,_,w){zx(n,o);var I=(o.flags&128)!==0;if(!f&&!I)return _&&ev(o,l,!1),Oo(n,o,w);f=o.stateNode,eS.current=o;var u=I&&typeof l.getDerivedStateFromError!="function"?null:f.render();return o.flags|=1,n!==null&&I?(o.child=kl(o,n.child,null,w),o.child=kl(o,null,u,w)):ji(n,o,u,w),o.memoizedState=f.state,_&&ev(o,l,!0),o.child}function Dx(n){var o=n.stateNode;o.pendingContext?Q_(n,o.pendingContext,o.pendingContext!==o.context):o.context&&Q_(n,o.context,!1),_g(n,o.containerInfo)}function gv(n,o,l,f,_){return Il(),dg(_),o.flags|=256,ji(n,o,l,f),o.child}var Im={dehydrated:null,treeContext:null,retryLane:0};function km(n){return{baseLanes:n,cachePool:null,transitions:null}}function Lx(n,o,l){var f=o.pendingProps,_=wn.current,w=!1,I=(o.flags&128)!==0,u;if((u=I)||(u=n!==null&&n.memoizedState===null?!1:(_&2)!==0),u?(w=!0,o.flags&=-129):(n===null||n.memoizedState!==null)&&(_|=1),ln(wn,_&1),n===null)return xm(o),n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(o.mode&1?n.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(I=f.children,n=f.fallback,w?(f=o.mode,w=o.child,I={mode:"hidden",children:I},!(f&1)&&w!==null?(w.childLanes=0,w.pendingProps=I):w=Kd(I,f,0,null),n=ra(n,f,l,null),w.return=o,n.return=o,w.sibling=n,o.child=w,o.child.memoizedState=km(l),o.memoizedState=Im,n):Cg(o,I));if(_=n.memoizedState,_!==null&&(u=_.dehydrated,u!==null))return tS(n,o,I,f,u,_,l);if(w){w=f.fallback,I=o.mode,_=n.child,u=_.sibling;var U={mode:"hidden",children:f.children};return!(I&1)&&o.child!==_?(f=o.child,f.childLanes=0,f.pendingProps=U,o.deletions=null):(f=vs(_,U),f.subtreeFlags=_.subtreeFlags&14680064),u!==null?w=vs(u,w):(w=ra(w,I,l,null),w.flags|=2),w.return=o,f.return=o,f.sibling=w,o.child=f,f=w,w=o.child,I=n.child.memoizedState,I=I===null?km(l):{baseLanes:I.baseLanes|l,cachePool:null,transitions:I.transitions},w.memoizedState=I,w.childLanes=n.childLanes&~l,o.memoizedState=Im,f}return w=n.child,n=w.sibling,f=vs(w,{mode:"visible",children:f.children}),!(o.mode&1)&&(f.lanes=l),f.return=o,f.sibling=null,n!==null&&(l=o.deletions,l===null?(o.deletions=[n],o.flags|=16):l.push(n)),o.child=f,o.memoizedState=null,f}function Cg(n,o){return o=Kd({mode:"visible",children:o},n.mode,0,null),o.return=n,n.child=o}function Kh(n,o,l,f){return f!==null&&dg(f),kl(o,n.child,null,l),n=Cg(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function tS(n,o,l,f,_,w,I){if(l)return o.flags&256?(o.flags&=-257,f=Df(Error(Me(422))),Kh(n,o,I,f)):o.memoizedState!==null?(o.child=n.child,o.flags|=128,null):(w=f.fallback,_=o.mode,f=Kd({mode:"visible",children:f.children},_,0,null),w=ra(w,_,I,null),w.flags|=2,f.return=o,w.return=o,f.sibling=w,o.child=f,o.mode&1&&kl(o,n.child,null,I),o.child.memoizedState=km(I),o.memoizedState=Im,w);if(!(o.mode&1))return Kh(n,o,I,null);if(_.data==="$!"){if(f=_.nextSibling&&_.nextSibling.dataset,f)var u=f.dgst;return f=u,w=Error(Me(419)),f=Df(w,f,void 0),Kh(n,o,I,f)}if(u=(I&n.childLanes)!==0,er||u){if(f=oi,f!==null){switch(I&-I){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(f.suspendedLanes|I)?0:_,_!==0&&_!==w.retryLane&&(w.retryLane=_,Fo(n,_),Kr(f,n,_,-1))}return zg(),f=Df(Error(Me(421))),Kh(n,o,I,f)}return _.data==="$?"?(o.flags|=128,o.child=n.child,o=fS.bind(null,n),_._reactRetry=o,null):(n=w.treeContext,pr=ms(_.nextSibling),fr=o,mn=!0,Wr=null,n!==null&&(kr[Pr++]=zo,kr[Pr++]=Do,kr[Pr++]=sa,zo=n.id,Do=n.overflow,sa=o),o=Cg(o,f.children),o.flags|=4096,o)}function yv(n,o,l){n.lanes|=o;var f=n.alternate;f!==null&&(f.lanes|=o),wm(n.return,o,l)}function Lf(n,o,l,f,_){var w=n.memoizedState;w===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:f,tail:l,tailMode:_}:(w.isBackwards=o,w.rendering=null,w.renderingStartTime=0,w.last=f,w.tail=l,w.tailMode=_)}function Rx(n,o,l){var f=o.pendingProps,_=f.revealOrder,w=f.tail;if(ji(n,o,f.children,l),f=wn.current,f&2)f=f&1|2,o.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&yv(n,l,o);else if(n.tag===19)yv(n,l,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break e;for(;n.sibling===null;){if(n.return===null||n.return===o)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}f&=1}if(ln(wn,f),!(o.mode&1))o.memoizedState=null;else switch(_){case"forwards":for(l=o.child,_=null;l!==null;)n=l.alternate,n!==null&&Ad(n)===null&&(_=l),l=l.sibling;l=_,l===null?(_=o.child,o.child=null):(_=l.sibling,l.sibling=null),Lf(o,!1,_,l,w);break;case"backwards":for(l=null,_=o.child,o.child=null;_!==null;){if(n=_.alternate,n!==null&&Ad(n)===null){o.child=_;break}n=_.sibling,_.sibling=l,l=_,_=n}Lf(o,!0,l,null,w);break;case"together":Lf(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function hd(n,o){!(o.mode&1)&&n!==null&&(n.alternate=null,o.alternate=null,o.flags|=2)}function Oo(n,o,l){if(n!==null&&(o.dependencies=n.dependencies),la|=o.lanes,!(l&o.childLanes))return null;if(n!==null&&o.child!==n.child)throw Error(Me(153));if(o.child!==null){for(n=o.child,l=vs(n,n.pendingProps),o.child=l,l.return=o;n.sibling!==null;)n=n.sibling,l=l.sibling=vs(n,n.pendingProps),l.return=o;l.sibling=null}return o.child}function nS(n,o,l){switch(o.tag){case 3:Dx(o),Il();break;case 5:lx(o);break;case 1:nr(o.type)&&Td(o);break;case 4:_g(o,o.stateNode.containerInfo);break;case 10:var f=o.type._context,_=o.memoizedProps.value;ln(kd,f._currentValue),f._currentValue=_;break;case 13:if(f=o.memoizedState,f!==null)return f.dehydrated!==null?(ln(wn,wn.current&1),o.flags|=128,null):l&o.child.childLanes?Lx(n,o,l):(ln(wn,wn.current&1),n=Oo(n,o,l),n!==null?n.sibling:null);ln(wn,wn.current&1);break;case 19:if(f=(l&o.childLanes)!==0,n.flags&128){if(f)return Rx(n,o,l);o.flags|=128}if(_=o.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),ln(wn,wn.current),f)break;return null;case 22:case 23:return o.lanes=0,Ax(n,o,l)}return Oo(n,o,l)}var Bx,Pm,Fx,Ox;Bx=function(n,o){for(var l=o.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return;l=l.return}l.sibling.return=l.return,l=l.sibling}};Pm=function(){};Fx=function(n,o,l,f){var _=n.memoizedProps;if(_!==f){n=o.stateNode,na(co.current);var w=null;switch(l){case"input":_=Yf(n,_),f=Yf(n,f),w=[];break;case"select":_=Sn({},_,{value:void 0}),f=Sn({},f,{value:void 0}),w=[];break;case"textarea":_=em(n,_),f=em(n,f),w=[];break;default:typeof _.onClick!="function"&&typeof f.onClick=="function"&&(n.onclick=Sd)}nm(l,f);var I;l=null;for(D in _)if(!f.hasOwnProperty(D)&&_.hasOwnProperty(D)&&_[D]!=null)if(D==="style"){var u=_[D];for(I in u)u.hasOwnProperty(I)&&(l||(l={}),l[I]="")}else D!=="dangerouslySetInnerHTML"&&D!=="children"&&D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(ac.hasOwnProperty(D)?w||(w=[]):(w=w||[]).push(D,null));for(D in f){var U=f[D];if(u=_!=null?_[D]:void 0,f.hasOwnProperty(D)&&U!==u&&(U!=null||u!=null))if(D==="style")if(u){for(I in u)!u.hasOwnProperty(I)||U&&U.hasOwnProperty(I)||(l||(l={}),l[I]="");for(I in U)U.hasOwnProperty(I)&&u[I]!==U[I]&&(l||(l={}),l[I]=U[I])}else l||(w||(w=[]),w.push(D,l)),l=U;else D==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,u=u?u.__html:void 0,U!=null&&u!==U&&(w=w||[]).push(D,U)):D==="children"?typeof U!="string"&&typeof U!="number"||(w=w||[]).push(D,""+U):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&(ac.hasOwnProperty(D)?(U!=null&&D==="onScroll"&&cn("scroll",n),w||u===U||(w=[])):(w=w||[]).push(D,U))}l&&(w=w||[]).push("style",l);var D=w;(o.updateQueue=D)&&(o.flags|=4)}};Ox=function(n,o,l,f){l!==f&&(o.flags|=4)};function Zu(n,o){if(!mn)switch(n.tailMode){case"hidden":o=n.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var f=null;l!==null;)l.alternate!==null&&(f=l),l=l.sibling;f===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:f.sibling=null}}function Pi(n){var o=n.alternate!==null&&n.alternate.child===n.child,l=0,f=0;if(o)for(var _=n.child;_!==null;)l|=_.lanes|_.childLanes,f|=_.subtreeFlags&14680064,f|=_.flags&14680064,_.return=n,_=_.sibling;else for(_=n.child;_!==null;)l|=_.lanes|_.childLanes,f|=_.subtreeFlags,f|=_.flags,_.return=n,_=_.sibling;return n.subtreeFlags|=f,n.childLanes=l,o}function iS(n,o,l){var f=o.pendingProps;switch(hg(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Pi(o),null;case 1:return nr(o.type)&&Ed(),Pi(o),null;case 3:return f=o.stateNode,Pl(),hn(tr),hn(Ai),xg(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(n===null||n.child===null)&&(Xh(o)?o.flags|=4:n===null||n.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Wr!==null&&(Fm(Wr),Wr=null))),Pm(n,o),Pi(o),null;case 5:vg(o);var _=na(vc.current);if(l=o.type,n!==null&&o.stateNode!=null)Fx(n,o,l,f,_),n.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!f){if(o.stateNode===null)throw Error(Me(166));return Pi(o),null}if(n=na(co.current),Xh(o)){f=o.stateNode,l=o.type;var w=o.memoizedProps;switch(f[lo]=o,f[yc]=w,n=(o.mode&1)!==0,l){case"dialog":cn("cancel",f),cn("close",f);break;case"iframe":case"object":case"embed":cn("load",f);break;case"video":case"audio":for(_=0;_<Yu.length;_++)cn(Yu[_],f);break;case"source":cn("error",f);break;case"img":case"image":case"link":cn("error",f),cn("load",f);break;case"details":cn("toggle",f);break;case"input":C_(f,w),cn("invalid",f);break;case"select":f._wrapperState={wasMultiple:!!w.multiple},cn("invalid",f);break;case"textarea":k_(f,w),cn("invalid",f)}nm(l,w),_=null;for(var I in w)if(w.hasOwnProperty(I)){var u=w[I];I==="children"?typeof u=="string"?f.textContent!==u&&(w.suppressHydrationWarning!==!0&&Wh(f.textContent,u,n),_=["children",u]):typeof u=="number"&&f.textContent!==""+u&&(w.suppressHydrationWarning!==!0&&Wh(f.textContent,u,n),_=["children",""+u]):ac.hasOwnProperty(I)&&u!=null&&I==="onScroll"&&cn("scroll",f)}switch(l){case"input":Uh(f),I_(f,w,!0);break;case"textarea":Uh(f),P_(f);break;case"select":case"option":break;default:typeof w.onClick=="function"&&(f.onclick=Sd)}f=_,o.updateQueue=f,f!==null&&(o.flags|=4)}else{I=_.nodeType===9?_:_.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=h0(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=I.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof f.is=="string"?n=I.createElement(l,{is:f.is}):(n=I.createElement(l),l==="select"&&(I=n,f.multiple?I.multiple=!0:f.size&&(I.size=f.size))):n=I.createElementNS(n,l),n[lo]=o,n[yc]=f,Bx(n,o,!1,!1),o.stateNode=n;e:{switch(I=im(l,f),l){case"dialog":cn("cancel",n),cn("close",n),_=f;break;case"iframe":case"object":case"embed":cn("load",n),_=f;break;case"video":case"audio":for(_=0;_<Yu.length;_++)cn(Yu[_],n);_=f;break;case"source":cn("error",n),_=f;break;case"img":case"image":case"link":cn("error",n),cn("load",n),_=f;break;case"details":cn("toggle",n),_=f;break;case"input":C_(n,f),_=Yf(n,f),cn("invalid",n);break;case"option":_=f;break;case"select":n._wrapperState={wasMultiple:!!f.multiple},_=Sn({},f,{value:void 0}),cn("invalid",n);break;case"textarea":k_(n,f),_=em(n,f),cn("invalid",n);break;default:_=f}nm(l,_),u=_;for(w in u)if(u.hasOwnProperty(w)){var U=u[w];w==="style"?f0(n,U):w==="dangerouslySetInnerHTML"?(U=U?U.__html:void 0,U!=null&&d0(n,U)):w==="children"?typeof U=="string"?(l!=="textarea"||U!=="")&&lc(n,U):typeof U=="number"&&lc(n,""+U):w!=="suppressContentEditableWarning"&&w!=="suppressHydrationWarning"&&w!=="autoFocus"&&(ac.hasOwnProperty(w)?U!=null&&w==="onScroll"&&cn("scroll",n):U!=null&&Km(n,w,U,I))}switch(l){case"input":Uh(n),I_(n,f,!1);break;case"textarea":Uh(n),P_(n);break;case"option":f.value!=null&&n.setAttribute("value",""+xs(f.value));break;case"select":n.multiple=!!f.multiple,w=f.value,w!=null?vl(n,!!f.multiple,w,!1):f.defaultValue!=null&&vl(n,!!f.multiple,f.defaultValue,!0);break;default:typeof _.onClick=="function"&&(n.onclick=Sd)}switch(l){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}}f&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Pi(o),null;case 6:if(n&&o.stateNode!=null)Ox(n,o,n.memoizedProps,f);else{if(typeof f!="string"&&o.stateNode===null)throw Error(Me(166));if(l=na(vc.current),na(co.current),Xh(o)){if(f=o.stateNode,l=o.memoizedProps,f[lo]=o,(w=f.nodeValue!==l)&&(n=fr,n!==null))switch(n.tag){case 3:Wh(f.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Wh(f.nodeValue,l,(n.mode&1)!==0)}w&&(o.flags|=4)}else f=(l.nodeType===9?l:l.ownerDocument).createTextNode(f),f[lo]=o,o.stateNode=f}return Pi(o),null;case 13:if(hn(wn),f=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(mn&&pr!==null&&o.mode&1&&!(o.flags&128))tx(),Il(),o.flags|=98560,w=!1;else if(w=Xh(o),f!==null&&f.dehydrated!==null){if(n===null){if(!w)throw Error(Me(318));if(w=o.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(Me(317));w[lo]=o}else Il(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Pi(o),w=!1}else Wr!==null&&(Fm(Wr),Wr=null),w=!0;if(!w)return o.flags&65536?o:null}return o.flags&128?(o.lanes=l,o):(f=f!==null,f!==(n!==null&&n.memoizedState!==null)&&f&&(o.child.flags|=8192,o.mode&1&&(n===null||wn.current&1?Hn===0&&(Hn=3):zg())),o.updateQueue!==null&&(o.flags|=4),Pi(o),null);case 4:return Pl(),Pm(n,o),n===null&&mc(o.stateNode.containerInfo),Pi(o),null;case 10:return mg(o.type._context),Pi(o),null;case 17:return nr(o.type)&&Ed(),Pi(o),null;case 19:if(hn(wn),w=o.memoizedState,w===null)return Pi(o),null;if(f=(o.flags&128)!==0,I=w.rendering,I===null)if(f)Zu(w,!1);else{if(Hn!==0||n!==null&&n.flags&128)for(n=o.child;n!==null;){if(I=Ad(n),I!==null){for(o.flags|=128,Zu(w,!1),f=I.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),o.subtreeFlags=0,f=l,l=o.child;l!==null;)w=l,n=f,w.flags&=14680066,I=w.alternate,I===null?(w.childLanes=0,w.lanes=n,w.child=null,w.subtreeFlags=0,w.memoizedProps=null,w.memoizedState=null,w.updateQueue=null,w.dependencies=null,w.stateNode=null):(w.childLanes=I.childLanes,w.lanes=I.lanes,w.child=I.child,w.subtreeFlags=0,w.deletions=null,w.memoizedProps=I.memoizedProps,w.memoizedState=I.memoizedState,w.updateQueue=I.updateQueue,w.type=I.type,n=I.dependencies,w.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return ln(wn,wn.current&1|2),o.child}n=n.sibling}w.tail!==null&&Ln()>Al&&(o.flags|=128,f=!0,Zu(w,!1),o.lanes=4194304)}else{if(!f)if(n=Ad(I),n!==null){if(o.flags|=128,f=!0,l=n.updateQueue,l!==null&&(o.updateQueue=l,o.flags|=4),Zu(w,!0),w.tail===null&&w.tailMode==="hidden"&&!I.alternate&&!mn)return Pi(o),null}else 2*Ln()-w.renderingStartTime>Al&&l!==1073741824&&(o.flags|=128,f=!0,Zu(w,!1),o.lanes=4194304);w.isBackwards?(I.sibling=o.child,o.child=I):(l=w.last,l!==null?l.sibling=I:o.child=I,w.last=I)}return w.tail!==null?(o=w.tail,w.rendering=o,w.tail=o.sibling,w.renderingStartTime=Ln(),o.sibling=null,l=wn.current,ln(wn,f?l&1|2:l&1),o):(Pi(o),null);case 22:case 23:return Ag(),f=o.memoizedState!==null,n!==null&&n.memoizedState!==null!==f&&(o.flags|=8192),f&&o.mode&1?dr&1073741824&&(Pi(o),o.subtreeFlags&6&&(o.flags|=8192)):Pi(o),null;case 24:return null;case 25:return null}throw Error(Me(156,o.tag))}function rS(n,o){switch(hg(o),o.tag){case 1:return nr(o.type)&&Ed(),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return Pl(),hn(tr),hn(Ai),xg(),n=o.flags,n&65536&&!(n&128)?(o.flags=n&-65537|128,o):null;case 5:return vg(o),null;case 13:if(hn(wn),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(Me(340));Il()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return hn(wn),null;case 4:return Pl(),null;case 10:return mg(o.type._context),null;case 22:case 23:return Ag(),null;case 24:return null;default:return null}}var Yh=!1,Mi=!1,oS=typeof WeakSet=="function"?WeakSet:Set,tt=null;function yl(n,o){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(f){Mn(n,o,f)}else l.current=null}function Mm(n,o,l){try{l()}catch(f){Mn(n,o,f)}}var _v=!1;function sS(n,o){if(pm=xd,n=$0(),ug(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var f=l.getSelection&&l.getSelection();if(f&&f.rangeCount!==0){l=f.anchorNode;var _=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{l.nodeType,w.nodeType}catch{l=null;break e}var I=0,u=-1,U=-1,D=0,ue=0,ie=n,pe=null;t:for(;;){for(var Ce;ie!==l||_!==0&&ie.nodeType!==3||(u=I+_),ie!==w||f!==0&&ie.nodeType!==3||(U=I+f),ie.nodeType===3&&(I+=ie.nodeValue.length),(Ce=ie.firstChild)!==null;)pe=ie,ie=Ce;for(;;){if(ie===n)break t;if(pe===l&&++D===_&&(u=I),pe===w&&++ue===f&&(U=I),(Ce=ie.nextSibling)!==null)break;ie=pe,pe=ie.parentNode}ie=Ce}l=u===-1||U===-1?null:{start:u,end:U}}else l=null}l=l||{start:0,end:0}}else l=null;for(fm={focusedElem:n,selectionRange:l},xd=!1,tt=o;tt!==null;)if(o=tt,n=o.child,(o.subtreeFlags&1028)!==0&&n!==null)n.return=o,tt=n;else for(;tt!==null;){o=tt;try{var ke=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ke!==null){var Pe=ke.memoizedProps,qe=ke.memoizedState,re=o.stateNode,te=re.getSnapshotBeforeUpdate(o.elementType===o.type?Pe:Zr(o.type,Pe),qe);re.__reactInternalSnapshotBeforeUpdate=te}break;case 3:var le=o.stateNode.containerInfo;le.nodeType===1?le.textContent="":le.nodeType===9&&le.documentElement&&le.removeChild(le.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Me(163))}}catch(Ee){Mn(o,o.return,Ee)}if(n=o.sibling,n!==null){n.return=o.return,tt=n;break}tt=o.return}return ke=_v,_v=!1,ke}function rc(n,o,l){var f=o.updateQueue;if(f=f!==null?f.lastEffect:null,f!==null){var _=f=f.next;do{if((_.tag&n)===n){var w=_.destroy;_.destroy=void 0,w!==void 0&&Mm(o,l,w)}_=_.next}while(_!==f)}}function Xd(n,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&n)===n){var f=l.create;l.destroy=f()}l=l.next}while(l!==o)}}function Am(n){var o=n.ref;if(o!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof o=="function"?o(n):o.current=n}}function Ux(n){var o=n.alternate;o!==null&&(n.alternate=null,Ux(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&(delete o[lo],delete o[yc],delete o[ym],delete o[$2],delete o[j2])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Nx(n){return n.tag===5||n.tag===3||n.tag===4}function vv(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Nx(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function zm(n,o,l){var f=n.tag;if(f===5||f===6)n=n.stateNode,o?l.nodeType===8?l.parentNode.insertBefore(n,o):l.insertBefore(n,o):(l.nodeType===8?(o=l.parentNode,o.insertBefore(n,l)):(o=l,o.appendChild(n)),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=Sd));else if(f!==4&&(n=n.child,n!==null))for(zm(n,o,l),n=n.sibling;n!==null;)zm(n,o,l),n=n.sibling}function Dm(n,o,l){var f=n.tag;if(f===5||f===6)n=n.stateNode,o?l.insertBefore(n,o):l.appendChild(n);else if(f!==4&&(n=n.child,n!==null))for(Dm(n,o,l),n=n.sibling;n!==null;)Dm(n,o,l),n=n.sibling}var di=null,Gr=!1;function is(n,o,l){for(l=l.child;l!==null;)Vx(n,o,l),l=l.sibling}function Vx(n,o,l){if(uo&&typeof uo.onCommitFiberUnmount=="function")try{uo.onCommitFiberUnmount(Nd,l)}catch{}switch(l.tag){case 5:Mi||yl(l,o);case 6:var f=di,_=Gr;di=null,is(n,o,l),di=f,Gr=_,di!==null&&(Gr?(n=di,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):di.removeChild(l.stateNode));break;case 18:di!==null&&(Gr?(n=di,l=l.stateNode,n.nodeType===8?If(n.parentNode,l):n.nodeType===1&&If(n,l),dc(n)):If(di,l.stateNode));break;case 4:f=di,_=Gr,di=l.stateNode.containerInfo,Gr=!0,is(n,o,l),di=f,Gr=_;break;case 0:case 11:case 14:case 15:if(!Mi&&(f=l.updateQueue,f!==null&&(f=f.lastEffect,f!==null))){_=f=f.next;do{var w=_,I=w.destroy;w=w.tag,I!==void 0&&(w&2||w&4)&&Mm(l,o,I),_=_.next}while(_!==f)}is(n,o,l);break;case 1:if(!Mi&&(yl(l,o),f=l.stateNode,typeof f.componentWillUnmount=="function"))try{f.props=l.memoizedProps,f.state=l.memoizedState,f.componentWillUnmount()}catch(u){Mn(l,o,u)}is(n,o,l);break;case 21:is(n,o,l);break;case 22:l.mode&1?(Mi=(f=Mi)||l.memoizedState!==null,is(n,o,l),Mi=f):is(n,o,l);break;default:is(n,o,l)}}function xv(n){var o=n.updateQueue;if(o!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new oS),o.forEach(function(f){var _=mS.bind(null,n,f);l.has(f)||(l.add(f),f.then(_,_))})}}function qr(n,o){var l=o.deletions;if(l!==null)for(var f=0;f<l.length;f++){var _=l[f];try{var w=n,I=o,u=I;e:for(;u!==null;){switch(u.tag){case 5:di=u.stateNode,Gr=!1;break e;case 3:di=u.stateNode.containerInfo,Gr=!0;break e;case 4:di=u.stateNode.containerInfo,Gr=!0;break e}u=u.return}if(di===null)throw Error(Me(160));Vx(w,I,_),di=null,Gr=!1;var U=_.alternate;U!==null&&(U.return=null),_.return=null}catch(D){Mn(_,o,D)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)$x(o,n),o=o.sibling}function $x(n,o){var l=n.alternate,f=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(qr(o,n),so(n),f&4){try{rc(3,n,n.return),Xd(3,n)}catch(Pe){Mn(n,n.return,Pe)}try{rc(5,n,n.return)}catch(Pe){Mn(n,n.return,Pe)}}break;case 1:qr(o,n),so(n),f&512&&l!==null&&yl(l,l.return);break;case 5:if(qr(o,n),so(n),f&512&&l!==null&&yl(l,l.return),n.flags&32){var _=n.stateNode;try{lc(_,"")}catch(Pe){Mn(n,n.return,Pe)}}if(f&4&&(_=n.stateNode,_!=null)){var w=n.memoizedProps,I=l!==null?l.memoizedProps:w,u=n.type,U=n.updateQueue;if(n.updateQueue=null,U!==null)try{u==="input"&&w.type==="radio"&&w.name!=null&&u0(_,w),im(u,I);var D=im(u,w);for(I=0;I<U.length;I+=2){var ue=U[I],ie=U[I+1];ue==="style"?f0(_,ie):ue==="dangerouslySetInnerHTML"?d0(_,ie):ue==="children"?lc(_,ie):Km(_,ue,ie,D)}switch(u){case"input":Jf(_,w);break;case"textarea":c0(_,w);break;case"select":var pe=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!w.multiple;var Ce=w.value;Ce!=null?vl(_,!!w.multiple,Ce,!1):pe!==!!w.multiple&&(w.defaultValue!=null?vl(_,!!w.multiple,w.defaultValue,!0):vl(_,!!w.multiple,w.multiple?[]:"",!1))}_[yc]=w}catch(Pe){Mn(n,n.return,Pe)}}break;case 6:if(qr(o,n),so(n),f&4){if(n.stateNode===null)throw Error(Me(162));_=n.stateNode,w=n.memoizedProps;try{_.nodeValue=w}catch(Pe){Mn(n,n.return,Pe)}}break;case 3:if(qr(o,n),so(n),f&4&&l!==null&&l.memoizedState.isDehydrated)try{dc(o.containerInfo)}catch(Pe){Mn(n,n.return,Pe)}break;case 4:qr(o,n),so(n);break;case 13:qr(o,n),so(n),_=n.child,_.flags&8192&&(w=_.memoizedState!==null,_.stateNode.isHidden=w,!w||_.alternate!==null&&_.alternate.memoizedState!==null||(Pg=Ln())),f&4&&xv(n);break;case 22:if(ue=l!==null&&l.memoizedState!==null,n.mode&1?(Mi=(D=Mi)||ue,qr(o,n),Mi=D):qr(o,n),so(n),f&8192){if(D=n.memoizedState!==null,(n.stateNode.isHidden=D)&&!ue&&n.mode&1)for(tt=n,ue=n.child;ue!==null;){for(ie=tt=ue;tt!==null;){switch(pe=tt,Ce=pe.child,pe.tag){case 0:case 11:case 14:case 15:rc(4,pe,pe.return);break;case 1:yl(pe,pe.return);var ke=pe.stateNode;if(typeof ke.componentWillUnmount=="function"){f=pe,l=pe.return;try{o=f,ke.props=o.memoizedProps,ke.state=o.memoizedState,ke.componentWillUnmount()}catch(Pe){Mn(f,l,Pe)}}break;case 5:yl(pe,pe.return);break;case 22:if(pe.memoizedState!==null){bv(ie);continue}}Ce!==null?(Ce.return=pe,tt=Ce):bv(ie)}ue=ue.sibling}e:for(ue=null,ie=n;;){if(ie.tag===5){if(ue===null){ue=ie;try{_=ie.stateNode,D?(w=_.style,typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"):(u=ie.stateNode,U=ie.memoizedProps.style,I=U!=null&&U.hasOwnProperty("display")?U.display:null,u.style.display=p0("display",I))}catch(Pe){Mn(n,n.return,Pe)}}}else if(ie.tag===6){if(ue===null)try{ie.stateNode.nodeValue=D?"":ie.memoizedProps}catch(Pe){Mn(n,n.return,Pe)}}else if((ie.tag!==22&&ie.tag!==23||ie.memoizedState===null||ie===n)&&ie.child!==null){ie.child.return=ie,ie=ie.child;continue}if(ie===n)break e;for(;ie.sibling===null;){if(ie.return===null||ie.return===n)break e;ue===ie&&(ue=null),ie=ie.return}ue===ie&&(ue=null),ie.sibling.return=ie.return,ie=ie.sibling}}break;case 19:qr(o,n),so(n),f&4&&xv(n);break;case 21:break;default:qr(o,n),so(n)}}function so(n){var o=n.flags;if(o&2){try{e:{for(var l=n.return;l!==null;){if(Nx(l)){var f=l;break e}l=l.return}throw Error(Me(160))}switch(f.tag){case 5:var _=f.stateNode;f.flags&32&&(lc(_,""),f.flags&=-33);var w=vv(n);Dm(n,w,_);break;case 3:case 4:var I=f.stateNode.containerInfo,u=vv(n);zm(n,u,I);break;default:throw Error(Me(161))}}catch(U){Mn(n,n.return,U)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function aS(n,o,l){tt=n,jx(n)}function jx(n,o,l){for(var f=(n.mode&1)!==0;tt!==null;){var _=tt,w=_.child;if(_.tag===22&&f){var I=_.memoizedState!==null||Yh;if(!I){var u=_.alternate,U=u!==null&&u.memoizedState!==null||Mi;u=Yh;var D=Mi;if(Yh=I,(Mi=U)&&!D)for(tt=_;tt!==null;)I=tt,U=I.child,I.tag===22&&I.memoizedState!==null?Sv(_):U!==null?(U.return=I,tt=U):Sv(_);for(;w!==null;)tt=w,jx(w),w=w.sibling;tt=_,Yh=u,Mi=D}wv(n)}else _.subtreeFlags&8772&&w!==null?(w.return=_,tt=w):wv(n)}}function wv(n){for(;tt!==null;){var o=tt;if(o.flags&8772){var l=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:Mi||Xd(5,o);break;case 1:var f=o.stateNode;if(o.flags&4&&!Mi)if(l===null)f.componentDidMount();else{var _=o.elementType===o.type?l.memoizedProps:Zr(o.type,l.memoizedProps);f.componentDidUpdate(_,l.memoizedState,f.__reactInternalSnapshotBeforeUpdate)}var w=o.updateQueue;w!==null&&rv(o,w,f);break;case 3:var I=o.updateQueue;if(I!==null){if(l=null,o.child!==null)switch(o.child.tag){case 5:l=o.child.stateNode;break;case 1:l=o.child.stateNode}rv(o,I,l)}break;case 5:var u=o.stateNode;if(l===null&&o.flags&4){l=u;var U=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":U.autoFocus&&l.focus();break;case"img":U.src&&(l.src=U.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var D=o.alternate;if(D!==null){var ue=D.memoizedState;if(ue!==null){var ie=ue.dehydrated;ie!==null&&dc(ie)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Me(163))}Mi||o.flags&512&&Am(o)}catch(pe){Mn(o,o.return,pe)}}if(o===n){tt=null;break}if(l=o.sibling,l!==null){l.return=o.return,tt=l;break}tt=o.return}}function bv(n){for(;tt!==null;){var o=tt;if(o===n){tt=null;break}var l=o.sibling;if(l!==null){l.return=o.return,tt=l;break}tt=o.return}}function Sv(n){for(;tt!==null;){var o=tt;try{switch(o.tag){case 0:case 11:case 15:var l=o.return;try{Xd(4,o)}catch(U){Mn(o,l,U)}break;case 1:var f=o.stateNode;if(typeof f.componentDidMount=="function"){var _=o.return;try{f.componentDidMount()}catch(U){Mn(o,_,U)}}var w=o.return;try{Am(o)}catch(U){Mn(o,w,U)}break;case 5:var I=o.return;try{Am(o)}catch(U){Mn(o,I,U)}}}catch(U){Mn(o,o.return,U)}if(o===n){tt=null;break}var u=o.sibling;if(u!==null){u.return=o.return,tt=u;break}tt=o.return}}var lS=Math.ceil,Ld=Uo.ReactCurrentDispatcher,Ig=Uo.ReactCurrentOwner,Ar=Uo.ReactCurrentBatchConfig,jt=0,oi=null,jn=null,pi=0,dr=0,_l=Es(0),Hn=0,Sc=null,la=0,Hd=0,kg=0,oc=null,Qi=null,Pg=0,Al=1/0,ko=null,Rd=!1,Lm=null,ys=null,Jh=!1,cs=null,Bd=0,sc=0,Rm=null,dd=-1,pd=0;function qi(){return jt&6?Ln():dd!==-1?dd:dd=Ln()}function _s(n){return n.mode&1?jt&2&&pi!==0?pi&-pi:Z2.transition!==null?(pd===0&&(pd=C0()),pd):(n=Jt,n!==0||(n=window.event,n=n===void 0?16:D0(n.type)),n):1}function Kr(n,o,l,f){if(50<sc)throw sc=0,Rm=null,Error(Me(185));Ic(n,l,f),(!(jt&2)||n!==oi)&&(n===oi&&(!(jt&2)&&(Hd|=l),Hn===4&&as(n,pi)),ir(n,f),l===1&&jt===0&&!(o.mode&1)&&(Al=Ln()+500,Zd&&Ts()))}function ir(n,o){var l=n.callbackNode;Zb(n,o);var f=vd(n,n===oi?pi:0);if(f===0)l!==null&&z_(l),n.callbackNode=null,n.callbackPriority=0;else if(o=f&-f,n.callbackPriority!==o){if(l!=null&&z_(l),o===1)n.tag===0?q2(Ev.bind(null,n)):J0(Ev.bind(null,n)),N2(function(){!(jt&6)&&Ts()}),l=null;else{switch(I0(f)){case 1:l=tg;break;case 4:l=E0;break;case 16:l=_d;break;case 536870912:l=T0;break;default:l=_d}l=Yx(l,qx.bind(null,n))}n.callbackPriority=o,n.callbackNode=l}}function qx(n,o){if(dd=-1,pd=0,jt&6)throw Error(Me(327));var l=n.callbackNode;if(El()&&n.callbackNode!==l)return null;var f=vd(n,n===oi?pi:0);if(f===0)return null;if(f&30||f&n.expiredLanes||o)o=Fd(n,f);else{o=f;var _=jt;jt|=2;var w=Gx();(oi!==n||pi!==o)&&(ko=null,Al=Ln()+500,ia(n,o));do try{hS();break}catch(u){Zx(n,u)}while(1);fg(),Ld.current=w,jt=_,jn!==null?o=0:(oi=null,pi=0,o=Hn)}if(o!==0){if(o===2&&(_=lm(n),_!==0&&(f=_,o=Bm(n,_))),o===1)throw l=Sc,ia(n,0),as(n,f),ir(n,Ln()),l;if(o===6)as(n,f);else{if(_=n.current.alternate,!(f&30)&&!uS(_)&&(o=Fd(n,f),o===2&&(w=lm(n),w!==0&&(f=w,o=Bm(n,w))),o===1))throw l=Sc,ia(n,0),as(n,f),ir(n,Ln()),l;switch(n.finishedWork=_,n.finishedLanes=f,o){case 0:case 1:throw Error(Me(345));case 2:Qs(n,Qi,ko);break;case 3:if(as(n,f),(f&130023424)===f&&(o=Pg+500-Ln(),10<o)){if(vd(n,0)!==0)break;if(_=n.suspendedLanes,(_&f)!==f){qi(),n.pingedLanes|=n.suspendedLanes&_;break}n.timeoutHandle=gm(Qs.bind(null,n,Qi,ko),o);break}Qs(n,Qi,ko);break;case 4:if(as(n,f),(f&4194240)===f)break;for(o=n.eventTimes,_=-1;0<f;){var I=31-Hr(f);w=1<<I,I=o[I],I>_&&(_=I),f&=~w}if(f=_,f=Ln()-f,f=(120>f?120:480>f?480:1080>f?1080:1920>f?1920:3e3>f?3e3:4320>f?4320:1960*lS(f/1960))-f,10<f){n.timeoutHandle=gm(Qs.bind(null,n,Qi,ko),f);break}Qs(n,Qi,ko);break;case 5:Qs(n,Qi,ko);break;default:throw Error(Me(329))}}}return ir(n,Ln()),n.callbackNode===l?qx.bind(null,n):null}function Bm(n,o){var l=oc;return n.current.memoizedState.isDehydrated&&(ia(n,o).flags|=256),n=Fd(n,o),n!==2&&(o=Qi,Qi=l,o!==null&&Fm(o)),n}function Fm(n){Qi===null?Qi=n:Qi.push.apply(Qi,n)}function uS(n){for(var o=n;;){if(o.flags&16384){var l=o.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var f=0;f<l.length;f++){var _=l[f],w=_.getSnapshot;_=_.value;try{if(!Yr(w(),_))return!1}catch{return!1}}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function as(n,o){for(o&=~kg,o&=~Hd,n.suspendedLanes|=o,n.pingedLanes&=~o,n=n.expirationTimes;0<o;){var l=31-Hr(o),f=1<<l;n[l]=-1,o&=~f}}function Ev(n){if(jt&6)throw Error(Me(327));El();var o=vd(n,0);if(!(o&1))return ir(n,Ln()),null;var l=Fd(n,o);if(n.tag!==0&&l===2){var f=lm(n);f!==0&&(o=f,l=Bm(n,f))}if(l===1)throw l=Sc,ia(n,0),as(n,o),ir(n,Ln()),l;if(l===6)throw Error(Me(345));return n.finishedWork=n.current.alternate,n.finishedLanes=o,Qs(n,Qi,ko),ir(n,Ln()),null}function Mg(n,o){var l=jt;jt|=1;try{return n(o)}finally{jt=l,jt===0&&(Al=Ln()+500,Zd&&Ts())}}function ua(n){cs!==null&&cs.tag===0&&!(jt&6)&&El();var o=jt;jt|=1;var l=Ar.transition,f=Jt;try{if(Ar.transition=null,Jt=1,n)return n()}finally{Jt=f,Ar.transition=l,jt=o,!(jt&6)&&Ts()}}function Ag(){dr=_l.current,hn(_l)}function ia(n,o){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,U2(l)),jn!==null)for(l=jn.return;l!==null;){var f=l;switch(hg(f),f.tag){case 1:f=f.type.childContextTypes,f!=null&&Ed();break;case 3:Pl(),hn(tr),hn(Ai),xg();break;case 5:vg(f);break;case 4:Pl();break;case 13:hn(wn);break;case 19:hn(wn);break;case 10:mg(f.type._context);break;case 22:case 23:Ag()}l=l.return}if(oi=n,jn=n=vs(n.current,null),pi=dr=o,Hn=0,Sc=null,kg=Hd=la=0,Qi=oc=null,ta!==null){for(o=0;o<ta.length;o++)if(l=ta[o],f=l.interleaved,f!==null){l.interleaved=null;var _=f.next,w=l.pending;if(w!==null){var I=w.next;w.next=_,f.next=I}l.pending=f}ta=null}return n}function Zx(n,o){do{var l=jn;try{if(fg(),ud.current=Dd,zd){for(var f=bn.memoizedState;f!==null;){var _=f.queue;_!==null&&(_.pending=null),f=f.next}zd=!1}if(aa=0,ri=Xn=bn=null,ic=!1,xc=0,Ig.current=null,l===null||l.return===null){Hn=1,Sc=o,jn=null;break}e:{var w=n,I=l.return,u=l,U=o;if(o=pi,u.flags|=32768,U!==null&&typeof U=="object"&&typeof U.then=="function"){var D=U,ue=u,ie=ue.tag;if(!(ue.mode&1)&&(ie===0||ie===11||ie===15)){var pe=ue.alternate;pe?(ue.updateQueue=pe.updateQueue,ue.memoizedState=pe.memoizedState,ue.lanes=pe.lanes):(ue.updateQueue=null,ue.memoizedState=null)}var Ce=hv(I);if(Ce!==null){Ce.flags&=-257,dv(Ce,I,u,w,o),Ce.mode&1&&cv(w,D,o),o=Ce,U=D;var ke=o.updateQueue;if(ke===null){var Pe=new Set;Pe.add(U),o.updateQueue=Pe}else ke.add(U);break e}else{if(!(o&1)){cv(w,D,o),zg();break e}U=Error(Me(426))}}else if(mn&&u.mode&1){var qe=hv(I);if(qe!==null){!(qe.flags&65536)&&(qe.flags|=256),dv(qe,I,u,w,o),dg(Ml(U,u));break e}}w=U=Ml(U,u),Hn!==4&&(Hn=2),oc===null?oc=[w]:oc.push(w),w=I;do{switch(w.tag){case 3:w.flags|=65536,o&=-o,w.lanes|=o;var re=kx(w,U,o);iv(w,re);break e;case 1:u=U;var te=w.type,le=w.stateNode;if(!(w.flags&128)&&(typeof te.getDerivedStateFromError=="function"||le!==null&&typeof le.componentDidCatch=="function"&&(ys===null||!ys.has(le)))){w.flags|=65536,o&=-o,w.lanes|=o;var Ee=Px(w,u,o);iv(w,Ee);break e}}w=w.return}while(w!==null)}Xx(l)}catch(Ze){o=Ze,jn===l&&l!==null&&(jn=l=l.return);continue}break}while(1)}function Gx(){var n=Ld.current;return Ld.current=Dd,n===null?Dd:n}function zg(){(Hn===0||Hn===3||Hn===2)&&(Hn=4),oi===null||!(la&268435455)&&!(Hd&268435455)||as(oi,pi)}function Fd(n,o){var l=jt;jt|=2;var f=Gx();(oi!==n||pi!==o)&&(ko=null,ia(n,o));do try{cS();break}catch(_){Zx(n,_)}while(1);if(fg(),jt=l,Ld.current=f,jn!==null)throw Error(Me(261));return oi=null,pi=0,Hn}function cS(){for(;jn!==null;)Wx(jn)}function hS(){for(;jn!==null&&!Bb();)Wx(jn)}function Wx(n){var o=Kx(n.alternate,n,dr);n.memoizedProps=n.pendingProps,o===null?Xx(n):jn=o,Ig.current=null}function Xx(n){var o=n;do{var l=o.alternate;if(n=o.return,o.flags&32768){if(l=rS(l,o),l!==null){l.flags&=32767,jn=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Hn=6,jn=null;return}}else if(l=iS(l,o,dr),l!==null){jn=l;return}if(o=o.sibling,o!==null){jn=o;return}jn=o=n}while(o!==null);Hn===0&&(Hn=5)}function Qs(n,o,l){var f=Jt,_=Ar.transition;try{Ar.transition=null,Jt=1,dS(n,o,l,f)}finally{Ar.transition=_,Jt=f}return null}function dS(n,o,l,f){do El();while(cs!==null);if(jt&6)throw Error(Me(327));l=n.finishedWork;var _=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(Me(177));n.callbackNode=null,n.callbackPriority=0;var w=l.lanes|l.childLanes;if(Gb(n,w),n===oi&&(jn=oi=null,pi=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||Jh||(Jh=!0,Yx(_d,function(){return El(),null})),w=(l.flags&15990)!==0,l.subtreeFlags&15990||w){w=Ar.transition,Ar.transition=null;var I=Jt;Jt=1;var u=jt;jt|=4,Ig.current=null,sS(n,l),$x(l,n),z2(fm),xd=!!pm,fm=pm=null,n.current=l,aS(l),Fb(),jt=u,Jt=I,Ar.transition=w}else n.current=l;if(Jh&&(Jh=!1,cs=n,Bd=_),w=n.pendingLanes,w===0&&(ys=null),Nb(l.stateNode),ir(n,Ln()),o!==null)for(f=n.onRecoverableError,l=0;l<o.length;l++)_=o[l],f(_.value,{componentStack:_.stack,digest:_.digest});if(Rd)throw Rd=!1,n=Lm,Lm=null,n;return Bd&1&&n.tag!==0&&El(),w=n.pendingLanes,w&1?n===Rm?sc++:(sc=0,Rm=n):sc=0,Ts(),null}function El(){if(cs!==null){var n=I0(Bd),o=Ar.transition,l=Jt;try{if(Ar.transition=null,Jt=16>n?16:n,cs===null)var f=!1;else{if(n=cs,cs=null,Bd=0,jt&6)throw Error(Me(331));var _=jt;for(jt|=4,tt=n.current;tt!==null;){var w=tt,I=w.child;if(tt.flags&16){var u=w.deletions;if(u!==null){for(var U=0;U<u.length;U++){var D=u[U];for(tt=D;tt!==null;){var ue=tt;switch(ue.tag){case 0:case 11:case 15:rc(8,ue,w)}var ie=ue.child;if(ie!==null)ie.return=ue,tt=ie;else for(;tt!==null;){ue=tt;var pe=ue.sibling,Ce=ue.return;if(Ux(ue),ue===D){tt=null;break}if(pe!==null){pe.return=Ce,tt=pe;break}tt=Ce}}}var ke=w.alternate;if(ke!==null){var Pe=ke.child;if(Pe!==null){ke.child=null;do{var qe=Pe.sibling;Pe.sibling=null,Pe=qe}while(Pe!==null)}}tt=w}}if(w.subtreeFlags&2064&&I!==null)I.return=w,tt=I;else e:for(;tt!==null;){if(w=tt,w.flags&2048)switch(w.tag){case 0:case 11:case 15:rc(9,w,w.return)}var re=w.sibling;if(re!==null){re.return=w.return,tt=re;break e}tt=w.return}}var te=n.current;for(tt=te;tt!==null;){I=tt;var le=I.child;if(I.subtreeFlags&2064&&le!==null)le.return=I,tt=le;else e:for(I=te;tt!==null;){if(u=tt,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Xd(9,u)}}catch(Ze){Mn(u,u.return,Ze)}if(u===I){tt=null;break e}var Ee=u.sibling;if(Ee!==null){Ee.return=u.return,tt=Ee;break e}tt=u.return}}if(jt=_,Ts(),uo&&typeof uo.onPostCommitFiberRoot=="function")try{uo.onPostCommitFiberRoot(Nd,n)}catch{}f=!0}return f}finally{Jt=l,Ar.transition=o}}return!1}function Tv(n,o,l){o=Ml(l,o),o=kx(n,o,1),n=gs(n,o,1),o=qi(),n!==null&&(Ic(n,1,o),ir(n,o))}function Mn(n,o,l){if(n.tag===3)Tv(n,n,l);else for(;o!==null;){if(o.tag===3){Tv(o,n,l);break}else if(o.tag===1){var f=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&(ys===null||!ys.has(f))){n=Ml(l,n),n=Px(o,n,1),o=gs(o,n,1),n=qi(),o!==null&&(Ic(o,1,n),ir(o,n));break}}o=o.return}}function pS(n,o,l){var f=n.pingCache;f!==null&&f.delete(o),o=qi(),n.pingedLanes|=n.suspendedLanes&l,oi===n&&(pi&l)===l&&(Hn===4||Hn===3&&(pi&130023424)===pi&&500>Ln()-Pg?ia(n,0):kg|=l),ir(n,o)}function Hx(n,o){o===0&&(n.mode&1?(o=$h,$h<<=1,!($h&130023424)&&($h=4194304)):o=1);var l=qi();n=Fo(n,o),n!==null&&(Ic(n,o,l),ir(n,l))}function fS(n){var o=n.memoizedState,l=0;o!==null&&(l=o.retryLane),Hx(n,l)}function mS(n,o){var l=0;switch(n.tag){case 13:var f=n.stateNode,_=n.memoizedState;_!==null&&(l=_.retryLane);break;case 19:f=n.stateNode;break;default:throw Error(Me(314))}f!==null&&f.delete(o),Hx(n,l)}var Kx;Kx=function(n,o,l){if(n!==null)if(n.memoizedProps!==o.pendingProps||tr.current)er=!0;else{if(!(n.lanes&l)&&!(o.flags&128))return er=!1,nS(n,o,l);er=!!(n.flags&131072)}else er=!1,mn&&o.flags&1048576&&Q0(o,Id,o.index);switch(o.lanes=0,o.tag){case 2:var f=o.type;hd(n,o),n=o.pendingProps;var _=Cl(o,Ai.current);Sl(o,l),_=bg(null,o,f,n,_,l);var w=Sg();return o.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,nr(f)?(w=!0,Td(o)):w=!1,o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,yg(o),_.updater=Gd,o.stateNode=_,_._reactInternals=o,Sm(o,f,n,l),o=Cm(null,o,f,!0,w,l)):(o.tag=0,mn&&w&&cg(o),ji(null,o,_,l),o=o.child),o;case 16:f=o.elementType;e:{switch(hd(n,o),n=o.pendingProps,_=f._init,f=_(f._payload),o.type=f,_=o.tag=yS(f),n=Zr(f,n),_){case 0:o=Tm(null,o,f,n,l);break e;case 1:o=mv(null,o,f,n,l);break e;case 11:o=pv(null,o,f,n,l);break e;case 14:o=fv(null,o,f,Zr(f.type,n),l);break e}throw Error(Me(306,f,""))}return o;case 0:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:Zr(f,_),Tm(n,o,f,_,l);case 1:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:Zr(f,_),mv(n,o,f,_,l);case 3:e:{if(Dx(o),n===null)throw Error(Me(387));f=o.pendingProps,w=o.memoizedState,_=w.element,ix(n,o),Md(o,f,null,l);var I=o.memoizedState;if(f=I.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=w,o.memoizedState=w,o.flags&256){_=Ml(Error(Me(423)),o),o=gv(n,o,f,l,_);break e}else if(f!==_){_=Ml(Error(Me(424)),o),o=gv(n,o,f,l,_);break e}else for(pr=ms(o.stateNode.containerInfo.firstChild),fr=o,mn=!0,Wr=null,l=ax(o,null,f,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Il(),f===_){o=Oo(n,o,l);break e}ji(n,o,f,l)}o=o.child}return o;case 5:return lx(o),n===null&&xm(o),f=o.type,_=o.pendingProps,w=n!==null?n.memoizedProps:null,I=_.children,mm(f,_)?I=null:w!==null&&mm(f,w)&&(o.flags|=32),zx(n,o),ji(n,o,I,l),o.child;case 6:return n===null&&xm(o),null;case 13:return Lx(n,o,l);case 4:return _g(o,o.stateNode.containerInfo),f=o.pendingProps,n===null?o.child=kl(o,null,f,l):ji(n,o,f,l),o.child;case 11:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:Zr(f,_),pv(n,o,f,_,l);case 7:return ji(n,o,o.pendingProps,l),o.child;case 8:return ji(n,o,o.pendingProps.children,l),o.child;case 12:return ji(n,o,o.pendingProps.children,l),o.child;case 10:e:{if(f=o.type._context,_=o.pendingProps,w=o.memoizedProps,I=_.value,ln(kd,f._currentValue),f._currentValue=I,w!==null)if(Yr(w.value,I)){if(w.children===_.children&&!tr.current){o=Oo(n,o,l);break e}}else for(w=o.child,w!==null&&(w.return=o);w!==null;){var u=w.dependencies;if(u!==null){I=w.child;for(var U=u.firstContext;U!==null;){if(U.context===f){if(w.tag===1){U=Lo(-1,l&-l),U.tag=2;var D=w.updateQueue;if(D!==null){D=D.shared;var ue=D.pending;ue===null?U.next=U:(U.next=ue.next,ue.next=U),D.pending=U}}w.lanes|=l,U=w.alternate,U!==null&&(U.lanes|=l),wm(w.return,l,o),u.lanes|=l;break}U=U.next}}else if(w.tag===10)I=w.type===o.type?null:w.child;else if(w.tag===18){if(I=w.return,I===null)throw Error(Me(341));I.lanes|=l,u=I.alternate,u!==null&&(u.lanes|=l),wm(I,l,o),I=w.sibling}else I=w.child;if(I!==null)I.return=w;else for(I=w;I!==null;){if(I===o){I=null;break}if(w=I.sibling,w!==null){w.return=I.return,I=w;break}I=I.return}w=I}ji(n,o,_.children,l),o=o.child}return o;case 9:return _=o.type,f=o.pendingProps.children,Sl(o,l),_=zr(_),f=f(_),o.flags|=1,ji(n,o,f,l),o.child;case 14:return f=o.type,_=Zr(f,o.pendingProps),_=Zr(f.type,_),fv(n,o,f,_,l);case 15:return Mx(n,o,o.type,o.pendingProps,l);case 17:return f=o.type,_=o.pendingProps,_=o.elementType===f?_:Zr(f,_),hd(n,o),o.tag=1,nr(f)?(n=!0,Td(o)):n=!1,Sl(o,l),ox(o,f,_),Sm(o,f,_,l),Cm(null,o,f,!0,n,l);case 19:return Rx(n,o,l);case 22:return Ax(n,o,l)}throw Error(Me(156,o.tag))};function Yx(n,o){return S0(n,o)}function gS(n,o,l,f){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mr(n,o,l,f){return new gS(n,o,l,f)}function Dg(n){return n=n.prototype,!(!n||!n.isReactComponent)}function yS(n){if(typeof n=="function")return Dg(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Jm)return 11;if(n===Qm)return 14}return 2}function vs(n,o){var l=n.alternate;return l===null?(l=Mr(n.tag,o,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=o,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,o=n.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function fd(n,o,l,f,_,w){var I=2;if(f=n,typeof n=="function")Dg(n)&&(I=1);else if(typeof n=="string")I=5;else e:switch(n){case ll:return ra(l.children,_,w,o);case Ym:I=8,_|=8;break;case Wf:return n=Mr(12,l,o,_|2),n.elementType=Wf,n.lanes=w,n;case Xf:return n=Mr(13,l,o,_),n.elementType=Xf,n.lanes=w,n;case Hf:return n=Mr(19,l,o,_),n.elementType=Hf,n.lanes=w,n;case s0:return Kd(l,_,w,o);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case r0:I=10;break e;case o0:I=9;break e;case Jm:I=11;break e;case Qm:I=14;break e;case rs:I=16,f=null;break e}throw Error(Me(130,n==null?n:typeof n,""))}return o=Mr(I,l,o,_),o.elementType=n,o.type=f,o.lanes=w,o}function ra(n,o,l,f){return n=Mr(7,n,f,o),n.lanes=l,n}function Kd(n,o,l,f){return n=Mr(22,n,f,o),n.elementType=s0,n.lanes=l,n.stateNode={isHidden:!1},n}function Rf(n,o,l){return n=Mr(6,n,null,o),n.lanes=l,n}function Bf(n,o,l){return o=Mr(4,n.children!==null?n.children:[],n.key,o),o.lanes=l,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}function _S(n,o,l,f,_){this.tag=o,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gf(0),this.expirationTimes=gf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gf(0),this.identifierPrefix=f,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Lg(n,o,l,f,_,w,I,u,U){return n=new _S(n,o,l,u,U),o===1?(o=1,w===!0&&(o|=8)):o=0,w=Mr(3,null,null,o),n.current=w,w.stateNode=n,w.memoizedState={element:f,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},yg(w),n}function vS(n,o,l){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:al,key:f==null?null:""+f,children:n,containerInfo:o,implementation:l}}function Jx(n){if(!n)return ws;n=n._reactInternals;e:{if(ha(n)!==n||n.tag!==1)throw Error(Me(170));var o=n;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(nr(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(Me(171))}if(n.tag===1){var l=n.type;if(nr(l))return Y0(n,l,o)}return o}function Qx(n,o,l,f,_,w,I,u,U){return n=Lg(l,f,!0,n,_,w,I,u,U),n.context=Jx(null),l=n.current,f=qi(),_=_s(l),w=Lo(f,_),w.callback=o??null,gs(l,w,_),n.current.lanes=_,Ic(n,_,f),ir(n,f),n}function Yd(n,o,l,f){var _=o.current,w=qi(),I=_s(_);return l=Jx(l),o.context===null?o.context=l:o.pendingContext=l,o=Lo(w,I),o.payload={element:n},f=f===void 0?null:f,f!==null&&(o.callback=f),n=gs(_,o,I),n!==null&&(Kr(n,_,I,w),ld(n,_,I)),I}function Od(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Cv(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<o?l:o}}function Rg(n,o){Cv(n,o),(n=n.alternate)&&Cv(n,o)}function xS(){return null}var e1=typeof reportError=="function"?reportError:function(n){console.error(n)};function Bg(n){this._internalRoot=n}Jd.prototype.render=Bg.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(Me(409));Yd(n,o,null,null)};Jd.prototype.unmount=Bg.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;ua(function(){Yd(null,n,null,null)}),o[Bo]=null}};function Jd(n){this._internalRoot=n}Jd.prototype.unstable_scheduleHydration=function(n){if(n){var o=M0();n={blockedOn:null,target:n,priority:o};for(var l=0;l<ss.length&&o!==0&&o<ss[l].priority;l++);ss.splice(l,0,n),l===0&&z0(n)}};function Fg(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Qd(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Iv(){}function wS(n,o,l,f,_){if(_){if(typeof f=="function"){var w=f;f=function(){var D=Od(I);w.call(D)}}var I=Qx(o,f,n,0,null,!1,!1,"",Iv);return n._reactRootContainer=I,n[Bo]=I.current,mc(n.nodeType===8?n.parentNode:n),ua(),I}for(;_=n.lastChild;)n.removeChild(_);if(typeof f=="function"){var u=f;f=function(){var D=Od(U);u.call(D)}}var U=Lg(n,0,!1,null,null,!1,!1,"",Iv);return n._reactRootContainer=U,n[Bo]=U.current,mc(n.nodeType===8?n.parentNode:n),ua(function(){Yd(o,U,l,f)}),U}function ep(n,o,l,f,_){var w=l._reactRootContainer;if(w){var I=w;if(typeof _=="function"){var u=_;_=function(){var U=Od(I);u.call(U)}}Yd(o,I,n,_)}else I=wS(l,o,n,_,f);return Od(I)}k0=function(n){switch(n.tag){case 3:var o=n.stateNode;if(o.current.memoizedState.isDehydrated){var l=Ku(o.pendingLanes);l!==0&&(ng(o,l|1),ir(o,Ln()),!(jt&6)&&(Al=Ln()+500,Ts()))}break;case 13:ua(function(){var f=Fo(n,1);if(f!==null){var _=qi();Kr(f,n,1,_)}}),Rg(n,1)}};ig=function(n){if(n.tag===13){var o=Fo(n,134217728);if(o!==null){var l=qi();Kr(o,n,134217728,l)}Rg(n,134217728)}};P0=function(n){if(n.tag===13){var o=_s(n),l=Fo(n,o);if(l!==null){var f=qi();Kr(l,n,o,f)}Rg(n,o)}};M0=function(){return Jt};A0=function(n,o){var l=Jt;try{return Jt=n,o()}finally{Jt=l}};om=function(n,o,l){switch(o){case"input":if(Jf(n,l),o=l.name,l.type==="radio"&&o!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<l.length;o++){var f=l[o];if(f!==n&&f.form===n.form){var _=qd(f);if(!_)throw Error(Me(90));l0(f),Jf(f,_)}}}break;case"textarea":c0(n,l);break;case"select":o=l.value,o!=null&&vl(n,!!l.multiple,o,!1)}};y0=Mg;_0=ua;var bS={usingClientEntryPoint:!1,Events:[Pc,dl,qd,m0,g0,Mg]},Gu={findFiberByHostInstance:ea,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},SS={bundleType:Gu.bundleType,version:Gu.version,rendererPackageName:Gu.rendererPackageName,rendererConfig:Gu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Uo.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=w0(n),n===null?null:n.stateNode},findFiberByHostInstance:Gu.findFiberByHostInstance||xS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qh.isDisabled&&Qh.supportsFiber)try{Nd=Qh.inject(SS),uo=Qh}catch{}}gr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=bS;gr.createPortal=function(n,o){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Fg(o))throw Error(Me(200));return vS(n,o,null,l)};gr.createRoot=function(n,o){if(!Fg(n))throw Error(Me(299));var l=!1,f="",_=e1;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),o=Lg(n,1,!1,null,null,l,!1,f,_),n[Bo]=o.current,mc(n.nodeType===8?n.parentNode:n),new Bg(o)};gr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(Me(188)):(n=Object.keys(n).join(","),Error(Me(268,n)));return n=w0(o),n=n===null?null:n.stateNode,n};gr.flushSync=function(n){return ua(n)};gr.hydrate=function(n,o,l){if(!Qd(o))throw Error(Me(200));return ep(null,n,o,!0,l)};gr.hydrateRoot=function(n,o,l){if(!Fg(n))throw Error(Me(405));var f=l!=null&&l.hydratedSources||null,_=!1,w="",I=e1;if(l!=null&&(l.unstable_strictMode===!0&&(_=!0),l.identifierPrefix!==void 0&&(w=l.identifierPrefix),l.onRecoverableError!==void 0&&(I=l.onRecoverableError)),o=Qx(o,null,n,1,l??null,_,!1,w,I),n[Bo]=o.current,mc(n),f)for(n=0;n<f.length;n++)l=f[n],_=l._getVersion,_=_(l._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[l,_]:o.mutableSourceEagerHydrationData.push(l,_);return new Jd(o)};gr.render=function(n,o,l){if(!Qd(o))throw Error(Me(200));return ep(null,n,o,!1,l)};gr.unmountComponentAtNode=function(n){if(!Qd(n))throw Error(Me(40));return n._reactRootContainer?(ua(function(){ep(null,null,n,!1,function(){n._reactRootContainer=null,n[Bo]=null})}),!0):!1};gr.unstable_batchedUpdates=Mg;gr.unstable_renderSubtreeIntoContainer=function(n,o,l,f){if(!Qd(l))throw Error(Me(200));if(n==null||n._reactInternals===void 0)throw Error(Me(38));return ep(n,o,l,!1,f)};gr.version="18.2.0-next-9e3b772b8-20220608";function t1(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t1)}catch(n){console.error(n)}}t1(),Qv.exports=gr;var Og=Qv.exports,kv=Og;Zf.createRoot=kv.createRoot,Zf.hydrateRoot=kv.hydrateRoot;const ES="modulepreload",TS=function(n){return"/gyamap-react/"+n},Pv={},CS=function(o,l,f){if(!l||l.length===0)return o();const _=document.getElementsByTagName("link");return Promise.all(l.map(w=>{if(w=TS(w),w in Pv)return;Pv[w]=!0;const I=w.endsWith(".css"),u=I?'[rel="stylesheet"]':"";if(!!f)for(let ue=_.length-1;ue>=0;ue--){const ie=_[ue];if(ie.href===w&&(!I||ie.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${w}"]${u}`))return;const D=document.createElement("link");if(D.rel=I?"stylesheet":ES,I||(D.as="script",D.crossOrigin=""),D.href=w,document.head.appendChild(D),I)return new Promise((ue,ie)=>{D.addEventListener("load",ue),D.addEventListener("error",()=>ie(new Error(`Unable to preload CSS for ${w}`)))})})).then(()=>o())},Ug=$e.createContext(null),IS=n=>{const[o,l]=$e.useState({}),f=$e.useCallback((w,I="default")=>{l(u=>{if(I==="current")throw new Error("'current' cannot be used as map id");if(u[I])throw new Error(`Multiple maps with the same id: ${I}`);return{...u,[I]:w}})},[]),_=$e.useCallback((w="default")=>{l(I=>{if(I[w]){const u={...I};return delete u[w],u}return I})},[]);return $e.createElement(Ug.Provider,{value:{maps:o,onMapMount:f,onMapUnmount:_}},n.children)};function Ng(){var n;const o=(n=$e.useContext(Ug))===null||n===void 0?void 0:n.maps,l=$e.useContext(Ac);return $e.useMemo(()=>({...o,current:l==null?void 0:l.map}),[o,l])}function kS(n){const o=n.clone();return o.pixelsToGLUnits=n.pixelsToGLUnits,o}function Mv(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function Av(n,o){const l=o.viewState||o;let f=!1;if("longitude"in l&&"latitude"in l){const _=n.center;n.center=new _.constructor(l.longitude,l.latitude),f=f||_!==n.center}if("zoom"in l){const _=n.zoom;n.zoom=l.zoom,f=f||_!==n.zoom}if("bearing"in l){const _=n.bearing;n.bearing=l.bearing,f=f||_!==n.bearing}if("pitch"in l){const _=n.pitch;n.pitch=l.pitch,f=f||_!==n.pitch}return l.padding&&!n.isPaddingEqual(l.padding)&&(f=!0,n.padding=l.padding),f}const PS=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function zv(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const o={};for(const f of n.layers)o[f.id]=f;const l=n.layers.map(f=>{const _=o[f.ref];let w=null;if("interactive"in f&&(w={...f},delete w.interactive),_){w=w||{...f},delete w.ref;for(const I of PS)I in _&&(w[I]=_[I])}return w||f});return{...n,layers:l}}function MS(n,o){const l=Array.isArray(n)?n[0]:n?n.x:0,f=Array.isArray(n)?n[1]:n?n.y:0,_=Array.isArray(o)?o[0]:o?o.x:0,w=Array.isArray(o)?o[1]:o?o.y:0;return l===_&&f===w}function ls(n,o){if(n===o)return!0;if(!n||!o)return!1;if(Array.isArray(n)){if(!Array.isArray(o)||n.length!==o.length)return!1;for(let l=0;l<n.length;l++)if(!ls(n[l],o[l]))return!1;return!0}else if(Array.isArray(o))return!1;if(typeof n=="object"&&typeof o=="object"){const l=Object.keys(n),f=Object.keys(o);if(l.length!==f.length)return!1;for(const _ of l)if(!o.hasOwnProperty(_)||!ls(n[_],o[_]))return!1;return!0}return!1}const Dv={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},Ff={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},Lv={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},AS=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],zS=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class zl{constructor(o,l,f){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=_=>{const w=this.props[Lv[_.type]];w&&w(_)},this._onPointerEvent=_=>{(_.type==="mousemove"||_.type==="mouseout")&&this._updateHover(_);const w=this.props[Dv[_.type]];w&&(this.props.interactiveLayerIds&&_.type!=="mouseover"&&_.type!=="mouseout"&&(_.features=this._hoveredFeatures||this._queryRenderedFeatures(_.point)),w(_),delete _.features)},this._onCameraEvent=_=>{if(!this._internalUpdate){const w=this.props[Ff[_.type]];w&&w(_)}_.type in this._deferredEvents&&(this._deferredEvents[_.type]=!1)},this._MapClass=o,this.props=l,this._initialize(f)}get map(){return this._map}get transform(){return this._renderTransform}setProps(o){const l=this.props;this.props=o;const f=this._updateSettings(o,l);f&&this._createShadowTransform(this._map);const _=this._updateSize(o),w=this._updateViewState(o,!0);this._updateStyle(o,l),this._updateStyleComponents(o,l),this._updateHandlers(o,l),(f||_||w&&!this._map.isMoving())&&this.redraw()}static reuse(o,l){const f=zl.savedMaps.pop();if(!f)return null;const _=f.map,w=_.getContainer();for(l.className=w.className;w.childNodes.length>0;)l.appendChild(w.childNodes[0]);_._container=l;const I=_._resizeObserver;I&&(I.disconnect(),I.observe(l)),f.setProps({...o,styleDiffing:!1}),_.resize();const{initialViewState:u}=o;return u&&(u.bounds?_.fitBounds(u.bounds,{...u.fitBoundsOptions,duration:0}):f._updateViewState(u,!1)),_.isStyleLoaded()?_.fire("load"):_.once("styledata",()=>_.fire("load")),_._update(),f}_initialize(o){const{props:l}=this,f={...l,...l.initialViewState,accessToken:l.mapboxAccessToken||DS()||null,container:o,style:zv(l.mapStyle)},_=f.initialViewState||f.viewState||f;if(Object.assign(f,{center:[_.longitude||0,_.latitude||0],zoom:_.zoom||0,pitch:_.pitch||0,bearing:_.bearing||0}),l.gl){const D=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=D,l.gl)}const w=new this._MapClass(f);_.padding&&w.setPadding(_.padding),l.cursor&&(w.getCanvas().style.cursor=l.cursor),this._createShadowTransform(w);const I=w._render;w._render=D=>{this._inRender=!0,I.call(w,D),this._inRender=!1};const u=w._renderTaskQueue.run;w._renderTaskQueue.run=D=>{u.call(w._renderTaskQueue,D),this._onBeforeRepaint()},w.on("render",()=>this._onAfterRepaint());const U=w.fire;w.fire=this._fireEvent.bind(this,U),w.on("resize",()=>{this._renderTransform.resize(w.transform.width,w.transform.height)}),w.on("styledata",()=>this._updateStyleComponents(this.props,{})),w.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const D in Dv)w.on(D,this._onPointerEvent);for(const D in Ff)w.on(D,this._onCameraEvent);for(const D in Lv)w.on(D,this._onEvent);this._map=w}recycle(){const l=this.map.getContainer().querySelector("[mapboxgl-children]");l==null||l.remove(),zl.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const o=this._map;!this._inRender&&o.style&&(o._frame&&(o._frame.cancel(),o._frame=null),o._render())}_createShadowTransform(o){const l=kS(o.transform);o.painter.transform=l,this._renderTransform=l}_updateSize(o){const{viewState:l}=o;if(l){const f=this._map;if(l.width!==f.transform.width||l.height!==f.transform.height)return f.resize(),!0}return!1}_updateViewState(o,l){if(this._internalUpdate)return!1;const f=this._map,_=this._renderTransform,{zoom:w,pitch:I,bearing:u}=_,U=f.isMoving();U&&(_.cameraElevationReference="sea");const D=Av(_,{...Mv(f.transform),...o});if(U&&(_.cameraElevationReference="ground"),D&&l){const ue=this._deferredEvents;ue.move=!0,ue.zoom||(ue.zoom=w!==_.zoom),ue.rotate||(ue.rotate=u!==_.bearing),ue.pitch||(ue.pitch=I!==_.pitch)}return U||Av(f.transform,o),D}_updateSettings(o,l){const f=this._map;let _=!1;for(const w of AS)w in o&&!ls(o[w],l[w])&&(_=!0,f[`set${w[0].toUpperCase()}${w.slice(1)}`](o[w]));return _}_updateStyle(o,l){if(o.cursor!==l.cursor&&(this._map.getCanvas().style.cursor=o.cursor),o.mapStyle!==l.mapStyle){const f={diff:o.styleDiffing};return"localIdeographFontFamily"in o&&(f.localIdeographFontFamily=o.localIdeographFontFamily),this._map.setStyle(zv(o.mapStyle),f),!0}return!1}_updateStyleComponents(o,l){const f=this._map;let _=!1;return f.style.loaded()&&("light"in o&&!ls(o.light,l.light)&&(_=!0,f.setLight(o.light)),"fog"in o&&!ls(o.fog,l.fog)&&(_=!0,f.setFog(o.fog)),"terrain"in o&&!ls(o.terrain,l.terrain)&&(!o.terrain||f.getSource(o.terrain.source))&&(_=!0,f.setTerrain(o.terrain))),_}_updateHandlers(o,l){const f=this._map;let _=!1;for(const w of zS){const I=o[w];ls(I,l[w])||(_=!0,I?f[w].enable(I):f[w].disable())}return _}_queryRenderedFeatures(o){const l=this._map,{interactiveLayerIds:f=[]}=this.props;try{return l.queryRenderedFeatures(o,{layers:f.filter(l.getLayer.bind(l))})}catch{return[]}}_updateHover(o){var l;const{props:f}=this;if(f.interactiveLayerIds&&(f.onMouseMove||f.onMouseEnter||f.onMouseLeave)){const w=o.type,I=((l=this._hoveredFeatures)===null||l===void 0?void 0:l.length)>0,u=this._queryRenderedFeatures(o.point),U=u.length>0;!U&&I&&(o.type="mouseleave",this._onPointerEvent(o)),this._hoveredFeatures=u,U&&!I&&(o.type="mouseenter",this._onPointerEvent(o)),o.type=w}else this._hoveredFeatures=null}_fireEvent(o,l,f){const _=this._map,w=_.transform,I=typeof l=="string"?l:l.type;return I==="move"&&this._updateViewState(this.props,!1),I in Ff&&(typeof l=="object"&&(l.viewState=Mv(w)),this._map.isMoving())?(_.transform=this._renderTransform,o.call(_,l,f),_.transform=w,_):(o.call(_,l,f),_)}_onBeforeRepaint(){const o=this._map;this._internalUpdate=!0;for(const f in this._deferredEvents)this._deferredEvents[f]&&o.fire(f);this._internalUpdate=!1;const l=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=l}}}zl.savedMaps=[];function DS(){let n=null;if(typeof location<"u"){const o=/access_token=([^&\/]*)/.exec(location.search);n=o&&o[1]}try{n=n||{}.MapboxAccessToken}catch{}try{n=n||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const LS=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function RS(n,o){if(!n)return null;const l=n.map,f={getMap:()=>l,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:_=>n.transform.locationPoint(o.LngLat.convert(_)),unproject:_=>n.transform.pointLocation(o.Point.convert(_)),queryTerrainElevation:(_,w)=>{const I=l.transform;l.transform=n.transform;const u=l.queryTerrainElevation(_,w);return l.transform=I,u}};for(const _ of BS(l))!(_ in f)&&!LS.includes(_)&&(f[_]=l[_].bind(l));return f}function BS(n){const o=new Set;let l=n;for(;l;){for(const f of Object.getOwnPropertyNames(l))f[0]!=="_"&&typeof n[f]=="function"&&f!=="fire"&&f!=="setEventedParent"&&o.add(f);l=Object.getPrototypeOf(l)}return Array.from(o)}const FS=typeof document<"u"?$e.useLayoutEffect:$e.useEffect,OS=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function US(n,o){for(const l of OS)l in o&&(n[l]=o[l]);o.RTLTextPlugin&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(o.RTLTextPlugin,l=>{l&&console.error(l)},!1)}const Ac=$e.createContext(null),NS={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:n=>console.error(n.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},Vg=$e.forwardRef((n,o)=>{const l=$e.useContext(Ug),[f,_]=$e.useState(null),w=$e.useRef(),{current:I}=$e.useRef({mapLib:null,map:null});$e.useEffect(()=>{const D=n.mapLib;let ue=!0,ie;return Promise.resolve(D||CS(()=>import("./index-fc2e9253.js").then(pe=>pe.i),[])).then(pe=>{if(ue){if(pe.Map||(pe=pe.default),!pe||!pe.Map)throw new Error("Invalid mapLib");if(US(pe,n),!pe.supported||pe.supported(n))n.reuseMaps&&(ie=zl.reuse(n,w.current)),ie||(ie=new zl(pe.Map,n,w.current)),I.map=RS(ie,pe),I.mapLib=pe,_(ie),l==null||l.onMapMount(I.map,n.id);else throw new Error("Map is not supported by this browser")}}).catch(pe=>{n.onError({type:"error",target:null,originalEvent:null,error:pe})}),()=>{ue=!1,ie&&(l==null||l.onMapUnmount(n.id),n.reuseMaps?ie.recycle():ie.destroy())}},[]),FS(()=>{f&&f.setProps(n)}),$e.useImperativeHandle(o,()=>I.map,[f]);const u=$e.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),U={height:"100%"};return $e.createElement("div",{id:n.id,ref:w,style:u},f&&$e.createElement(Ac.Provider,{value:I},$e.createElement("div",{"mapboxgl-children":"",style:U},n.children)))});Vg.displayName="Map";Vg.defaultProps=NS;const VS=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function da(n,o){if(!n||!o)return;const l=n.style;for(const f in o){const _=o[f];Number.isFinite(_)&&!VS.test(f)?l[f]=`${_}px`:l[f]=_}}const $S={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function n1(n){const{map:o,mapLib:l}=$e.useContext(Ac),f=$e.useRef({props:n});f.current.props=n;const _=$e.useMemo(()=>{let w=!1;$e.Children.forEach(n.children,U=>{U&&(w=!0)});const I={...n,element:w?document.createElement("div"):null},u=new l.Marker(I).setLngLat([n.longitude,n.latitude]);return u.getElement().addEventListener("click",U=>{var D,ue;(ue=(D=f.current.props).onClick)===null||ue===void 0||ue.call(D,{type:"click",target:u,originalEvent:U})}),u.on("dragstart",U=>{var D,ue;const ie=U;ie.lngLat=_.getLngLat(),(ue=(D=f.current.props).onDragStart)===null||ue===void 0||ue.call(D,ie)}),u.on("drag",U=>{var D,ue;const ie=U;ie.lngLat=_.getLngLat(),(ue=(D=f.current.props).onDrag)===null||ue===void 0||ue.call(D,ie)}),u.on("dragend",U=>{var D,ue;const ie=U;ie.lngLat=_.getLngLat(),(ue=(D=f.current.props).onDragEnd)===null||ue===void 0||ue.call(D,ie)}),u},[]);return $e.useEffect(()=>(_.addTo(o.getMap()),()=>{_.remove()}),[]),$e.useEffect(()=>{da(_.getElement(),n.style)},[n.style]),(_.getLngLat().lng!==n.longitude||_.getLngLat().lat!==n.latitude)&&_.setLngLat([n.longitude,n.latitude]),n.offset&&!MS(_.getOffset(),n.offset)&&_.setOffset(n.offset),_.isDraggable()!==n.draggable&&_.setDraggable(n.draggable),_.getRotation()!==n.rotation&&_.setRotation(n.rotation),_.getRotationAlignment()!==n.rotationAlignment&&_.setRotationAlignment(n.rotationAlignment),_.getPitchAlignment()!==n.pitchAlignment&&_.setPitchAlignment(n.pitchAlignment),_.getPopup()!==n.popup&&_.setPopup(n.popup),Og.createPortal(n.children,_.getElement())}n1.defaultProps=$S;const jS=$e.memo(n1);function Rv(n){return new Set(n?n.trim().split(/\s+/):[])}function qS(n){const{map:o,mapLib:l}=$e.useContext(Ac),f=$e.useMemo(()=>document.createElement("div"),[]),_=$e.useRef({props:n});_.current.props=n;const w=$e.useMemo(()=>{const I={...n},u=new l.Popup(I).setLngLat([n.longitude,n.latitude]);return u.once("open",U=>{var D,ue;(ue=(D=_.current.props).onOpen)===null||ue===void 0||ue.call(D,U)}),u},[]);if($e.useEffect(()=>{const I=u=>{var U,D;(D=(U=_.current.props).onClose)===null||D===void 0||D.call(U,u)};return w.on("close",I),w.setDOMContent(f).addTo(o.getMap()),()=>{w.off("close",I),w.isOpen()&&w.remove()}},[]),$e.useEffect(()=>{da(w.getElement(),n.style)},[n.style]),w.isOpen()&&((w.getLngLat().lng!==n.longitude||w.getLngLat().lat!==n.latitude)&&w.setLngLat([n.longitude,n.latitude]),n.offset&&!ls(w.options.offset,n.offset)&&w.setOffset(n.offset),(w.options.anchor!==n.anchor||w.options.maxWidth!==n.maxWidth)&&(w.options.anchor=n.anchor,w.setMaxWidth(n.maxWidth)),w.options.className!==n.className)){const I=Rv(w.options.className),u=Rv(n.className);for(const U of I)u.has(U)||w.removeClassName(U);for(const U of u)I.has(U)||w.addClassName(U);w.options.className=n.className}return Og.createPortal(n.children,f)}$e.memo(qS);function zc(n,o,l,f){const _=$e.useContext(Ac),w=$e.useMemo(()=>n(_),[]);return $e.useEffect(()=>{const I=f||l||o,u=typeof o=="function"&&typeof l=="function"?o:null,U=typeof l=="function"?l:typeof o=="function"?o:null,{map:D}=_;return D.hasControl(w)||(D.addControl(w,I==null?void 0:I.position),u&&u(_)),()=>{U&&U(_),D.hasControl(w)&&D.removeControl(w)}},[]),w}function ZS(n){const o=zc(({mapLib:l})=>new l.AttributionControl(n),{position:n.position});return $e.useEffect(()=>{da(o._container,n.style)},[n.style]),null}$e.memo(ZS);function GS(n){const o=zc(({mapLib:l})=>new l.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return $e.useEffect(()=>{da(o._controlContainer,n.style)},[n.style]),null}$e.memo(GS);const i1=$e.forwardRef((n,o)=>{const l=$e.useRef({props:n}),f=zc(({mapLib:_})=>{const w=new _.GeolocateControl(n),I=w._setupUI;return w._setupUI=u=>{w._container.hasChildNodes()||I(u)},w.on("geolocate",u=>{var U,D;(D=(U=l.current.props).onGeolocate)===null||D===void 0||D.call(U,u)}),w.on("error",u=>{var U,D;(D=(U=l.current.props).onError)===null||D===void 0||D.call(U,u)}),w.on("outofmaxbounds",u=>{var U,D;(D=(U=l.current.props).onOutOfMaxBounds)===null||D===void 0||D.call(U,u)}),w.on("trackuserlocationstart",u=>{var U,D;(D=(U=l.current.props).onTrackUserLocationStart)===null||D===void 0||D.call(U,u)}),w.on("trackuserlocationend",u=>{var U,D;(D=(U=l.current.props).onTrackUserLocationEnd)===null||D===void 0||D.call(U,u)}),w},{position:n.position});return l.current.props=n,$e.useImperativeHandle(o,()=>({trigger:()=>f.trigger()}),[]),$e.useEffect(()=>{da(f._container,n.style)},[n.style]),null});i1.displayName="GeolocateControl";$e.memo(i1);function WS(n){const o=zc(({mapLib:l})=>new l.NavigationControl(n),{position:n.position});return $e.useEffect(()=>{da(o._container,n.style)},[n.style]),null}const XS=$e.memo(WS),HS={unit:"metric",maxWidth:100};function r1(n){const o=zc(({mapLib:l})=>new l.ScaleControl(n),{position:n.position});return(o.options.unit!==n.unit||o.options.maxWidth!==n.maxWidth)&&(o.options.maxWidth=n.maxWidth,o.setUnit(n.unit)),$e.useEffect(()=>{da(o._container,n.style)},[n.style]),null}r1.defaultProps=HS;$e.memo(r1);var o1={exports:{}};(function(n,o){(function(l,f){n.exports=f()})(Qw,function(){var l,f,_;function w(u,U){if(!l)l=U;else if(!f)f=U;else{var D="var sharedChunk = {}; ("+l+")(sharedChunk); ("+f+")(sharedChunk);",ue={};l(ue),_=U(ue),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}w(["exports"],function(u){function U(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var D=ue;function ue(i,e){this.x=i,this.y=e}ue.prototype={clone:function(){return new ue(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,e){return this.clone()._rotateAround(i,e)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var e=i.x-this.x,r=i.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,e){return Math.atan2(this.x*e-this.y*i,this.x*i+this.y*e)},_matMult:function(i){var e=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=e,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var e=Math.cos(i),r=Math.sin(i),a=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=a,this},_rotateAround:function(i,e){var r=Math.cos(i),a=Math.sin(i),d=e.y+a*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-a*(this.y-e.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ue.convert=function(i){return i instanceof ue?i:Array.isArray(i)?new ue(i[0],i[1]):i};var ie=U(D),pe=Ce;function Ce(i,e,r,a){this.cx=3*i,this.bx=3*(r-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=e,this.p2x=r,this.p2y=a}Ce.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,e){if(e===void 0&&(e=1e-6),i<0)return 0;if(i>1)return 1;for(var r=i,a=0;a<8;a++){var d=this.sampleCurveX(r)-i;if(Math.abs(d)<e)return r;var m=this.sampleCurveDerivativeX(r);if(Math.abs(m)<1e-6)break;r-=d/m}var g=0,v=1;for(r=i,a=0;a<20&&(d=this.sampleCurveX(r),!(Math.abs(d-i)<e));a++)i>d?g=r:v=r,r=.5*(v-g)+g;return r},solve:function(i,e){return this.sampleCurveY(this.solveCurveX(i,e))}};var ke=U(pe);function Pe(i,e,r,a){const d=new ke(i,e,r,a);return function(m){return d.solve(m)}}const qe=Pe(.25,.1,.25,1);function re(i,e,r){return Math.min(r,Math.max(e,i))}function te(i,e,r){const a=r-e,d=((i-e)%a+a)%a+e;return d===e?r:d}function le(i,...e){for(const r of e)for(const a in r)i[a]=r[a];return i}let Ee=1;function Ze(i,e){i.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function Fe(i,e,r){const a={};for(const d in i)a[d]=e.call(r||this,i[d],d,i);return a}function Ae(i,e,r){const a={};for(const d in i)e.call(r||this,i[d],d,i)&&(a[d]=i[d]);return a}function We(i){return Array.isArray(i)?i.map(We):typeof i=="object"&&i?Fe(i,We):i}const bt={};function st(i){bt[i]||(typeof console<"u"&&console.warn(i),bt[i]=!0)}function _t(i,e,r){return(r.y-i.y)*(e.x-i.x)>(e.y-i.y)*(r.x-i.x)}function mi(i){let e=0;for(let r,a,d=0,m=i.length,g=m-1;d<m;g=d++)r=i[d],a=i[g],e+=(a.x-r.x)*(r.y+a.y);return e}function qt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let Kn=null;function qn(i){if(Kn==null){const e=i.navigator?i.navigator.userAgent:null;Kn=!!i.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Kn}function gi(i){return typeof ImageBitmap<"u"&&i instanceof ImageBitmap}const En="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Xe,ht;const ct={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(i){const e=requestAnimationFrame(i);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(i,e=0){return this.getImageCanvasContext(i).getImageData(-e,-e,i.width+2*e,i.height+2*e)},getImageCanvasContext(i){const e=window.document.createElement("canvas"),r=e.getContext("2d",{willReadFrequently:!0});if(!r)throw new Error("failed to create canvas 2d context");return e.width=i.width,e.height=i.height,r.drawImage(i,0,0,i.width,i.height),r},resolveURL:i=>(Xe||(Xe=document.createElement("a")),Xe.href=i,Xe.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ht==null&&(ht=matchMedia("(prefers-reduced-motion: reduce)")),ht.matches)}},It={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class Bt extends Error{constructor(e,r,a,d){super(`AJAXError: ${r} (${e}): ${a}`),this.status=e,this.statusText=r,this.url=a,this.body=d}}const zi=qt()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Tn=i=>It.REGISTERED_PROTOCOLS[i.substring(0,i.indexOf("://"))];function Di(i,e){const r=new AbortController,a=new Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:zi(),signal:r.signal});let d=!1,m=!1;return i.type==="json"&&a.headers.set("Accept","application/json"),m||fetch(a).then(g=>g.ok?(v=>{(i.type==="arrayBuffer"||i.type==="image"?v.arrayBuffer():i.type==="json"?v.json():v.text()).then(b=>{m||(d=!0,e(null,b,v.headers.get("Cache-Control"),v.headers.get("Expires")))}).catch(b=>{m||e(new Error(b.message))})})(g):g.blob().then(v=>e(new Bt(g.status,g.statusText,i.url,v)))).catch(g=>{g.code!==20&&e(new Error(g.message))}),{cancel:()=>{m=!0,d||r.abort()}}}const Ut=function(i,e){if(/:\/\//.test(i.url)&&!/^https?:|^file:/.test(i.url)){if(qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e);if(!qt())return(Tn(i.url)||Di)(i,e)}if(!(/^file:/.test(r=i.url)||/^file:/.test(zi())&&!/^\w+:/.test(r))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Di(i,e);if(qt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,e,void 0,!0)}var r;return function(a,d){const m=new XMLHttpRequest;m.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(m.responseType="arraybuffer");for(const g in a.headers)m.setRequestHeader(g,a.headers[g]);return a.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=a.credentials==="include",m.onerror=()=>{d(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let g=m.response;if(a.type==="json")try{g=JSON.parse(m.response)}catch(v){return d(v)}d(null,g,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else{const g=new Blob([m.response],{type:m.getResponseHeader("Content-Type")});d(new Bt(m.status,m.statusText,a.url,g))}},m.send(a.body),{cancel:()=>m.abort()}}(i,e)},si=function(i,e){return Ut(le(i,{type:"arrayBuffer"}),e)};function ho(i){if(!i||i.indexOf("://")<=0||i.indexOf("data:image/")===0||i.indexOf("blob:")===0)return!0;const e=new URL(i),r=window.location;return e.protocol===r.protocol&&e.host===r.host}function yi(i,e,r){r[i]&&r[i].indexOf(e)!==-1||(r[i]=r[i]||[],r[i].push(e))}function Jr(i,e,r){if(r&&r[i]){const a=r[i].indexOf(e);a!==-1&&r[i].splice(a,1)}}class Pt{constructor(e,r={}){le(this,r),this.type=e}}class Zt extends Pt{constructor(e,r={}){super("error",le({error:e},r))}}class Wt{on(e,r){return this._listeners=this._listeners||{},yi(e,r,this._listeners),this}off(e,r){return Jr(e,r,this._listeners),Jr(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},yi(e,r,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,r){typeof e=="string"&&(e=new Pt(e,r||{}));const a=e.type;if(this.listens(a)){e.target=this;const d=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const v of d)v.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const v of m)Jr(a,v,this._oneTimeListeners),v.call(this,e);const g=this._eventedParent;g&&(le(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(e))}else e instanceof Zt&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var me={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const Rn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function _i(i,e){const r={};for(const a in i)a!=="ref"&&(r[a]=i[a]);return Rn.forEach(a=>{a in e&&(r[a]=e[a])}),r}function vt(i,e){if(Array.isArray(i)){if(!Array.isArray(e)||i.length!==e.length)return!1;for(let r=0;r<i.length;r++)if(!vt(i[r],e[r]))return!1;return!0}if(typeof i=="object"&&i!==null&&e!==null){if(typeof e!="object"||Object.keys(i).length!==Object.keys(e).length)return!1;for(const r in i)if(!vt(i[r],e[r]))return!1;return!0}return i===e}const dt={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function un(i,e,r){r.push({command:dt.addSource,args:[i,e[i]]})}function Qr(i,e,r){e.push({command:dt.removeSource,args:[i]}),r[i]=!0}function po(i,e,r,a){Qr(i,r,a),un(i,e,r)}function fo(i,e,r){let a;for(a in i[r])if(Object.prototype.hasOwnProperty.call(i[r],a)&&a!=="data"&&!vt(i[r][a],e[r][a]))return!1;for(a in e[r])if(Object.prototype.hasOwnProperty.call(e[r],a)&&a!=="data"&&!vt(i[r][a],e[r][a]))return!1;return!0}function Gt(i,e,r,a,d,m){let g;for(g in e=e||{},i=i||{})Object.prototype.hasOwnProperty.call(i,g)&&(vt(i[g],e[g])||r.push({command:m,args:[a,g,e[g],d]}));for(g in e)Object.prototype.hasOwnProperty.call(e,g)&&!Object.prototype.hasOwnProperty.call(i,g)&&(vt(i[g],e[g])||r.push({command:m,args:[a,g,e[g],d]}))}function Zn(i){return i.id}function Lr(i,e){return i[e.id]=e,i}class Le{constructor(e,r,a,d){this.message=(e?`${e}: `:"")+a,d&&(this.identifier=d),r!=null&&r.__line__&&(this.line=r.__line__)}}function Bn(i,...e){for(const r of e)for(const a in r)i[a]=r[a];return i}class vi extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}class _r{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[a,d]of r)this.bindings[a]=d}concat(e){return new _r(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Rr={kind:"null"},Re={kind:"number"},wt={kind:"string"},mt={kind:"boolean"},Fn={kind:"color"},rr={kind:"object"},at={kind:"value"},Br={kind:"collator"},eo={kind:"formatted"},No={kind:"padding"},to={kind:"resolvedImage"};function Gn(i,e){return{kind:"array",itemType:i,N:e}}function $(i){if(i.kind==="array"){const e=$(i.itemType);return typeof i.N=="number"?`array<${e}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${e}>`}return i.kind}const z=[Rr,Re,wt,mt,Fn,eo,rr,Gn(at),No,to];function R(i,e){if(e.kind==="error")return null;if(i.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!R(i.itemType,e.itemType))&&(typeof i.N!="number"||i.N===e.N))return null}else{if(i.kind===e.kind)return null;if(i.kind==="value"){for(const r of z)if(!R(r,e))return null}}return`Expected ${$(i)} but found ${$(e)} instead.`}function N(i,e){return e.some(r=>r.kind===i.kind)}function X(i,e){return e.some(r=>r==="null"?i===null:r==="array"?Array.isArray(i):r==="object"?i&&!Array.isArray(i)&&typeof i=="object":r===typeof i)}function Y(i,e){return i.kind==="array"&&e.kind==="array"?i.itemType.kind===e.itemType.kind&&typeof i.N=="number":i.kind===e.kind}const oe=.96422,ne=.82521,K=4/29,se=6/29,ve=3*se*se,ye=Math.PI/180,xe=180/Math.PI;function nt(i){return(i%=360)<0&&(i+=360),i}function pt([i,e,r,a]){let d,m;const g=it((.2225045*(i=Je(i))+.7168786*(e=Je(e))+.0606169*(r=Je(r)))/1);i===e&&e===r?d=m=g:(d=it((.4360747*i+.3850649*e+.1430804*r)/oe),m=it((.0139322*i+.0971045*e+.7141733*r)/ne));const v=116*g-16;return[v<0?0:v,500*(d-g),200*(g-m),a]}function Je(i){return i<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function it(i){return i>.008856451679035631?Math.pow(i,1/3):i/ve+K}function gt([i,e,r,a]){let d=(i+16)/116,m=isNaN(e)?d:d+e/500,g=isNaN(r)?d:d-r/200;return d=1*xt(d),m=oe*xt(m),g=ne*xt(g),[Ct(3.1338561*m-1.6168667*d-.4906146*g),Ct(-.9787684*m+1.9161415*d+.033454*g),Ct(.0719453*m-.2289914*d+1.4052427*g),a]}function Ct(i){return(i=i<=.00304?12.92*i:1.055*Math.pow(i,1/2.4)-.055)<0?0:i>1?1:i}function xt(i){return i>se?i*i*i:ve*(i-K)}function Ft(i){return parseInt(i.padEnd(2,i),16)/255}function Nt(i,e){return en(e?i/100:i,0,1)}function en(i,e,r){return Math.min(Math.max(e,i),r)}function on(i){return!i.some(Number.isNaN)}const gn={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Mt{constructor(e,r,a,d=1,m=!0){this.r=e,this.g=r,this.b=a,this.a=d,m||(this.r*=d,this.g*=d,this.b*=d,d||this.overwriteGetter("rgb",[e,r,a,d]))}static parse(e){if(e instanceof Mt)return e;if(typeof e!="string")return;const r=function(a){if((a=a.toLowerCase())==="transparent")return[0,0,0,0];const d=gn[a];if(d){const[v,b,T]=d;return[v/255,b/255,T/255,1]}if(/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const v=a.length<6?1:2;let b=1;return[Ft(a.slice(b,b+=v)),Ft(a.slice(b,b+=v)),Ft(a.slice(b,b+=v)),Ft(a.slice(b,b+v)||"ff")]}const m=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[v,b,T,k,A,L,B,O,G,j,ee,ae]=m,J=[k||" ",B||" ",j].join("");if(J==="  "||J==="  /"||J===",,"||J===",,,"){const ce=[T,L,G].join(""),fe=ce==="%%%"?100:ce===""?255:0;if(fe){const _e=[en(+b/fe,0,1),en(+A/fe,0,1),en(+O/fe,0,1),ee?Nt(+ee,ae):1];if(on(_e))return _e}}return}const g=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(g){const[v,b,T,k,A,L,B,O,G]=g,j=[T||" ",A||" ",B].join("");if(j==="  "||j==="  /"||j===",,"||j===",,,"){const ee=[+b,en(+k,0,100),en(+L,0,100),O?Nt(+O,G):1];if(on(ee))return function([ae,J,ce,fe]){function _e(He){const Ye=(He+ae/30)%12,Ne=J*Math.min(ce,1-ce);return ce-Ne*Math.max(-1,Math.min(Ye-3,9-Ye,1))}return ae=nt(ae),J/=100,ce/=100,[_e(0),_e(8),_e(4),fe]}(ee)}}}(e);return r?new Mt(...r,!1):void 0}get rgb(){const{r:e,g:r,b:a,a:d}=this,m=d||1/0;return this.overwriteGetter("rgb",[e/m,r/m,a/m,d])}get hcl(){return this.overwriteGetter("hcl",function(e){const[r,a,d,m]=pt(e),g=Math.sqrt(a*a+d*d);return[Math.round(1e4*g)?nt(Math.atan2(d,a)*xe):NaN,g,r,m]}(this.rgb))}get lab(){return this.overwriteGetter("lab",pt(this.rgb))}overwriteGetter(e,r){return Object.defineProperty(this,e,{value:r}),r}toString(){const[e,r,a,d]=this.rgb;return`rgba(${[e,r,a].map(m=>Math.round(255*m)).join(",")},${d})`}}Mt.black=new Mt(0,0,0,1),Mt.white=new Mt(1,1,1,1),Mt.transparent=new Mt(0,0,0,0),Mt.red=new Mt(1,0,0,1);class Fl{constructor(e,r,a){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ol{constructor(e,r,a,d,m){this.text=e,this.image=r,this.scale=a,this.fontStack=d,this.textColor=m}}class Li{constructor(e){this.sections=e}static fromString(e){return new Li([new Ol(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Li?e:Li.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class xi{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof xi)return e;if(typeof e=="number")return new xi([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const r of e)if(typeof r!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new xi(e)}}toString(){return JSON.stringify(this.values)}}class Yn{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Yn({name:e,available:!1}):null}}function Dc(i,e,r,a){return typeof i=="number"&&i>=0&&i<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[i,e,r,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[i,e,r,a]:[i,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function pa(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof Mt||i instanceof Fl||i instanceof Li||i instanceof xi||i instanceof Yn)return!0;if(Array.isArray(i)){for(const e of i)if(!pa(e))return!1;return!0}if(typeof i=="object"){for(const e in i)if(!pa(i[e]))return!1;return!0}return!1}function sn(i){if(i===null)return Rr;if(typeof i=="string")return wt;if(typeof i=="boolean")return mt;if(typeof i=="number")return Re;if(i instanceof Mt)return Fn;if(i instanceof Fl)return Br;if(i instanceof Li)return eo;if(i instanceof xi)return No;if(i instanceof Yn)return to;if(Array.isArray(i)){const e=i.length;let r;for(const a of i){const d=sn(a);if(r){if(r===d)continue;r=at;break}r=d}return Gn(r||at,e)}return rr}function Cs(i){const e=typeof i;return i===null?"":e==="string"||e==="number"||e==="boolean"?String(i):i instanceof Mt||i instanceof Li||i instanceof xi||i instanceof Yn?i.toString():JSON.stringify(i)}class mo{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!pa(e[1]))return r.error("invalid value");const a=e[1];let d=sn(a);const m=r.expectedType;return d.kind!=="array"||d.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(d=m),new mo(d,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class On{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Is={string:wt,number:Re,boolean:mt,object:rr};class wi{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let a,d=1;const m=e[0];if(m==="array"){let v,b;if(e.length>2){const T=e[1];if(typeof T!="string"||!(T in Is)||T==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);v=Is[T],d++}else v=at;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);b=e[2],d++}a=Gn(v,b)}else{if(!Is[m])throw new Error(`Types doesn't contain name = ${m}`);a=Is[m]}const g=[];for(;d<e.length;d++){const v=r.parse(e[d],d,at);if(!v)return null;g.push(v)}return new wi(a,g)}evaluate(e){for(let r=0;r<this.args.length;r++){const a=this.args[r].evaluate(e);if(!R(this.type,sn(a)))return a;if(r===this.args.length-1)throw new On(`Expected value to be of type ${$(this.type)}, but found ${$(sn(a))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Lc={"to-boolean":mt,"to-color":Fn,"to-number":Re,"to-string":wt};class no{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const a=e[0];if(!Lc[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&e.length!==2)return r.error("Expected one argument.");const d=Lc[a],m=[];for(let g=1;g<e.length;g++){const v=r.parse(e[g],g,at);if(!v)return null;m.push(v)}return new no(d,m)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let r,a;for(const d of this.args){if(r=d.evaluate(e),a=null,r instanceof Mt)return r;if(typeof r=="string"){const m=e.parseColor(r);if(m)return m}else if(Array.isArray(r)&&(a=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:Dc(r[0],r[1],r[2],r[3]),!a))return new Mt(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new On(a||`Could not parse color from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}if(this.type.kind==="padding"){let r;for(const a of this.args){r=a.evaluate(e);const d=xi.parse(r);if(d)return d}throw new On(`Could not parse padding from value '${typeof r=="string"?r:JSON.stringify(r)}'`)}if(this.type.kind==="number"){let r=null;for(const a of this.args){if(r=a.evaluate(e),r===null)return 0;const d=Number(r);if(!isNaN(d))return d}throw new On(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?Li.fromString(Cs(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Yn.fromString(Cs(this.args[0].evaluate(e))):Cs(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const np=["Unknown","Point","LineString","Polygon"];class or{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?np[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let r=this._parseColorCache[e];return r||(r=this._parseColorCache[e]=Mt.parse(e)),r}}class Vo{constructor(e,r,a=[],d,m=new _r,g=[]){this.registry=e,this.path=a,this.key=a.map(v=>`[${v}]`).join(""),this.scope=m,this.errors=g,this.expectedType=d,this._isConstant=r}parse(e,r,a,d,m={}){return r?this.concat(r,a,d)._parse(e,m):this._parse(e,m)}_parse(e,r){function a(d,m,g){return g==="assert"?new wi(m,[d]):g==="coerce"?new no(m,[d]):d}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=e[0];if(typeof d!="string")return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let g=m.parse(e,this);if(!g)return null;if(this.expectedType){const v=this.expectedType,b=g.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||b.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string")if(v.kind!=="padding"||b.kind!=="value"&&b.kind!=="number"&&b.kind!=="array"){if(this.checkSubtype(v,b))return null}else g=a(g,v,r.typeAnnotation||"coerce");else g=a(g,v,r.typeAnnotation||"coerce");else g=a(g,v,r.typeAnnotation||"assert")}if(!(g instanceof mo)&&g.type.kind!=="resolvedImage"&&this._isConstant(g)){const v=new or;try{g=new mo(g.type,g.evaluate(v))}catch(b){return this.error(b.message),null}}return g}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,a){const d=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new Vo(this.registry,this._isConstant,d,r||null,m,this.errors)}error(e,...r){const a=`${this.key}${r.map(d=>`[${d}]`).join("")}`;this.errors.push(new vi(a,e))}checkSubtype(e,r){const a=R(e,r);return a&&this.error(a),a}}class $o{constructor(e,r,a){this.type=Br,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return r.error("Collator options argument must be an object.");const d=r.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,mt);if(!d)return null;const m=r.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,mt);if(!m)return null;let g=null;return a.locale&&(g=r.parse(a.locale,1,wt),!g)?null:new $o(d,m,g)}evaluate(e){return new Fl(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const Wi=8192;function Vt(i,e){i[0]=Math.min(i[0],e[0]),i[1]=Math.min(i[1],e[1]),i[2]=Math.max(i[2],e[0]),i[3]=Math.max(i[3],e[1])}function fa(i,e){return!(i[0]<=e[0]||i[2]>=e[2]||i[1]<=e[1]||i[3]>=e[3])}function Ul(i,e){const r=(180+i[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,d=Math.pow(2,e.z);return[Math.round(r*d*Wi),Math.round(a*d*Wi)]}function ip(i,e,r){const a=i[0]-e[0],d=i[1]-e[1],m=i[0]-r[0],g=i[1]-r[1];return a*g-m*d==0&&a*m<=0&&d*g<=0}function ma(i,e){let r=!1;for(let g=0,v=e.length;g<v;g++){const b=e[g];for(let T=0,k=b.length;T<k-1;T++){if(ip(i,b[T],b[T+1]))return!1;(d=b[T])[1]>(a=i)[1]!=(m=b[T+1])[1]>a[1]&&a[0]<(m[0]-d[0])*(a[1]-d[1])/(m[1]-d[1])+d[0]&&(r=!r)}}var a,d,m;return r}function Rc(i,e){for(let r=0;r<e.length;r++)if(ma(i,e[r]))return!0;return!1}function Bc(i,e,r,a){const d=a[0]-r[0],m=a[1]-r[1],g=(i[0]-r[0])*m-d*(i[1]-r[1]),v=(e[0]-r[0])*m-d*(e[1]-r[1]);return g>0&&v<0||g<0&&v>0}function Fc(i,e,r){for(const T of r)for(let k=0;k<T.length-1;++k)if((v=[(g=T[k+1])[0]-(m=T[k])[0],g[1]-m[1]])[0]*(b=[(d=e)[0]-(a=i)[0],d[1]-a[1]])[1]-v[1]*b[0]!=0&&Bc(a,d,m,g)&&Bc(m,g,a,d))return!0;var a,d,m,g,v,b;return!1}function Nl(i,e){for(let r=0;r<i.length;++r)if(!ma(i[r],e))return!1;for(let r=0;r<i.length-1;++r)if(Fc(i[r],i[r+1],e))return!1;return!0}function rp(i,e){for(let r=0;r<e.length;r++)if(Nl(i,e[r]))return!0;return!1}function Vl(i,e,r){const a=[];for(let d=0;d<i.length;d++){const m=[];for(let g=0;g<i[d].length;g++){const v=Ul(i[d][g],r);Vt(e,v),m.push(v)}a.push(m)}return a}function Oc(i,e,r){const a=[];for(let d=0;d<i.length;d++){const m=Vl(i[d],e,r);a.push(m)}return a}function Uc(i,e,r,a){if(i[0]<r[0]||i[0]>r[2]){const d=.5*a;let m=i[0]-r[0]>d?-a:r[0]-i[0]>d?a:0;m===0&&(m=i[0]-r[2]>d?-a:r[2]-i[0]>d?a:0),i[0]+=m}Vt(e,i)}function $l(i,e,r,a){const d=Math.pow(2,a.z)*Wi,m=[a.x*Wi,a.y*Wi],g=[];for(const v of i)for(const b of v){const T=[b.x+m[0],b.y+m[1]];Uc(T,e,r,d),g.push(T)}return g}function jl(i,e,r,a){const d=Math.pow(2,a.z)*Wi,m=[a.x*Wi,a.y*Wi],g=[];for(const b of i){const T=[];for(const k of b){const A=[k.x+m[0],k.y+m[1]];Vt(e,A),T.push(A)}g.push(T)}if(e[2]-e[0]<=d/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const b of g)for(const T of b)Uc(T,e,r,d)}var v;return g}class go{constructor(e,r){this.type=mt,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(pa(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let d=0;d<a.features.length;++d){const m=a.features[d].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new go(a,a.features[d].geometry)}else if(a.type==="Feature"){const d=a.geometry.type;if(d==="Polygon"||d==="MultiPolygon")return new go(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new go(a,a)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,a){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(a.type==="Polygon"){const v=Vl(a.coordinates,m,g),b=$l(r.geometry(),d,m,g);if(!fa(d,m))return!1;for(const T of b)if(!ma(T,v))return!1}if(a.type==="MultiPolygon"){const v=Oc(a.coordinates,m,g),b=$l(r.geometry(),d,m,g);if(!fa(d,m))return!1;for(const T of b)if(!Rc(T,v))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,a){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],g=r.canonicalID();if(a.type==="Polygon"){const v=Vl(a.coordinates,m,g),b=jl(r.geometry(),d,m,g);if(!fa(d,m))return!1;for(const T of b)if(!Nl(T,v))return!1}if(a.type==="MultiPolygon"){const v=Oc(a.coordinates,m,g),b=jl(r.geometry(),d,m,g);if(!fa(d,m))return!1;for(const T of b)if(!rp(T,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class ga{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const a=e[1];return r.scope.has(a)?new ga(a,r.scope.get(a)):r.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class bi{constructor(e,r,a,d){this.name=e,this.type=r,this._evaluate=a,this.args=d}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,r){const a=e[0],d=bi.definitions[a];if(!d)return r.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,g=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,v=g.filter(([T])=>!Array.isArray(T)||T.length===e.length-1);let b=null;for(const[T,k]of v){b=new Vo(r.registry,ya,r.path,null,r.scope);const A=[];let L=!1;for(let B=1;B<e.length;B++){const O=e[B],G=Array.isArray(T)?T[B-1]:T.type,j=b.parse(O,1+A.length,G);if(!j){L=!0;break}A.push(j)}if(!L)if(Array.isArray(T)&&T.length!==A.length)b.error(`Expected ${T.length} arguments, but found ${A.length} instead.`);else{for(let B=0;B<A.length;B++){const O=Array.isArray(T)?T[B]:T.type,G=A[B];b.concat(B+1).checkSubtype(O,G.type)}if(b.errors.length===0)return new bi(a,m,k,A)}}if(v.length===1)r.errors.push(...b.errors);else{const T=(v.length?v:g).map(([A])=>{return L=A,Array.isArray(L)?`(${L.map($).join(", ")})`:`(${$(L.type)}...)`;var L}).join(" | "),k=[];for(let A=1;A<e.length;A++){const L=r.parse(e[A],1+k.length);if(!L)return null;k.push($(L.type))}r.error(`Expected arguments of type ${T}, but found (${k.join(", ")}) instead.`)}return null}static register(e,r){bi.definitions=r;for(const a in r)e[a]=bi}}function ya(i){if(i instanceof ga)return ya(i.boundExpression);if(i instanceof bi&&i.name==="error"||i instanceof $o||i instanceof go)return!1;const e=i instanceof no||i instanceof wi;let r=!0;return i.eachChild(a=>{r=e?r&&ya(a):r&&a instanceof mo}),!!r&&_a(i)&&Ps(i,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function _a(i){if(i instanceof bi&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof go)return!1;let e=!0;return i.eachChild(r=>{e&&!_a(r)&&(e=!1)}),e}function ks(i){if(i instanceof bi&&i.name==="feature-state")return!1;let e=!0;return i.eachChild(r=>{e&&!ks(r)&&(e=!1)}),e}function Ps(i,e){if(i instanceof bi&&e.indexOf(i.name)>=0)return!1;let r=!0;return i.eachChild(a=>{r&&!Ps(a,e)&&(r=!1)}),r}function Ms(i,e){const r=i.length-1;let a,d,m=0,g=r,v=0;for(;m<=g;)if(v=Math.floor((m+g)/2),a=i[v],d=i[v+1],a<=e){if(v===r||e<d)return v;m=v+1}else{if(!(a>e))throw new On("Input is not a number.");g=v-1}return 0}class As{constructor(e,r,a){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[d,m]of a)this.labels.push(d),this.outputs.push(m)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const a=r.parse(e[1],1,Re);if(!a)return null;const d=[];let m=null;r.expectedType&&r.expectedType.kind!=="value"&&(m=r.expectedType);for(let g=1;g<e.length;g+=2){const v=g===1?-1/0:e[g],b=e[g+1],T=g,k=g+1;if(typeof v!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',T);if(d.length&&d[d.length-1][0]>=v)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',T);const A=r.parse(b,k,m);if(!A)return null;m=m||A.type,d.push([v,A])}return new As(m,a,d)}evaluate(e){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=r[0])return a[0].evaluate(e);const m=r.length;return d>=r[m-1]?a[m-1].evaluate(e):a[Ms(r,d)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function zs(i,e,r){return i+r*(e-i)}function Ds(i,e,r){return i.map((a,d)=>zs(a,e[d],r))}const Si={number:zs,color:function(i,e,r,a="rgb"){switch(a){case"rgb":{const[d,m,g,v]=Ds(i.rgb,e.rgb,r);return new Mt(d,m,g,v,!1)}case"hcl":{const[d,m,g,v]=i.hcl,[b,T,k,A]=e.hcl;let L,B;if(isNaN(d)||isNaN(b))isNaN(d)?isNaN(b)?L=NaN:(L=b,g!==1&&g!==0||(B=T)):(L=d,k!==1&&k!==0||(B=m));else{let ae=b-d;b>d&&ae>180?ae-=360:b<d&&d-b>180&&(ae+=360),L=d+r*ae}const[O,G,j,ee]=function([ae,J,ce,fe]){return ae=isNaN(ae)?0:ae*ye,gt([ce,Math.cos(ae)*J,Math.sin(ae)*J,fe])}([L,B??zs(m,T,r),zs(g,k,r),zs(v,A,r)]);return new Mt(O,G,j,ee,!1)}case"lab":{const[d,m,g,v]=gt(Ds(i.lab,e.lab,r));return new Mt(d,m,g,v,!1)}}},array:Ds,padding:function(i,e,r){return new xi(Ds(i.values,e.values,r))}};class Ri{constructor(e,r,a,d,m){this.type=e,this.operator=r,this.interpolation=a,this.input=d,this.labels=[],this.outputs=[];for(const[g,v]of m)this.labels.push(g),this.outputs.push(v)}static interpolationFactor(e,r,a,d){let m=0;if(e.name==="exponential")m=ql(r,e.base,a,d);else if(e.name==="linear")m=ql(r,1,a,d);else if(e.name==="cubic-bezier"){const g=e.controlPoints;m=new ke(g[0],g[1],g[2],g[3]).solve(ql(r,1,a,d))}return m}static parse(e,r){let[a,d,m,...g]=e;if(!Array.isArray(d)||d.length===0)return r.error("Expected an interpolation type expression.",1);if(d[0]==="linear")d={name:"linear"};else if(d[0]==="exponential"){const T=d[1];if(typeof T!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:T}}else{if(d[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const T=d.slice(1);if(T.length!==4||T.some(k=>typeof k!="number"||k<0||k>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:T}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(m=r.parse(m,2,Re),!m)return null;const v=[];let b=null;a==="interpolate-hcl"||a==="interpolate-lab"?b=Fn:r.expectedType&&r.expectedType.kind!=="value"&&(b=r.expectedType);for(let T=0;T<g.length;T+=2){const k=g[T],A=g[T+1],L=T+3,B=T+4;if(typeof k!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(v.length&&v[v.length-1][0]>=k)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const O=r.parse(A,B,b);if(!O)return null;b=b||O.type,v.push([k,O])}return Y(b,Re)||Y(b,Fn)||Y(b,No)||Y(b,Gn(Re))?new Ri(b,a,d,m,v):r.error(`Type ${$(b)} is not interpolatable.`)}evaluate(e){const r=this.labels,a=this.outputs;if(r.length===1)return a[0].evaluate(e);const d=this.input.evaluate(e);if(d<=r[0])return a[0].evaluate(e);const m=r.length;if(d>=r[m-1])return a[m-1].evaluate(e);const g=Ms(r,d),v=Ri.interpolationFactor(this.interpolation,d,r[g],r[g+1]),b=a[g].evaluate(e),T=a[g+1].evaluate(e);switch(this.operator){case"interpolate":return Si[this.type.kind](b,T,v);case"interpolate-hcl":return Si.color(b,T,v,"hcl");case"interpolate-lab":return Si.color(b,T,v,"lab")}}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function ql(i,e,r,a){const d=a-r,m=i-r;return d===0?0:e===1?m/d:(Math.pow(e,m)-1)/(Math.pow(e,d)-1)}class va{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let a=null;const d=r.expectedType;d&&d.kind!=="value"&&(a=d);const m=[];for(const v of e.slice(1)){const b=r.parse(v,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!b)return null;a=a||b.type,m.push(b)}if(!a)throw new Error("No output type");const g=d&&m.some(v=>R(d,v.type));return new va(g?at:a,m)}evaluate(e){let r,a=null,d=0;for(const m of this.args)if(d++,a=m.evaluate(e),a&&a instanceof Yn&&!a.available&&(r||(r=a.name),a=null,d===this.args.length&&(a=r)),a!==null)break;return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class xa{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const g=e[m];if(typeof g!="string")return r.error(`Expected string, but found ${typeof g} instead.`,m);if(/[^a-zA-Z0-9_]/.test(g))return r.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=r.parse(e[m+1],m+1);if(!v)return null;a.push([g,v])}const d=r.parse(e[e.length-1],e.length-1,r.expectedType,a);return d?new xa(a,d):null}outputDefined(){return this.result.outputDefined()}}class Zl{constructor(e,r,a){this.type=e,this.index=r,this.input=a}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,Re),d=r.parse(e[2],2,Gn(r.expectedType||at));return a&&d?new Zl(d.type.itemType,a,d):null}evaluate(e){const r=this.index.evaluate(e),a=this.input.evaluate(e);if(r<0)throw new On(`Array index out of bounds: ${r} < 0.`);if(r>=a.length)throw new On(`Array index out of bounds: ${r} > ${a.length-1}.`);if(r!==Math.floor(r))throw new On(`Array index must be an integer, but found ${r} instead.`);return a[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class Gl{constructor(e,r){this.type=mt,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,at),d=r.parse(e[2],2,at);return a&&d?N(a.type,[mt,wt,Re,Rr,at])?new Gl(a,d):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${$(a.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!X(r,["boolean","string","number","null"]))throw new On(`Expected first argument to be of type boolean, string, number or null, but found ${$(sn(r))} instead.`);if(!X(a,["string","array"]))throw new On(`Expected second argument to be of type array or string, but found ${$(sn(a))} instead.`);return a.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class wa{constructor(e,r,a){this.type=Re,this.needle=e,this.haystack=r,this.fromIndex=a}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,at),d=r.parse(e[2],2,at);if(!a||!d)return null;if(!N(a.type,[mt,wt,Re,Rr,at]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${$(a.type)} instead`);if(e.length===4){const m=r.parse(e[3],3,Re);return m?new wa(a,d,m):null}return new wa(a,d)}evaluate(e){const r=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!X(r,["boolean","string","number","null"]))throw new On(`Expected first argument to be of type boolean, string, number or null, but found ${$(sn(r))} instead.`);if(!X(a,["string","array"]))throw new On(`Expected second argument to be of type array or string, but found ${$(sn(a))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(e);return a.indexOf(r,d)}return a.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class At{constructor(e,r,a,d,m,g){this.inputType=e,this.type=r,this.input=a,this.cases=d,this.outputs=m,this.otherwise=g}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let a,d;r.expectedType&&r.expectedType.kind!=="value"&&(d=r.expectedType);const m={},g=[];for(let T=2;T<e.length-1;T+=2){let k=e[T];const A=e[T+1];Array.isArray(k)||(k=[k]);const L=r.concat(T);if(k.length===0)return L.error("Expected at least one branch label.");for(const O of k){if(typeof O!="number"&&typeof O!="string")return L.error("Branch labels must be numbers or strings.");if(typeof O=="number"&&Math.abs(O)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof O=="number"&&Math.floor(O)!==O)return L.error("Numeric branch labels must be integer values.");if(a){if(L.checkSubtype(a,sn(O)))return null}else a=sn(O);if(m[String(O)]!==void 0)return L.error("Branch labels must be unique.");m[String(O)]=g.length}const B=r.parse(A,T,d);if(!B)return null;d=d||B.type,g.push(B)}const v=r.parse(e[1],1,at);if(!v)return null;const b=r.parse(e[e.length-1],e.length-1,d);return b?v.type.kind!=="value"&&r.concat(1).checkSubtype(a,v.type)?null:new At(a,d,v,m,g,b):null}evaluate(e){const r=this.input.evaluate(e);return(sn(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class Wl{constructor(e,r,a){this.type=e,this.branches=r,this.otherwise=a}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let a;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);const d=[];for(let g=1;g<e.length-1;g+=2){const v=r.parse(e[g],g,mt);if(!v)return null;const b=r.parse(e[g+1],g+1,a);if(!b)return null;d.push([v,b]),a=a||b.type}const m=r.parse(e[e.length-1],e.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new Wl(a,d,m)}evaluate(e){for(const[r,a]of this.branches)if(r.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,a]of this.branches)e(r),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}}class ba{constructor(e,r,a,d){this.type=e,this.input=r,this.beginIndex=a,this.endIndex=d}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=r.parse(e[1],1,at),d=r.parse(e[2],2,Re);if(!a||!d)return null;if(!N(a.type,[Gn(at),wt,at]))return r.error(`Expected first argument to be of type array or string, but found ${$(a.type)} instead`);if(e.length===4){const m=r.parse(e[3],3,Re);return m?new ba(a.type,a,d,m):null}return new ba(a.type,a,d)}evaluate(e){const r=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!X(r,["string","array"]))throw new On(`Expected first argument to be of type array or string, but found ${$(sn(r))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(e);return r.slice(a,d)}return r.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function Nc(i,e){return i==="=="||i==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function Vc(i,e,r,a){return a.compare(e,r)===0}function jo(i,e,r){const a=i!=="=="&&i!=="!=";return class s1{constructor(m,g,v){this.type=mt,this.lhs=m,this.rhs=g,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||g.type.kind==="value"}static parse(m,g){if(m.length!==3&&m.length!==4)return g.error("Expected two or three arguments.");const v=m[0];let b=g.parse(m[1],1,at);if(!b)return null;if(!Nc(v,b.type))return g.concat(1).error(`"${v}" comparisons are not supported for type '${$(b.type)}'.`);let T=g.parse(m[2],2,at);if(!T)return null;if(!Nc(v,T.type))return g.concat(2).error(`"${v}" comparisons are not supported for type '${$(T.type)}'.`);if(b.type.kind!==T.type.kind&&b.type.kind!=="value"&&T.type.kind!=="value")return g.error(`Cannot compare types '${$(b.type)}' and '${$(T.type)}'.`);a&&(b.type.kind==="value"&&T.type.kind!=="value"?b=new wi(T.type,[b]):b.type.kind!=="value"&&T.type.kind==="value"&&(T=new wi(b.type,[T])));let k=null;if(m.length===4){if(b.type.kind!=="string"&&T.type.kind!=="string"&&b.type.kind!=="value"&&T.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(k=g.parse(m[3],3,Br),!k)return null}return new s1(b,T,k)}evaluate(m){const g=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const b=sn(g),T=sn(v);if(b.kind!==T.kind||b.kind!=="string"&&b.kind!=="number")throw new On(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${b.kind}, ${T.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const b=sn(g),T=sn(v);if(b.kind!=="string"||T.kind!=="string")return e(m,g,v)}return this.collator?r(m,g,v,this.collator.evaluate(m)):e(m,g,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const op=jo("==",function(i,e,r){return e===r},Vc),sp=jo("!=",function(i,e,r){return e!==r},function(i,e,r,a){return!Vc(0,e,r,a)}),ap=jo("<",function(i,e,r){return e<r},function(i,e,r,a){return a.compare(e,r)<0}),lp=jo(">",function(i,e,r){return e>r},function(i,e,r,a){return a.compare(e,r)>0}),up=jo("<=",function(i,e,r){return e<=r},function(i,e,r,a){return a.compare(e,r)<=0}),cp=jo(">=",function(i,e,r){return e>=r},function(i,e,r,a){return a.compare(e,r)>=0});class Xl{constructor(e,r,a,d,m){this.type=wt,this.number=e,this.locale=r,this.currency=a,this.minFractionDigits=d,this.maxFractionDigits=m}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const a=r.parse(e[1],1,Re);if(!a)return null;const d=e[2];if(typeof d!="object"||Array.isArray(d))return r.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=r.parse(d.locale,1,wt),!m))return null;let g=null;if(d.currency&&(g=r.parse(d.currency,1,wt),!g))return null;let v=null;if(d["min-fraction-digits"]&&(v=r.parse(d["min-fraction-digits"],1,Re),!v))return null;let b=null;return d["max-fraction-digits"]&&(b=r.parse(d["max-fraction-digits"],1,Re),!b)?null:new Xl(a,m,g,v,b)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Sa{constructor(e){this.type=eo,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return r.error("First argument must be an image or text section.");const d=[];let m=!1;for(let g=1;g<=e.length-1;++g){const v=e[g];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let b=null;if(v["font-scale"]&&(b=r.parse(v["font-scale"],1,Re),!b))return null;let T=null;if(v["text-font"]&&(T=r.parse(v["text-font"],1,Gn(wt)),!T))return null;let k=null;if(v["text-color"]&&(k=r.parse(v["text-color"],1,Fn),!k))return null;const A=d[d.length-1];A.scale=b,A.font=T,A.textColor=k}else{const b=r.parse(e[g],1,at);if(!b)return null;const T=b.type.kind;if(T!=="string"&&T!=="value"&&T!=="null"&&T!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:b,scale:null,font:null,textColor:null})}}return new Sa(d)}evaluate(e){return new Li(this.sections.map(r=>{const a=r.content.evaluate(e);return sn(a)===to?new Ol("",a,null,null,null):new Ol(Cs(a),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}}class Hl{constructor(e){this.type=to,this.input=e}static parse(e,r){if(e.length!==2)return r.error("Expected two arguments.");const a=r.parse(e[1],1,wt);return a?new Hl(a):r.error("No image name provided.")}evaluate(e){const r=this.input.evaluate(e),a=Yn.fromString(r);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(r)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}}class Kl{constructor(e){this.type=Re,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=r.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${$(a.type)} instead.`):new Kl(a):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new On(`Expected value to be of type string or array, but found ${$(sn(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const qo={"==":op,"!=":sp,">":lp,"<":ap,">=":cp,"<=":up,array:wi,at:Zl,boolean:wi,case:Wl,coalesce:va,collator:$o,format:Sa,image:Hl,in:Gl,"index-of":wa,interpolate:Ri,"interpolate-hcl":Ri,"interpolate-lab":Ri,length:Kl,let:xa,literal:mo,match:At,number:wi,"number-format":Xl,object:wi,slice:ba,step:As,string:wi,"to-boolean":no,"to-color":no,"to-number":no,"to-string":no,var:ga,within:go};function $c(i,[e,r,a,d]){e=e.evaluate(i),r=r.evaluate(i),a=a.evaluate(i);const m=d?d.evaluate(i):1,g=Dc(e,r,a,m);if(g)throw new On(g);return new Mt(e/255,r/255,a/255,m,!1)}function jc(i,e){return i in e}function Yl(i,e){const r=e[i];return r===void 0?null:r}function yo(i){return{type:i}}function qc(i){return{result:"success",value:i}}function Zo(i){return{result:"error",value:i}}function Go(i){return i["property-type"]==="data-driven"||i["property-type"]==="cross-faded-data-driven"}function Zc(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function Jl(i){return!!i.expression&&i.expression.interpolated}function $t(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function Ea(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function hp(i){return i}function Gc(i,e){const r=e.type==="color",a=i.stops&&typeof i.stops[0][0]=="object",d=a||!(a||i.property!==void 0),m=i.type||(Jl(e)?"exponential":"interval");if(r||e.type==="padding"){const k=r?Mt.parse:xi.parse;(i=Bn({},i)).stops&&(i.stops=i.stops.map(A=>[A[0],k(A[1])])),i.default=k(i.default?i.default:e.default)}if(i.colorSpace&&(g=i.colorSpace)!=="rgb"&&g!=="hcl"&&g!=="lab")throw new Error(`Unknown color space: "${i.colorSpace}"`);var g;let v,b,T;if(m==="exponential")v=Wc;else if(m==="interval")v=Ql;else if(m==="categorical"){v=dp,b=Object.create(null);for(const k of i.stops)b[k[0]]=k[1];T=typeof i.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);v=pp}if(a){const k={},A=[];for(let O=0;O<i.stops.length;O++){const G=i.stops[O],j=G[0].zoom;k[j]===void 0&&(k[j]={zoom:j,type:i.type,property:i.property,default:i.default,stops:[]},A.push(j)),k[j].stops.push([G[0].value,G[1]])}const L=[];for(const O of A)L.push([k[O].zoom,Gc(k[O],e)]);const B={name:"linear"};return{kind:"composite",interpolationType:B,interpolationFactor:Ri.interpolationFactor.bind(void 0,B),zoomStops:L.map(O=>O[0]),evaluate:({zoom:O},G)=>Wc({stops:L,base:i.base},e,O).evaluate(O,G)}}if(d){const k=m==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:k,interpolationFactor:Ri.interpolationFactor.bind(void 0,k),zoomStops:i.stops.map(A=>A[0]),evaluate:({zoom:A})=>v(i,e,A,b,T)}}return{kind:"source",evaluate(k,A){const L=A&&A.properties?A.properties[i.property]:void 0;return L===void 0?Ls(i.default,e.default):v(i,e,L,b,T)}}}function Ls(i,e,r){return i!==void 0?i:e!==void 0?e:r!==void 0?r:void 0}function dp(i,e,r,a,d){return Ls(typeof r===d?a[r]:void 0,i.default,e.default)}function Ql(i,e,r){if($t(r)!=="number")return Ls(i.default,e.default);const a=i.stops.length;if(a===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[a-1][0])return i.stops[a-1][1];const d=Ms(i.stops.map(m=>m[0]),r);return i.stops[d][1]}function Wc(i,e,r){const a=i.base!==void 0?i.base:1;if($t(r)!=="number")return Ls(i.default,e.default);const d=i.stops.length;if(d===1||r<=i.stops[0][0])return i.stops[0][1];if(r>=i.stops[d-1][0])return i.stops[d-1][1];const m=Ms(i.stops.map(k=>k[0]),r),g=function(k,A,L,B){const O=B-L,G=k-L;return O===0?0:A===1?G/O:(Math.pow(A,G)-1)/(Math.pow(A,O)-1)}(r,a,i.stops[m][0],i.stops[m+1][0]),v=i.stops[m][1],b=i.stops[m+1][1],T=Si[e.type]||hp;return typeof v.evaluate=="function"?{evaluate(...k){const A=v.evaluate.apply(void 0,k),L=b.evaluate.apply(void 0,k);if(A!==void 0&&L!==void 0)return T(A,L,g,i.colorSpace)}}:T(v,b,g,i.colorSpace)}function pp(i,e,r){switch(e.type){case"color":r=Mt.parse(r);break;case"formatted":r=Li.fromString(r.toString());break;case"resolvedImage":r=Yn.fromString(r.toString());break;case"padding":r=xi.parse(r);break;default:$t(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0)}return Ls(r,i.default,e.default)}bi.register(qo,{error:[{kind:"error"},[wt],(i,[e])=>{throw new On(e.evaluate(i))}],typeof:[wt,[at],(i,[e])=>$(sn(e.evaluate(i)))],"to-rgba":[Gn(Re,4),[Fn],(i,[e])=>{const[r,a,d,m]=e.evaluate(i).rgb;return[255*r,255*a,255*d,m]}],rgb:[Fn,[Re,Re,Re],$c],rgba:[Fn,[Re,Re,Re,Re],$c],has:{type:mt,overloads:[[[wt],(i,[e])=>jc(e.evaluate(i),i.properties())],[[wt,rr],(i,[e,r])=>jc(e.evaluate(i),r.evaluate(i))]]},get:{type:at,overloads:[[[wt],(i,[e])=>Yl(e.evaluate(i),i.properties())],[[wt,rr],(i,[e,r])=>Yl(e.evaluate(i),r.evaluate(i))]]},"feature-state":[at,[wt],(i,[e])=>Yl(e.evaluate(i),i.featureState||{})],properties:[rr,[],i=>i.properties()],"geometry-type":[wt,[],i=>i.geometryType()],id:[at,[],i=>i.id()],zoom:[Re,[],i=>i.globals.zoom],"heatmap-density":[Re,[],i=>i.globals.heatmapDensity||0],"line-progress":[Re,[],i=>i.globals.lineProgress||0],accumulated:[at,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Re,yo(Re),(i,e)=>{let r=0;for(const a of e)r+=a.evaluate(i);return r}],"*":[Re,yo(Re),(i,e)=>{let r=1;for(const a of e)r*=a.evaluate(i);return r}],"-":{type:Re,overloads:[[[Re,Re],(i,[e,r])=>e.evaluate(i)-r.evaluate(i)],[[Re],(i,[e])=>-e.evaluate(i)]]},"/":[Re,[Re,Re],(i,[e,r])=>e.evaluate(i)/r.evaluate(i)],"%":[Re,[Re,Re],(i,[e,r])=>e.evaluate(i)%r.evaluate(i)],ln2:[Re,[],()=>Math.LN2],pi:[Re,[],()=>Math.PI],e:[Re,[],()=>Math.E],"^":[Re,[Re,Re],(i,[e,r])=>Math.pow(e.evaluate(i),r.evaluate(i))],sqrt:[Re,[Re],(i,[e])=>Math.sqrt(e.evaluate(i))],log10:[Re,[Re],(i,[e])=>Math.log(e.evaluate(i))/Math.LN10],ln:[Re,[Re],(i,[e])=>Math.log(e.evaluate(i))],log2:[Re,[Re],(i,[e])=>Math.log(e.evaluate(i))/Math.LN2],sin:[Re,[Re],(i,[e])=>Math.sin(e.evaluate(i))],cos:[Re,[Re],(i,[e])=>Math.cos(e.evaluate(i))],tan:[Re,[Re],(i,[e])=>Math.tan(e.evaluate(i))],asin:[Re,[Re],(i,[e])=>Math.asin(e.evaluate(i))],acos:[Re,[Re],(i,[e])=>Math.acos(e.evaluate(i))],atan:[Re,[Re],(i,[e])=>Math.atan(e.evaluate(i))],min:[Re,yo(Re),(i,e)=>Math.min(...e.map(r=>r.evaluate(i)))],max:[Re,yo(Re),(i,e)=>Math.max(...e.map(r=>r.evaluate(i)))],abs:[Re,[Re],(i,[e])=>Math.abs(e.evaluate(i))],round:[Re,[Re],(i,[e])=>{const r=e.evaluate(i);return r<0?-Math.round(-r):Math.round(r)}],floor:[Re,[Re],(i,[e])=>Math.floor(e.evaluate(i))],ceil:[Re,[Re],(i,[e])=>Math.ceil(e.evaluate(i))],"filter-==":[mt,[wt,at],(i,[e,r])=>i.properties()[e.value]===r.value],"filter-id-==":[mt,[at],(i,[e])=>i.id()===e.value],"filter-type-==":[mt,[wt],(i,[e])=>i.geometryType()===e.value],"filter-<":[mt,[wt,at],(i,[e,r])=>{const a=i.properties()[e.value],d=r.value;return typeof a==typeof d&&a<d}],"filter-id-<":[mt,[at],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r<a}],"filter->":[mt,[wt,at],(i,[e,r])=>{const a=i.properties()[e.value],d=r.value;return typeof a==typeof d&&a>d}],"filter-id->":[mt,[at],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r>a}],"filter-<=":[mt,[wt,at],(i,[e,r])=>{const a=i.properties()[e.value],d=r.value;return typeof a==typeof d&&a<=d}],"filter-id-<=":[mt,[at],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r<=a}],"filter->=":[mt,[wt,at],(i,[e,r])=>{const a=i.properties()[e.value],d=r.value;return typeof a==typeof d&&a>=d}],"filter-id->=":[mt,[at],(i,[e])=>{const r=i.id(),a=e.value;return typeof r==typeof a&&r>=a}],"filter-has":[mt,[at],(i,[e])=>e.value in i.properties()],"filter-has-id":[mt,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[mt,[Gn(wt)],(i,[e])=>e.value.indexOf(i.geometryType())>=0],"filter-id-in":[mt,[Gn(at)],(i,[e])=>e.value.indexOf(i.id())>=0],"filter-in-small":[mt,[wt,Gn(at)],(i,[e,r])=>r.value.indexOf(i.properties()[e.value])>=0],"filter-in-large":[mt,[wt,Gn(at)],(i,[e,r])=>function(a,d,m,g){for(;m<=g;){const v=m+g>>1;if(d[v]===a)return!0;d[v]>a?g=v-1:m=v+1}return!1}(i.properties()[e.value],r.value,0,r.value.length-1)],all:{type:mt,overloads:[[[mt,mt],(i,[e,r])=>e.evaluate(i)&&r.evaluate(i)],[yo(mt),(i,e)=>{for(const r of e)if(!r.evaluate(i))return!1;return!0}]]},any:{type:mt,overloads:[[[mt,mt],(i,[e,r])=>e.evaluate(i)||r.evaluate(i)],[yo(mt),(i,e)=>{for(const r of e)if(r.evaluate(i))return!0;return!1}]]},"!":[mt,[mt],(i,[e])=>!e.evaluate(i)],"is-supported-script":[mt,[wt],(i,[e])=>{const r=i.globals&&i.globals.isSupportedScript;return!r||r(e.evaluate(i))}],upcase:[wt,[wt],(i,[e])=>e.evaluate(i).toUpperCase()],downcase:[wt,[wt],(i,[e])=>e.evaluate(i).toLowerCase()],concat:[wt,yo(at),(i,e)=>e.map(r=>Cs(r.evaluate(i))).join("")],"resolved-locale":[wt,[Br],(i,[e])=>e.evaluate(i).resolvedLocale()]});class eu{constructor(e,r){var a;this.expression=e,this._warningHistory={},this._evaluator=new or,this._defaultValue=r?(a=r).type==="color"&&Ea(a.default)?new Mt(0,0,0,0):a.type==="color"?Mt.parse(a.default)||null:a.type==="padding"?xi.parse(a.default)||null:a.default===void 0?null:a.default:null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,a,d,m,g){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=a,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)}evaluate(e,r,a,d,m,g){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=a||null,this._evaluator.canonical=d,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=g||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new On(`Expected value to be one of ${Object.keys(this._enumValues).map(b=>JSON.stringify(b)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Ta(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in qo}function an(i,e){const r=new Vo(qo,ya,[],e?function(d){const m={color:Fn,string:wt,number:Re,enum:wt,boolean:mt,formatted:eo,padding:No,resolvedImage:to};return d.type==="array"?Gn(m[d.value]||at,d.length):m[d.type]}(e):void 0),a=r.parse(i,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?qc(new eu(a,e)):Zo(r.errors)}class tu{constructor(e,r){this.kind=e,this._styleExpression=r,this.isStateDependent=e!=="constant"&&!ks(r.expression)}evaluateWithoutErrorHandling(e,r,a,d,m,g){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,d,m,g)}evaluate(e,r,a,d,m,g){return this._styleExpression.evaluate(e,r,a,d,m,g)}}class Tt{constructor(e,r,a,d){this.kind=e,this.zoomStops=a,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!ks(r.expression),this.interpolationType=d}evaluateWithoutErrorHandling(e,r,a,d,m,g){return this._styleExpression.evaluateWithoutErrorHandling(e,r,a,d,m,g)}evaluate(e,r,a,d,m,g){return this._styleExpression.evaluate(e,r,a,d,m,g)}interpolationFactor(e,r,a){return this.interpolationType?Ri.interpolationFactor(this.interpolationType,e,r,a):0}}function Ca(i,e){const r=an(i,e);if(r.result==="error")return r;const a=r.value.expression,d=_a(a);if(!d&&!Go(e))return Zo([new vi("","data expressions not supported")]);const m=Ps(a,["zoom"]);if(!m&&!Zc(e))return Zo([new vi("","zoom expressions not supported")]);const g=Ht(a);return g||m?g instanceof vi?Zo([g]):g instanceof Ri&&!Jl(e)?Zo([new vi("",'"interpolate" expressions cannot be used with this property')]):qc(g?new Tt(d?"camera":"composite",r.value,g.labels,g instanceof Ri?g.interpolation:void 0):new tu(d?"constant":"source",r.value)):Zo([new vi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Kt{constructor(e,r){this._parameters=e,this._specification=r,Bn(this,Gc(this._parameters,this._specification))}static deserialize(e){return new Kt(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Ht(i){let e=null;if(i instanceof xa)e=Ht(i.result);else if(i instanceof va){for(const r of i.args)if(e=Ht(r),e)break}else(i instanceof As||i instanceof Ri)&&i.input instanceof bi&&i.input.name==="zoom"&&(e=i);return e instanceof vi||i.eachChild(r=>{const a=Ht(r);a instanceof vi?e=a:!e&&a?e=new vi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new vi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Wo(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const e of i.slice(1))if(!Wo(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Xc={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function nu(i){if(i==null)return{filter:()=>!0,needGeometry:!1};Wo(i)||(i=Ia(i));const e=an(i,Xc);if(e.result==="error")throw new Error(e.value.map(r=>`${r.key}: ${r.message}`).join(", "));return{filter:(r,a,d)=>e.value.evaluate(r,a,{},d),needGeometry:Hc(i)}}function fp(i,e){return i<e?-1:i>e?1:0}function Hc(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let e=1;e<i.length;e++)if(Hc(i[e]))return!0;return!1}function Ia(i){if(!i)return!0;const e=i[0];return i.length<=1?e!=="any":e==="=="?ka(i[1],i[2],"=="):e==="!="?Rs(ka(i[1],i[2],"==")):e==="<"||e===">"||e==="<="||e===">="?ka(i[1],i[2],e):e==="any"?(r=i.slice(1),["any"].concat(r.map(Ia))):e==="all"?["all"].concat(i.slice(1).map(Ia)):e==="none"?["all"].concat(i.slice(1).map(Ia).map(Rs)):e==="in"?iu(i[1],i.slice(2)):e==="!in"?Rs(iu(i[1],i.slice(2))):e==="has"?ru(i[1]):e==="!has"?Rs(ru(i[1])):e!=="within"||i;var r}function ka(i,e,r){switch(i){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,i,e]}}function iu(i,e){if(e.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",i,["literal",e.sort(fp)]]:["filter-in-small",i,["literal",e]]}}function ru(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function Rs(i){return["!",i]}function Bs(i){const e=typeof i;if(e==="number"||e==="boolean"||e==="string"||i==null)return JSON.stringify(i);if(Array.isArray(i)){let d="[";for(const m of i)d+=`${Bs(m)},`;return`${d}]`}const r=Object.keys(i).sort();let a="{";for(let d=0;d<r.length;d++)a+=`${JSON.stringify(r[d])}:${Bs(i[r[d]])},`;return`${a}}`}function mp(i){let e="";for(const r of Rn)e+=`/${Bs(i[r])}`;return e}function Kc(i){const e=i.value;return e?[new Le(i.key,e,"constants have been deprecated as of v8")]:[]}function yn(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function _o(i){if(Array.isArray(i))return i.map(_o);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const e={};for(const r in i)e[r]=_o(i[r]);return e}return yn(i)}function Xi(i){const e=i.key,r=i.value,a=i.valueSpec||{},d=i.objectElementValidators||{},m=i.style,g=i.styleSpec,v=i.validateSpec;let b=[];const T=$t(r);if(T!=="object")return[new Le(e,r,`object expected, ${T} found`)];for(const k in r){const A=k.split(".")[0],L=a[A]||a["*"];let B;if(d[A])B=d[A];else if(a[A])B=v;else if(d["*"])B=d["*"];else{if(!a["*"]){b.push(new Le(e,r[k],`unknown property "${k}"`));continue}B=v}b=b.concat(B({key:(e&&`${e}.`)+k,value:r[k],valueSpec:L,style:m,styleSpec:g,object:r,objectKey:k,validateSpec:v},r))}for(const k in a)d[k]||a[k].required&&a[k].default===void 0&&r[k]===void 0&&b.push(new Le(e,r,`missing required property "${k}"`));return b}function Yc(i){const e=i.value,r=i.valueSpec,a=i.style,d=i.styleSpec,m=i.key,g=i.arrayElementValidator||i.validateSpec;if($t(e)!=="array")return[new Le(m,e,`array expected, ${$t(e)} found`)];if(r.length&&e.length!==r.length)return[new Le(m,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new Le(m,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let v={type:r.value,values:r.values};d.$version<7&&(v.function=r.function),$t(r.value)==="object"&&(v=r.value);let b=[];for(let T=0;T<e.length;T++)b=b.concat(g({array:e,arrayIndex:T,value:e[T],valueSpec:v,validateSpec:i.validateSpec,style:a,styleSpec:d,key:`${m}[${T}]`}));return b}function ou(i){const e=i.key,r=i.value,a=i.valueSpec;let d=$t(r);return d==="number"&&r!=r&&(d="NaN"),d!=="number"?[new Le(e,r,`number expected, ${d} found`)]:"minimum"in a&&r<a.minimum?[new Le(e,r,`${r} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&r>a.maximum?[new Le(e,r,`${r} is greater than the maximum value ${a.maximum}`)]:[]}function Jc(i){const e=i.valueSpec,r=yn(i.value.type);let a,d,m,g={};const v=r!=="categorical"&&i.value.property===void 0,b=!v,T=$t(i.value.stops)==="array"&&$t(i.value.stops[0])==="array"&&$t(i.value.stops[0][0])==="object",k=Xi({key:i.key,value:i.value,valueSpec:i.styleSpec.function,validateSpec:i.validateSpec,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(B){if(r==="identity")return[new Le(B.key,B.value,'identity function may not have a "stops" property')];let O=[];const G=B.value;return O=O.concat(Yc({key:B.key,value:G,valueSpec:B.valueSpec,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:A})),$t(G)==="array"&&G.length===0&&O.push(new Le(B.key,G,"array must have at least one stop")),O},default:function(B){return B.validateSpec({key:B.key,value:B.value,valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec})}}});return r==="identity"&&v&&k.push(new Le(i.key,i.value,'missing required property "property"')),r==="identity"||i.value.stops||k.push(new Le(i.key,i.value,'missing required property "stops"')),r==="exponential"&&i.valueSpec.expression&&!Jl(i.valueSpec)&&k.push(new Le(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(b&&!Go(i.valueSpec)?k.push(new Le(i.key,i.value,"property functions not supported")):v&&!Zc(i.valueSpec)&&k.push(new Le(i.key,i.value,"zoom functions not supported"))),r!=="categorical"&&!T||i.value.property!==void 0||k.push(new Le(i.key,i.value,'"property" property is required')),k;function A(B){let O=[];const G=B.value,j=B.key;if($t(G)!=="array")return[new Le(j,G,`array expected, ${$t(G)} found`)];if(G.length!==2)return[new Le(j,G,`array length 2 expected, length ${G.length} found`)];if(T){if($t(G[0])!=="object")return[new Le(j,G,`object expected, ${$t(G[0])} found`)];if(G[0].zoom===void 0)return[new Le(j,G,"object stop key must have zoom")];if(G[0].value===void 0)return[new Le(j,G,"object stop key must have value")];if(m&&m>yn(G[0].zoom))return[new Le(j,G[0].zoom,"stop zoom values must appear in ascending order")];yn(G[0].zoom)!==m&&(m=yn(G[0].zoom),d=void 0,g={}),O=O.concat(Xi({key:`${j}[0]`,value:G[0],valueSpec:{zoom:{}},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:ou,value:L}}))}else O=O.concat(L({key:`${j}[0]`,value:G[0],valueSpec:{},validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec},G));return Ta(_o(G[1]))?O.concat([new Le(`${j}[1]`,G[1],"expressions are not allowed in function stops.")]):O.concat(B.validateSpec({key:`${j}[1]`,value:G[1],valueSpec:e,validateSpec:B.validateSpec,style:B.style,styleSpec:B.styleSpec}))}function L(B,O){const G=$t(B.value),j=yn(B.value),ee=B.value!==null?B.value:O;if(a){if(G!==a)return[new Le(B.key,ee,`${G} stop domain type must match previous stop domain type ${a}`)]}else a=G;if(G!=="number"&&G!=="string"&&G!=="boolean")return[new Le(B.key,ee,"stop domain value must be a number, string, or boolean")];if(G!=="number"&&r!=="categorical"){let ae=`number expected, ${G} found`;return Go(e)&&r===void 0&&(ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Le(B.key,ee,ae)]}return r!=="categorical"||G!=="number"||isFinite(j)&&Math.floor(j)===j?r!=="categorical"&&G==="number"&&d!==void 0&&j<d?[new Le(B.key,ee,"stop domain values must appear in ascending order")]:(d=j,r==="categorical"&&j in g?[new Le(B.key,ee,"stop domain values must be unique")]:(g[j]=!0,[])):[new Le(B.key,ee,`integer expected, found ${j}`)]}}function vo(i){const e=(i.expressionContext==="property"?Ca:an)(_o(i.value),i.valueSpec);if(e.result==="error")return e.value.map(a=>new Le(`${i.key}${a.key}`,i.value,a.message));const r=e.value.expression||e.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!r.outputDefined())return[new Le(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!ks(r))return[new Le(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter"&&!ks(r))return[new Le(i.key,i.value,'"feature-state" data expressions are not supported with filters.')];if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Ps(r,["zoom","feature-state"]))return[new Le(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!_a(r))return[new Le(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Fs(i){const e=i.key,r=i.value,a=i.valueSpec,d=[];return Array.isArray(a.values)?a.values.indexOf(yn(r))===-1&&d.push(new Le(e,r,`expected one of [${a.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(a.values).indexOf(yn(r))===-1&&d.push(new Le(e,r,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(r)} found`)),d}function Xo(i){return Wo(_o(i.value))?vo(Bn({},i,{expressionContext:"filter",valueSpec:{value:"boolean"}})):Qc(i)}function Qc(i){const e=i.value,r=i.key;if($t(e)!=="array")return[new Le(r,e,`array expected, ${$t(e)} found`)];const a=i.styleSpec;let d,m=[];if(e.length<1)return[new Le(r,e,"filter array must have at least 1 element")];switch(m=m.concat(Fs({key:`${r}[0]`,value:e[0],valueSpec:a.filter_operator,style:i.style,styleSpec:i.styleSpec})),yn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&yn(e[1])==="$type"&&m.push(new Le(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Le(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(d=$t(e[1]),d!=="string"&&m.push(new Le(`${r}[1]`,e[1],`string expected, ${d} found`)));for(let g=2;g<e.length;g++)d=$t(e[g]),yn(e[1])==="$type"?m=m.concat(Fs({key:`${r}[${g}]`,value:e[g],valueSpec:a.geometry_type,style:i.style,styleSpec:i.styleSpec})):d!=="string"&&d!=="number"&&d!=="boolean"&&m.push(new Le(`${r}[${g}]`,e[g],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let g=1;g<e.length;g++)m=m.concat(Qc({key:`${r}[${g}]`,value:e[g],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":d=$t(e[1]),e.length!==2?m.push(new Le(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="string"&&m.push(new Le(`${r}[1]`,e[1],`string expected, ${d} found`));break;case"within":d=$t(e[1]),e.length!==2?m.push(new Le(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):d!=="object"&&m.push(new Le(`${r}[1]`,e[1],`object expected, ${d} found`))}return m}function su(i,e){const r=i.key,a=i.validateSpec,d=i.style,m=i.styleSpec,g=i.value,v=i.objectKey,b=m[`${e}_${i.layerType}`];if(!b)return[];const T=v.match(/^(.*)-transition$/);if(e==="paint"&&T&&b[T[1]]&&b[T[1]].transition)return a({key:r,value:g,valueSpec:m.transition,style:d,styleSpec:m});const k=i.valueSpec||b[v];if(!k)return[new Le(r,g,`unknown property "${v}"`)];let A;if($t(g)==="string"&&Go(k)&&!k.tokens&&(A=/^{([^}]+)}$/.exec(g)))return[new Le(r,g,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(A[1])} }\`.`)];const L=[];return i.layerType==="symbol"&&(v==="text-field"&&d&&!d.glyphs&&L.push(new Le(r,g,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Ea(_o(g))&&yn(g.type)==="identity"&&L.push(new Le(r,g,'"text-font" does not support identity functions'))),L.concat(a({key:i.key,value:g,valueSpec:k,style:d,styleSpec:m,expressionContext:"property",propertyType:e,propertyKey:v}))}function au(i){return su(i,"paint")}function eh(i){return su(i,"layout")}function Pa(i){let e=[];const r=i.value,a=i.key,d=i.style,m=i.styleSpec;r.type||r.ref||e.push(new Le(a,r,'either "type" or "ref" is required'));let g=yn(r.type);const v=yn(r.ref);if(r.id){const b=yn(r.id);for(let T=0;T<i.arrayIndex;T++){const k=d.layers[T];yn(k.id)===b&&e.push(new Le(a,r.id,`duplicate layer id "${r.id}", previously used at line ${k.id.__line__}`))}}if("ref"in r){let b;["type","source","source-layer","filter","layout"].forEach(T=>{T in r&&e.push(new Le(a,r[T],`"${T}" is prohibited for ref layers`))}),d.layers.forEach(T=>{yn(T.id)===v&&(b=T)}),b?b.ref?e.push(new Le(a,r.ref,"ref cannot reference another ref layer")):g=yn(b.type):e.push(new Le(a,r.ref,`ref layer "${v}" not found`))}else if(g!=="background")if(r.source){const b=d.sources&&d.sources[r.source],T=b&&yn(b.type);b?T==="vector"&&g==="raster"?e.push(new Le(a,r.source,`layer "${r.id}" requires a raster source`)):T==="raster"&&g!=="raster"?e.push(new Le(a,r.source,`layer "${r.id}" requires a vector source`)):T!=="vector"||r["source-layer"]?T==="raster-dem"&&g!=="hillshade"?e.push(new Le(a,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!r.paint||!r.paint["line-gradient"]||T==="geojson"&&b.lineMetrics||e.push(new Le(a,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Le(a,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new Le(a,r.source,`source "${r.source}" not found`))}else e.push(new Le(a,r,'missing required property "source"'));return e=e.concat(Xi({key:a,value:r,valueSpec:m.layer,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,objectElementValidators:{"*":()=>[],type:()=>i.validateSpec({key:`${a}.type`,value:r.type,valueSpec:m.layer.type,style:i.style,styleSpec:i.styleSpec,validateSpec:i.validateSpec,object:r,objectKey:"type"}),filter:Xo,layout:b=>Xi({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":T=>eh(Bn({layerType:g},T))}}),paint:b=>Xi({layer:r,key:b.key,value:b.value,style:b.style,styleSpec:b.styleSpec,validateSpec:b.validateSpec,objectElementValidators:{"*":T=>au(Bn({layerType:g},T))}})}})),e}function vr(i){const e=i.value,r=i.key,a=$t(e);return a!=="string"?[new Le(r,e,`string expected, ${a} found`)]:[]}const Ma={promoteId:function({key:i,value:e}){if($t(e)==="string")return vr({key:i,value:e});{const r=[];for(const a in e)r.push(...vr({key:`${i}.${a}`,value:e[a]}));return r}}};function Aa(i){const e=i.value,r=i.key,a=i.styleSpec,d=i.style,m=i.validateSpec;if(!e.type)return[new Le(r,e,'"type" is required')];const g=yn(e.type);let v;switch(g){case"vector":case"raster":case"raster-dem":return v=Xi({key:r,value:e,valueSpec:a[`source_${g.replace("-","_")}`],style:i.style,styleSpec:a,objectElementValidators:Ma,validateSpec:m}),v;case"geojson":if(v=Xi({key:r,value:e,valueSpec:a.source_geojson,style:d,styleSpec:a,validateSpec:m,objectElementValidators:Ma}),e.cluster)for(const b in e.clusterProperties){const[T,k]=e.clusterProperties[b],A=typeof T=="string"?[T,["accumulated"],["get",b]]:T;v.push(...vo({key:`${r}.${b}.map`,value:k,validateSpec:m,expressionContext:"cluster-map"})),v.push(...vo({key:`${r}.${b}.reduce`,value:A,validateSpec:m,expressionContext:"cluster-reduce"}))}return v;case"video":return Xi({key:r,value:e,valueSpec:a.source_video,style:d,validateSpec:m,styleSpec:a});case"image":return Xi({key:r,value:e,valueSpec:a.source_image,style:d,validateSpec:m,styleSpec:a});case"canvas":return[new Le(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Fs({key:`${r}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:d,validateSpec:m,styleSpec:a})}}function th(i){const e=i.value,r=i.styleSpec,a=r.light,d=i.style;let m=[];const g=$t(e);if(e===void 0)return m;if(g!=="object")return m=m.concat([new Le("light",e,`object expected, ${g} found`)]),m;for(const v in e){const b=v.match(/^(.*)-transition$/);m=m.concat(b&&a[b[1]]&&a[b[1]].transition?i.validateSpec({key:v,value:e[v],valueSpec:r.transition,validateSpec:i.validateSpec,style:d,styleSpec:r}):a[v]?i.validateSpec({key:v,value:e[v],valueSpec:a[v],validateSpec:i.validateSpec,style:d,styleSpec:r}):[new Le(v,e[v],`unknown property "${v}"`)])}return m}function Os(i){const e=i.value,r=i.styleSpec,a=r.terrain,d=i.style;let m=[];const g=$t(e);if(e===void 0)return m;if(g!=="object")return m=m.concat([new Le("terrain",e,`object expected, ${g} found`)]),m;for(const v in e)m=m.concat(a[v]?i.validateSpec({key:v,value:e[v],valueSpec:a[v],validateSpec:i.validateSpec,style:d,styleSpec:r}):[new Le(v,e[v],`unknown property "${v}"`)]);return m}function nh(i){let e=[];const r=i.value,a=i.key;if(Array.isArray(r)){const d=[],m=[];for(const g in r)r[g].id&&d.includes(r[g].id)&&e.push(new Le(a,r,`all the sprites' ids must be unique, but ${r[g].id} is duplicated`)),d.push(r[g].id),r[g].url&&m.includes(r[g].url)&&e.push(new Le(a,r,`all the sprites' URLs must be unique, but ${r[g].url} is duplicated`)),m.push(r[g].url),e=e.concat(Xi({key:`${a}[${g}]`,value:r[g],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:i.validateSpec}));return e}return vr({key:a,value:r})}const ih={"*":()=>[],array:Yc,boolean:function(i){const e=i.value,r=i.key,a=$t(e);return a!=="boolean"?[new Le(r,e,`boolean expected, ${a} found`)]:[]},number:ou,color:function(i){const e=i.key,r=i.value,a=$t(r);return a!=="string"?[new Le(e,r,`color expected, ${a} found`)]:Mt.parse(String(r))?[]:[new Le(e,r,`color expected, "${r}" found`)]},constants:Kc,enum:Fs,filter:Xo,function:Jc,layer:Pa,object:Xi,source:Aa,light:th,terrain:Os,string:vr,formatted:function(i){return vr(i).length===0?[]:vo(i)},resolvedImage:function(i){return vr(i).length===0?[]:vo(i)},padding:function(i){const e=i.key,r=i.value;if($t(r)==="array"){if(r.length<1||r.length>4)return[new Le(e,r,`padding requires 1 to 4 values; ${r.length} values found`)];const a={type:"number"};let d=[];for(let m=0;m<r.length;m++)d=d.concat(i.validateSpec({key:`${e}[${m}]`,value:r[m],validateSpec:i.validateSpec,valueSpec:a}));return d}return ou({key:e,value:r,valueSpec:{}})},sprite:nh};function Us(i){const e=i.value,r=i.valueSpec,a=i.styleSpec;return i.validateSpec=Us,r.expression&&Ea(yn(e))?Jc(i):r.expression&&Ta(_o(e))?vo(i):r.type&&ih[r.type]?ih[r.type](i):Xi(Bn({},i,{valueSpec:r.type?a[r.type]:r}))}function rh(i){const e=i.value,r=i.key,a=vr(i);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Le(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Le(r,e,'"glyphs" url must include a "{range}" token'))),a}function xr(i,e=me){let r=[];return r=r.concat(Us({key:"",value:i,valueSpec:e.$root,styleSpec:e,style:i,validateSpec:Us,objectElementValidators:{glyphs:rh,"*":()=>[]}})),i.constants&&(r=r.concat(Kc({key:"constants",value:i.constants,style:i,styleSpec:e,validateSpec:Us}))),Ns(r)}function Hi(i){return function(e){return i({...e,validateSpec:Us})}}function Ns(i){return[].concat(i).sort((e,r)=>e.line-r.line)}function Cn(i){return function(...e){return Ns(i.apply(this,e))}}xr.source=Cn(Hi(Aa)),xr.sprite=Cn(Hi(nh)),xr.glyphs=Cn(Hi(rh)),xr.light=Cn(Hi(th)),xr.terrain=Cn(Hi(Os)),xr.layer=Cn(Hi(Pa)),xr.filter=Cn(Hi(Xo)),xr.paintProperty=Cn(Hi(au)),xr.layoutProperty=Cn(Hi(eh));const io=xr,gp=io.light,yp=io.paintProperty,_p=io.layoutProperty;function Ho(i,e){let r=!1;if(e&&e.length)for(const a of e)i.fire(new Zt(new Error(a.message))),r=!0;return r}class Vs{constructor(e,r,a){const d=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const g=new Int32Array(this.arrayBuffer);e=g[0],this.d=(r=g[1])+2*(a=g[2]);for(let b=0;b<this.d*this.d;b++){const T=g[3+b],k=g[3+b+1];d.push(T===k?null:g.subarray(T,k))}const v=g[3+d.length+1];this.keys=g.subarray(g[3+d.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=r+2*a;for(let g=0;g<this.d*this.d;g++)d.push([]);this.keys=[],this.bboxes=[]}this.n=r,this.extent=e,this.padding=a,this.scale=r/e,this.uid=0;const m=a/r*e;this.min=-m,this.max=e+m}insert(e,r,a,d,m){this._forEachCell(r,a,d,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(r),this.bboxes.push(a),this.bboxes.push(d),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,r,a,d,m,g){this.cells[m].push(g)}query(e,r,a,d,m){const g=this.min,v=this.max;if(e<=g&&r<=g&&v<=a&&v<=d&&!m)return Array.prototype.slice.call(this.keys);{const b=[];return this._forEachCell(e,r,a,d,this._queryCell,b,{},m),b}}_queryCell(e,r,a,d,m,g,v,b){const T=this.cells[m];if(T!==null){const k=this.keys,A=this.bboxes;for(let L=0;L<T.length;L++){const B=T[L];if(v[B]===void 0){const O=4*B;(b?b(A[O+0],A[O+1],A[O+2],A[O+3]):e<=A[O+2]&&r<=A[O+3]&&a>=A[O+0]&&d>=A[O+1])?(v[B]=!0,g.push(k[B])):v[B]=!1}}}}_forEachCell(e,r,a,d,m,g,v,b){const T=this._convertToCellCoord(e),k=this._convertToCellCoord(r),A=this._convertToCellCoord(a),L=this._convertToCellCoord(d);for(let B=T;B<=A;B++)for(let O=k;O<=L;O++){const G=this.d*O+B;if((!b||b(this._convertFromCellCoord(B),this._convertFromCellCoord(O),this._convertFromCellCoord(B+1),this._convertFromCellCoord(O+1)))&&m.call(this,e,r,a,d,G,g,v,b))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,r=3+this.cells.length+1+1;let a=0;for(let g=0;g<this.cells.length;g++)a+=this.cells[g].length;const d=new Int32Array(r+a+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;let m=r;for(let g=0;g<e.length;g++){const v=e[g];d[3+g]=m,d.set(v,m),m+=v.length}return d[3+e.length]=m,d.set(this.keys,m),m+=this.keys.length,d[3+e.length+1]=m,d.set(this.bboxes,m),m+=this.bboxes.length,d.buffer}static serialize(e,r){const a=e.toArrayBuffer();return r&&r.push(a),{buffer:a}}static deserialize(e){return new Vs(e.buffer)}}const wr={};function Ke(i,e,r={}){if(wr[i])throw new Error(`${i} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:i,writeable:!1}),wr[i]={klass:e,omit:r.omit||[],shallow:r.shallow||[]}}Ke("Object",Object),Ke("TransferableGridIndex",Vs),Ke("Color",Mt),Ke("Error",Error),Ke("AJAXError",Bt),Ke("ResolvedImage",Yn),Ke("StylePropertyFunction",Kt),Ke("StyleExpression",eu,{omit:["_evaluator"]}),Ke("ZoomDependentExpression",Tt),Ke("ZoomConstantExpression",tu),Ke("CompoundExpression",bi,{omit:["_evaluate"]});for(const i in qo)qo[i]._classRegistryKey||Ke(`Expression_${i}`,qo[i]);function za(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function $s(i,e){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob)return i;if(za(i)||gi(i))return e&&e.push(i),i;if(ArrayBuffer.isView(i)){const r=i;return e&&e.push(r.buffer),r}if(i instanceof ImageData)return e&&e.push(i.data.buffer),i;if(Array.isArray(i)){const r=[];for(const a of i)r.push($s(a,e));return r}if(typeof i=="object"){const r=i.constructor,a=r._classRegistryKey;if(!a)throw new Error("can't serialize object of unregistered class");if(!wr[a])throw new Error(`${a} is not registered.`);const d=r.serialize?r.serialize(i,e):{};if(r.serialize){if(e&&d===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in i){if(!i.hasOwnProperty(m)||wr[a].omit.indexOf(m)>=0)continue;const g=i[m];d[m]=wr[a].shallow.indexOf(m)>=0?g:$s(g,e)}i instanceof Error&&(d.message=i.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(d.$name=a),d}throw new Error("can't serialize object of type "+typeof i)}function Fr(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||i instanceof Blob||za(i)||gi(i)||ArrayBuffer.isView(i)||i instanceof ImageData)return i;if(Array.isArray(i))return i.map(Fr);if(typeof i=="object"){const e=i.$name||"Object";if(!wr[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:r}=wr[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(i);const a=Object.create(r.prototype);for(const d of Object.keys(i)){if(d==="$name")continue;const m=i[d];a[d]=wr[e].shallow.indexOf(d)>=0?m:Fr(m)}return a}throw new Error("can't deserialize object of type "+typeof i)}class oh{constructor(){this.first=!0}update(e,r){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=r):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=r),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const Ue={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Da(i){for(const e of i)if(La(e.charCodeAt(0)))return!0;return!1}function lu(i){for(const e of i)if(!sh(e.charCodeAt(0)))return!1;return!0}function sh(i){return!(Ue.Arabic(i)||Ue["Arabic Supplement"](i)||Ue["Arabic Extended-A"](i)||Ue["Arabic Presentation Forms-A"](i)||Ue["Arabic Presentation Forms-B"](i))}function La(i){return!(i!==746&&i!==747&&(i<4352||!(Ue["Bopomofo Extended"](i)||Ue.Bopomofo(i)||Ue["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ue["CJK Compatibility Ideographs"](i)||Ue["CJK Compatibility"](i)||Ue["CJK Radicals Supplement"](i)||Ue["CJK Strokes"](i)||!(!Ue["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ue["CJK Unified Ideographs Extension A"](i)||Ue["CJK Unified Ideographs"](i)||Ue["Enclosed CJK Letters and Months"](i)||Ue["Hangul Compatibility Jamo"](i)||Ue["Hangul Jamo Extended-A"](i)||Ue["Hangul Jamo Extended-B"](i)||Ue["Hangul Jamo"](i)||Ue["Hangul Syllables"](i)||Ue.Hiragana(i)||Ue["Ideographic Description Characters"](i)||Ue.Kanbun(i)||Ue["Kangxi Radicals"](i)||Ue["Katakana Phonetic Extensions"](i)||Ue.Katakana(i)&&i!==12540||!(!Ue["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ue["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ue["Unified Canadian Aboriginal Syllabics"](i)||Ue["Unified Canadian Aboriginal Syllabics Extended"](i)||Ue["Vertical Forms"](i)||Ue["Yijing Hexagram Symbols"](i)||Ue["Yi Syllables"](i)||Ue["Yi Radicals"](i))))}function ah(i){return!(La(i)||function(e){return!!(Ue["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||Ue["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||Ue["Letterlike Symbols"](e)||Ue["Number Forms"](e)||Ue["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||Ue["Control Pictures"](e)&&e!==9251||Ue["Optical Character Recognition"](e)||Ue["Enclosed Alphanumerics"](e)||Ue["Geometric Shapes"](e)||Ue["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||Ue["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ue["CJK Symbols and Punctuation"](e)||Ue.Katakana(e)||Ue["Private Use Area"](e)||Ue["CJK Compatibility Forms"](e)||Ue["Small Form Variants"](e)||Ue["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(i))}function Ra(i){return i>=1424&&i<=2303||Ue["Arabic Presentation Forms-A"](i)||Ue["Arabic Presentation Forms-B"](i)}function Ba(i,e){return!(!e&&Ra(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ue.Khmer(i))}function lh(i){for(const e of i)if(Ra(e.charCodeAt(0)))return!0;return!1}const uu="deferred",Fa="loading",cu="loaded";let js=null,Ei="unavailable",ro=null;const uh=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(Ei="error"),js&&js(i)};function hu(){Oa.fire(new Pt("pluginStateChange",{pluginStatus:Ei,pluginURL:ro}))}const Oa=new Wt,du=function(){return Ei},ch=function(){if(Ei!==uu||!ro)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ei=Fa,hu(),ro&&si({url:ro},i=>{i?uh(i):(Ei=cu,hu())})},Ki={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ei===cu||Ki.applyArabicShaping!=null,isLoading:()=>Ei===Fa,setState(i){if(!qt())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");Ei=i.pluginStatus,ro=i.pluginURL},isParsed(){if(!qt())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Ki.applyArabicShaping!=null&&Ki.processBidirectionalText!=null&&Ki.processStyledBidirectionalText!=null},getPluginURL(){if(!qt())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return ro}};class tn{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.zoomHistory=r.zoomHistory,this.transition=r.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new oh,this.transition={})}isSupportedScript(e){return function(r,a){for(const d of r)if(!Ba(d.charCodeAt(0),a))return!1;return!0}(e,Ki.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,r=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:r+(1-r)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*r}}}class Ua{constructor(e,r){this.property=e,this.value=r,this.expression=function(a,d){if(Ea(a))return new Kt(a,d);if(Ta(a)){const m=Ca(a,d);if(m.result==="error")throw new Error(m.value.map(g=>`${g.key}: ${g.message}`).join(", "));return m.value}{let m=a;return d.type==="color"&&typeof a=="string"?m=Mt.parse(a):d.type!=="padding"||typeof a!="number"&&!Array.isArray(a)||(m=xi.parse(a)),{kind:"constant",evaluate:()=>m}}}(r===void 0?e.specification.default:r,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,a){return this.property.possiblyEvaluate(this,e,r,a)}}class pu{constructor(e){this.property=e,this.value=new Ua(e,void 0)}transitioned(e,r){return new qs(this.property,this.value,r,le({},e.transition,this.transition),e.now)}untransitioned(){return new qs(this.property,this.value,null,{},0)}}class hh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return We(this._values[e].value.value)}setValue(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new pu(this._values[e].property)),this._values[e].value=new Ua(this._values[e].property,r===null?void 0:We(r))}getTransition(e){return We(this._values[e].transition)}setTransition(e,r){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new pu(this._values[e].property)),this._values[e].transition=We(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(e[r]=a);const d=this.getTransition(r);d!==void 0&&(e[`${r}-transition`]=d)}return e}transitioned(e,r){const a=new dh(this._properties);for(const d of Object.keys(this._values))a._values[d]=this._values[d].transitioned(e,r._values[d]);return a}untransitioned(){const e=new dh(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class qs{constructor(e,r,a,d,m){this.property=e,this.value=r,this.begin=m+d.delay||0,this.end=this.begin+d.duration||0,e.specification.transition&&(d.delay||d.duration)&&(this.prior=a)}possiblyEvaluate(e,r,a){const d=e.now||0,m=this.value.possiblyEvaluate(e,r,a),g=this.prior;if(g){if(d>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(d<this.begin)return g.possiblyEvaluate(e,r,a);{const v=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,r,a),m,function(b){if(b<=0)return 0;if(b>=1)return 1;const T=b*b,k=T*b;return 4*(b<.5?k:3*(b-T)+k-.75)}(v))}}return m}}class dh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,a){const d=new Na(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,r,a);return d}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class fu{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return We(this._values[e].value)}setValue(e,r){this._values[e]=new Ua(this._values[e].property,r===null?void 0:We(r))}serialize(){const e={};for(const r of Object.keys(this._values)){const a=this.getValue(r);a!==void 0&&(e[r]=a)}return e}possiblyEvaluate(e,r,a){const d=new Na(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(e,r,a);return d}}class br{constructor(e,r,a){this.property=e,this.value=r,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,a,d){return this.property.evaluate(this.value,this.parameters,e,r,a,d)}}class Na{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class et{constructor(e){this.specification=e}possiblyEvaluate(e,r){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(r)}interpolate(e,r,a){const d=Si[this.specification.type];return d?d(e,r,a):e}}class lt{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,a,d){return new br(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},a,d)}:e.expression,r)}interpolate(e,r,a){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new br(this,{kind:"constant",value:void 0},e.parameters);const d=Si[this.specification.type];if(d){const m=d(e.value.value,r.value.value,a);return new br(this,{kind:"constant",value:m},e.parameters)}return e}evaluate(e,r,a,d,m,g){return e.kind==="constant"?e.value:e.evaluate(r,a,d,m,g)}}class Zs extends lt{possiblyEvaluate(e,r,a,d){if(e.value===void 0)return new br(this,{kind:"constant",value:void 0},r);if(e.expression.kind==="constant"){const m=e.expression.evaluate(r,null,{},a,d),g=e.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(g,g,g,r);return new br(this,{kind:"constant",value:v},r)}if(e.expression.kind==="camera"){const m=this._calculate(e.expression.evaluate({zoom:r.zoom-1}),e.expression.evaluate({zoom:r.zoom}),e.expression.evaluate({zoom:r.zoom+1}),r);return new br(this,{kind:"constant",value:m},r)}return new br(this,e.expression,r)}evaluate(e,r,a,d,m,g){if(e.kind==="source"){const v=e.evaluate(r,a,d,m,g);return this._calculate(v,v,v,r)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(r.zoom)-1},a,d),e.evaluate({zoom:Math.floor(r.zoom)},a,d),e.evaluate({zoom:Math.floor(r.zoom)+1},a,d),r):e.value}_calculate(e,r,a,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:a,to:r}}interpolate(e){return e}}class mu{constructor(e){this.specification=e}possiblyEvaluate(e,r,a,d){if(e.value!==void 0){if(e.expression.kind==="constant"){const m=e.expression.evaluate(r,null,{},a,d);return this._calculate(m,m,m,r)}return this._calculate(e.expression.evaluate(new tn(Math.floor(r.zoom-1),r)),e.expression.evaluate(new tn(Math.floor(r.zoom),r)),e.expression.evaluate(new tn(Math.floor(r.zoom+1),r)),r)}}_calculate(e,r,a,d){return d.zoom>d.zoomHistory.lastIntegerZoom?{from:e,to:r}:{from:a,to:r}}interpolate(e){return e}}class gu{constructor(e){this.specification=e}possiblyEvaluate(e,r,a,d){return!!e.expression.evaluate(r,null,{},a,d)}interpolate(){return!1}}class Ti{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const r in e){const a=e[r];a.specification.overridable&&this.overridableProperties.push(r);const d=this.defaultPropertyValues[r]=new Ua(a,void 0),m=this.defaultTransitionablePropertyValues[r]=new pu(a);this.defaultTransitioningPropertyValues[r]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=d.possiblyEvaluate({})}}}Ke("DataDrivenProperty",lt),Ke("DataConstantProperty",et),Ke("CrossFadedDataDrivenProperty",Zs),Ke("CrossFadedProperty",mu),Ke("ColorRampProperty",gu);const Va="-transition";class Sr extends Wt{constructor(e,r){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),r.layout&&(this._unevaluatedLayout=new fu(r.layout)),r.paint)){this._transitionablePaint=new hh(r.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Na(r.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,a={}){r!=null&&this._validate(_p,`layers.${this.id}.layout.${e}`,e,r,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,r):this.visibility=r)}getPaintProperty(e){return e.endsWith(Va)?this._transitionablePaint.getTransition(e.slice(0,-Va.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,a={}){if(r!=null&&this._validate(yp,`layers.${this.id}.paint.${e}`,e,r,a))return!1;if(e.endsWith(Va))return this._transitionablePaint.setTransition(e.slice(0,-Va.length),r||void 0),!1;{const d=this._transitionablePaint._values[e],m=d.property.specification["property-type"]==="cross-faded-data-driven",g=d.value.isDataDriven(),v=d.value;this._transitionablePaint.setValue(e,r),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value;return b.isDataDriven()||g||m||this._handleOverridablePaintPropertyUpdate(e,v,b)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,r,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Ae(e,(r,a)=>!(r===void 0||a==="layout"&&!Object.keys(r).length||a==="paint"&&!Object.keys(r).length))}_validate(e,r,a,d,m={}){return(!m||m.validate!==!1)&&Ho(this,e.call(io,{key:r,layerType:this.type,objectKey:a,value:d,styleSpec:me,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof br&&Go(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}}const vp={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Or{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class dn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function In(i,e=1){let r=0,a=0;return{members:i.map(d=>{const m=vp[d.type].BYTES_PER_ELEMENT,g=r=ph(r,Math.max(e,m)),v=d.components||1;return a=Math.max(a,m),r+=m*v,{name:d.name,type:d.type,components:v,offset:g}}),size:ph(r,Math.max(a,e)),alignment:e}}function ph(i,e){return Math.ceil(i/e)*e}class Ko extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const d=2*e;return this.int16[d+0]=r,this.int16[d+1]=a,e}}Ko.prototype.bytesPerElement=4,Ke("StructArrayLayout2i4",Ko);class $a extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,a)}emplace(e,r,a,d){const m=3*e;return this.int16[m+0]=r,this.int16[m+1]=a,this.int16[m+2]=d,e}}$a.prototype.bytesPerElement=6,Ke("StructArrayLayout3i6",$a);class yu extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,d)}emplace(e,r,a,d,m){const g=4*e;return this.int16[g+0]=r,this.int16[g+1]=a,this.int16[g+2]=d,this.int16[g+3]=m,e}}yu.prototype.bytesPerElement=8,Ke("StructArrayLayout4i8",yu);class Er extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,d,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,a,d,m,g)}emplace(e,r,a,d,m,g,v){const b=6*e;return this.int16[b+0]=r,this.int16[b+1]=a,this.int16[b+2]=d,this.int16[b+3]=m,this.int16[b+4]=g,this.int16[b+5]=v,e}}Er.prototype.bytesPerElement=12,Ke("StructArrayLayout2i4i12",Er);class ja extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,d,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,a,d,m,g)}emplace(e,r,a,d,m,g,v){const b=4*e,T=8*e;return this.int16[b+0]=r,this.int16[b+1]=a,this.uint8[T+4]=d,this.uint8[T+5]=m,this.uint8[T+6]=g,this.uint8[T+7]=v,e}}ja.prototype.bytesPerElement=8,Ke("StructArrayLayout2i4ub8",ja);class xo extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const d=2*e;return this.float32[d+0]=r,this.float32[d+1]=a,e}}xo.prototype.bytesPerElement=8,Ke("StructArrayLayout2f8",xo);class qa extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,d,m,g,v,b,T,k){const A=this.length;return this.resize(A+1),this.emplace(A,e,r,a,d,m,g,v,b,T,k)}emplace(e,r,a,d,m,g,v,b,T,k,A){const L=10*e;return this.uint16[L+0]=r,this.uint16[L+1]=a,this.uint16[L+2]=d,this.uint16[L+3]=m,this.uint16[L+4]=g,this.uint16[L+5]=v,this.uint16[L+6]=b,this.uint16[L+7]=T,this.uint16[L+8]=k,this.uint16[L+9]=A,e}}qa.prototype.bytesPerElement=20,Ke("StructArrayLayout10ui20",qa);class Gs extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,d,m,g,v,b,T,k,A,L){const B=this.length;return this.resize(B+1),this.emplace(B,e,r,a,d,m,g,v,b,T,k,A,L)}emplace(e,r,a,d,m,g,v,b,T,k,A,L,B){const O=12*e;return this.int16[O+0]=r,this.int16[O+1]=a,this.int16[O+2]=d,this.int16[O+3]=m,this.uint16[O+4]=g,this.uint16[O+5]=v,this.uint16[O+6]=b,this.uint16[O+7]=T,this.int16[O+8]=k,this.int16[O+9]=A,this.int16[O+10]=L,this.int16[O+11]=B,e}}Gs.prototype.bytesPerElement=24,Ke("StructArrayLayout4i4ui4i24",Gs);class _u extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,a)}emplace(e,r,a,d){const m=3*e;return this.float32[m+0]=r,this.float32[m+1]=a,this.float32[m+2]=d,e}}_u.prototype.bytesPerElement=12,Ke("StructArrayLayout3f12",_u);class Yo extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}Yo.prototype.bytesPerElement=4,Ke("StructArrayLayout1ul4",Yo);class wo extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a,d,m,g,v,b,T){const k=this.length;return this.resize(k+1),this.emplace(k,e,r,a,d,m,g,v,b,T)}emplace(e,r,a,d,m,g,v,b,T,k){const A=10*e,L=5*e;return this.int16[A+0]=r,this.int16[A+1]=a,this.int16[A+2]=d,this.int16[A+3]=m,this.int16[A+4]=g,this.int16[A+5]=v,this.uint32[L+3]=b,this.uint16[A+8]=T,this.uint16[A+9]=k,e}}wo.prototype.bytesPerElement=20,Ke("StructArrayLayout6i1ul2ui20",wo);class vu extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,d,m,g){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,a,d,m,g)}emplace(e,r,a,d,m,g,v){const b=6*e;return this.int16[b+0]=r,this.int16[b+1]=a,this.int16[b+2]=d,this.int16[b+3]=m,this.int16[b+4]=g,this.int16[b+5]=v,e}}vu.prototype.bytesPerElement=12,Ke("StructArrayLayout2i2i2i12",vu);class Za extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,a,d,m){const g=this.length;return this.resize(g+1),this.emplace(g,e,r,a,d,m)}emplace(e,r,a,d,m,g){const v=4*e,b=8*e;return this.float32[v+0]=r,this.float32[v+1]=a,this.float32[v+2]=d,this.int16[b+6]=m,this.int16[b+7]=g,e}}Za.prototype.bytesPerElement=16,Ke("StructArrayLayout2f1f2i16",Za);class bo extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,d)}emplace(e,r,a,d,m){const g=12*e,v=3*e;return this.uint8[g+0]=r,this.uint8[g+1]=a,this.float32[v+1]=d,this.float32[v+2]=m,e}}bo.prototype.bytesPerElement=12,Ke("StructArrayLayout2ub2f12",bo);class Ga extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,a)}emplace(e,r,a,d){const m=3*e;return this.uint16[m+0]=r,this.uint16[m+1]=a,this.uint16[m+2]=d,e}}Ga.prototype.bytesPerElement=6,Ke("StructArrayLayout3ui6",Ga);class xu extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,d,m,g,v,b,T,k,A,L,B,O,G,j,ee){const ae=this.length;return this.resize(ae+1),this.emplace(ae,e,r,a,d,m,g,v,b,T,k,A,L,B,O,G,j,ee)}emplace(e,r,a,d,m,g,v,b,T,k,A,L,B,O,G,j,ee,ae){const J=24*e,ce=12*e,fe=48*e;return this.int16[J+0]=r,this.int16[J+1]=a,this.uint16[J+2]=d,this.uint16[J+3]=m,this.uint32[ce+2]=g,this.uint32[ce+3]=v,this.uint32[ce+4]=b,this.uint16[J+10]=T,this.uint16[J+11]=k,this.uint16[J+12]=A,this.float32[ce+7]=L,this.float32[ce+8]=B,this.uint8[fe+36]=O,this.uint8[fe+37]=G,this.uint8[fe+38]=j,this.uint32[ce+10]=ee,this.int16[J+22]=ae,e}}xu.prototype.bytesPerElement=48,Ke("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",xu);class Wa extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,d,m,g,v,b,T,k,A,L,B,O,G,j,ee,ae,J,ce,fe,_e,He,Ye,Ne,Be,ze,Ve){const Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,e,r,a,d,m,g,v,b,T,k,A,L,B,O,G,j,ee,ae,J,ce,fe,_e,He,Ye,Ne,Be,ze,Ve)}emplace(e,r,a,d,m,g,v,b,T,k,A,L,B,O,G,j,ee,ae,J,ce,fe,_e,He,Ye,Ne,Be,ze,Ve,Oe){const Te=34*e,ot=17*e;return this.int16[Te+0]=r,this.int16[Te+1]=a,this.int16[Te+2]=d,this.int16[Te+3]=m,this.int16[Te+4]=g,this.int16[Te+5]=v,this.int16[Te+6]=b,this.int16[Te+7]=T,this.uint16[Te+8]=k,this.uint16[Te+9]=A,this.uint16[Te+10]=L,this.uint16[Te+11]=B,this.uint16[Te+12]=O,this.uint16[Te+13]=G,this.uint16[Te+14]=j,this.uint16[Te+15]=ee,this.uint16[Te+16]=ae,this.uint16[Te+17]=J,this.uint16[Te+18]=ce,this.uint16[Te+19]=fe,this.uint16[Te+20]=_e,this.uint16[Te+21]=He,this.uint16[Te+22]=Ye,this.uint32[ot+12]=Ne,this.float32[ot+13]=Be,this.float32[ot+14]=ze,this.float32[ot+15]=Ve,this.float32[ot+16]=Oe,e}}Wa.prototype.bytesPerElement=68,Ke("StructArrayLayout8i15ui1ul4f68",Wa);class Xa extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}Xa.prototype.bytesPerElement=4,Ke("StructArrayLayout1f4",Xa);class Ha extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,a){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,a)}emplace(e,r,a,d){const m=4*e;return this.uint32[2*e+0]=r,this.uint16[m+2]=a,this.uint16[m+3]=d,e}}Ha.prototype.bytesPerElement=8,Ke("StructArrayLayout1ul2ui8",Ha);class h extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const a=this.length;return this.resize(a+1),this.emplace(a,e,r)}emplace(e,r,a){const d=2*e;return this.uint16[d+0]=r,this.uint16[d+1]=a,e}}h.prototype.bytesPerElement=4,Ke("StructArrayLayout2ui4",h);class t extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}t.prototype.bytesPerElement=2,Ke("StructArrayLayout1ui2",t);class s extends dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,a,d){const m=this.length;return this.resize(m+1),this.emplace(m,e,r,a,d)}emplace(e,r,a,d,m){const g=4*e;return this.float32[g+0]=r,this.float32[g+1]=a,this.float32[g+2]=d,this.float32[g+3]=m,e}}s.prototype.bytesPerElement=16,Ke("StructArrayLayout4f16",s);class c extends Or{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new ie(this.anchorPointX,this.anchorPointY)}}c.prototype.size=20;class p extends wo{get(e){return new c(this,e)}}Ke("CollisionBoxArray",p);class y extends Or{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}y.prototype.size=48;class x extends xu{get(e){return new y(this,e)}}Ke("PlacedSymbolArray",x);class E extends Or{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get textOffset0(){return this._structArray.float32[this._pos4+14]}get textOffset1(){return this._structArray.float32[this._pos4+15]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+16]}}E.prototype.size=68;class S extends Wa{get(e){return new E(this,e)}}Ke("SymbolInstanceArray",S);class C extends Xa{getoffsetX(e){return this.float32[1*e+0]}}Ke("GlyphOffsetArray",C);class M extends $a{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Ke("SymbolLineVertexArray",M);class P extends Or{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}P.prototype.size=8;class F extends Ha{get(e){return new P(this,e)}}Ke("FeatureIndexArray",F);class Z extends Ko{}class V extends Ko{}class q extends Ko{}class H extends Er{}class Q extends ja{}class de extends xo{}class W extends qa{}class he extends Gs{}class ge extends _u{}class we extends Yo{}class Se extends vu{}class Ie extends bo{}class be extends Ga{}class je extends h{}const rt=In([{name:"a_pos",components:2,type:"Int16"}],4),{members:ft}=rt;class De{constructor(e=[]){this.segments=e}prepareSegment(e,r,a,d){let m=this.segments[this.segments.length-1];return e>De.MAX_VERTEX_ARRAY_LENGTH&&st(`Max vertices per segment is ${De.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>De.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==d)&&(m={vertexOffset:r.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},d!==void 0&&(m.sortKey=d),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,a,d){return new De([{vertexOffset:e,primitiveOffset:r,vertexLength:a,primitiveLength:d,vaos:{},sortKey:0}])}}function ut(i,e){return 256*(i=re(Math.floor(i),0,255))+re(Math.floor(e),0,255)}De.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ke("SegmentVector",De);const Ge=In([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var zt={exports:{}},_n={exports:{}};_n.exports=function(i,e){var r,a,d,m,g,v,b,T;for(a=i.length-(r=3&i.length),d=e,g=3432918353,v=461845907,T=0;T<a;)b=255&i.charCodeAt(T)|(255&i.charCodeAt(++T))<<8|(255&i.charCodeAt(++T))<<16|(255&i.charCodeAt(++T))<<24,++T,d=27492+(65535&(m=5*(65535&(d=(d^=b=(65535&(b=(b=(65535&b)*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(b=0,r){case 3:b^=(255&i.charCodeAt(T+2))<<16;case 2:b^=(255&i.charCodeAt(T+1))<<8;case 1:d^=b=(65535&(b=(b=(65535&(b^=255&i.charCodeAt(T)))*g+(((b>>>16)*g&65535)<<16)&4294967295)<<15|b>>>17))*v+(((b>>>16)*v&65535)<<16)&4294967295}return d^=i.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0};var Dt=_n.exports,yt={exports:{}};yt.exports=function(i,e){for(var r,a=i.length,d=e^a,m=0;a>=4;)r=1540483477*(65535&(r=255&i.charCodeAt(m)|(255&i.charCodeAt(++m))<<8|(255&i.charCodeAt(++m))<<16|(255&i.charCodeAt(++m))<<24))+((1540483477*(r>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),a-=4,++m;switch(a){case 3:d^=(255&i.charCodeAt(m+2))<<16;case 2:d^=(255&i.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&i.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};var pn=Dt,ai=yt.exports;zt.exports=pn,zt.exports.murmur3=pn,zt.exports.murmur2=ai;var vn=U(zt.exports);class Un{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,r,a,d){this.ids.push(Bi(e)),this.positions.push(r,a,d)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const r=Bi(e);let a=0,d=this.ids.length-1;for(;a<d;){const g=a+d>>1;this.ids[g]>=r?d=g:a=g+1}const m=[];for(;this.ids[a]===r;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(e,r){const a=new Float64Array(e.ids),d=new Uint32Array(e.positions);return sr(a,d,0,a.length-1),r&&r.push(a.buffer,d.buffer),{ids:a,positions:d}}static deserialize(e){const r=new Un;return r.ids=e.ids,r.positions=e.positions,r.indexed=!0,r}}function Bi(i){const e=+i;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:vn(String(i))}function sr(i,e,r,a){for(;r<a;){const d=i[r+a>>1];let m=r-1,g=a+1;for(;;){do m++;while(i[m]<d);do g--;while(i[g]>d);if(m>=g)break;ar(i,m,g),ar(e,3*m,3*g),ar(e,3*m+1,3*g+1),ar(e,3*m+2,3*g+2)}g-r<a-g?(sr(i,e,r,g),r=g+1):(sr(i,e,g+1,a),a=g)}}function ar(i,e,r){const a=i[e];i[e]=i[r],i[r]=a}Ke("FeaturePositionMap",Un);class li{constructor(e,r){this.gl=e.gl,this.location=r}}class Tr extends li{constructor(e,r){super(e,r),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Ws extends li{constructor(e,r){super(e,r),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Jn extends li{constructor(e,r){super(e,r),this.current=Mt.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Nn=new Float32Array(16);function Rt(i){return[ut(255*i.r,255*i.g),ut(255*i.b,255*i.a)]}class An{constructor(e,r,a){this.value=e,this.uniformNames=r.map(d=>`u_${d}`),this.type=a}setUniform(e,r,a){e.set(a.constantOr(this.value))}getBinding(e,r,a){return this.type==="color"?new Jn(e,r):new Tr(e,r)}}class Vn{constructor(e,r){this.uniformNames=r.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,r){this.pixelRatioFrom=r.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=r.tlbr,this.patternTo=e.tlbr}setUniform(e,r,a,d){const m=d==="u_pattern_to"?this.patternTo:d==="u_pattern_from"?this.patternFrom:d==="u_pixel_ratio_to"?this.pixelRatioTo:d==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&e.set(m)}getBinding(e,r,a){return a.substr(0,9)==="u_pattern"?new Ws(e,r):new Tr(e,r)}}class Ot{constructor(e,r,a,d){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=r.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(e,r,a,d,m){const g=this.paintVertexArray.length,v=this.expression.evaluate(new tn(0),r,{},d,[],m);this.paintVertexArray.resize(e),this._setPaintValue(g,e,v)}updatePaintArray(e,r,a,d){const m=this.expression.evaluate({zoom:0},a,d);this._setPaintValue(e,r,m)}_setPaintValue(e,r,a){if(this.type==="color"){const d=Rt(a);for(let m=e;m<r;m++)this.paintVertexArray.emplace(m,d[0],d[1])}else{for(let d=e;d<r;d++)this.paintVertexArray.emplace(d,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class zn{constructor(e,r,a,d,m,g){this.expression=e,this.uniformNames=r.map(v=>`u_${v}_t`),this.type=a,this.useIntegerZoom=d,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=r.map(v=>({name:`a_${v}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(e,r,a,d,m){const g=this.expression.evaluate(new tn(this.zoom),r,{},d,[],m),v=this.expression.evaluate(new tn(this.zoom+1),r,{},d,[],m),b=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(b,e,g,v)}updatePaintArray(e,r,a,d){const m=this.expression.evaluate({zoom:this.zoom},a,d),g=this.expression.evaluate({zoom:this.zoom+1},a,d);this._setPaintValue(e,r,m,g)}_setPaintValue(e,r,a,d){if(this.type==="color"){const m=Rt(a),g=Rt(d);for(let v=e;v<r;v++)this.paintVertexArray.emplace(v,m[0],m[1],g[0],g[1])}else{for(let m=e;m<r;m++)this.paintVertexArray.emplace(m,a,d);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(d))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r){const a=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,d=re(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);e.set(d)}getBinding(e,r,a){return new Tr(e,r)}}class Fi{constructor(e,r,a,d,m,g){this.expression=e,this.type=r,this.useIntegerZoom=a,this.zoom=d,this.layerId=g,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,r,a){const d=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(d,e,r.patterns&&r.patterns[this.layerId],a)}updatePaintArray(e,r,a,d,m){this._setPaintValues(e,r,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(e,r,a,d){if(!d||!a)return;const{min:m,mid:g,max:v}=a,b=d[m],T=d[g],k=d[v];if(b&&T&&k)for(let A=e;A<r;A++)this.zoomInPaintVertexArray.emplace(A,T.tl[0],T.tl[1],T.br[0],T.br[1],b.tl[0],b.tl[1],b.br[0],b.br[1],T.pixelRatio,b.pixelRatio),this.zoomOutPaintVertexArray.emplace(A,T.tl[0],T.tl[1],T.br[0],T.br[1],k.tl[0],k.tl[1],k.br[0],k.br[1],T.pixelRatio,k.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Ge.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Ge.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ka{constructor(e,r,a){this.binders={},this._buffers=[];const d=[];for(const m in e.paint._values){if(!a(m))continue;const g=e.paint.get(m);if(!(g instanceof br&&Go(g.property.specification)))continue;const v=xp(m,e.type),b=g.value,T=g.property.specification.type,k=g.property.useIntegerZoom,A=g.property.specification["property-type"],L=A==="cross-faded"||A==="cross-faded-data-driven";if(b.kind==="constant")this.binders[m]=L?new Vn(b.value,v):new An(b.value,v,T),d.push(`/u_${m}`);else if(b.kind==="source"||L){const B=fh(m,T,"source");this.binders[m]=L?new Fi(b,T,k,r,B,e.id):new Ot(b,v,T,B),d.push(`/a_${m}`)}else{const B=fh(m,T,"composite");this.binders[m]=new zn(b,v,T,k,r,B),d.push(`/z_${m}`)}}this.cacheKey=d.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof Ot||r instanceof zn?r.maxValue:0}populatePaintArrays(e,r,a,d,m){for(const g in this.binders){const v=this.binders[g];(v instanceof Ot||v instanceof zn||v instanceof Fi)&&v.populatePaintArray(e,r,a,d,m)}}setConstantPatternPositions(e,r){for(const a in this.binders){const d=this.binders[a];d instanceof Vn&&d.setConstantPatternPositions(e,r)}}updatePaintArrays(e,r,a,d,m){let g=!1;for(const v in e){const b=r.getPositions(v);for(const T of b){const k=a.feature(T.index);for(const A in this.binders){const L=this.binders[A];if((L instanceof Ot||L instanceof zn||L instanceof Fi)&&L.expression.isStateDependent===!0){const B=d.paint.get(A);L.expression=B.value,L.updatePaintArray(T.start,T.end,k,e[v],m),g=!0}}}}return g}defines(){const e=[];for(const r in this.binders){const a=this.binders[r];(a instanceof An||a instanceof Vn)&&e.push(...a.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof Ot||a instanceof zn)for(let d=0;d<a.paintVertexAttributes.length;d++)e.push(a.paintVertexAttributes[d].name);else if(a instanceof Fi)for(let d=0;d<Ge.members.length;d++)e.push(Ge.members[d].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const a=this.binders[r];if(a instanceof An||a instanceof Vn||a instanceof zn)for(const d of a.uniformNames)e.push(d)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,r){const a=[];for(const d in this.binders){const m=this.binders[d];if(m instanceof An||m instanceof Vn||m instanceof zn){for(const g of m.uniformNames)if(r[g]){const v=m.getBinding(e,r[g],g);a.push({name:g,property:d,binding:v})}}}return a}setUniforms(e,r,a,d){for(const{name:m,property:g,binding:v}of r)this.binders[g].setUniform(v,d,a.get(g),m)}updatePaintBuffers(e){this._buffers=[];for(const r in this.binders){const a=this.binders[r];if(e&&a instanceof Fi){const d=e.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;d&&this._buffers.push(d)}else(a instanceof Ot||a instanceof zn)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const r in this.binders){const a=this.binders[r];(a instanceof Ot||a instanceof zn||a instanceof Fi)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof Ot||r instanceof zn||r instanceof Fi)&&r.destroy()}}}class Ur{constructor(e,r,a=()=>!0){this.programConfigurations={};for(const d of e)this.programConfigurations[d.id]=new Ka(d,r,a);this.needsUpload=!1,this._featureMap=new Un,this._bufferOffset=0}populatePaintArrays(e,r,a,d,m,g){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(e,r,d,m,g);r.id!==void 0&&this._featureMap.add(r.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,a,d){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,r,m,d)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function xp(i,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[i]||[i.replace(`${e}-`,"").replace(/-/g,"_")]}function fh(i,e,r){const a={color:{source:xo,composite:s},number:{source:Xa,composite:xo}},d=function(m){return{"line-pattern":{source:W,composite:W},"fill-pattern":{source:W,composite:W},"fill-extrusion-pattern":{source:W,composite:W}}[m]}(i);return d&&d[r]||a[e][r]}Ke("ConstantBinder",An),Ke("CrossFadedConstantBinder",Vn),Ke("SourceExpressionBinder",Ot),Ke("CrossFadedCompositeBinder",Fi),Ke("CompositeExpressionBinder",zn),Ke("ProgramConfiguration",Ka,{omit:["_buffers"]}),Ke("ProgramConfigurationSet",Ur);var nn=8192;const wu=Math.pow(2,14)-1,Xs=-wu-1;function Nr(i){const e=nn/i.extent,r=i.loadGeometry();for(let a=0;a<r.length;a++){const d=r[a];for(let m=0;m<d.length;m++){const g=d[m],v=Math.round(g.x*e),b=Math.round(g.y*e);g.x=re(v,Xs,wu),g.y=re(b,Xs,wu),(v<g.x||v>g.x+1||b<g.y||b>g.y+1)&&st("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return r}function Hs(i,e){return{type:i.type,id:i.id,properties:i.properties,geometry:e?Nr(i):[]}}function mh(i,e,r,a,d){i.emplaceBack(2*e+(a+1)/2,2*r+(d+1)/2)}class wp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new V,this.indexArray=new be,this.segments=new De,this.programConfigurations=new Ur(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a){const d=this.layers[0],m=[];let g=null,v=!1;d.type==="circle"&&(g=d.layout.get("circle-sort-key"),v=!g.isConstant());for(const{feature:b,id:T,index:k,sourceLayerIndex:A}of e){const L=this.layers[0]._featureFilter.needGeometry,B=Hs(b,L);if(!this.layers[0]._featureFilter.filter(new tn(this.zoom),B,a))continue;const O=v?g.evaluate(B,{},a):void 0,G={id:T,properties:b.properties,type:b.type,sourceLayerIndex:A,index:k,geometry:L?B.geometry:Nr(b),patterns:{},sortKey:O};m.push(G)}v&&m.sort((b,T)=>b.sortKey-T.sortKey);for(const b of m){const{geometry:T,index:k,sourceLayerIndex:A}=b,L=e[k].feature;this.addFeature(b,T,k,a),r.featureIndex.insert(L,T,k,A,this.index)}}update(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ft),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,a,d){for(const m of r)for(const g of m){const v=g.x,b=g.y;if(v<0||v>=nn||b<0||b>=nn)continue;const T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),k=T.vertexLength;mh(this.layoutVertexArray,v,b,-1,-1),mh(this.layoutVertexArray,v,b,1,-1),mh(this.layoutVertexArray,v,b,1,1),mh(this.layoutVertexArray,v,b,-1,1),this.indexArray.emplaceBack(k,k+1,k+2),this.indexArray.emplaceBack(k,k+3,k+2),T.vertexLength+=4,T.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},d)}}function qg(i,e){for(let r=0;r<i.length;r++)if(Ya(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(Ya(i,e[r]))return!0;return!!bp(i,e)}function g1(i,e,r){return!!Ya(i,e)||!!Sp(e,i,r)}function Zg(i,e){if(i.length===1)return Wg(e,i[0]);for(let r=0;r<e.length;r++){const a=e[r];for(let d=0;d<a.length;d++)if(Ya(i,a[d]))return!0}for(let r=0;r<i.length;r++)if(Wg(e,i[r]))return!0;for(let r=0;r<e.length;r++)if(bp(i,e[r]))return!0;return!1}function y1(i,e,r){if(i.length>1){if(bp(i,e))return!0;for(let a=0;a<e.length;a++)if(Sp(e[a],i,r))return!0}for(let a=0;a<i.length;a++)if(Sp(i[a],e,r))return!0;return!1}function bp(i,e){if(i.length===0||e.length===0)return!1;for(let r=0;r<i.length-1;r++){const a=i[r],d=i[r+1];for(let m=0;m<e.length-1;m++)if(_1(a,d,e[m],e[m+1]))return!0}return!1}function _1(i,e,r,a){return _t(i,r,a)!==_t(e,r,a)&&_t(i,e,r)!==_t(i,e,a)}function Sp(i,e,r){const a=r*r;if(e.length===1)return i.distSqr(e[0])<a;for(let d=1;d<e.length;d++)if(Gg(i,e[d-1],e[d])<a)return!0;return!1}function Gg(i,e,r){const a=e.distSqr(r);if(a===0)return i.distSqr(e);const d=((i.x-e.x)*(r.x-e.x)+(i.y-e.y)*(r.y-e.y))/a;return i.distSqr(d<0?e:d>1?r:r.sub(e)._mult(d)._add(e))}function Wg(i,e){let r,a,d,m=!1;for(let g=0;g<i.length;g++){r=i[g];for(let v=0,b=r.length-1;v<r.length;b=v++)a=r[v],d=r[b],a.y>e.y!=d.y>e.y&&e.x<(d.x-a.x)*(e.y-a.y)/(d.y-a.y)+a.x&&(m=!m)}return m}function Ya(i,e){let r=!1;for(let a=0,d=i.length-1;a<i.length;d=a++){const m=i[a],g=i[d];m.y>e.y!=g.y>e.y&&e.x<(g.x-m.x)*(e.y-m.y)/(g.y-m.y)+m.x&&(r=!r)}return r}function v1(i,e,r){const a=r[0],d=r[2];if(i.x<a.x&&e.x<a.x||i.x>d.x&&e.x>d.x||i.y<a.y&&e.y<a.y||i.y>d.y&&e.y>d.y)return!1;const m=_t(i,e,r[0]);return m!==_t(i,e,r[1])||m!==_t(i,e,r[2])||m!==_t(i,e,r[3])}function bu(i,e,r){const a=e.paint.get(i).value;return a.kind==="constant"?a.value:r.programConfigurations.get(e.id).getMaxValue(i)}function gh(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function yh(i,e,r,a,d){if(!e[0]&&!e[1])return i;const m=ie.convert(e)._mult(d);r==="viewport"&&m._rotate(-a);const g=[];for(let v=0;v<i.length;v++)g.push(i[v].sub(m));return g}let Xg,Hg;Ke("CircleBucket",wp,{omit:["layers"]});var x1={get paint(){return Hg=Hg||new Ti({"circle-radius":new lt(me.paint_circle["circle-radius"]),"circle-color":new lt(me.paint_circle["circle-color"]),"circle-blur":new lt(me.paint_circle["circle-blur"]),"circle-opacity":new lt(me.paint_circle["circle-opacity"]),"circle-translate":new et(me.paint_circle["circle-translate"]),"circle-translate-anchor":new et(me.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new et(me.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new et(me.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new lt(me.paint_circle["circle-stroke-width"]),"circle-stroke-color":new lt(me.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new lt(me.paint_circle["circle-stroke-opacity"])})},get layout(){return Xg=Xg||new Ti({"circle-sort-key":new lt(me.layout_circle["circle-sort-key"])})}},Ci=1e-6,Ja=typeof Float32Array<"u"?Float32Array:Array;function Ep(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Kg(i,e,r){var a=e[0],d=e[1],m=e[2],g=e[3],v=e[4],b=e[5],T=e[6],k=e[7],A=e[8],L=e[9],B=e[10],O=e[11],G=e[12],j=e[13],ee=e[14],ae=e[15],J=r[0],ce=r[1],fe=r[2],_e=r[3];return i[0]=J*a+ce*v+fe*A+_e*G,i[1]=J*d+ce*b+fe*L+_e*j,i[2]=J*m+ce*T+fe*B+_e*ee,i[3]=J*g+ce*k+fe*O+_e*ae,i[4]=(J=r[4])*a+(ce=r[5])*v+(fe=r[6])*A+(_e=r[7])*G,i[5]=J*d+ce*b+fe*L+_e*j,i[6]=J*m+ce*T+fe*B+_e*ee,i[7]=J*g+ce*k+fe*O+_e*ae,i[8]=(J=r[8])*a+(ce=r[9])*v+(fe=r[10])*A+(_e=r[11])*G,i[9]=J*d+ce*b+fe*L+_e*j,i[10]=J*m+ce*T+fe*B+_e*ee,i[11]=J*g+ce*k+fe*O+_e*ae,i[12]=(J=r[12])*a+(ce=r[13])*v+(fe=r[14])*A+(_e=r[15])*G,i[13]=J*d+ce*b+fe*L+_e*j,i[14]=J*m+ce*T+fe*B+_e*ee,i[15]=J*g+ce*k+fe*O+_e*ae,i}Math.hypot||(Math.hypot=function(){for(var i=0,e=arguments.length;e--;)i+=arguments[e]*arguments[e];return Math.sqrt(i)});var Su,w1=Kg;function _h(i,e,r){var a=e[0],d=e[1],m=e[2],g=e[3];return i[0]=r[0]*a+r[4]*d+r[8]*m+r[12]*g,i[1]=r[1]*a+r[5]*d+r[9]*m+r[13]*g,i[2]=r[2]*a+r[6]*d+r[10]*m+r[14]*g,i[3]=r[3]*a+r[7]*d+r[11]*m+r[15]*g,i}function Yg(i,e){const r=_h([],[i.x,i.y,0,1],e);return new ie(r[0]/r[3],r[1]/r[3])}Su=new Ja(4),Ja!=Float32Array&&(Su[0]=0,Su[1]=0,Su[2]=0,Su[3]=0);class Jg extends wp{}let Qg;Ke("HeatmapBucket",Jg,{omit:["layers"]});var b1={get paint(){return Qg=Qg||new Ti({"heatmap-radius":new lt(me.paint_heatmap["heatmap-radius"]),"heatmap-weight":new lt(me.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new et(me.paint_heatmap["heatmap-intensity"]),"heatmap-color":new gu(me.paint_heatmap["heatmap-color"]),"heatmap-opacity":new et(me.paint_heatmap["heatmap-opacity"])})}};function Tp(i,{width:e,height:r},a,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==e*r*a)throw new RangeError(`mismatched image size. expected: ${d.length} but got: ${e*r*a}`)}else d=new Uint8Array(e*r*a);return i.width=e,i.height=r,i.data=d,i}function ey(i,{width:e,height:r},a){if(e===i.width&&r===i.height)return;const d=Tp({},{width:e,height:r},a);Cp(i,d,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,e),height:Math.min(i.height,r)},a),i.width=e,i.height=r,i.data=d.data}function Cp(i,e,r,a,d,m){if(d.width===0||d.height===0)return e;if(d.width>i.width||d.height>i.height||r.x>i.width-d.width||r.y>i.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>e.width||d.height>e.height||a.x>e.width-d.width||a.y>e.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const g=i.data,v=e.data;if(g===v)throw new Error("srcData equals dstData, so image is already copied");for(let b=0;b<d.height;b++){const T=((r.y+b)*i.width+r.x)*m,k=((a.y+b)*e.width+a.x)*m;for(let A=0;A<d.width*m;A++)v[k+A]=g[T+A]}return e}class Eu{constructor(e,r){Tp(this,e,1,r)}resize(e){ey(this,e,1)}clone(){return new Eu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,a,d,m){Cp(e,r,a,d,m,1)}}class lr{constructor(e,r){Tp(this,e,4,r)}resize(e){ey(this,e,4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new lr({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,a,d,m){Cp(e,r,a,d,m,4)}}function ty(i){const e={},r=i.resolution||256,a=i.clips?i.clips.length:1,d=i.image||new lr({width:r,height:a});if(Math.log(r)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${r}`);const m=(g,v,b)=>{e[i.evaluationKey]=b;const T=i.expression.evaluate(e);d.data[g+v+0]=Math.floor(255*T.r/T.a),d.data[g+v+1]=Math.floor(255*T.g/T.a),d.data[g+v+2]=Math.floor(255*T.b/T.a),d.data[g+v+3]=Math.floor(255*T.a)};if(i.clips)for(let g=0,v=0;g<a;++g,v+=4*r)for(let b=0,T=0;b<r;b++,T+=4){const k=b/(r-1),{start:A,end:L}=i.clips[g];m(v,T,A*(1-k)+L*k)}else for(let g=0,v=0;g<r;g++,v+=4)m(0,v,g/(r-1));return d}let ny;Ke("AlphaImage",Eu),Ke("RGBAImage",lr);var S1={get paint(){return ny=ny||new Ti({"hillshade-illumination-direction":new et(me.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new et(me.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new et(me.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new et(me.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new et(me.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new et(me.paint_hillshade["hillshade-accent-color"])})}};const E1=In([{name:"a_pos",components:2,type:"Int16"}],4),{members:T1}=E1;var Ip={exports:{}};function vh(i,e,r){r=r||2;var a,d,m,g,v,b,T,k=e&&e.length,A=k?e[0]*r:i.length,L=iy(i,0,A,r,!0),B=[];if(!L||L.next===L.prev)return B;if(k&&(L=function(G,j,ee,ae){var J,ce,fe,_e=[];for(J=0,ce=j.length;J<ce;J++)(fe=iy(G,j[J]*ae,J<ce-1?j[J+1]*ae:G.length,ae,!1))===fe.next&&(fe.steiner=!0),_e.push(D1(fe));for(_e.sort(M1),J=0;J<_e.length;J++)ee=A1(_e[J],ee);return ee}(i,e,L,r)),i.length>80*r){a=m=i[0],d=g=i[1];for(var O=r;O<A;O+=r)(v=i[O])<a&&(a=v),(b=i[O+1])<d&&(d=b),v>m&&(m=v),b>g&&(g=b);T=(T=Math.max(m-a,g-d))!==0?32767/T:0}return Tu(L,B,r,a,d,T,0),B}function iy(i,e,r,a,d){var m,g;if(d===Mp(i,e,r,a)>0)for(m=e;m<r;m+=a)g=sy(m,i[m],i[m+1],g);else for(m=r-a;m>=e;m-=a)g=sy(m,i[m],i[m+1],g);return g&&xh(g,g.next)&&(Iu(g),g=g.next),g}function Ks(i,e){if(!i)return i;e||(e=i);var r,a=i;do if(r=!1,a.steiner||!xh(a,a.next)&&xn(a.prev,a,a.next)!==0)a=a.next;else{if(Iu(a),(a=e=a.prev)===a.next)break;r=!0}while(r||a!==e);return e}function Tu(i,e,r,a,d,m,g){if(i){!g&&m&&function(k,A,L,B){var O=k;do O.z===0&&(O.z=kp(O.x,O.y,A,L,B)),O.prevZ=O.prev,O.nextZ=O.next,O=O.next;while(O!==k);O.prevZ.nextZ=null,O.prevZ=null,function(G){var j,ee,ae,J,ce,fe,_e,He,Ye=1;do{for(ee=G,G=null,ce=null,fe=0;ee;){for(fe++,ae=ee,_e=0,j=0;j<Ye&&(_e++,ae=ae.nextZ);j++);for(He=Ye;_e>0||He>0&&ae;)_e!==0&&(He===0||!ae||ee.z<=ae.z)?(J=ee,ee=ee.nextZ,_e--):(J=ae,ae=ae.nextZ,He--),ce?ce.nextZ=J:G=J,J.prevZ=ce,ce=J;ee=ae}ce.nextZ=null,Ye*=2}while(fe>1)}(O)}(i,a,d,m);for(var v,b,T=i;i.prev!==i.next;)if(v=i.prev,b=i.next,m?I1(i,a,d,m):C1(i))e.push(v.i/r|0),e.push(i.i/r|0),e.push(b.i/r|0),Iu(i),i=b.next,T=b.next;else if((i=b)===T){g?g===1?Tu(i=k1(Ks(i),e,r),e,r,a,d,m,2):g===2&&P1(i,e,r,a,d,m):Tu(Ks(i),e,r,a,d,m,1);break}}}function C1(i){var e=i.prev,r=i,a=i.next;if(xn(e,r,a)>=0)return!1;for(var d=e.x,m=r.x,g=a.x,v=e.y,b=r.y,T=a.y,k=d<m?d<g?d:g:m<g?m:g,A=v<b?v<T?v:T:b<T?b:T,L=d>m?d>g?d:g:m>g?m:g,B=v>b?v>T?v:T:b>T?b:T,O=a.next;O!==e;){if(O.x>=k&&O.x<=L&&O.y>=A&&O.y<=B&&Qa(d,v,m,b,g,T,O.x,O.y)&&xn(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function I1(i,e,r,a){var d=i.prev,m=i,g=i.next;if(xn(d,m,g)>=0)return!1;for(var v=d.x,b=m.x,T=g.x,k=d.y,A=m.y,L=g.y,B=v<b?v<T?v:T:b<T?b:T,O=k<A?k<L?k:L:A<L?A:L,G=v>b?v>T?v:T:b>T?b:T,j=k>A?k>L?k:L:A>L?A:L,ee=kp(B,O,e,r,a),ae=kp(G,j,e,r,a),J=i.prevZ,ce=i.nextZ;J&&J.z>=ee&&ce&&ce.z<=ae;){if(J.x>=B&&J.x<=G&&J.y>=O&&J.y<=j&&J!==d&&J!==g&&Qa(v,k,b,A,T,L,J.x,J.y)&&xn(J.prev,J,J.next)>=0||(J=J.prevZ,ce.x>=B&&ce.x<=G&&ce.y>=O&&ce.y<=j&&ce!==d&&ce!==g&&Qa(v,k,b,A,T,L,ce.x,ce.y)&&xn(ce.prev,ce,ce.next)>=0))return!1;ce=ce.nextZ}for(;J&&J.z>=ee;){if(J.x>=B&&J.x<=G&&J.y>=O&&J.y<=j&&J!==d&&J!==g&&Qa(v,k,b,A,T,L,J.x,J.y)&&xn(J.prev,J,J.next)>=0)return!1;J=J.prevZ}for(;ce&&ce.z<=ae;){if(ce.x>=B&&ce.x<=G&&ce.y>=O&&ce.y<=j&&ce!==d&&ce!==g&&Qa(v,k,b,A,T,L,ce.x,ce.y)&&xn(ce.prev,ce,ce.next)>=0)return!1;ce=ce.nextZ}return!0}function k1(i,e,r){var a=i;do{var d=a.prev,m=a.next.next;!xh(d,m)&&ry(d,a,a.next,m)&&Cu(d,m)&&Cu(m,d)&&(e.push(d.i/r|0),e.push(a.i/r|0),e.push(m.i/r|0),Iu(a),Iu(a.next),a=i=m),a=a.next}while(a!==i);return Ks(a)}function P1(i,e,r,a,d,m){var g=i;do{for(var v=g.next.next;v!==g.prev;){if(g.i!==v.i&&L1(g,v)){var b=oy(g,v);return g=Ks(g,g.next),b=Ks(b,b.next),Tu(g,e,r,a,d,m,0),void Tu(b,e,r,a,d,m,0)}v=v.next}g=g.next}while(g!==i)}function M1(i,e){return i.x-e.x}function A1(i,e){var r=function(d,m){var g,v=m,b=d.x,T=d.y,k=-1/0;do{if(T<=v.y&&T>=v.next.y&&v.next.y!==v.y){var A=v.x+(T-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(A<=b&&A>k&&(k=A,g=v.x<v.next.x?v:v.next,A===b))return g}v=v.next}while(v!==m);if(!g)return null;var L,B=g,O=g.x,G=g.y,j=1/0;v=g;do b>=v.x&&v.x>=O&&b!==v.x&&Qa(T<G?b:k,T,O,G,T<G?k:b,T,v.x,v.y)&&(L=Math.abs(T-v.y)/(b-v.x),Cu(v,d)&&(L<j||L===j&&(v.x>g.x||v.x===g.x&&z1(g,v)))&&(g=v,j=L)),v=v.next;while(v!==B);return g}(i,e);if(!r)return e;var a=oy(r,i);return Ks(a,a.next),Ks(r,r.next)}function z1(i,e){return xn(i.prev,i,e.prev)<0&&xn(e.next,i,i.next)<0}function kp(i,e,r,a,d){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-r)*d|0)|i<<8))|i<<4))|i<<2))|i<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*d|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function D1(i){var e=i,r=i;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==i);return r}function Qa(i,e,r,a,d,m,g,v){return(d-g)*(e-v)>=(i-g)*(m-v)&&(i-g)*(a-v)>=(r-g)*(e-v)&&(r-g)*(m-v)>=(d-g)*(a-v)}function L1(i,e){return i.next.i!==e.i&&i.prev.i!==e.i&&!function(r,a){var d=r;do{if(d.i!==r.i&&d.next.i!==r.i&&d.i!==a.i&&d.next.i!==a.i&&ry(d,d.next,r,a))return!0;d=d.next}while(d!==r);return!1}(i,e)&&(Cu(i,e)&&Cu(e,i)&&function(r,a){var d=r,m=!1,g=(r.x+a.x)/2,v=(r.y+a.y)/2;do d.y>v!=d.next.y>v&&d.next.y!==d.y&&g<(d.next.x-d.x)*(v-d.y)/(d.next.y-d.y)+d.x&&(m=!m),d=d.next;while(d!==r);return m}(i,e)&&(xn(i.prev,i,e.prev)||xn(i,e.prev,e))||xh(i,e)&&xn(i.prev,i,i.next)>0&&xn(e.prev,e,e.next)>0)}function xn(i,e,r){return(e.y-i.y)*(r.x-e.x)-(e.x-i.x)*(r.y-e.y)}function xh(i,e){return i.x===e.x&&i.y===e.y}function ry(i,e,r,a){var d=bh(xn(i,e,r)),m=bh(xn(i,e,a)),g=bh(xn(r,a,i)),v=bh(xn(r,a,e));return d!==m&&g!==v||!(d!==0||!wh(i,r,e))||!(m!==0||!wh(i,a,e))||!(g!==0||!wh(r,i,a))||!(v!==0||!wh(r,e,a))}function wh(i,e,r){return e.x<=Math.max(i.x,r.x)&&e.x>=Math.min(i.x,r.x)&&e.y<=Math.max(i.y,r.y)&&e.y>=Math.min(i.y,r.y)}function bh(i){return i>0?1:i<0?-1:0}function Cu(i,e){return xn(i.prev,i,i.next)<0?xn(i,e,i.next)>=0&&xn(i,i.prev,e)>=0:xn(i,e,i.prev)<0||xn(i,i.next,e)<0}function oy(i,e){var r=new Pp(i.i,i.x,i.y),a=new Pp(e.i,e.x,e.y),d=i.next,m=e.prev;return i.next=e,e.prev=i,r.next=d,d.prev=r,a.next=r,r.prev=a,m.next=a,a.prev=m,a}function sy(i,e,r,a){var d=new Pp(i,e,r);return a?(d.next=a.next,d.prev=a,a.next.prev=d,a.next=d):(d.prev=d,d.next=d),d}function Iu(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Pp(i,e,r){this.i=i,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Mp(i,e,r,a){for(var d=0,m=e,g=r-a;m<r;m+=a)d+=(i[g]-i[m])*(i[m+1]+i[g+1]),g=m;return d}Ip.exports=vh,Ip.exports.default=vh,vh.deviation=function(i,e,r,a){var d=e&&e.length,m=Math.abs(Mp(i,0,d?e[0]*r:i.length,r));if(d)for(var g=0,v=e.length;g<v;g++)m-=Math.abs(Mp(i,e[g]*r,g<v-1?e[g+1]*r:i.length,r));var b=0;for(g=0;g<a.length;g+=3){var T=a[g]*r,k=a[g+1]*r,A=a[g+2]*r;b+=Math.abs((i[T]-i[A])*(i[k+1]-i[T+1])-(i[T]-i[k])*(i[A+1]-i[T+1]))}return m===0&&b===0?0:Math.abs((b-m)/m)},vh.flatten=function(i){for(var e=i[0][0].length,r={vertices:[],holes:[],dimensions:e},a=0,d=0;d<i.length;d++){for(var m=0;m<i[d].length;m++)for(var g=0;g<e;g++)r.vertices.push(i[d][m][g]);d>0&&r.holes.push(a+=i[d-1].length)}return r};var ay=U(Ip.exports);function R1(i,e,r,a,d){ly(i,e,r||0,a||i.length-1,d||B1)}function ly(i,e,r,a,d){for(;a>r;){if(a-r>600){var m=a-r+1,g=e-r+1,v=Math.log(m),b=.5*Math.exp(2*v/3),T=.5*Math.sqrt(v*b*(m-b)/m)*(g-m/2<0?-1:1);ly(i,e,Math.max(r,Math.floor(e-g*b/m+T)),Math.min(a,Math.floor(e+(m-g)*b/m+T)),d)}var k=i[e],A=r,L=a;for(ku(i,r,e),d(i[a],k)>0&&ku(i,r,a);A<L;){for(ku(i,A,L),A++,L--;d(i[A],k)<0;)A++;for(;d(i[L],k)>0;)L--}d(i[r],k)===0?ku(i,r,L):ku(i,++L,a),L<=e&&(r=L+1),e<=L&&(a=L-1)}}function ku(i,e,r){var a=i[e];i[e]=i[r],i[r]=a}function B1(i,e){return i<e?-1:i>e?1:0}function Ap(i,e){const r=i.length;if(r<=1)return[i];const a=[];let d,m;for(let g=0;g<r;g++){const v=mi(i[g]);v!==0&&(i[g].area=Math.abs(v),m===void 0&&(m=v<0),m===v<0?(d&&a.push(d),d=[i[g]]):d.push(i[g]))}if(d&&a.push(d),e>1)for(let g=0;g<a.length;g++)a[g].length<=e||(R1(a[g],e,1,a[g].length-1,F1),a[g]=a[g].slice(0,e));return a}function F1(i,e){return e.area-i.area}function zp(i,e,r){const a=r.patternDependencies;let d=!1;for(const m of e){const g=m.paint.get(`${i}-pattern`);g.isConstant()||(d=!0);const v=g.constantOr(null);v&&(d=!0,a[v.to]=!0,a[v.from]=!0)}return d}function Dp(i,e,r,a,d){const m=d.patternDependencies;for(const g of e){const v=g.paint.get(`${i}-pattern`).value;if(v.kind!=="constant"){let b=v.evaluate({zoom:a-1},r,{},d.availableImages),T=v.evaluate({zoom:a},r,{},d.availableImages),k=v.evaluate({zoom:a+1},r,{},d.availableImages);b=b&&b.name?b.name:b,T=T&&T.name?T.name:T,k=k&&k.name?k.name:k,m[b]=!0,m[T]=!0,m[k]=!0,r.patterns[g.id]={min:b,mid:T,max:k}}}return r}class Lp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new q,this.indexArray=new be,this.indexArray2=new je,this.programConfigurations=new Ur(e.layers,e.zoom),this.segments=new De,this.segments2=new De,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a){this.hasPattern=zp("fill",this.layers,r);const d=this.layers[0].layout.get("fill-sort-key"),m=!d.isConstant(),g=[];for(const{feature:v,id:b,index:T,sourceLayerIndex:k}of e){const A=this.layers[0]._featureFilter.needGeometry,L=Hs(v,A);if(!this.layers[0]._featureFilter.filter(new tn(this.zoom),L,a))continue;const B=m?d.evaluate(L,{},a,r.availableImages):void 0,O={id:b,properties:v.properties,type:v.type,sourceLayerIndex:k,index:T,geometry:A?L.geometry:Nr(v),patterns:{},sortKey:B};g.push(O)}m&&g.sort((v,b)=>v.sortKey-b.sortKey);for(const v of g){const{geometry:b,index:T,sourceLayerIndex:k}=v;if(this.hasPattern){const A=Dp("fill",this.layers,v,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(v,b,T,a,{});r.featureIndex.insert(e[T].feature,b,T,k,this.index)}}update(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)}addFeatures(e,r,a){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,T1),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,a,d,m){for(const g of Ap(r,500)){let v=0;for(const B of g)v+=B.length;const b=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),T=b.vertexLength,k=[],A=[];for(const B of g){if(B.length===0)continue;B!==g[0]&&A.push(k.length/2);const O=this.segments2.prepareSegment(B.length,this.layoutVertexArray,this.indexArray2),G=O.vertexLength;this.layoutVertexArray.emplaceBack(B[0].x,B[0].y),this.indexArray2.emplaceBack(G+B.length-1,G),k.push(B[0].x),k.push(B[0].y);for(let j=1;j<B.length;j++)this.layoutVertexArray.emplaceBack(B[j].x,B[j].y),this.indexArray2.emplaceBack(G+j-1,G+j),k.push(B[j].x),k.push(B[j].y);O.vertexLength+=B.length,O.primitiveLength+=B.length}const L=ay(k,A);for(let B=0;B<L.length;B+=3)this.indexArray.emplaceBack(T+L[B],T+L[B+1],T+L[B+2]);b.vertexLength+=v,b.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,d)}}let uy,cy;Ke("FillBucket",Lp,{omit:["layers","patternFeatures"]});var O1={get paint(){return cy=cy||new Ti({"fill-antialias":new et(me.paint_fill["fill-antialias"]),"fill-opacity":new lt(me.paint_fill["fill-opacity"]),"fill-color":new lt(me.paint_fill["fill-color"]),"fill-outline-color":new lt(me.paint_fill["fill-outline-color"]),"fill-translate":new et(me.paint_fill["fill-translate"]),"fill-translate-anchor":new et(me.paint_fill["fill-translate-anchor"]),"fill-pattern":new Zs(me.paint_fill["fill-pattern"])})},get layout(){return uy=uy||new Ti({"fill-sort-key":new lt(me.layout_fill["fill-sort-key"])})}};const U1=In([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),N1=In([{name:"a_centroid",components:2,type:"Int16"}],4),{members:V1}=U1;var Jo={},$1=D,hy=el;function el(i,e,r,a,d){this.properties={},this.extent=r,this.type=0,this._pbf=i,this._geometry=-1,this._keys=a,this._values=d,i.readFields(j1,this,e)}function j1(i,e,r){i==1?e.id=r.readVarint():i==2?function(a,d){for(var m=a.readVarint()+a.pos;a.pos<m;){var g=d._keys[a.readVarint()],v=d._values[a.readVarint()];d.properties[g]=v}}(r,e):i==3?e.type=r.readVarint():i==4&&(e._geometry=r.pos)}function q1(i){for(var e,r,a=0,d=0,m=i.length,g=m-1;d<m;g=d++)a+=((r=i[g]).x-(e=i[d]).x)*(e.y+r.y);return a}el.types=["Unknown","Point","LineString","Polygon"],el.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var e,r=i.readVarint()+i.pos,a=1,d=0,m=0,g=0,v=[];i.pos<r;){if(d<=0){var b=i.readVarint();a=7&b,d=b>>3}if(d--,a===1||a===2)m+=i.readSVarint(),g+=i.readSVarint(),a===1&&(e&&v.push(e),e=[]),e.push(new $1(m,g));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&v.push(e),v},el.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var e=i.readVarint()+i.pos,r=1,a=0,d=0,m=0,g=1/0,v=-1/0,b=1/0,T=-1/0;i.pos<e;){if(a<=0){var k=i.readVarint();r=7&k,a=k>>3}if(a--,r===1||r===2)(d+=i.readSVarint())<g&&(g=d),d>v&&(v=d),(m+=i.readSVarint())<b&&(b=m),m>T&&(T=m);else if(r!==7)throw new Error("unknown command "+r)}return[g,b,v,T]},el.prototype.toGeoJSON=function(i,e,r){var a,d,m=this.extent*Math.pow(2,r),g=this.extent*i,v=this.extent*e,b=this.loadGeometry(),T=el.types[this.type];function k(B){for(var O=0;O<B.length;O++){var G=B[O];B[O]=[360*(G.x+g)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(G.y+v)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(a=0;a<b.length;a++)A[a]=b[a][0];k(b=A);break;case 2:for(a=0;a<b.length;a++)k(b[a]);break;case 3:for(b=function(B){var O=B.length;if(O<=1)return[B];for(var G,j,ee=[],ae=0;ae<O;ae++){var J=q1(B[ae]);J!==0&&(j===void 0&&(j=J<0),j===J<0?(G&&ee.push(G),G=[B[ae]]):G.push(B[ae]))}return G&&ee.push(G),ee}(b),a=0;a<b.length;a++)for(d=0;d<b[a].length;d++)k(b[a][d])}b.length===1?b=b[0]:T="Multi"+T;var L={type:"Feature",geometry:{type:T,coordinates:b},properties:this.properties};return"id"in this&&(L.id=this.id),L};var Z1=hy,dy=py;function py(i,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(G1,this,e),this.length=this._features.length}function G1(i,e,r){i===15?e.version=r.readVarint():i===1?e.name=r.readString():i===5?e.extent=r.readVarint():i===2?e._features.push(r.pos):i===3?e._keys.push(r.readString()):i===4&&e._values.push(function(a){for(var d=null,m=a.readVarint()+a.pos;a.pos<m;){var g=a.readVarint()>>3;d=g===1?a.readString():g===2?a.readFloat():g===3?a.readDouble():g===4?a.readVarint64():g===5?a.readVarint():g===6?a.readSVarint():g===7?a.readBoolean():null}return d}(r))}py.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var e=this._pbf.readVarint()+this._pbf.pos;return new Z1(this._pbf,e,this.extent,this._keys,this._values)};var W1=dy;function X1(i,e,r){if(i===3){var a=new W1(r,r.readVarint()+r.pos);a.length&&(e[a.name]=a)}}Jo.VectorTile=function(i,e){this.layers=i.readFields(X1,{},e)},Jo.VectorTileFeature=hy,Jo.VectorTileLayer=dy;const H1=Jo.VectorTileFeature.types,Rp=Math.pow(2,13);function Pu(i,e,r,a,d,m,g,v){i.emplaceBack(e,r,2*Math.floor(a*Rp)+g,d*Rp*2,m*Rp*2,Math.round(v))}class Bp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new H,this.centroidVertexArray=new Z,this.indexArray=new be,this.programConfigurations=new Ur(e.layers,e.zoom),this.segments=new De,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a){this.features=[],this.hasPattern=zp("fill-extrusion",this.layers,r);for(const{feature:d,id:m,index:g,sourceLayerIndex:v}of e){const b=this.layers[0]._featureFilter.needGeometry,T=Hs(d,b);if(!this.layers[0]._featureFilter.filter(new tn(this.zoom),T,a))continue;const k={id:m,sourceLayerIndex:v,index:g,geometry:b?T.geometry:Nr(d),properties:d.properties,type:d.type,patterns:{}};this.hasPattern?this.features.push(Dp("fill-extrusion",this.layers,k,this.zoom,r)):this.addFeature(k,k.geometry,g,a,{}),r.featureIndex.insert(d,k.geometry,g,v,this.index,!0)}}addFeatures(e,r,a){for(const d of this.features){const{geometry:m}=d;this.addFeature(d,m,d.index,r,a)}}update(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,V1),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,N1.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,r,a,d,m){const g={x:0,y:0,vertexCount:0};for(const v of Ap(r,500)){let b=0;for(const O of v)b+=O.length;let T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const O of v){if(O.length===0||Y1(O))continue;let G=0;for(let j=0;j<O.length;j++){const ee=O[j];if(j>=1){const ae=O[j-1];if(!K1(ee,ae)){T.vertexLength+4>De.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const J=ee.sub(ae)._perp()._unit(),ce=ae.dist(ee);G+ce>32768&&(G=0),Pu(this.layoutVertexArray,ee.x,ee.y,J.x,J.y,0,0,G),Pu(this.layoutVertexArray,ee.x,ee.y,J.x,J.y,0,1,G),g.x+=2*ee.x,g.y+=2*ee.y,g.vertexCount+=2,G+=ce,Pu(this.layoutVertexArray,ae.x,ae.y,J.x,J.y,0,0,G),Pu(this.layoutVertexArray,ae.x,ae.y,J.x,J.y,0,1,G),g.x+=2*ae.x,g.y+=2*ae.y,g.vertexCount+=2;const fe=T.vertexLength;this.indexArray.emplaceBack(fe,fe+2,fe+1),this.indexArray.emplaceBack(fe+1,fe+2,fe+3),T.vertexLength+=4,T.primitiveLength+=2}}}}if(T.vertexLength+b>De.MAX_VERTEX_ARRAY_LENGTH&&(T=this.segments.prepareSegment(b,this.layoutVertexArray,this.indexArray)),H1[e.type]!=="Polygon")continue;const k=[],A=[],L=T.vertexLength;for(const O of v)if(O.length!==0){O!==v[0]&&A.push(k.length/2);for(let G=0;G<O.length;G++){const j=O[G];Pu(this.layoutVertexArray,j.x,j.y,0,0,1,1,0),g.x+=j.x,g.y+=j.y,g.vertexCount+=1,k.push(j.x),k.push(j.y)}}const B=ay(k,A);for(let O=0;O<B.length;O+=3)this.indexArray.emplaceBack(L+B[O],L+B[O+2],L+B[O+1]);T.primitiveLength+=B.length/3,T.vertexLength+=b}for(let v=0;v<g.vertexCount;v++)this.centroidVertexArray.emplaceBack(Math.floor(g.x/g.vertexCount),Math.floor(g.y/g.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,d)}}function K1(i,e){return i.x===e.x&&(i.x<0||i.x>nn)||i.y===e.y&&(i.y<0||i.y>nn)}function Y1(i){return i.every(e=>e.x<0)||i.every(e=>e.x>nn)||i.every(e=>e.y<0)||i.every(e=>e.y>nn)}let fy;Ke("FillExtrusionBucket",Bp,{omit:["layers","features"]});var J1={get paint(){return fy=fy||new Ti({"fill-extrusion-opacity":new et(me["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new lt(me["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new et(me["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new et(me["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Zs(me["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new lt(me["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new lt(me["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new et(me["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};function Mu(i,e){return i.x*e.x+i.y*e.y}function my(i,e){if(i.length===1){let r=0;const a=e[r++];let d;for(;!d||a.equals(d);)if(d=e[r++],!d)return 1/0;for(;r<e.length;r++){const m=e[r],g=i[0],v=d.sub(a),b=m.sub(a),T=g.sub(a),k=Mu(v,v),A=Mu(v,b),L=Mu(b,b),B=Mu(T,v),O=Mu(T,b),G=k*L-A*A,j=(L*B-A*O)/G,ee=(k*O-A*B)/G,ae=a.z*(1-j-ee)+d.z*j+m.z*ee;if(isFinite(ae))return ae}return 1/0}{let r=1/0;for(const a of e)r=Math.min(r,a.z);return r}}const Q1=In([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:ew}=Q1,tw=In([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:nw}=tw,iw=Jo.VectorTileFeature.types,rw=Math.cos(Math.PI/180*37.5),gy=Math.pow(2,14)/.5;class Fp{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new Q,this.layoutVertexArray2=new de,this.indexArray=new be,this.programConfigurations=new Ur(e.layers,e.zoom),this.segments=new De,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,a){this.hasPattern=zp("line",this.layers,r);const d=this.layers[0].layout.get("line-sort-key"),m=!d.isConstant(),g=[];for(const{feature:v,id:b,index:T,sourceLayerIndex:k}of e){const A=this.layers[0]._featureFilter.needGeometry,L=Hs(v,A);if(!this.layers[0]._featureFilter.filter(new tn(this.zoom),L,a))continue;const B=m?d.evaluate(L,{},a):void 0,O={id:b,properties:v.properties,type:v.type,sourceLayerIndex:k,index:T,geometry:A?L.geometry:Nr(v),patterns:{},sortKey:B};g.push(O)}m&&g.sort((v,b)=>v.sortKey-b.sortKey);for(const v of g){const{geometry:b,index:T,sourceLayerIndex:k}=v;if(this.hasPattern){const A=Dp("line",this.layers,v,this.zoom,r);this.patternFeatures.push(A)}else this.addFeature(v,b,T,a,{});r.featureIndex.insert(e[T].feature,b,T,k,this.index)}}update(e,r,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,r,this.stateDependentLayers,a)}addFeatures(e,r,a){for(const d of this.patternFeatures)this.addFeature(d,d.geometry,d.index,r,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,nw)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ew),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,a,d,m){const g=this.layers[0].layout,v=g.get("line-join").evaluate(e,{}),b=g.get("line-cap"),T=g.get("line-miter-limit"),k=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const A of r)this.addLine(A,e,v,b,T,k);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,d)}addLine(e,r,a,d,m,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ee=0;ee<e.length-1;ee++)this.totalDistance+=e[ee].dist(e[ee+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=iw[r.type]==="Polygon";let b=e.length;for(;b>=2&&e[b-1].equals(e[b-2]);)b--;let T=0;for(;T<b-1&&e[T].equals(e[T+1]);)T++;if(b<(v?3:2))return;a==="bevel"&&(m=1.05);const k=this.overscaling<=16?122880/(512*this.overscaling):0,A=this.segments.prepareSegment(10*b,this.layoutVertexArray,this.indexArray);let L,B,O,G,j;this.e1=this.e2=-1,v&&(L=e[b-2],j=e[T].sub(L)._unit()._perp());for(let ee=T;ee<b;ee++){if(O=ee===b-1?v?e[T+1]:void 0:e[ee+1],O&&e[ee].equals(O))continue;j&&(G=j),L&&(B=L),L=e[ee],j=O?O.sub(L)._unit()._perp():G,G=G||j;let ae=G.add(j);ae.x===0&&ae.y===0||ae._unit();const J=G.x*j.x+G.y*j.y,ce=ae.x*j.x+ae.y*j.y,fe=ce!==0?1/ce:1/0,_e=2*Math.sqrt(2-2*ce),He=ce<rw&&B&&O,Ye=G.x*j.y-G.y*j.x>0;if(He&&ee>T){const ze=L.dist(B);if(ze>2*k){const Ve=L.sub(L.sub(B)._mult(k/ze)._round());this.updateDistance(B,Ve),this.addCurrentVertex(Ve,G,0,0,A),B=Ve}}const Ne=B&&O;let Be=Ne?a:v?"butt":d;if(Ne&&Be==="round"&&(fe<g?Be="miter":fe<=2&&(Be="fakeround")),Be==="miter"&&fe>m&&(Be="bevel"),Be==="bevel"&&(fe>2&&(Be="flipbevel"),fe<m&&(Be="miter")),B&&this.updateDistance(B,L),Be==="miter")ae._mult(fe),this.addCurrentVertex(L,ae,0,0,A);else if(Be==="flipbevel"){if(fe>100)ae=j.mult(-1);else{const ze=fe*G.add(j).mag()/G.sub(j).mag();ae._perp()._mult(ze*(Ye?-1:1))}this.addCurrentVertex(L,ae,0,0,A),this.addCurrentVertex(L,ae.mult(-1),0,0,A)}else if(Be==="bevel"||Be==="fakeround"){const ze=-Math.sqrt(fe*fe-1),Ve=Ye?ze:0,Oe=Ye?0:ze;if(B&&this.addCurrentVertex(L,G,Ve,Oe,A),Be==="fakeround"){const Te=Math.round(180*_e/Math.PI/20);for(let ot=1;ot<Te;ot++){let Qe=ot/Te;if(Qe!==.5){const Qt=Qe-.5;Qe+=Qe*Qt*(Qe-1)*((1.0904+J*(J*(3.55645-1.43519*J)-3.2452))*Qt*Qt+(.848013+J*(.215638*J-1.06021)))}const St=j.sub(G)._mult(Qe)._add(G)._unit()._mult(Ye?-1:1);this.addHalfVertex(L,St.x,St.y,!1,Ye,0,A)}}O&&this.addCurrentVertex(L,j,-Ve,-Oe,A)}else if(Be==="butt")this.addCurrentVertex(L,ae,0,0,A);else if(Be==="square"){const ze=B?1:-1;this.addCurrentVertex(L,ae,ze,ze,A)}else Be==="round"&&(B&&(this.addCurrentVertex(L,G,0,0,A),this.addCurrentVertex(L,G,1,1,A,!0)),O&&(this.addCurrentVertex(L,j,-1,-1,A,!0),this.addCurrentVertex(L,j,0,0,A)));if(He&&ee<b-1){const ze=L.dist(O);if(ze>2*k){const Ve=L.add(O.sub(L)._mult(k/ze)._round());this.updateDistance(L,Ve),this.addCurrentVertex(Ve,j,0,0,A),L=Ve}}}}addCurrentVertex(e,r,a,d,m,g=!1){const v=r.y*d-r.x,b=-r.y-r.x*d;this.addHalfVertex(e,r.x+r.y*a,r.y-r.x*a,g,!1,a,m),this.addHalfVertex(e,v,b,g,!0,-d,m),this.distance>gy/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,r,a,d,m,g))}addHalfVertex({x:e,y:r},a,d,m,g,v,b){const T=.5*(this.lineClips?this.scaledDistance*(gy-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(r<<1)+(g?1:0),Math.round(63*a)+128,Math.round(63*d)+128,1+(v===0?0:v<0?-1:1)|(63&T)<<2,T>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const k=b.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,k),b.primitiveLength++),g?this.e2=k:this.e1=k}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}let yy,_y;Ke("LineBucket",Fp,{omit:["layers","patternFeatures"]});var vy={get paint(){return _y=_y||new Ti({"line-opacity":new lt(me.paint_line["line-opacity"]),"line-color":new lt(me.paint_line["line-color"]),"line-translate":new et(me.paint_line["line-translate"]),"line-translate-anchor":new et(me.paint_line["line-translate-anchor"]),"line-width":new lt(me.paint_line["line-width"]),"line-gap-width":new lt(me.paint_line["line-gap-width"]),"line-offset":new lt(me.paint_line["line-offset"]),"line-blur":new lt(me.paint_line["line-blur"]),"line-dasharray":new mu(me.paint_line["line-dasharray"]),"line-pattern":new Zs(me.paint_line["line-pattern"]),"line-gradient":new gu(me.paint_line["line-gradient"])})},get layout(){return yy=yy||new Ti({"line-cap":new et(me.layout_line["line-cap"]),"line-join":new lt(me.layout_line["line-join"]),"line-miter-limit":new et(me.layout_line["line-miter-limit"]),"line-round-limit":new et(me.layout_line["line-round-limit"]),"line-sort-key":new lt(me.layout_line["line-sort-key"])})}};class ow extends lt{possiblyEvaluate(e,r){return r=new tn(Math.floor(r.zoom),{now:r.now,fadeDuration:r.fadeDuration,zoomHistory:r.zoomHistory,transition:r.transition}),super.possiblyEvaluate(e,r)}evaluate(e,r,a,d){return r=le({},r,{zoom:Math.floor(r.zoom)}),super.evaluate(e,r,a,d)}}let Sh;function xy(i,e){return e>0?e+2*i:i}const sw=In([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),aw=In([{name:"a_projected_pos",components:3,type:"Float32"}],4);In([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const lw=In([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);In([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const wy=In([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),uw=In([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function cw(i,e,r){return i.sections.forEach(a=>{a.text=function(d,m,g){const v=m.layout.get("text-transform").evaluate(g,{});return v==="uppercase"?d=d.toLocaleUpperCase():v==="lowercase"&&(d=d.toLocaleLowerCase()),Ki.applyArabicShaping&&(d=Ki.applyArabicShaping(d)),d}(a.text,e,r)}),i}In([{name:"triangle",components:3,type:"Uint16"}]),In([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),In([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),In([{type:"Float32",name:"offsetX"}]),In([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const Au={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂"};var Wn=24,by=Xt,Sy=function(i,e,r,a,d){var m,g,v=8*d-a-1,b=(1<<v)-1,T=b>>1,k=-7,A=r?d-1:0,L=r?-1:1,B=i[e+A];for(A+=L,m=B&(1<<-k)-1,B>>=-k,k+=v;k>0;m=256*m+i[e+A],A+=L,k-=8);for(g=m&(1<<-k)-1,m>>=-k,k+=a;k>0;g=256*g+i[e+A],A+=L,k-=8);if(m===0)m=1-T;else{if(m===b)return g?NaN:1/0*(B?-1:1);g+=Math.pow(2,a),m-=T}return(B?-1:1)*g*Math.pow(2,m-a)},Ey=function(i,e,r,a,d,m){var g,v,b,T=8*m-d-1,k=(1<<T)-1,A=k>>1,L=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,B=a?0:m-1,O=a?1:-1,G=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,g=k):(g=Math.floor(Math.log(e)/Math.LN2),e*(b=Math.pow(2,-g))<1&&(g--,b*=2),(e+=g+A>=1?L/b:L*Math.pow(2,1-A))*b>=2&&(g++,b/=2),g+A>=k?(v=0,g=k):g+A>=1?(v=(e*b-1)*Math.pow(2,d),g+=A):(v=e*Math.pow(2,A-1)*Math.pow(2,d),g=0));d>=8;i[r+B]=255&v,B+=O,v/=256,d-=8);for(g=g<<d|v,T+=d;T>0;i[r+B]=255&g,B+=O,g/=256,T-=8);i[r+B-O]|=128*G};function Xt(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Xt.Varint=0,Xt.Fixed64=1,Xt.Bytes=2,Xt.Fixed32=5;var Op=4294967296,Ty=1/Op,Cy=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function So(i){return i.type===Xt.Bytes?i.readVarint()+i.pos:i.pos+1}function tl(i,e,r){return r?4294967296*e+(i>>>0):4294967296*(e>>>0)+(i>>>0)}function Iy(i,e,r){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(a);for(var d=r.pos-1;d>=i;d--)r.buf[d+a]=r.buf[d]}function hw(i,e){for(var r=0;r<i.length;r++)e.writeVarint(i[r])}function dw(i,e){for(var r=0;r<i.length;r++)e.writeSVarint(i[r])}function pw(i,e){for(var r=0;r<i.length;r++)e.writeFloat(i[r])}function fw(i,e){for(var r=0;r<i.length;r++)e.writeDouble(i[r])}function mw(i,e){for(var r=0;r<i.length;r++)e.writeBoolean(i[r])}function gw(i,e){for(var r=0;r<i.length;r++)e.writeFixed32(i[r])}function yw(i,e){for(var r=0;r<i.length;r++)e.writeSFixed32(i[r])}function _w(i,e){for(var r=0;r<i.length;r++)e.writeFixed64(i[r])}function vw(i,e){for(var r=0;r<i.length;r++)e.writeSFixed64(i[r])}function Eh(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+16777216*i[e+3]}function nl(i,e,r){i[r]=e,i[r+1]=e>>>8,i[r+2]=e>>>16,i[r+3]=e>>>24}function ky(i,e){return(i[e]|i[e+1]<<8|i[e+2]<<16)+(i[e+3]<<24)}Xt.prototype={destroy:function(){this.buf=null},readFields:function(i,e,r){for(r=r||this.length;this.pos<r;){var a=this.readVarint(),d=a>>3,m=this.pos;this.type=7&a,i(d,e,this),this.pos===m&&this.skip(a)}return e},readMessage:function(i,e){return this.readFields(i,e,this.readVarint()+this.pos)},readFixed32:function(){var i=Eh(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=ky(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=Eh(this.buf,this.pos)+Eh(this.buf,this.pos+4)*Op;return this.pos+=8,i},readSFixed64:function(){var i=Eh(this.buf,this.pos)+ky(this.buf,this.pos+4)*Op;return this.pos+=8,i},readFloat:function(){var i=Sy(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=Sy(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var e,r,a=this.buf;return e=127&(r=a[this.pos++]),r<128?e:(e|=(127&(r=a[this.pos++]))<<7,r<128?e:(e|=(127&(r=a[this.pos++]))<<14,r<128?e:(e|=(127&(r=a[this.pos++]))<<21,r<128?e:function(d,m,g){var v,b,T=g.buf;if(v=(112&(b=T[g.pos++]))>>4,b<128||(v|=(127&(b=T[g.pos++]))<<3,b<128)||(v|=(127&(b=T[g.pos++]))<<10,b<128)||(v|=(127&(b=T[g.pos++]))<<17,b<128)||(v|=(127&(b=T[g.pos++]))<<24,b<128)||(v|=(1&(b=T[g.pos++]))<<31,b<128))return tl(d,v,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=a[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,e=this.pos;return this.pos=i,i-e>=12&&Cy?function(r,a,d){return Cy.decode(r.subarray(a,d))}(this.buf,e,i):function(r,a,d){for(var m="",g=a;g<d;){var v,b,T,k=r[g],A=null,L=k>239?4:k>223?3:k>191?2:1;if(g+L>d)break;L===1?k<128&&(A=k):L===2?(192&(v=r[g+1]))==128&&(A=(31&k)<<6|63&v)<=127&&(A=null):L===3?(b=r[g+2],(192&(v=r[g+1]))==128&&(192&b)==128&&((A=(15&k)<<12|(63&v)<<6|63&b)<=2047||A>=55296&&A<=57343)&&(A=null)):L===4&&(b=r[g+2],T=r[g+3],(192&(v=r[g+1]))==128&&(192&b)==128&&(192&T)==128&&((A=(15&k)<<18|(63&v)<<12|(63&b)<<6|63&T)<=65535||A>=1114112)&&(A=null)),A===null?(A=65533,L=1):A>65535&&(A-=65536,m+=String.fromCharCode(A>>>10&1023|55296),A=56320|1023&A),m+=String.fromCharCode(A),g+=L}return m}(this.buf,e,i)},readBytes:function(){var i=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,i);return this.pos=i,e},readPackedVarint:function(i,e){if(this.type!==Xt.Bytes)return i.push(this.readVarint(e));var r=So(this);for(i=i||[];this.pos<r;)i.push(this.readVarint(e));return i},readPackedSVarint:function(i){if(this.type!==Xt.Bytes)return i.push(this.readSVarint());var e=So(this);for(i=i||[];this.pos<e;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Xt.Bytes)return i.push(this.readBoolean());var e=So(this);for(i=i||[];this.pos<e;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Xt.Bytes)return i.push(this.readFloat());var e=So(this);for(i=i||[];this.pos<e;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Xt.Bytes)return i.push(this.readDouble());var e=So(this);for(i=i||[];this.pos<e;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Xt.Bytes)return i.push(this.readFixed32());var e=So(this);for(i=i||[];this.pos<e;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Xt.Bytes)return i.push(this.readSFixed32());var e=So(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Xt.Bytes)return i.push(this.readFixed64());var e=So(this);for(i=i||[];this.pos<e;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Xt.Bytes)return i.push(this.readSFixed64());var e=So(this);for(i=i||[];this.pos<e;)i.push(this.readSFixed64());return i},skip:function(i){var e=7&i;if(e===Xt.Varint)for(;this.buf[this.pos++]>127;);else if(e===Xt.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Xt.Fixed32)this.pos+=4;else{if(e!==Xt.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(i,e){this.writeVarint(i<<3|e)},realloc:function(i){for(var e=this.length||16;e<this.pos+i;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),nl(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),nl(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),nl(this.buf,-1&i,this.pos),nl(this.buf,Math.floor(i*Ty),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),nl(this.buf,-1&i,this.pos),nl(this.buf,Math.floor(i*Ty),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?function(e,r){var a,d;if(e>=0?(a=e%4294967296|0,d=e/4294967296|0):(d=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,d=d+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(m,g,v){v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,v.buf[v.pos]=127&(m>>>=7)}(a,0,r),function(m,g){var v=(7&m)<<4;g.buf[g.pos++]|=v|((m>>>=3)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m|((m>>>=7)?128:0),m&&(g.buf[g.pos++]=127&m)))))}(d,r)}(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var e=this.pos;this.pos=function(a,d,m){for(var g,v,b=0;b<d.length;b++){if((g=d.charCodeAt(b))>55295&&g<57344){if(!v){g>56319||b+1===d.length?(a[m++]=239,a[m++]=191,a[m++]=189):v=g;continue}if(g<56320){a[m++]=239,a[m++]=191,a[m++]=189,v=g;continue}g=v-55296<<10|g-56320|65536,v=null}else v&&(a[m++]=239,a[m++]=191,a[m++]=189,v=null);g<128?a[m++]=g:(g<2048?a[m++]=g>>6|192:(g<65536?a[m++]=g>>12|224:(a[m++]=g>>18|240,a[m++]=g>>12&63|128),a[m++]=g>>6&63|128),a[m++]=63&g|128)}return m}(this.buf,i,this.pos);var r=this.pos-e;r>=128&&Iy(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(i){this.realloc(4),Ey(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),Ey(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var e=i.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=i[r]},writeRawMessage:function(i,e){this.pos++;var r=this.pos;i(e,this);var a=this.pos-r;a>=128&&Iy(r,a,this),this.pos=r-1,this.writeVarint(a),this.pos+=a},writeMessage:function(i,e,r){this.writeTag(i,Xt.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(i,e){e.length&&this.writeMessage(i,hw,e)},writePackedSVarint:function(i,e){e.length&&this.writeMessage(i,dw,e)},writePackedBoolean:function(i,e){e.length&&this.writeMessage(i,mw,e)},writePackedFloat:function(i,e){e.length&&this.writeMessage(i,pw,e)},writePackedDouble:function(i,e){e.length&&this.writeMessage(i,fw,e)},writePackedFixed32:function(i,e){e.length&&this.writeMessage(i,gw,e)},writePackedSFixed32:function(i,e){e.length&&this.writeMessage(i,yw,e)},writePackedFixed64:function(i,e){e.length&&this.writeMessage(i,_w,e)},writePackedSFixed64:function(i,e){e.length&&this.writeMessage(i,vw,e)},writeBytesField:function(i,e){this.writeTag(i,Xt.Bytes),this.writeBytes(e)},writeFixed32Field:function(i,e){this.writeTag(i,Xt.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(i,e){this.writeTag(i,Xt.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(i,e){this.writeTag(i,Xt.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(i,e){this.writeTag(i,Xt.Fixed64),this.writeSFixed64(e)},writeVarintField:function(i,e){this.writeTag(i,Xt.Varint),this.writeVarint(e)},writeSVarintField:function(i,e){this.writeTag(i,Xt.Varint),this.writeSVarint(e)},writeStringField:function(i,e){this.writeTag(i,Xt.Bytes),this.writeString(e)},writeFloatField:function(i,e){this.writeTag(i,Xt.Fixed32),this.writeFloat(e)},writeDoubleField:function(i,e){this.writeTag(i,Xt.Fixed64),this.writeDouble(e)},writeBooleanField:function(i,e){this.writeVarintField(i,!!e)}};var Qo,Up=U(by);function xw(i,e,r){i===1&&r.readMessage(ww,e)}function ww(i,e,r){if(i===3){const{id:a,bitmap:d,width:m,height:g,left:v,top:b,advance:T}=r.readMessage(bw,{});e.push({id:a,bitmap:new Eu({width:m+6,height:g+6},d),metrics:{width:m,height:g,left:v,top:b,advance:T}})}}function bw(i,e,r){i===1?e.id=r.readVarint():i===2?e.bitmap=r.readBytes():i===3?e.width=r.readVarint():i===4?e.height=r.readVarint():i===5?e.left=r.readSVarint():i===6?e.top=r.readSVarint():i===7&&(e.advance=r.readVarint())}function Py(i){let e=0,r=0;for(const g of i)e+=g.w*g.h,r=Math.max(r,g.w);i.sort((g,v)=>v.h-g.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let d=0,m=0;for(const g of i)for(let v=a.length-1;v>=0;v--){const b=a[v];if(!(g.w>b.w||g.h>b.h)){if(g.x=b.x,g.y=b.y,m=Math.max(m,g.y+g.h),d=Math.max(d,g.x+g.w),g.w===b.w&&g.h===b.h){const T=a.pop();v<a.length&&(a[v]=T)}else g.h===b.h?(b.x+=g.w,b.w-=g.w):g.w===b.w?(b.y+=g.h,b.h-=g.h):(a.push({x:b.x+g.w,y:b.y,w:b.w-g.w,h:g.h}),b.y+=g.h,b.h-=g.h);break}}return{w:d,h:m,fill:e/(d*m)||0}}class Np{constructor(e,{pixelRatio:r,version:a,stretchX:d,stretchY:m,content:g}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=d,this.stretchY=m,this.content=g,this.version=a}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class My{constructor(e,r){const a={},d={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,a,m),this.addImages(r,d,m);const{w:g,h:v}=Py(m),b=new lr({width:g||1,height:v||1});for(const T in e){const k=e[T],A=a[T].paddedRect;lr.copy(k.data,b,{x:0,y:0},{x:A.x+1,y:A.y+1},k.data)}for(const T in r){const k=r[T],A=d[T].paddedRect,L=A.x+1,B=A.y+1,O=k.data.width,G=k.data.height;lr.copy(k.data,b,{x:0,y:0},{x:L,y:B},k.data),lr.copy(k.data,b,{x:0,y:G-1},{x:L,y:B-1},{width:O,height:1}),lr.copy(k.data,b,{x:0,y:0},{x:L,y:B+G},{width:O,height:1}),lr.copy(k.data,b,{x:O-1,y:0},{x:L-1,y:B},{width:1,height:G}),lr.copy(k.data,b,{x:0,y:0},{x:L+O,y:B},{width:1,height:G})}this.image=b,this.iconPositions=a,this.patternPositions=d}addImages(e,r,a){for(const d in e){const m=e[d],g={x:0,y:0,w:m.data.width+2,h:m.data.height+2};a.push(g),r[d]=new Np(g,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(e,r){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),r),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),r)}patchUpdatedImage(e,r,a){if(!e||!r||e.version===r.version)return;e.version=r.version;const[d,m]=e.tl;a.update(r.data,void 0,{x:d,y:m})}}Ke("ImagePosition",Np),Ke("ImageAtlas",My),u.WritingMode=void 0,(Qo=u.WritingMode||(u.WritingMode={}))[Qo.none=0]="none",Qo[Qo.horizontal=1]="horizontal",Qo[Qo.vertical=2]="vertical",Qo[Qo.horizontalOnly=3]="horizontalOnly";const Th=-17;class zu{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const a=new zu;return a.scale=e||1,a.fontStack=r,a}static forImage(e){const r=new zu;return r.imageName=e,r}}class il{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const a=new il;for(let d=0;d<e.sections.length;d++){const m=e.sections[d];m.image?a.addImageSection(m):a.addTextSection(m,r)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let r="";for(let a=0;a<e.length;a++){const d=e.charCodeAt(a+1)||null,m=e.charCodeAt(a-1)||null;r+=d&&ah(d)&&!Au[e[a+1]]||m&&ah(m)&&!Au[e[a-1]]||!Au[e[a]]?e[a]:Au[e[a]]}return r}(this.text)}trim(){let e=0;for(let a=0;a<this.text.length&&Ih[this.text.charCodeAt(a)];a++)e++;let r=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&Ih[this.text.charCodeAt(a)];a--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const a=new il;return a.text=this.text.substring(e,r),a.sectionIndex=this.sectionIndex.slice(e,r),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(zu.forText(e.scale,e.fontStack||r));const a=this.sections.length-1;for(let d=0;d<e.text.length;++d)this.sectionIndex.push(a)}addImageSection(e){const r=e.image?e.image.name:"";if(r.length===0)return void st("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(zu.forImage(r)),this.sectionIndex.push(this.sections.length-1)):st("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ch(i,e,r,a,d,m,g,v,b,T,k,A,L,B,O,G){const j=il.fromFeature(i,d);let ee;A===u.WritingMode.vertical&&j.verticalizePunctuation();const{processBidirectionalText:ae,processStyledBidirectionalText:J}=Ki;if(ae&&j.sections.length===1){ee=[];const _e=ae(j.toString(),Vp(j,T,m,e,a,B,O));for(const He of _e){const Ye=new il;Ye.text=He,Ye.sections=j.sections;for(let Ne=0;Ne<He.length;Ne++)Ye.sectionIndex.push(0);ee.push(Ye)}}else if(J){ee=[];const _e=J(j.text,j.sectionIndex,Vp(j,T,m,e,a,B,O));for(const He of _e){const Ye=new il;Ye.text=He[0],Ye.sectionIndex=He[1],Ye.sections=j.sections,ee.push(Ye)}}else ee=function(_e,He){const Ye=[],Ne=_e.text;let Be=0;for(const ze of He)Ye.push(_e.substring(Be,ze)),Be=ze;return Be<Ne.length&&Ye.push(_e.substring(Be,Ne.length)),Ye}(j,Vp(j,T,m,e,a,B,O));const ce=[],fe={positionedLines:ce,text:j.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:A,iconsInText:!1,verticalizable:!1};return function(_e,He,Ye,Ne,Be,ze,Ve,Oe,Te,ot,Qe,St){let Qt=0,rn=Th,Dn=0,cr=0;const Qn=Oe==="right"?1:Oe==="left"?0:.5;let kn=0;for(const Pn of Be){Pn.trim();const ti=Pn.getMaxScale(),ci=(ti-1)*Wn,Ii={positionedGlyphs:[],lineOffset:0};_e.positionedLines[kn]=Ii;const Ui=Ii.positionedGlyphs;let Ni=0;if(!Pn.length()){rn+=ze,++kn;continue}for(let ni=0;ni<Pn.length();ni++){const Et=Pn.getSection(ni),Yi=Pn.getSectionIndex(ni),ii=Pn.getCharCode(ni);let hi=0,Cr=null,Vr=null,$r=null,To=Wn;const Ir=!(Te===u.WritingMode.horizontal||!Qe&&!La(ii)||Qe&&(Ih[ii]||($n=ii,Ue.Arabic($n)||Ue["Arabic Supplement"]($n)||Ue["Arabic Extended-A"]($n)||Ue["Arabic Presentation Forms-A"]($n)||Ue["Arabic Presentation Forms-B"]($n))));if(Et.imageName){const hr=Ne[Et.imageName];if(!hr)continue;$r=Et.imageName,_e.iconsInText=_e.iconsInText||!0,Vr=hr.paddedRect;const Vi=hr.displaySize;Et.scale=Et.scale*Wn/St,Cr={width:Vi[0],height:Vi[1],left:1,top:-3,advance:Ir?Vi[1]:Vi[0]},hi=ci+(Wn-Vi[1]*Et.scale),To=Cr.advance;const Co=Ir?Vi[0]*Et.scale-Wn*ti:Vi[1]*Et.scale-Wn*ti;Co>0&&Co>Ni&&(Ni=Co)}else{const hr=Ye[Et.fontStack],Vi=hr&&hr[ii];if(Vi&&Vi.rect)Vr=Vi.rect,Cr=Vi.metrics;else{const Co=He[Et.fontStack],Bu=Co&&Co[ii];if(!Bu)continue;Cr=Bu.metrics}hi=(ti-Et.scale)*Wn}Ir?(_e.verticalizable=!0,Ui.push({glyph:ii,imageName:$r,x:Qt,y:rn+hi,vertical:Ir,scale:Et.scale,fontStack:Et.fontStack,sectionIndex:Yi,metrics:Cr,rect:Vr}),Qt+=To*Et.scale+ot):(Ui.push({glyph:ii,imageName:$r,x:Qt,y:rn+hi,vertical:Ir,scale:Et.scale,fontStack:Et.fontStack,sectionIndex:Yi,metrics:Cr,rect:Vr}),Qt+=Cr.advance*Et.scale+ot)}Ui.length!==0&&(Dn=Math.max(Qt-ot,Dn),Tw(Ui,0,Ui.length-1,Qn,Ni)),Qt=0;const fn=ze*ti+Ni;Ii.lineOffset=Math.max(Ni,ci),rn+=fn,cr=Math.max(fn,cr),++kn}var $n;const ei=rn-Th,{horizontalAlign:ui,verticalAlign:Oi}=$p(Ve);(function(Pn,ti,ci,Ii,Ui,Ni,fn,ni,Et){const Yi=(ti-ci)*Ui;let ii=0;ii=Ni!==fn?-ni*Ii-Th:(-Ii*Et+.5)*fn;for(const hi of Pn)for(const Cr of hi.positionedGlyphs)Cr.x+=Yi,Cr.y+=ii})(_e.positionedLines,Qn,ui,Oi,Dn,cr,ze,ei,Be.length),_e.top+=-Oi*ei,_e.bottom=_e.top+ei,_e.left+=-ui*Dn,_e.right=_e.left+Dn}(fe,e,r,a,ee,g,v,b,A,T,L,G),!function(_e){for(const He of _e)if(He.positionedGlyphs.length!==0)return!1;return!0}(ce)&&fe}const Ih={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Sw={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ay(i,e,r,a,d,m){if(e.imageName){const g=a[e.imageName];return g?g.displaySize[0]*e.scale*Wn/m+d:0}{const g=r[e.fontStack],v=g&&g[i];return v?v.metrics.advance*e.scale+d:0}}function zy(i,e,r,a){const d=Math.pow(i-e,2);return a?i<e?d/2:2*d:d+Math.abs(r)*r}function Ew(i,e,r){let a=0;return i===10&&(a-=1e4),r&&(a+=150),i!==40&&i!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function Dy(i,e,r,a,d,m){let g=null,v=zy(e,r,d,m);for(const b of a){const T=zy(e-b.x,r,d,m)+b.badness;T<=v&&(g=b,v=T)}return{index:i,x:e,priorBreak:g,badness:v}}function Ly(i){return i?Ly(i.priorBreak).concat(i.index):[]}function Vp(i,e,r,a,d,m,g){if(m!=="point")return[];if(!i)return[];const v=[],b=function(L,B,O,G,j,ee){let ae=0;for(let J=0;J<L.length();J++){const ce=L.getSection(J);ae+=Ay(L.getCharCode(J),ce,G,j,B,ee)}return ae/Math.max(1,Math.ceil(ae/O))}(i,e,r,a,d,g),T=i.text.indexOf("​")>=0;let k=0;for(let L=0;L<i.length();L++){const B=i.getSection(L),O=i.getCharCode(L);if(Ih[O]||(k+=Ay(O,B,a,d,e,g)),L<i.length()-1){const G=!((A=O)<11904||!(Ue["Bopomofo Extended"](A)||Ue.Bopomofo(A)||Ue["CJK Compatibility Forms"](A)||Ue["CJK Compatibility Ideographs"](A)||Ue["CJK Compatibility"](A)||Ue["CJK Radicals Supplement"](A)||Ue["CJK Strokes"](A)||Ue["CJK Symbols and Punctuation"](A)||Ue["CJK Unified Ideographs Extension A"](A)||Ue["CJK Unified Ideographs"](A)||Ue["Enclosed CJK Letters and Months"](A)||Ue["Halfwidth and Fullwidth Forms"](A)||Ue.Hiragana(A)||Ue["Ideographic Description Characters"](A)||Ue["Kangxi Radicals"](A)||Ue["Katakana Phonetic Extensions"](A)||Ue.Katakana(A)||Ue["Vertical Forms"](A)||Ue["Yi Radicals"](A)||Ue["Yi Syllables"](A)));(Sw[O]||G||B.imageName)&&v.push(Dy(L+1,k,b,v,Ew(O,i.getCharCode(L+1),G&&T),!1))}}var A;return Ly(Dy(i.length(),k,b,v,0,!0))}function $p(i){let e=.5,r=.5;switch(i){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function Tw(i,e,r,a,d){if(!a&&!d)return;const m=i[r],g=(i[r].x+m.metrics.advance*m.scale)*a;for(let v=e;v<=r;v++)i[v].x-=g,i[v].y+=d}function Cw(i,e,r){const{horizontalAlign:a,verticalAlign:d}=$p(r),m=e[0]-i.displaySize[0]*a,g=e[1]-i.displaySize[1]*d;return{image:i,top:g,bottom:g+i.displaySize[1],left:m,right:m+i.displaySize[0]}}function Ry(i,e,r,a,d,m){const g=i.image;let v;if(g.content){const j=g.content,ee=g.pixelRatio||1;v=[j[0]/ee,j[1]/ee,g.displaySize[0]-j[2]/ee,g.displaySize[1]-j[3]/ee]}const b=e.left*m,T=e.right*m;let k,A,L,B;r==="width"||r==="both"?(B=d[0]+b-a[3],A=d[0]+T+a[1]):(B=d[0]+(b+T-g.displaySize[0])/2,A=B+g.displaySize[0]);const O=e.top*m,G=e.bottom*m;return r==="height"||r==="both"?(k=d[1]+O-a[0],L=d[1]+G+a[2]):(k=d[1]+(O+G-g.displaySize[1])/2,L=k+g.displaySize[1]),{image:g,top:k,right:A,bottom:L,left:B,collisionPadding:v}}const Eo=128,es=32640;function By(i,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new tn(i+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:d}=r;let m=0;for(;m<a.length&&a[m]<=i;)m++;m=Math.max(0,m-1);let g=m;for(;g<a.length&&a[g]<i+1;)g++;g=Math.min(a.length-1,g);const v=a[m],b=a[g];return r.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:b,interpolationType:d}:{kind:"camera",minZoom:v,maxZoom:b,minSize:r.evaluate(new tn(v)),maxSize:r.evaluate(new tn(b)),interpolationType:d}}}function jp(i,e,r){let a="never";const d=i.get(e);return d?a=d:i.get(r)&&(a="always"),a}const Iw=Jo.VectorTileFeature.types,kw=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function kh(i,e,r,a,d,m,g,v,b,T,k,A,L){const B=v?Math.min(es,Math.round(v[0])):0,O=v?Math.min(es,Math.round(v[1])):0;i.emplaceBack(e,r,Math.round(32*a),Math.round(32*d),m,g,(B<<1)+(b?1:0),O,16*T,16*k,256*A,256*L)}function qp(i,e,r){i.emplaceBack(e.x,e.y,r),i.emplaceBack(e.x,e.y,r),i.emplaceBack(e.x,e.y,r),i.emplaceBack(e.x,e.y,r)}function Pw(i){for(const e of i.sections)if(lh(e.text))return!0;return!1}class Zp{constructor(e){this.layoutVertexArray=new he,this.indexArray=new be,this.programConfigurations=e,this.segments=new De,this.dynamicLayoutVertexArray=new ge,this.opacityVertexArray=new we,this.hasVisibleVertices=!1,this.placedSymbolArray=new x}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,r,a,d){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sw.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,aw.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,kw,!0),this.opacityVertexBuffer.itemSize=1),(a||d)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ke("SymbolBuffers",Zp);class Gp{constructor(e,r,a){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new a,this.segments=new De,this.collisionVertexArray=new Ie}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,lw.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ke("CollisionBuffers",Gp);class rl{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(g=>g.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ep([]),this.placementViewportMatrix=Ep([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=By(this.zoom,r["text-size"]),this.iconSizeData=By(this.zoom,r["icon-size"]);const a=this.layers[0].layout,d=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=jp(a,"text-overlap","text-allow-overlap")!=="never"||jp(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!d.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(g=>u.WritingMode[g])),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=e.sourceID}createArrays(){this.text=new Zp(new Ur(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Zp(new Ur(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new C,this.lineVertexArray=new M,this.symbolInstances=new S}calculateGlyphDependencies(e,r,a,d,m){for(let g=0;g<e.length;g++)if(r[e.charCodeAt(g)]=!0,(a||d)&&m){const v=Au[e.charAt(g)];v&&(r[v.charCodeAt(0)]=!0)}}populate(e,r,a){const d=this.layers[0],m=d.layout,g=m.get("text-font"),v=m.get("text-field"),b=m.get("icon-image"),T=(v.value.kind!=="constant"||v.value.value instanceof Li&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),k=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,A=m.get("symbol-sort-key");if(this.features=[],!T&&!k)return;const L=r.iconDependencies,B=r.glyphDependencies,O=r.availableImages,G=new tn(this.zoom);for(const{feature:j,id:ee,index:ae,sourceLayerIndex:J}of e){const ce=d._featureFilter.needGeometry,fe=Hs(j,ce);if(!d._featureFilter.filter(G,fe,a))continue;let _e,He;if(ce||(fe.geometry=Nr(j)),T){const Ne=d.getValueAndResolveTokens("text-field",fe,a,O),Be=Li.factory(Ne);Pw(Be)&&(this.hasRTLText=!0),(!this.hasRTLText||du()==="unavailable"||this.hasRTLText&&Ki.isParsed())&&(_e=cw(Be,d,fe))}if(k){const Ne=d.getValueAndResolveTokens("icon-image",fe,a,O);He=Ne instanceof Yn?Ne:Yn.fromString(Ne)}if(!_e&&!He)continue;const Ye=this.sortFeaturesByKey?A.evaluate(fe,{},a):void 0;if(this.features.push({id:ee,text:_e,icon:He,index:ae,sourceLayerIndex:J,geometry:fe.geometry,properties:j.properties,type:Iw[j.type],sortKey:Ye}),He&&(L[He.name]=!0),_e){const Ne=g.evaluate(fe,{},a).join(","),Be=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.WritingMode.vertical)>=0;for(const ze of _e.sections)if(ze.image)L[ze.image.name]=!0;else{const Ve=Da(_e.toString()),Oe=ze.fontStack||Ne,Te=B[Oe]=B[Oe]||{};this.calculateGlyphDependencies(ze.text,Te,Be,this.allowVerticalPlacement,Ve)}}}m.get("symbol-placement")==="line"&&(this.features=function(j){const ee={},ae={},J=[];let ce=0;function fe(Ne){J.push(j[Ne]),ce++}function _e(Ne,Be,ze){const Ve=ae[Ne];return delete ae[Ne],ae[Be]=Ve,J[Ve].geometry[0].pop(),J[Ve].geometry[0]=J[Ve].geometry[0].concat(ze[0]),Ve}function He(Ne,Be,ze){const Ve=ee[Be];return delete ee[Be],ee[Ne]=Ve,J[Ve].geometry[0].shift(),J[Ve].geometry[0]=ze[0].concat(J[Ve].geometry[0]),Ve}function Ye(Ne,Be,ze){const Ve=ze?Be[0][Be[0].length-1]:Be[0][0];return`${Ne}:${Ve.x}:${Ve.y}`}for(let Ne=0;Ne<j.length;Ne++){const Be=j[Ne],ze=Be.geometry,Ve=Be.text?Be.text.toString():null;if(!Ve){fe(Ne);continue}const Oe=Ye(Ve,ze),Te=Ye(Ve,ze,!0);if(Oe in ae&&Te in ee&&ae[Oe]!==ee[Te]){const ot=He(Oe,Te,ze),Qe=_e(Oe,Te,J[ot].geometry);delete ee[Oe],delete ae[Te],ae[Ye(Ve,J[Qe].geometry,!0)]=Qe,J[ot].geometry=null}else Oe in ae?_e(Oe,Te,ze):Te in ee?He(Oe,Te,ze):(fe(Ne),ee[Oe]=ce-1,ae[Te]=ce-1)}return J.filter(Ne=>Ne.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((j,ee)=>j.sortKey-ee.sortKey)}update(e,r,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,r,this.layers,a),this.icon.programConfigurations.updatePaintArrays(e,r,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const a=this.lineVertexArray.length;if(e.segment!==void 0){let d=e.dist(r[e.segment+1]),m=e.dist(r[e.segment]);const g={};for(let v=e.segment+1;v<r.length;v++)g[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:d},v<r.length-1&&(d+=r[v+1].dist(r[v]));for(let v=e.segment||0;v>=0;v--)g[v]={x:r[v].x,y:r[v].y,tileUnitDistanceFromAnchor:m},v>0&&(m+=r[v-1].dist(r[v]));for(let v=0;v<r.length;v++){const b=g[v];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,r,a,d,m,g,v,b,T,k,A,L){const B=e.indexArray,O=e.layoutVertexArray,G=e.segments.prepareSegment(4*r.length,O,B,this.canOverlap?g.sortKey:void 0),j=this.glyphOffsetArray.length,ee=G.vertexLength,ae=this.allowVerticalPlacement&&v===u.WritingMode.vertical?Math.PI/2:0,J=g.text&&g.text.sections;for(let ce=0;ce<r.length;ce++){const{tl:fe,tr:_e,bl:He,br:Ye,tex:Ne,pixelOffsetTL:Be,pixelOffsetBR:ze,minFontScaleX:Ve,minFontScaleY:Oe,glyphOffset:Te,isSDF:ot,sectionIndex:Qe}=r[ce],St=G.vertexLength,Qt=Te[1];kh(O,b.x,b.y,fe.x,Qt+fe.y,Ne.x,Ne.y,a,ot,Be.x,Be.y,Ve,Oe),kh(O,b.x,b.y,_e.x,Qt+_e.y,Ne.x+Ne.w,Ne.y,a,ot,ze.x,Be.y,Ve,Oe),kh(O,b.x,b.y,He.x,Qt+He.y,Ne.x,Ne.y+Ne.h,a,ot,Be.x,ze.y,Ve,Oe),kh(O,b.x,b.y,Ye.x,Qt+Ye.y,Ne.x+Ne.w,Ne.y+Ne.h,a,ot,ze.x,ze.y,Ve,Oe),qp(e.dynamicLayoutVertexArray,b,ae),B.emplaceBack(St,St+1,St+2),B.emplaceBack(St+1,St+2,St+3),G.vertexLength+=4,G.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Te[0]),ce!==r.length-1&&Qe===r[ce+1].sectionIndex||e.programConfigurations.populatePaintArrays(O.length,g,g.index,{},L,J&&J[Qe])}e.placedSymbolArray.emplaceBack(b.x,b.y,j,this.glyphOffsetArray.length-j,ee,T,k,b.segment,a?a[0]:0,a?a[1]:0,d[0],d[1],v,0,!1,0,A)}_addCollisionDebugVertex(e,r,a,d,m,g){return r.emplaceBack(0,0),e.emplaceBack(a.x,a.y,d,m,Math.round(g.x),Math.round(g.y))}addCollisionDebugVertices(e,r,a,d,m,g,v){const b=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),T=b.vertexLength,k=m.layoutVertexArray,A=m.collisionVertexArray,L=v.anchorX,B=v.anchorY;this._addCollisionDebugVertex(k,A,g,L,B,new ie(e,r)),this._addCollisionDebugVertex(k,A,g,L,B,new ie(a,r)),this._addCollisionDebugVertex(k,A,g,L,B,new ie(a,d)),this._addCollisionDebugVertex(k,A,g,L,B,new ie(e,d)),b.vertexLength+=4;const O=m.indexArray;O.emplaceBack(T,T+1),O.emplaceBack(T+1,T+2),O.emplaceBack(T+2,T+3),O.emplaceBack(T+3,T),b.primitiveLength+=4}addDebugCollisionBoxes(e,r,a,d){for(let m=e;m<r;m++){const g=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,d?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Gp(Se,wy.members,je),this.iconCollisionBox=new Gp(Se,wy.members,je);for(let e=0;e<this.symbolInstances.length;e++){const r=this.symbolInstances.get(e);this.addDebugCollisionBoxes(r.textBoxStartIndex,r.textBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r,!0),this.addDebugCollisionBoxes(r.iconBoxStartIndex,r.iconBoxEndIndex,r,!1),this.addDebugCollisionBoxes(r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex,r,!1)}}_deserializeCollisionBoxesForSymbol(e,r,a,d,m,g,v,b,T){const k={};for(let A=r;A<a;A++){const L=e.get(A);k.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},k.textFeatureIndex=L.featureIndex;break}for(let A=d;A<m;A++){const L=e.get(A);k.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},k.verticalTextFeatureIndex=L.featureIndex;break}for(let A=g;A<v;A++){const L=e.get(A);k.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},k.iconFeatureIndex=L.featureIndex;break}for(let A=b;A<T;A++){const L=e.get(A);k.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},k.verticalIconFeatureIndex=L.featureIndex;break}return k}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const a=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,r){const a=e.placedSymbolArray.get(r),d=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<d;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),a=Math.cos(e),d=[],m=[],g=[];for(let v=0;v<this.symbolInstances.length;++v){g.push(v);const b=this.symbolInstances.get(v);d.push(0|Math.round(r*b.anchorX+a*b.anchorY)),m.push(b.featureIndex)}return g.sort((v,b)=>d[v]-d[b]||m[b]-m[v]),g}addToSortKeyRanges(e,r){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===r?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const a=this.symbolInstances.get(r);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((d,m,g)=>{d>=0&&g.indexOf(d)===m&&this.addIndicesForPlacedSymbol(this.text,d)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let Fy,Oy;Ke("SymbolBucket",rl,{omit:["layers","collisionBoxArray","features","compareText"]}),rl.MAX_GLYPHS=65535,rl.addDynamicAttributes=qp;var Wp={get paint(){return Oy=Oy||new Ti({"icon-opacity":new lt(me.paint_symbol["icon-opacity"]),"icon-color":new lt(me.paint_symbol["icon-color"]),"icon-halo-color":new lt(me.paint_symbol["icon-halo-color"]),"icon-halo-width":new lt(me.paint_symbol["icon-halo-width"]),"icon-halo-blur":new lt(me.paint_symbol["icon-halo-blur"]),"icon-translate":new et(me.paint_symbol["icon-translate"]),"icon-translate-anchor":new et(me.paint_symbol["icon-translate-anchor"]),"text-opacity":new lt(me.paint_symbol["text-opacity"]),"text-color":new lt(me.paint_symbol["text-color"],{runtimeType:Fn,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new lt(me.paint_symbol["text-halo-color"]),"text-halo-width":new lt(me.paint_symbol["text-halo-width"]),"text-halo-blur":new lt(me.paint_symbol["text-halo-blur"]),"text-translate":new et(me.paint_symbol["text-translate"]),"text-translate-anchor":new et(me.paint_symbol["text-translate-anchor"])})},get layout(){return Fy=Fy||new Ti({"symbol-placement":new et(me.layout_symbol["symbol-placement"]),"symbol-spacing":new et(me.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new et(me.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new lt(me.layout_symbol["symbol-sort-key"]),"symbol-z-order":new et(me.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new et(me.layout_symbol["icon-allow-overlap"]),"icon-overlap":new et(me.layout_symbol["icon-overlap"]),"icon-ignore-placement":new et(me.layout_symbol["icon-ignore-placement"]),"icon-optional":new et(me.layout_symbol["icon-optional"]),"icon-rotation-alignment":new et(me.layout_symbol["icon-rotation-alignment"]),"icon-size":new lt(me.layout_symbol["icon-size"]),"icon-text-fit":new et(me.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new et(me.layout_symbol["icon-text-fit-padding"]),"icon-image":new lt(me.layout_symbol["icon-image"]),"icon-rotate":new lt(me.layout_symbol["icon-rotate"]),"icon-padding":new lt(me.layout_symbol["icon-padding"]),"icon-keep-upright":new et(me.layout_symbol["icon-keep-upright"]),"icon-offset":new lt(me.layout_symbol["icon-offset"]),"icon-anchor":new lt(me.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new et(me.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new et(me.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new et(me.layout_symbol["text-rotation-alignment"]),"text-field":new lt(me.layout_symbol["text-field"]),"text-font":new lt(me.layout_symbol["text-font"]),"text-size":new lt(me.layout_symbol["text-size"]),"text-max-width":new lt(me.layout_symbol["text-max-width"]),"text-line-height":new et(me.layout_symbol["text-line-height"]),"text-letter-spacing":new lt(me.layout_symbol["text-letter-spacing"]),"text-justify":new lt(me.layout_symbol["text-justify"]),"text-radial-offset":new lt(me.layout_symbol["text-radial-offset"]),"text-variable-anchor":new et(me.layout_symbol["text-variable-anchor"]),"text-anchor":new lt(me.layout_symbol["text-anchor"]),"text-max-angle":new et(me.layout_symbol["text-max-angle"]),"text-writing-mode":new et(me.layout_symbol["text-writing-mode"]),"text-rotate":new lt(me.layout_symbol["text-rotate"]),"text-padding":new et(me.layout_symbol["text-padding"]),"text-keep-upright":new et(me.layout_symbol["text-keep-upright"]),"text-transform":new lt(me.layout_symbol["text-transform"]),"text-offset":new lt(me.layout_symbol["text-offset"]),"text-allow-overlap":new et(me.layout_symbol["text-allow-overlap"]),"text-overlap":new et(me.layout_symbol["text-overlap"]),"text-ignore-placement":new et(me.layout_symbol["text-ignore-placement"]),"text-optional":new et(me.layout_symbol["text-optional"])})}};class Uy{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Rr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ke("FormatSectionOverride",Uy,{omit:["defaultValue"]});class Ph extends Sr{constructor(e){super(e,Wp)}recalculate(e,r){if(super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const d=[];for(const m of a)d.indexOf(m)<0&&d.push(m);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,r,a,d){const m=this.layout.get(e).evaluate(r,{},a,d),g=this._unevaluatedLayout._values[e];return g.isDataDriven()||Ta(g.value)||!m?m:function(v,b){return b.replace(/{([^{}]+)}/g,(T,k)=>k in v?String(v[k]):"")}(r.properties,m)}createBucket(e){return new rl(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Wp.paint.overridableProperties){if(!Ph.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),a=new Uy(r),d=new eu(a,r.property.specification);let m=null;m=r.value.kind==="constant"||r.value.kind==="source"?new tu("source",d):new Tt("composite",d,r.value.zoomStops),this.paint._values[e]=new br(r.property,m,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,a){return!(!this.layout||r.isDataDriven()||a.isDataDriven())&&Ph.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const a=e.get("text-field"),d=Wp.paint.properties[r];let m=!1;const g=v=>{for(const b of v)if(d.overrides&&d.overrides.hasOverride(b))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Li)g(a.value.value.sections);else if(a.value.kind==="source"){const v=T=>{m||(T instanceof mo&&sn(T.value)===eo?g(T.value.sections):T instanceof Sa?g(T.sections):T.eachChild(v))},b=a.value;b._styleExpression&&v(b._styleExpression.expression)}return m}}let Ny;var Mw={get paint(){return Ny=Ny||new Ti({"background-color":new et(me.paint_background["background-color"]),"background-pattern":new mu(me.paint_background["background-pattern"]),"background-opacity":new et(me.paint_background["background-opacity"])})}};let Vy;var Aw={get paint(){return Vy=Vy||new Ti({"raster-opacity":new et(me.paint_raster["raster-opacity"]),"raster-hue-rotate":new et(me.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new et(me.paint_raster["raster-brightness-min"]),"raster-brightness-max":new et(me.paint_raster["raster-brightness-max"]),"raster-saturation":new et(me.paint_raster["raster-saturation"]),"raster-contrast":new et(me.paint_raster["raster-contrast"]),"raster-resampling":new et(me.paint_raster["raster-resampling"]),"raster-fade-duration":new et(me.paint_raster["raster-fade-duration"])})}};class zw extends Sr{constructor(e){super(e,{}),this.onAdd=r=>{this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},this.onRemove=r=>{this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}const Dw={circle:class extends Sr{constructor(i){super(i,x1)}createBucket(i){return new wp(i)}queryRadius(i){const e=i;return bu("circle-radius",this,e)+bu("circle-stroke-width",this,e)+gh(this.paint.get("circle-translate"))}queryIntersectsFeature(i,e,r,a,d,m,g,v){const b=yh(i,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,g),T=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r),k=this.paint.get("circle-pitch-alignment")==="map",A=k?b:function(B,O){return B.map(G=>Yg(G,O))}(b,v),L=k?T*g:T;for(const B of a)for(const O of B){const G=k?O:Yg(O,v);let j=L;const ee=_h([],[O.x,O.y,0,1],v);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?j*=ee[3]/m.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(j*=m.cameraToCenterDistance/ee[3]),g1(A,G,j))return!0}return!1}},heatmap:class extends Sr{createBucket(i){return new Jg(i)}constructor(i){super(i,b1),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ty({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}},hillshade:class extends Sr{constructor(i){super(i,S1)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}},fill:class extends Sr{constructor(i){super(i,O1)}recalculate(i,e){super.recalculate(i,e);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new Lp(i)}queryRadius(){return gh(this.paint.get("fill-translate"))}queryIntersectsFeature(i,e,r,a,d,m,g){return Zg(yh(i,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,g),a)}isTileClipped(){return!0}},"fill-extrusion":class extends Sr{constructor(i){super(i,J1)}createBucket(i){return new Bp(i)}queryRadius(){return gh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(i,e,r,a,d,m,g,v){const b=yh(i,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,g),T=this.paint.get("fill-extrusion-height").evaluate(e,r),k=this.paint.get("fill-extrusion-base").evaluate(e,r),A=function(B,O,G,j){const ee=[];for(const ae of B){const J=[ae.x,ae.y,0,1];_h(J,J,O),ee.push(new ie(J[0]/J[3],J[1]/J[3]))}return ee}(b,v),L=function(B,O,G,j){const ee=[],ae=[],J=j[8]*O,ce=j[9]*O,fe=j[10]*O,_e=j[11]*O,He=j[8]*G,Ye=j[9]*G,Ne=j[10]*G,Be=j[11]*G;for(const ze of B){const Ve=[],Oe=[];for(const Te of ze){const ot=Te.x,Qe=Te.y,St=j[0]*ot+j[4]*Qe+j[12],Qt=j[1]*ot+j[5]*Qe+j[13],rn=j[2]*ot+j[6]*Qe+j[14],Dn=j[3]*ot+j[7]*Qe+j[15],cr=rn+fe,Qn=Dn+_e,kn=St+He,$n=Qt+Ye,ei=rn+Ne,ui=Dn+Be,Oi=new ie((St+J)/Qn,(Qt+ce)/Qn);Oi.z=cr/Qn,Ve.push(Oi);const Pn=new ie(kn/ui,$n/ui);Pn.z=ei/ui,Oe.push(Pn)}ee.push(Ve),ae.push(Oe)}return[ee,ae]}(a,k,T,v);return function(B,O,G){let j=1/0;Zg(G,O)&&(j=my(G,O[0]));for(let ee=0;ee<O.length;ee++){const ae=O[ee],J=B[ee];for(let ce=0;ce<ae.length-1;ce++){const fe=ae[ce],_e=[fe,ae[ce+1],J[ce+1],J[ce],fe];qg(G,_e)&&(j=Math.min(j,my(G,_e)))}}return j!==1/0&&j}(L[0],L[1],A)}},line:class extends Sr{constructor(i){super(i,vy),this.gradientVersion=0,Sh||(Sh=new ow(vy.paint.properties["line-width"].specification),Sh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(i){i==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof As,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER)}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(i,e){super.recalculate(i,e),this.paint._values["line-floorwidth"]=Sh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new Fp(i)}queryRadius(i){const e=i,r=xy(bu("line-width",this,e),bu("line-gap-width",this,e)),a=bu("line-offset",this,e);return r/2+Math.abs(a)+gh(this.paint.get("line-translate"))}queryIntersectsFeature(i,e,r,a,d,m,g){const v=yh(i,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,g),b=g/2*xy(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),T=this.paint.get("line-offset").evaluate(e,r);return T&&(a=function(k,A){const L=[];for(let B=0;B<k.length;B++){const O=k[B],G=[];for(let j=0;j<O.length;j++){const ee=O[j-1],ae=O[j],J=O[j+1],ce=j===0?new ie(0,0):ae.sub(ee)._unit()._perp(),fe=j===O.length-1?new ie(0,0):J.sub(ae)._unit()._perp(),_e=ce._add(fe)._unit(),He=_e.x*fe.x+_e.y*fe.y;He!==0&&_e._mult(1/He),G.push(_e._mult(A)._add(ae))}L.push(G)}return L}(a,T*g)),function(k,A,L){for(let B=0;B<A.length;B++){const O=A[B];if(k.length>=3){for(let G=0;G<O.length;G++)if(Ya(k,O[G]))return!0}if(y1(k,O,L))return!0}return!1}(v,a,b)}isTileClipped(){return!0}},symbol:Ph,background:class extends Sr{constructor(i){super(i,Mw)}},raster:class extends Sr{constructor(i){super(i,Aw)}}};class Lw{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const Xp=63710088e-1;class ts{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ts(te(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,a=this.lat*r,d=e.lat*r,m=Math.sin(a)*Math.sin(d)+Math.cos(a)*Math.cos(d)*Math.cos((e.lng-this.lng)*r);return Xp*Math.acos(Math.min(m,1))}static convert(e){if(e instanceof ts)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new ts(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new ts(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const $y=2*Math.PI*Xp;function jy(i){return $y*Math.cos(i*Math.PI/180)}function qy(i){return(180+i)/360}function Zy(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function Gy(i,e){return i/jy(e)}function Hp(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}class Mh{constructor(e,r,a=0){this.x=+e,this.y=+r,this.z=+a}static fromLngLat(e,r=0){const a=ts.convert(e);return new Mh(qy(a.lng),Zy(a.lat),Gy(r,a.lat))}toLngLat(){return new ts(360*this.x-180,Hp(this.y))}toAltitude(){return this.z*jy(Hp(this.y))}meterInMercatorCoordinateUnits(){return 1/$y*(e=Hp(this.y),1/Math.cos(e*Math.PI/180));var e}}function Wy(i,e,r){var a=2*Math.PI*6378137/256/Math.pow(2,r);return[i*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Kp{constructor(e,r,a){if(e<0||e>25||a<0||a>=Math.pow(2,e)||r<0||r>=Math.pow(2,e))throw new Error(`x=${r}, y=${a}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=r,this.y=a,this.key=Du(0,e,e,r,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r,a){const d=(g=this.y,v=this.z,b=Wy(256*(m=this.x),256*(g=Math.pow(2,v)-g-1),v),T=Wy(256*(m+1),256*(g+1),v),b[0]+","+b[1]+","+T[0]+","+T[1]);var m,g,v,b,T;const k=function(A,L,B){let O,G="";for(let j=A;j>0;j--)O=1<<j-1,G+=(L&O?1:0)+(B&O?2:0);return G}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,r>1?"@2x":"").replace(/{quadkey}/g,k).replace(/{bbox-epsg-3857}/g,d)}isChildOf(e){const r=this.z-e.z;return r>0&&e.x===this.x>>r&&e.y===this.y>>r}getTilePoint(e){const r=Math.pow(2,this.z);return new ie((e.x*r-this.x)*nn,(e.y*r-this.y)*nn)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Xy{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Du(e,r.z,r.z,r.x,r.y)}}class ur{constructor(e,r,a,d,m){if(e<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${a}`);this.overscaledZ=e,this.wrap=r,this.canonical=new Kp(a,+d,+m),this.key=Du(r,e,a,d,m)}clone(){return new ur(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const r=this.canonical.z-e;return e>this.canonical.z?new ur(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ur(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-e;return e>this.canonical.z?Du(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y):Du(this.wrap*+r,e,e,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new ur(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,a=2*this.canonical.x,d=2*this.canonical.y;return[new ur(r,this.wrap,r,a,d),new ur(r,this.wrap,r,a+1,d),new ur(r,this.wrap,r,a,d+1),new ur(r,this.wrap,r,a+1,d+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new ur(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ur(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Xy(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Mh(e.x-this.wrap,e.y))}}function Du(i,e,r,a,d){(i*=2)<0&&(i=-1*i-1);const m=1<<r;return(m*m*i+m*d+a).toString(36)+r.toString(36)+e.toString(36)}Ke("CanonicalTileID",Kp),Ke("OverscaledTileID",ur,{omit:["posMatrix"]});class Hy{constructor(e,r,a){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(a&&a!=="mapbox"&&a!=="terrarium")return void st(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const d=this.dim=r.height-2;this.data=new Uint32Array(r.data.buffer),this.encoding=a||"mapbox";for(let m=0;m<d;m++)this.data[this._idx(-1,m)]=this.data[this._idx(0,m)],this.data[this._idx(d,m)]=this.data[this._idx(d-1,m)],this.data[this._idx(m,-1)]=this.data[this._idx(m,0)],this.data[this._idx(m,d)]=this.data[this._idx(m,d-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(d,-1)]=this.data[this._idx(d-1,0)],this.data[this._idx(-1,d)]=this.data[this._idx(0,d-1)],this.data[this._idx(d,d)]=this.data[this._idx(d-1,d-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let m=0;m<d;m++)for(let g=0;g<d;g++){const v=this.get(m,g);v>this.max&&(this.max=v),v<this.min&&(this.min=v)}}get(e,r){const a=new Uint8Array(this.data.buffer),d=4*this._idx(e,r);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(a[d],a[d+1],a[d+2])}getUnpackVector(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(r+1)*this.stride+(e+1)}_unpackMapbox(e,r,a){return(256*e*256+256*r+a)/10-1e4}_unpackTerrarium(e,r,a){return 256*e+r+a/256-32768}getPixels(){return new lr({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,r,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let d=r*this.dim,m=r*this.dim+this.dim,g=a*this.dim,v=a*this.dim+this.dim;switch(r){case-1:d=m-1;break;case 1:m=d+1}switch(a){case-1:g=v-1;break;case 1:v=g+1}const b=-r*this.dim,T=-a*this.dim;for(let k=g;k<v;k++)for(let A=d;A<m;A++)this.data[this._idx(A,k)]=e.data[this._idx(A+b,k+T)]}}Ke("DEMData",Hy);class Ky{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const a=e[r];this._stringToNumber[a]=r,this._numberToString[r]=a}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class Yy{constructor(e,r,a,d,m){this.type="Feature",this._vectorTileFeature=e,e._z=r,e._x=a,e._y=d,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const r in this)r!=="_geometry"&&r!=="_vectorTileFeature"&&(e[r]=this[r]);return e}}class Jy{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Vs(nn,16,0),this.grid3D=new Vs(nn,16,0),this.featureIndexArray=new F,this.promoteId=r}insert(e,r,a,d,m,g){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,d,m);const b=g?this.grid3D:this.grid;for(let T=0;T<r.length;T++){const k=r[T],A=[1/0,1/0,-1/0,-1/0];for(let L=0;L<k.length;L++){const B=k[L];A[0]=Math.min(A[0],B.x),A[1]=Math.min(A[1],B.y),A[2]=Math.max(A[2],B.x),A[3]=Math.max(A[3],B.y)}A[0]<nn&&A[1]<nn&&A[2]>=0&&A[3]>=0&&b.insert(v,A[0],A[1],A[2],A[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Jo.VectorTile(new Up(this.rawTileData)).layers,this.sourceLayerCoder=new Ky(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,r,a,d){this.loadVTLayers();const m=e.params||{},g=nn/e.tileSize/e.scale,v=nu(m.filter),b=e.queryGeometry,T=e.queryPadding*g,k=e_(b),A=this.grid.query(k.minX-T,k.minY-T,k.maxX+T,k.maxY+T),L=e_(e.cameraQueryGeometry),B=this.grid3D.query(L.minX-T,L.minY-T,L.maxX+T,L.maxY+T,(j,ee,ae,J)=>function(ce,fe,_e,He,Ye){for(const Be of ce)if(fe<=Be.x&&_e<=Be.y&&He>=Be.x&&Ye>=Be.y)return!0;const Ne=[new ie(fe,_e),new ie(fe,Ye),new ie(He,Ye),new ie(He,_e)];if(ce.length>2){for(const Be of Ne)if(Ya(ce,Be))return!0}for(let Be=0;Be<ce.length-1;Be++)if(v1(ce[Be],ce[Be+1],Ne))return!0;return!1}(e.cameraQueryGeometry,j-T,ee-T,ae+T,J+T));for(const j of B)A.push(j);A.sort(Rw);const O={};let G;for(let j=0;j<A.length;j++){const ee=A[j];if(ee===G)continue;G=ee;const ae=this.featureIndexArray.get(ee);let J=null;this.loadMatchingFeature(O,ae.bucketIndex,ae.sourceLayerIndex,ae.featureIndex,v,m.layers,m.availableImages,r,a,d,(ce,fe,_e)=>(J||(J=Nr(ce)),fe.queryIntersectsFeature(b,ce,_e,J,this.z,e.transform,g,e.pixelPosMatrix)))}return O}loadMatchingFeature(e,r,a,d,m,g,v,b,T,k,A){const L=this.bucketLayerIDs[r];if(g&&!function(j,ee){for(let ae=0;ae<j.length;ae++)if(ee.indexOf(j[ae])>=0)return!0;return!1}(g,L))return;const B=this.sourceLayerCoder.decode(a),O=this.vtLayers[B].feature(d);if(m.needGeometry){const j=Hs(O,!0);if(!m.filter(new tn(this.tileID.overscaledZ),j,this.tileID.canonical))return}else if(!m.filter(new tn(this.tileID.overscaledZ),O))return;const G=this.getId(O,B);for(let j=0;j<L.length;j++){const ee=L[j];if(g&&g.indexOf(ee)<0)continue;const ae=b[ee];if(!ae)continue;let J={};G&&k&&(J=k.getState(ae.sourceLayer||"_geojsonTileLayer",G));const ce=le({},T[ee]);ce.paint=Qy(ce.paint,ae.paint,O,J,v),ce.layout=Qy(ce.layout,ae.layout,O,J,v);const fe=!A||A(O,ae,J);if(!fe)continue;const _e=new Yy(O,this.z,this.x,this.y,G);_e.layer=ce;let He=e[ee];He===void 0&&(He=e[ee]=[]),He.push({featureIndex:d,feature:_e,intersectionZ:fe})}}lookupSymbolFeatures(e,r,a,d,m,g,v,b){const T={};this.loadVTLayers();const k=nu(m);for(const A of e)this.loadMatchingFeature(T,a,d,A,k,g,v,b,r);return T}hasLayer(e){for(const r of this.bucketLayerIDs)for(const a of r)if(e===a)return!0;return!1}getId(e,r){let a=e.id;return this.promoteId&&(a=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[r]],typeof a=="boolean"&&(a=Number(a))),a}}function Qy(i,e,r,a,d){return Fe(i,(m,g)=>{const v=e instanceof Na?e.get(g):null;return v&&v.evaluate?v.evaluate(r,a,d):v})}function e_(i){let e=1/0,r=1/0,a=-1/0,d=-1/0;for(const m of i)e=Math.min(e,m.x),r=Math.min(r,m.y),a=Math.max(a,m.x),d=Math.max(d,m.y);return{minX:e,minY:r,maxX:a,maxY:d}}function Rw(i,e){return e-i}function t_(i,e,r,a,d){const m=[];for(let g=0;g<i.length;g++){const v=i[g];let b;for(let T=0;T<v.length-1;T++){let k=v[T],A=v[T+1];k.x<e&&A.x<e||(k.x<e?k=new ie(e,k.y+(e-k.x)/(A.x-k.x)*(A.y-k.y))._round():A.x<e&&(A=new ie(e,k.y+(e-k.x)/(A.x-k.x)*(A.y-k.y))._round()),k.y<r&&A.y<r||(k.y<r?k=new ie(k.x+(r-k.y)/(A.y-k.y)*(A.x-k.x),r)._round():A.y<r&&(A=new ie(k.x+(r-k.y)/(A.y-k.y)*(A.x-k.x),r)._round()),k.x>=a&&A.x>=a||(k.x>=a?k=new ie(a,k.y+(a-k.x)/(A.x-k.x)*(A.y-k.y))._round():A.x>=a&&(A=new ie(a,k.y+(a-k.x)/(A.x-k.x)*(A.y-k.y))._round()),k.y>=d&&A.y>=d||(k.y>=d?k=new ie(k.x+(d-k.y)/(A.y-k.y)*(A.x-k.x),d)._round():A.y>=d&&(A=new ie(k.x+(d-k.y)/(A.y-k.y)*(A.x-k.x),d)._round()),b&&k.equals(b[b.length-1])||(b=[k],m.push(b)),b.push(A)))))}}return m}Ke("FeatureIndex",Jy,{omit:["rawTileData","sourceLayerCoder"]});class ns extends ie{constructor(e,r,a,d){super(e,r),this.angle=a,d!==void 0&&(this.segment=d)}clone(){return new ns(this.x,this.y,this.angle,this.segment)}}function n_(i,e,r,a,d){if(e.segment===void 0)return!0;let m=e,g=e.segment+1,v=0;for(;v>-r/2;){if(g--,g<0)return!1;v-=i[g].dist(m),m=i[g]}v+=i[g].dist(i[g+1]),g++;const b=[];let T=0;for(;v<r/2;){const k=i[g],A=i[g+1];if(!A)return!1;let L=i[g-1].angleTo(k)-k.angleTo(A);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),b.push({distance:v,angleDelta:L}),T+=L;v-b[0].distance>a;)T-=b.shift().angleDelta;if(T>d)return!1;g++,v+=k.dist(A)}return!0}function i_(i){let e=0;for(let r=0;r<i.length-1;r++)e+=i[r].dist(i[r+1]);return e}function r_(i,e,r){return i?.6*e*r:0}function o_(i,e){return Math.max(i?i.right-i.left:0,e?e.right-e.left:0)}function Bw(i,e,r,a,d,m){const g=r_(r,d,m),v=o_(r,a)*m;let b=0;const T=i_(i)/2;for(let k=0;k<i.length-1;k++){const A=i[k],L=i[k+1],B=A.dist(L);if(b+B>T){const O=(T-b)/B,G=Si.number(A.x,L.x,O),j=Si.number(A.y,L.y,O),ee=new ns(G,j,L.angleTo(A),k);return ee._round(),!g||n_(i,ee,v,g,e)?ee:void 0}b+=B}}function Fw(i,e,r,a,d,m,g,v,b){const T=r_(a,m,g),k=o_(a,d),A=k*g,L=i[0].x===0||i[0].x===b||i[0].y===0||i[0].y===b;return e-A<e/4&&(e=A+e/4),s_(i,L?e/2*v%e:(k/2+2*m)*g*v%e,e,T,r,A,L,!1,b)}function s_(i,e,r,a,d,m,g,v,b){const T=m/2,k=i_(i);let A=0,L=e-r,B=[];for(let O=0;O<i.length-1;O++){const G=i[O],j=i[O+1],ee=G.dist(j),ae=j.angleTo(G);for(;L+r<A+ee;){L+=r;const J=(L-A)/ee,ce=Si.number(G.x,j.x,J),fe=Si.number(G.y,j.y,J);if(ce>=0&&ce<b&&fe>=0&&fe<b&&L-T>=0&&L+T<=k){const _e=new ns(ce,fe,ae,O);_e._round(),a&&!n_(i,_e,m,a,d)||B.push(_e)}}A+=ee}return v||B.length||g||(B=s_(i,A/2,r,a,d,m,g,!0,b)),B}function a_(i,e,r,a){const d=[],m=i.image,g=m.pixelRatio,v=m.paddedRect.w-2,b=m.paddedRect.h-2,T=i.right-i.left,k=i.bottom-i.top,A=m.stretchX||[[0,v]],L=m.stretchY||[[0,b]],B=(ze,Ve)=>ze+Ve[1]-Ve[0],O=A.reduce(B,0),G=L.reduce(B,0),j=v-O,ee=b-G;let ae=0,J=O,ce=0,fe=G,_e=0,He=j,Ye=0,Ne=ee;if(m.content&&a){const ze=m.content;ae=Ah(A,0,ze[0]),ce=Ah(L,0,ze[1]),J=Ah(A,ze[0],ze[2]),fe=Ah(L,ze[1],ze[3]),_e=ze[0]-ae,Ye=ze[1]-ce,He=ze[2]-ze[0]-J,Ne=ze[3]-ze[1]-fe}const Be=(ze,Ve,Oe,Te)=>{const ot=zh(ze.stretch-ae,J,T,i.left),Qe=Dh(ze.fixed-_e,He,ze.stretch,O),St=zh(Ve.stretch-ce,fe,k,i.top),Qt=Dh(Ve.fixed-Ye,Ne,Ve.stretch,G),rn=zh(Oe.stretch-ae,J,T,i.left),Dn=Dh(Oe.fixed-_e,He,Oe.stretch,O),cr=zh(Te.stretch-ce,fe,k,i.top),Qn=Dh(Te.fixed-Ye,Ne,Te.stretch,G),kn=new ie(ot,St),$n=new ie(rn,St),ei=new ie(rn,cr),ui=new ie(ot,cr),Oi=new ie(Qe/g,Qt/g),Pn=new ie(Dn/g,Qn/g),ti=e*Math.PI/180;if(ti){const Ui=Math.sin(ti),Ni=Math.cos(ti),fn=[Ni,-Ui,Ui,Ni];kn._matMult(fn),$n._matMult(fn),ui._matMult(fn),ei._matMult(fn)}const ci=ze.stretch+ze.fixed,Ii=Ve.stretch+Ve.fixed;return{tl:kn,tr:$n,bl:ui,br:ei,tex:{x:m.paddedRect.x+1+ci,y:m.paddedRect.y+1+Ii,w:Oe.stretch+Oe.fixed-ci,h:Te.stretch+Te.fixed-Ii},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Oi,pixelOffsetBR:Pn,minFontScaleX:He/g/T,minFontScaleY:Ne/g/k,isSDF:r}};if(a&&(m.stretchX||m.stretchY)){const ze=l_(A,j,O),Ve=l_(L,ee,G);for(let Oe=0;Oe<ze.length-1;Oe++){const Te=ze[Oe],ot=ze[Oe+1];for(let Qe=0;Qe<Ve.length-1;Qe++)d.push(Be(Te,Ve[Qe],ot,Ve[Qe+1]))}}else d.push(Be({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:b+1}));return d}function Ah(i,e,r){let a=0;for(const d of i)a+=Math.max(e,Math.min(r,d[1]))-Math.max(e,Math.min(r,d[0]));return a}function l_(i,e,r){const a=[{fixed:-1,stretch:0}];for(const[d,m]of i){const g=a[a.length-1];a.push({fixed:d-g.stretch,stretch:g.stretch}),a.push({fixed:d-g.stretch,stretch:g.stretch+(m-d)})}return a.push({fixed:e+1,stretch:r}),a}function zh(i,e,r,a){return i/e*r+a}function Dh(i,e,r,a){return i-e*r/a}Ke("Anchor",ns);class Lh{constructor(e,r,a,d,m,g,v,b,T,k){if(this.boxStartIndex=e.length,T){let A=g.top,L=g.bottom;const B=g.collisionPadding;B&&(A-=B[1],L+=B[3]);let O=L-A;O>0&&(O=Math.max(10,O),this.circleDiameter=O)}else{let A=g.top*v-b[0],L=g.bottom*v+b[2],B=g.left*v-b[3],O=g.right*v+b[1];const G=g.collisionPadding;if(G&&(B-=G[0]*v,A-=G[1]*v,O+=G[2]*v,L+=G[3]*v),k){const j=new ie(B,A),ee=new ie(O,A),ae=new ie(B,L),J=new ie(O,L),ce=k*Math.PI/180;j._rotate(ce),ee._rotate(ce),ae._rotate(ce),J._rotate(ce),B=Math.min(j.x,ee.x,ae.x,J.x),O=Math.max(j.x,ee.x,ae.x,J.x),A=Math.min(j.y,ee.y,ae.y,J.y),L=Math.max(j.y,ee.y,ae.y,J.y)}e.emplaceBack(r.x,r.y,B,A,O,L,a,d,m)}this.boxEndIndex=e.length}}class Ow{constructor(e=[],r=Uw){if(this.data=e,this.length=this.data.length,this.compare=r,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],r=this.data.pop();return this.length--,this.length>0&&(this.data[0]=r,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:r,compare:a}=this,d=r[e];for(;e>0;){const m=e-1>>1,g=r[m];if(a(d,g)>=0)break;r[e]=g,e=m}r[e]=d}_down(e){const{data:r,compare:a}=this,d=this.length>>1,m=r[e];for(;e<d;){let g=1+(e<<1),v=r[g];const b=g+1;if(b<this.length&&a(r[b],v)<0&&(g=b,v=r[b]),a(v,m)>=0)break;r[e]=v,e=g}r[e]=m}}function Uw(i,e){return i<e?-1:i>e?1:0}function Nw(i,e=1,r=!1){let a=1/0,d=1/0,m=-1/0,g=-1/0;const v=i[0];for(let B=0;B<v.length;B++){const O=v[B];(!B||O.x<a)&&(a=O.x),(!B||O.y<d)&&(d=O.y),(!B||O.x>m)&&(m=O.x),(!B||O.y>g)&&(g=O.y)}const b=Math.min(m-a,g-d);let T=b/2;const k=new Ow([],Vw);if(b===0)return new ie(a,d);for(let B=a;B<m;B+=b)for(let O=d;O<g;O+=b)k.push(new ol(B+T,O+T,T,i));let A=function(B){let O=0,G=0,j=0;const ee=B[0];for(let ae=0,J=ee.length,ce=J-1;ae<J;ce=ae++){const fe=ee[ae],_e=ee[ce],He=fe.x*_e.y-_e.x*fe.y;G+=(fe.x+_e.x)*He,j+=(fe.y+_e.y)*He,O+=3*He}return new ol(G/O,j/O,0,B)}(i),L=k.length;for(;k.length;){const B=k.pop();(B.d>A.d||!A.d)&&(A=B,r&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,L)),B.max-A.d<=e||(T=B.h/2,k.push(new ol(B.p.x-T,B.p.y-T,T,i)),k.push(new ol(B.p.x+T,B.p.y-T,T,i)),k.push(new ol(B.p.x-T,B.p.y+T,T,i)),k.push(new ol(B.p.x+T,B.p.y+T,T,i)),L+=4)}return r&&(console.log(`num probes: ${L}`),console.log(`best distance: ${A.d}`)),A.p}function Vw(i,e){return e.max-i.max}function ol(i,e,r,a){this.p=new ie(i,e),this.h=r,this.d=function(d,m){let g=!1,v=1/0;for(let b=0;b<m.length;b++){const T=m[b];for(let k=0,A=T.length,L=A-1;k<A;L=k++){const B=T[k],O=T[L];B.y>d.y!=O.y>d.y&&d.x<(O.x-B.x)*(d.y-B.y)/(O.y-B.y)+B.x&&(g=!g),v=Math.min(v,Gg(d,B,O))}}return(g?1:-1)*Math.sqrt(v)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}const Yp=Number.POSITIVE_INFINITY;function u_(i,e){return e[1]!==Yp?function(r,a,d){let m=0,g=0;switch(a=Math.abs(a),d=Math.abs(d),r){case"top-right":case"top-left":case"top":g=d-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-d}switch(r){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}return[m,g]}(i,e[0],e[1]):function(r,a){let d=0,m=0;a<0&&(a=0);const g=a/Math.sqrt(2);switch(r){case"top-right":case"top-left":m=g-7;break;case"bottom-right":case"bottom-left":m=7-g;break;case"bottom":m=7-a;break;case"top":m=a-7}switch(r){case"top-right":case"bottom-right":d=-g;break;case"top-left":case"bottom-left":d=g;break;case"left":d=a;break;case"right":d=-a}return[d,m]}(i,e[0])}function Jp(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function $w(i,e,r,a,d,m,g,v,b,T,k){let A=m.textMaxSize.evaluate(e,{});A===void 0&&(A=g);const L=i.layers[0].layout,B=L.get("icon-offset").evaluate(e,{},k),O=h_(r.horizontal),G=g/24,j=i.tilePixelRatio*G,ee=i.tilePixelRatio*A/24,ae=i.tilePixelRatio*v,J=i.tilePixelRatio*L.get("symbol-spacing"),ce=L.get("text-padding")*i.tilePixelRatio,fe=function(Te,ot,Qe,St=1){const Qt=Te.get("icon-padding").evaluate(ot,{},Qe),rn=Qt&&Qt.values;return[rn[0]*St,rn[1]*St,rn[2]*St,rn[3]*St]}(L,e,k,i.tilePixelRatio),_e=L.get("text-max-angle")/180*Math.PI,He=L.get("text-rotation-alignment")!=="viewport"&&L.get("symbol-placement")!=="point",Ye=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Ne=L.get("symbol-placement"),Be=J/2,ze=L.get("icon-text-fit");let Ve;a&&ze!=="none"&&(i.allowVerticalPlacement&&r.vertical&&(Ve=Ry(a,r.vertical,ze,L.get("icon-text-fit-padding"),B,G)),O&&(a=Ry(a,O,ze,L.get("icon-text-fit-padding"),B,G)));const Oe=(Te,ot)=>{ot.x<0||ot.x>=nn||ot.y<0||ot.y>=nn||function(Qe,St,Qt,rn,Dn,cr,Qn,kn,$n,ei,ui,Oi,Pn,ti,ci,Ii,Ui,Ni,fn,ni,Et,Yi,ii,hi,Cr){const Vr=Qe.addToLineVertexArray(St,Qt);let $r,To,Ir,hr,Vi=0,Co=0,Bu=0,m_=0,af=-1,lf=-1;const Io={};let g_=vn(""),uf=0,cf=0;if(kn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[uf,cf]=kn.layout.get("text-offset").evaluate(Et,{},hi).map($i=>$i*Wn):(uf=kn.layout.get("text-radial-offset").evaluate(Et,{},hi)*Wn,cf=Yp),Qe.allowVerticalPlacement&&rn.vertical){const $i=kn.layout.get("text-rotate").evaluate(Et,{},hi)+90;Ir=new Lh($n,St,ei,ui,Oi,rn.vertical,Pn,ti,ci,$i),Qn&&(hr=new Lh($n,St,ei,ui,Oi,Qn,Ui,Ni,ci,$i))}if(Dn){const $i=kn.layout.get("icon-rotate").evaluate(Et,{}),oo=kn.layout.get("icon-text-fit")!=="none",Fu=a_(Dn,$i,ii,oo),Ou=Qn?a_(Qn,$i,ii,oo):void 0;To=new Lh($n,St,ei,ui,Oi,Dn,Ui,Ni,!1,$i),Vi=4*Fu.length;const v_=Qe.iconSizeData;let Ys=null;v_.kind==="source"?(Ys=[Eo*kn.layout.get("icon-size").evaluate(Et,{})],Ys[0]>es&&st(`${Qe.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):v_.kind==="composite"&&(Ys=[Eo*Yi.compositeIconSizes[0].evaluate(Et,{},hi),Eo*Yi.compositeIconSizes[1].evaluate(Et,{},hi)],(Ys[0]>es||Ys[1]>es)&&st(`${Qe.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Qe.addSymbols(Qe.icon,Fu,Ys,ni,fn,Et,u.WritingMode.none,St,Vr.lineStartIndex,Vr.lineLength,-1,hi),af=Qe.icon.placedSymbolArray.length-1,Ou&&(Co=4*Ou.length,Qe.addSymbols(Qe.icon,Ou,Ys,ni,fn,Et,u.WritingMode.vertical,St,Vr.lineStartIndex,Vr.lineLength,-1,hi),lf=Qe.icon.placedSymbolArray.length-1)}const y_=Object.keys(rn.horizontal);for(const $i of y_){const oo=rn.horizontal[$i];if(!$r){g_=vn(oo.text);const Ou=kn.layout.get("text-rotate").evaluate(Et,{},hi);$r=new Lh($n,St,ei,ui,Oi,oo,Pn,ti,ci,Ou)}const Fu=oo.positionedLines.length===1;if(Bu+=c_(Qe,St,oo,cr,kn,ci,Et,Ii,Vr,rn.vertical?u.WritingMode.horizontal:u.WritingMode.horizontalOnly,Fu?y_:[$i],Io,af,Yi,hi),Fu)break}rn.vertical&&(m_+=c_(Qe,St,rn.vertical,cr,kn,ci,Et,Ii,Vr,u.WritingMode.vertical,["vertical"],Io,lf,Yi,hi));const Zw=$r?$r.boxStartIndex:Qe.collisionBoxArray.length,Gw=$r?$r.boxEndIndex:Qe.collisionBoxArray.length,Ww=Ir?Ir.boxStartIndex:Qe.collisionBoxArray.length,Xw=Ir?Ir.boxEndIndex:Qe.collisionBoxArray.length,Hw=To?To.boxStartIndex:Qe.collisionBoxArray.length,Kw=To?To.boxEndIndex:Qe.collisionBoxArray.length,Yw=hr?hr.boxStartIndex:Qe.collisionBoxArray.length,Jw=hr?hr.boxEndIndex:Qe.collisionBoxArray.length;let jr=-1;const Bh=($i,oo)=>$i&&$i.circleDiameter?Math.max($i.circleDiameter,oo):oo;jr=Bh($r,jr),jr=Bh(Ir,jr),jr=Bh(To,jr),jr=Bh(hr,jr);const __=jr>-1?1:0;__&&(jr*=Cr/Wn),Qe.glyphOffsetArray.length>=rl.MAX_GLYPHS&&st("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Et.sortKey!==void 0&&Qe.addToSortKeyRanges(Qe.symbolInstances.length,Et.sortKey),Qe.symbolInstances.emplaceBack(St.x,St.y,Io.right>=0?Io.right:-1,Io.center>=0?Io.center:-1,Io.left>=0?Io.left:-1,Io.vertical||-1,af,lf,g_,Zw,Gw,Ww,Xw,Hw,Kw,Yw,Jw,ei,Bu,m_,Vi,Co,__,0,Pn,uf,cf,jr)}(i,ot,Te,r,a,d,Ve,i.layers[0],i.collisionBoxArray,e.index,e.sourceLayerIndex,i.index,j,[ce,ce,ce,ce],He,b,ae,fe,Ye,B,e,m,T,k,g)};if(Ne==="line")for(const Te of t_(e.geometry,0,0,nn,nn)){const ot=Fw(Te,J,_e,r.vertical||O,a,24,ee,i.overscaling,nn);for(const Qe of ot)O&&jw(i,O.text,Be,Qe)||Oe(Te,Qe)}else if(Ne==="line-center"){for(const Te of e.geometry)if(Te.length>1){const ot=Bw(Te,_e,r.vertical||O,a,24,ee);ot&&Oe(Te,ot)}}else if(e.type==="Polygon")for(const Te of Ap(e.geometry,0)){const ot=Nw(Te,16);Oe(Te[0],new ns(ot.x,ot.y,0))}else if(e.type==="LineString")for(const Te of e.geometry)Oe(Te,new ns(Te[0].x,Te[0].y,0));else if(e.type==="Point")for(const Te of e.geometry)for(const ot of Te)Oe([ot],new ns(ot.x,ot.y,0))}function c_(i,e,r,a,d,m,g,v,b,T,k,A,L,B,O){const G=function(ae,J,ce,fe,_e,He,Ye,Ne){const Be=fe.layout.get("text-rotate").evaluate(He,{})*Math.PI/180,ze=[];for(const Ve of J.positionedLines)for(const Oe of Ve.positionedGlyphs){if(!Oe.rect)continue;const Te=Oe.rect||{};let ot=4,Qe=!0,St=1,Qt=0;const rn=(_e||Ne)&&Oe.vertical,Dn=Oe.metrics.advance*Oe.scale/2;if(Ne&&J.verticalizable&&(Qt=Ve.lineOffset/2-(Oe.imageName?-(Wn-Oe.metrics.width*Oe.scale)/2:(Oe.scale-1)*Wn)),Oe.imageName){const fn=Ye[Oe.imageName];Qe=fn.sdf,St=fn.pixelRatio,ot=1/St}const cr=_e?[Oe.x+Dn,Oe.y]:[0,0];let Qn=_e?[0,0]:[Oe.x+Dn+ce[0],Oe.y+ce[1]-Qt],kn=[0,0];rn&&(kn=Qn,Qn=[0,0]);const $n=(Oe.metrics.left-ot)*Oe.scale-Dn+Qn[0],ei=(-Oe.metrics.top-ot)*Oe.scale+Qn[1],ui=$n+Te.w*Oe.scale/St,Oi=ei+Te.h*Oe.scale/St,Pn=new ie($n,ei),ti=new ie(ui,ei),ci=new ie($n,Oi),Ii=new ie(ui,Oi);if(rn){const fn=new ie(-Dn,Dn-Th),ni=-Math.PI/2,Et=12-Dn,Yi=new ie(22-Et,-(Oe.imageName?Et:0)),ii=new ie(...kn);Pn._rotateAround(ni,fn)._add(Yi)._add(ii),ti._rotateAround(ni,fn)._add(Yi)._add(ii),ci._rotateAround(ni,fn)._add(Yi)._add(ii),Ii._rotateAround(ni,fn)._add(Yi)._add(ii)}if(Be){const fn=Math.sin(Be),ni=Math.cos(Be),Et=[ni,-fn,fn,ni];Pn._matMult(Et),ti._matMult(Et),ci._matMult(Et),Ii._matMult(Et)}const Ui=new ie(0,0),Ni=new ie(0,0);ze.push({tl:Pn,tr:ti,bl:ci,br:Ii,tex:Te,writingMode:J.writingMode,glyphOffset:cr,sectionIndex:Oe.sectionIndex,isSDF:Qe,pixelOffsetTL:Ui,pixelOffsetBR:Ni,minFontScaleX:0,minFontScaleY:0})}return ze}(0,r,v,d,m,g,a,i.allowVerticalPlacement),j=i.textSizeData;let ee=null;j.kind==="source"?(ee=[Eo*d.layout.get("text-size").evaluate(g,{})],ee[0]>es&&st(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):j.kind==="composite"&&(ee=[Eo*B.compositeTextSizes[0].evaluate(g,{},O),Eo*B.compositeTextSizes[1].evaluate(g,{},O)],(ee[0]>es||ee[1]>es)&&st(`${i.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),i.addSymbols(i.text,G,ee,v,m,g,T,e,b.lineStartIndex,b.lineLength,L,O);for(const ae of k)A[ae]=i.text.placedSymbolArray.length-1;return 4*G.length}function h_(i){for(const e in i)return i[e];return null}function jw(i,e,r,a){const d=i.compareText;if(e in d){const m=d[e];for(let g=m.length-1;g>=0;g--)if(a.dist(m[g])<r)return!0}else d[e]=[];return d[e].push(a),!1}const d_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Qp{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,a]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const d=a>>4;if(d!==1)throw new Error(`Got v${d} data when expected v1.`);const m=d_[15&a];if(!m)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new Qp(v,g,m,e)}constructor(e,r=64,a=Float64Array,d){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const m=d_.indexOf(this.ArrayType),g=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,b=(8-v%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${a}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+b,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+g+v+b),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+b,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=r,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return ef(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,a,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:g,nodeSize:v}=this,b=[0,m.length-1,0],T=[];for(;b.length;){const k=b.pop()||0,A=b.pop()||0,L=b.pop()||0;if(A-L<=v){for(let j=L;j<=A;j++){const ee=g[2*j],ae=g[2*j+1];ee>=e&&ee<=a&&ae>=r&&ae<=d&&T.push(m[j])}continue}const B=L+A>>1,O=g[2*B],G=g[2*B+1];O>=e&&O<=a&&G>=r&&G<=d&&T.push(m[B]),(k===0?e<=O:r<=G)&&(b.push(L),b.push(B-1),b.push(1-k)),(k===0?a>=O:d>=G)&&(b.push(B+1),b.push(A),b.push(1-k))}return T}within(e,r,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:m,nodeSize:g}=this,v=[0,d.length-1,0],b=[],T=a*a;for(;v.length;){const k=v.pop()||0,A=v.pop()||0,L=v.pop()||0;if(A-L<=g){for(let j=L;j<=A;j++)f_(m[2*j],m[2*j+1],e,r)<=T&&b.push(d[j]);continue}const B=L+A>>1,O=m[2*B],G=m[2*B+1];f_(O,G,e,r)<=T&&b.push(d[B]),(k===0?e-a<=O:r-a<=G)&&(v.push(L),v.push(B-1),v.push(1-k)),(k===0?e+a>=O:r+a>=G)&&(v.push(B+1),v.push(A),v.push(1-k))}return b}}function ef(i,e,r,a,d,m){if(d-a<=r)return;const g=a+d>>1;p_(i,e,g,a,d,m),ef(i,e,r,a,g-1,1-m),ef(i,e,r,g+1,d,1-m)}function p_(i,e,r,a,d,m){for(;d>a;){if(d-a>600){const T=d-a+1,k=r-a+1,A=Math.log(T),L=.5*Math.exp(2*A/3),B=.5*Math.sqrt(A*L*(T-L)/T)*(k-T/2<0?-1:1);p_(i,e,r,Math.max(a,Math.floor(r-k*L/T+B)),Math.min(d,Math.floor(r+(T-k)*L/T+B)),m)}const g=e[2*r+m];let v=a,b=d;for(Lu(i,e,a,r),e[2*d+m]>g&&Lu(i,e,a,d);v<b;){for(Lu(i,e,v,b),v++,b--;e[2*v+m]<g;)v++;for(;e[2*b+m]>g;)b--}e[2*a+m]===g?Lu(i,e,a,b):(b++,Lu(i,e,b,d)),b<=r&&(a=b+1),r<=b&&(d=b-1)}}function Lu(i,e,r,a){tf(i,r,a),tf(e,2*r,2*a),tf(e,2*r+1,2*a+1)}function tf(i,e,r){const a=i[e];i[e]=i[r],i[r]=a}function f_(i,e,r,a){const d=i-r,m=e-a;return d*d+m*m}var nf;u.PerformanceMarkers=void 0,(nf=u.PerformanceMarkers||(u.PerformanceMarkers={})).create="create",nf.load="load",nf.fullLoad="fullLoad";let Rh=null,Ru=[];const rf=1e3/60,of="loadTime",sf="fullLoadTime",qw={mark(i){performance.mark(i)},frame(i){const e=i;Rh!=null&&Ru.push(e-Rh),Rh=e},clearMetrics(){Rh=null,Ru=[],performance.clearMeasures(of),performance.clearMeasures(sf);for(const i in u.PerformanceMarkers)performance.clearMarks(u.PerformanceMarkers[i])},getPerformanceMetrics(){performance.measure(of,u.PerformanceMarkers.create,u.PerformanceMarkers.load),performance.measure(sf,u.PerformanceMarkers.create,u.PerformanceMarkers.fullLoad);const i=performance.getEntriesByName(of)[0].duration,e=performance.getEntriesByName(sf)[0].duration,r=Ru.length,a=1/(Ru.reduce((m,g)=>m+g,0)/r/1e3),d=Ru.filter(m=>m>rf).reduce((m,g)=>m+(g-rf)/rf,0);return{loadTime:i,fullLoadTime:e,fps:a,percentDroppedFrames:d/(r+d)*100,totalFrames:r}}};u.AJAXError=Bt,u.ARRAY_TYPE=Ja,u.Actor=class{constructor(i,e,r){this.target=i,this.parent=e,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},Ze(["receive","process"],this),this.invoker=new Lw(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=qt()?i:window}send(i,e,r,a,d=!1){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[m]=r);const g=qn(this.globalScope)?void 0:[];return this.target.postMessage({id:m,type:i,hasCallback:!!r,targetMapId:a,mustQueue:d,sourceMapId:this.mapId,data:$s(e,g)},g),{cancel:()=>{r&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(i){const e=i.data,r=e.id;if(r&&(!e.targetMapId||this.mapId===e.targetMapId))if(e.type==="<cancel>"){delete this.tasks[r];const a=this.cancelCallbacks[r];delete this.cancelCallbacks[r],a&&a()}else qt()||e.mustQueue?(this.tasks[r]=e,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,e)}process(){if(!this.taskQueue.length)return;const i=this.taskQueue.shift(),e=this.tasks[i];delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),e&&this.processTask(i,e)}processTask(i,e){if(e.type==="<response>"){const r=this.callbacks[i];delete this.callbacks[i],r&&(e.error?r(Fr(e.error)):r(null,Fr(e.data)))}else{let r=!1;const a=qn(this.globalScope)?void 0:[],d=e.hasCallback?(v,b)=>{r=!0,delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:v?$s(v):null,data:$s(b,a)},a)}:v=>{r=!0};let m=null;const g=Fr(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,g,d);else if(this.parent.getWorkerSource){const v=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,v[0],g.source)[v[1]](g,d)}else d(new Error(`Could not find function ${e.type}`));!r&&m&&m.cancel&&(this.cancelCallbacks[i]=m.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.AlphaImage=Eu,u.CanonicalTileID=Kp,u.CollisionBoxArray=p,u.CollisionCircleLayoutArray=class extends Za{},u.Color=Mt,u.DEMData=Hy,u.DataConstantProperty=et,u.DictionaryCoder=Ky,u.EXTENT=nn,u.ErrorEvent=Zt,u.EvaluationParameters=tn,u.Event=Pt,u.Evented=Wt,u.FeatureIndex=Jy,u.FillBucket=Lp,u.FillExtrusionBucket=Bp,u.GeoJSONFeature=Yy,u.ImageAtlas=My,u.ImagePosition=Np,u.KDBush=Qp,u.LineBucket=Fp,u.LineStripIndexArray=class extends t{},u.LngLat=ts,u.MercatorCoordinate=Mh,u.ONE_EM=Wn,u.OverscaledTileID=ur,u.PerformanceUtils=qw,u.Point=ie,u.Pos3dArray=class extends $a{},u.PosArray=Z,u.Properties=Ti,u.Protobuf=Up,u.QuadTriangleArray=class extends Ga{},u.RGBAImage=lr,u.RasterBoundsArray=class extends yu{},u.RequestPerformance=class{constructor(i){this._marks={start:[i.url,"start"].join("#"),end:[i.url,"end"].join("#"),measure:i.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let i=performance.getEntriesByName(this._marks.measure);return i.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),i=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),i}},u.SegmentVector=De,u.SymbolBucket=rl,u.Transitionable=hh,u.TriangleIndexArray=be,u.Uniform1f=Tr,u.Uniform1i=class extends li{constructor(i,e){super(i,e),this.current=0}set(i){this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},u.Uniform2f=class extends li{constructor(i,e){super(i,e),this.current=[0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1]))}},u.Uniform3f=class extends li{constructor(i,e){super(i,e),this.current=[0,0,0]}set(i){i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2]))}},u.Uniform4f=Ws,u.UniformColor=Jn,u.UniformMatrix4f=class extends li{constructor(i,e){super(i,e),this.current=Nn}set(i){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let e=1;e<16;e++)if(i[e]!==this.current[e]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}},u.UnwrappedTileID=Xy,u.ValidationError=Le,u.ZoomHistory=oh,u.addDynamicAttributes=qp,u.arrayBufferToImage=function(i,e){const r=new Image;r.onload=()=>{e(null,r),URL.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(()=>{r.src=En})},r.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const a=new Blob([new Uint8Array(i)],{type:"image/png"});r.src=i.byteLength?URL.createObjectURL(a):En},u.arrayBufferToImageBitmap=function(i,e){const r=new Blob([new Uint8Array(i)],{type:"image/png"});createImageBitmap(r).then(a=>{e(null,a)}).catch(a=>{e(new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},u.asyncAll=function(i,e,r){if(!i.length)return r(null,[]);let a=i.length;const d=new Array(i.length);let m=null;i.forEach((g,v)=>{e(g,(b,T)=>{b&&(m=b),d[v]=T,--a==0&&r(m,d)})})},u.bezier=Pe,u.bindAll=Ze,u.clamp=re,u.clipLine=t_,u.clone=function(i){var e=new Ja(16);return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],e},u.clone$1=We,u.collisionCircleLayout=uw,u.config=It,u.copy=function(i,e){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[4]=e[4],i[5]=e[5],i[6]=e[6],i[7]=e[7],i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},u.create=function(){var i=new Ja(16);return Ja!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},u.createExpression=an,u.createFilter=nu,u.createLayout=In,u.createStyleLayer=function(i){return i.type==="custom"?new zw(i):new Dw[i.type](i)},u.deepEqual=function i(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(let a=0;a<e.length;a++)if(!i(e[a],r[a]))return!1;return!0}if(typeof e=="object"&&e!==null&&r!==null){if(typeof r!="object"||Object.keys(e).length!==Object.keys(r).length)return!1;for(const a in e)if(!i(e[a],r[a]))return!1;return!0}return e===r},u.derefLayers=function(i){i=i.slice();const e=Object.create(null);for(let r=0;r<i.length;r++)e[i[r].id]=i[r];for(let r=0;r<i.length;r++)"ref"in i[r]&&(i[r]=_i(i[r],e[i[r].ref]));return i},u.diffStyles=function(i,e){if(!i)return[{command:dt.setStyle,args:[e]}];let r=[];try{if(!vt(i.version,e.version))return[{command:dt.setStyle,args:[e]}];vt(i.center,e.center)||r.push({command:dt.setCenter,args:[e.center]}),vt(i.zoom,e.zoom)||r.push({command:dt.setZoom,args:[e.zoom]}),vt(i.bearing,e.bearing)||r.push({command:dt.setBearing,args:[e.bearing]}),vt(i.pitch,e.pitch)||r.push({command:dt.setPitch,args:[e.pitch]}),vt(i.sprite,e.sprite)||r.push({command:dt.setSprite,args:[e.sprite]}),vt(i.glyphs,e.glyphs)||r.push({command:dt.setGlyphs,args:[e.glyphs]}),vt(i.transition,e.transition)||r.push({command:dt.setTransition,args:[e.transition]}),vt(i.light,e.light)||r.push({command:dt.setLight,args:[e.light]});const a={},d=[];(function(g,v,b,T){let k;for(k in v=v||{},g=g||{})Object.prototype.hasOwnProperty.call(g,k)&&(Object.prototype.hasOwnProperty.call(v,k)||Qr(k,b,T));for(k in v)Object.prototype.hasOwnProperty.call(v,k)&&(Object.prototype.hasOwnProperty.call(g,k)?vt(g[k],v[k])||(g[k].type==="geojson"&&v[k].type==="geojson"&&fo(g,v,k)?b.push({command:dt.setGeoJSONSourceData,args:[k,v[k].data]}):po(k,v,b,T)):un(k,v,b))})(i.sources,e.sources,d,a);const m=[];i.layers&&i.layers.forEach(g=>{a[g.source]?r.push({command:dt.removeLayer,args:[g.id]}):m.push(g)}),r=r.concat(d),function(g,v,b){v=v||[];const T=(g=g||[]).map(Zn),k=v.map(Zn),A=g.reduce(Lr,{}),L=v.reduce(Lr,{}),B=T.slice(),O=Object.create(null);let G,j,ee,ae,J,ce,fe;for(G=0,j=0;G<T.length;G++)ee=T[G],Object.prototype.hasOwnProperty.call(L,ee)?j++:(b.push({command:dt.removeLayer,args:[ee]}),B.splice(B.indexOf(ee,j),1));for(G=0,j=0;G<k.length;G++)ee=k[k.length-1-G],B[B.length-1-G]!==ee&&(Object.prototype.hasOwnProperty.call(A,ee)?(b.push({command:dt.removeLayer,args:[ee]}),B.splice(B.lastIndexOf(ee,B.length-j),1)):j++,ce=B[B.length-G],b.push({command:dt.addLayer,args:[L[ee],ce]}),B.splice(B.length-G,0,ee),O[ee]=!0);for(G=0;G<k.length;G++)if(ee=k[G],ae=A[ee],J=L[ee],!O[ee]&&!vt(ae,J))if(vt(ae.source,J.source)&&vt(ae["source-layer"],J["source-layer"])&&vt(ae.type,J.type)){for(fe in Gt(ae.layout,J.layout,b,ee,null,dt.setLayoutProperty),Gt(ae.paint,J.paint,b,ee,null,dt.setPaintProperty),vt(ae.filter,J.filter)||b.push({command:dt.setFilter,args:[ee,J.filter]}),vt(ae.minzoom,J.minzoom)&&vt(ae.maxzoom,J.maxzoom)||b.push({command:dt.setLayerZoomRange,args:[ee,J.minzoom,J.maxzoom]}),ae)Object.prototype.hasOwnProperty.call(ae,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?Gt(ae[fe],J[fe],b,ee,fe.slice(6),dt.setPaintProperty):vt(ae[fe],J[fe])||b.push({command:dt.setLayerProperty,args:[ee,fe,J[fe]]}));for(fe in J)Object.prototype.hasOwnProperty.call(J,fe)&&!Object.prototype.hasOwnProperty.call(ae,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?Gt(ae[fe],J[fe],b,ee,fe.slice(6),dt.setPaintProperty):vt(ae[fe],J[fe])||b.push({command:dt.setLayerProperty,args:[ee,fe,J[fe]]}))}else b.push({command:dt.removeLayer,args:[ee]}),ce=B[B.lastIndexOf(ee)+1],b.push({command:dt.addLayer,args:[J,ce]})}(m,e.layers,r)}catch(a){console.warn("Unable to compute style diff:",a),r=[{command:dt.setStyle,args:[e]}]}return r},u.dot=function(i,e){return i[0]*e[0]+i[1]*e[1]+i[2]*e[2]+i[3]*e[3]},u.earthRadius=Xp,u.ease=qe,u.emitValidationErrors=Ho,u.emptyStyle=function(){const i={},e=me.$version;for(const r in me.$root){const a=me.$root[r];if(a.required){let d=null;d=r==="version"?e:a.type==="array"?[]:{},d!=null&&(i[r]=d)}}return i},u.equals=function(i,e){var r=i[0],a=i[1],d=i[2],m=i[3],g=i[4],v=i[5],b=i[6],T=i[7],k=i[8],A=i[9],L=i[10],B=i[11],O=i[12],G=i[13],j=i[14],ee=i[15],ae=e[0],J=e[1],ce=e[2],fe=e[3],_e=e[4],He=e[5],Ye=e[6],Ne=e[7],Be=e[8],ze=e[9],Ve=e[10],Oe=e[11],Te=e[12],ot=e[13],Qe=e[14],St=e[15];return Math.abs(r-ae)<=Ci*Math.max(1,Math.abs(r),Math.abs(ae))&&Math.abs(a-J)<=Ci*Math.max(1,Math.abs(a),Math.abs(J))&&Math.abs(d-ce)<=Ci*Math.max(1,Math.abs(d),Math.abs(ce))&&Math.abs(m-fe)<=Ci*Math.max(1,Math.abs(m),Math.abs(fe))&&Math.abs(g-_e)<=Ci*Math.max(1,Math.abs(g),Math.abs(_e))&&Math.abs(v-He)<=Ci*Math.max(1,Math.abs(v),Math.abs(He))&&Math.abs(b-Ye)<=Ci*Math.max(1,Math.abs(b),Math.abs(Ye))&&Math.abs(T-Ne)<=Ci*Math.max(1,Math.abs(T),Math.abs(Ne))&&Math.abs(k-Be)<=Ci*Math.max(1,Math.abs(k),Math.abs(Be))&&Math.abs(A-ze)<=Ci*Math.max(1,Math.abs(A),Math.abs(ze))&&Math.abs(L-Ve)<=Ci*Math.max(1,Math.abs(L),Math.abs(Ve))&&Math.abs(B-Oe)<=Ci*Math.max(1,Math.abs(B),Math.abs(Oe))&&Math.abs(O-Te)<=Ci*Math.max(1,Math.abs(O),Math.abs(Te))&&Math.abs(G-ot)<=Ci*Math.max(1,Math.abs(G),Math.abs(ot))&&Math.abs(j-Qe)<=Ci*Math.max(1,Math.abs(j),Math.abs(Qe))&&Math.abs(ee-St)<=Ci*Math.max(1,Math.abs(ee),Math.abs(St))},u.evaluateSizeForFeature=function(i,{uSize:e,uSizeT:r},{lowerSize:a,upperSize:d}){return i.kind==="source"?a/Eo:i.kind==="composite"?Si.number(a/Eo,d/Eo,r):e},u.evaluateSizeForZoom=function(i,e){let r=0,a=0;if(i.kind==="constant")a=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:d,minZoom:m,maxZoom:g}=i,v=d?re(Ri.interpolationFactor(d,e,m,g),0,1):0;i.kind==="camera"?a=Si.number(i.minSize,i.maxSize,v):r=v}return{uSizeT:r,uSize:a}},u.evaluateVariableOffset=u_,u.evented=Oa,u.exported=ct,u.extend=le,u.filterObject=Ae,u.findLineIntersection=function(i,e,r,a){const d=e.y-i.y,m=e.x-i.x,g=a.y-r.y,v=a.x-r.x,b=g*m-v*d;if(b===0)return null;const T=(v*(i.y-r.y)-g*(i.x-r.x))/b;return new ie(i.x+T*m,i.y+T*d)},u.fromScaling=function(i,e){return i[0]=e[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=e[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=e[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},u.getAnchorAlignment=$p,u.getAnchorJustification=Jp,u.getArrayBuffer=si,u.getDefaultExportFromCjs=U,u.getJSON=function(i,e){return Ut(le(i,{type:"json"}),e)},u.getOverlapMode=jp,u.getProtocolAction=Tn,u.getRTLTextPluginStatus=du,u.getReferrer=zi,u.getVideo=function(i,e){const r=window.document.createElement("video");r.muted=!0,r.onloadstart=function(){e(null,r)};for(let a=0;a<i.length;a++){const d=window.document.createElement("source");ho(i[a])||(r.crossOrigin="Anonymous"),d.src=i[a],r.appendChild(d)}return{cancel:()=>{}}},u.groupByLayout=function(i,e){const r={};for(let d=0;d<i.length;d++){const m=e&&e[i[d].id]||mp(i[d]);e&&(e[i[d].id]=m);let g=r[m];g||(g=r[m]=[]),g.push(i[d])}const a=[];for(const d in r)a.push(r[d]);return a},u.identity=Ep,u.interpolate=Si,u.invert=function(i,e){var r=e[0],a=e[1],d=e[2],m=e[3],g=e[4],v=e[5],b=e[6],T=e[7],k=e[8],A=e[9],L=e[10],B=e[11],O=e[12],G=e[13],j=e[14],ee=e[15],ae=r*v-a*g,J=r*b-d*g,ce=r*T-m*g,fe=a*b-d*v,_e=a*T-m*v,He=d*T-m*b,Ye=k*G-A*O,Ne=k*j-L*O,Be=k*ee-B*O,ze=A*j-L*G,Ve=A*ee-B*G,Oe=L*ee-B*j,Te=ae*Oe-J*Ve+ce*ze+fe*Be-_e*Ne+He*Ye;return Te?(i[0]=(v*Oe-b*Ve+T*ze)*(Te=1/Te),i[1]=(d*Ve-a*Oe-m*ze)*Te,i[2]=(G*He-j*_e+ee*fe)*Te,i[3]=(L*_e-A*He-B*fe)*Te,i[4]=(b*Be-g*Oe-T*Ne)*Te,i[5]=(r*Oe-d*Be+m*Ne)*Te,i[6]=(j*ce-O*He-ee*J)*Te,i[7]=(k*He-L*ce+B*J)*Te,i[8]=(g*Ve-v*Be+T*Ye)*Te,i[9]=(a*Be-r*Ve-m*Ye)*Te,i[10]=(O*_e-G*ce+ee*ae)*Te,i[11]=(A*ce-k*_e-B*ae)*Te,i[12]=(v*Ne-g*ze-b*Ye)*Te,i[13]=(r*ze-a*Ne+d*Ye)*Te,i[14]=(G*J-O*fe-j*ae)*Te,i[15]=(k*fe-A*J+L*ae)*Te,i):null},u.isImageBitmap=gi,u.isSafari=qn,u.isWorker=qt,u.keysDifference=function(i,e){const r=[];for(const a in i)a in e||r.push(a);return r},u.lazyLoadRTLTextPlugin=function(){Ki.isLoading()||Ki.isLoaded()||du()!=="deferred"||ch()},u.makeRequest=Ut,u.mapObject=Fe,u.mercatorXfromLng=qy,u.mercatorYfromLat=Zy,u.mercatorZfromAltitude=Gy,u.mul=w1,u.mul$1=function(i,e,r){return i[0]=e[0]*r[0],i[1]=e[1]*r[1],i[2]=e[2]*r[2],i[3]=e[3]*r[3],i},u.multiply=Kg,u.nextPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))},u.operations=dt,u.ortho=function(i,e,r,a,d,m,g){var v=1/(e-r),b=1/(a-d),T=1/(m-g);return i[0]=-2*v,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*b,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*T,i[11]=0,i[12]=(e+r)*v,i[13]=(d+a)*b,i[14]=(g+m)*T,i[15]=1,i},u.parseCacheControl=function(i){const e={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,a,d,m)=>{const g=d||m;return e[a]=!g||g.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e},u.parseGlyphPbf=function(i){return new Up(i).readFields(xw,[])},u.pbf=by,u.performSymbolLayout=function(i){i.bucket.createArrays(),i.bucket.tilePixelRatio=nn/(512*i.bucket.overscaling),i.bucket.compareText={},i.bucket.iconsNeedLinear=!1;const e=i.bucket.layers[0].layout,r=i.bucket.layers[0]._unevaluatedLayout._values,a={layoutIconSize:r["icon-size"].possiblyEvaluate(new tn(i.bucket.zoom+1),i.canonical),layoutTextSize:r["text-size"].possiblyEvaluate(new tn(i.bucket.zoom+1),i.canonical),textMaxSize:r["text-size"].possiblyEvaluate(new tn(18))};if(i.bucket.textSizeData.kind==="composite"){const{minZoom:b,maxZoom:T}=i.bucket.textSizeData;a.compositeTextSizes=[r["text-size"].possiblyEvaluate(new tn(b),i.canonical),r["text-size"].possiblyEvaluate(new tn(T),i.canonical)]}if(i.bucket.iconSizeData.kind==="composite"){const{minZoom:b,maxZoom:T}=i.bucket.iconSizeData;a.compositeIconSizes=[r["icon-size"].possiblyEvaluate(new tn(b),i.canonical),r["icon-size"].possiblyEvaluate(new tn(T),i.canonical)]}const d=e.get("text-line-height")*Wn,m=e.get("text-rotation-alignment")!=="viewport"&&e.get("symbol-placement")!=="point",g=e.get("text-keep-upright"),v=e.get("text-size");for(const b of i.bucket.features){const T=e.get("text-font").evaluate(b,{},i.canonical).join(","),k=v.evaluate(b,{},i.canonical),A=a.layoutTextSize.evaluate(b,{},i.canonical),L=a.layoutIconSize.evaluate(b,{},i.canonical),B={horizontal:{},vertical:void 0},O=b.text;let G,j=[0,0];if(O){const J=O.toString(),ce=e.get("text-letter-spacing").evaluate(b,{},i.canonical)*Wn,fe=lu(J)?ce:0,_e=e.get("text-anchor").evaluate(b,{},i.canonical),He=e.get("text-variable-anchor");if(!He){const Ve=e.get("text-radial-offset").evaluate(b,{},i.canonical);j=Ve?u_(_e,[Ve*Wn,Yp]):e.get("text-offset").evaluate(b,{},i.canonical).map(Oe=>Oe*Wn)}let Ye=m?"center":e.get("text-justify").evaluate(b,{},i.canonical);const Ne=e.get("symbol-placement"),Be=Ne==="point"?e.get("text-max-width").evaluate(b,{},i.canonical)*Wn:0,ze=()=>{i.bucket.allowVerticalPlacement&&Da(J)&&(B.vertical=Ch(O,i.glyphMap,i.glyphPositions,i.imagePositions,T,Be,d,_e,"left",fe,j,u.WritingMode.vertical,!0,Ne,A,k))};if(!m&&He){const Ve=Ye==="auto"?He.map(Te=>Jp(Te)):[Ye];let Oe=!1;for(let Te=0;Te<Ve.length;Te++){const ot=Ve[Te];if(!B.horizontal[ot])if(Oe)B.horizontal[ot]=B.horizontal[0];else{const Qe=Ch(O,i.glyphMap,i.glyphPositions,i.imagePositions,T,Be,d,"center",ot,fe,j,u.WritingMode.horizontal,!1,Ne,A,k);Qe&&(B.horizontal[ot]=Qe,Oe=Qe.positionedLines.length===1)}}ze()}else{Ye==="auto"&&(Ye=Jp(_e));const Ve=Ch(O,i.glyphMap,i.glyphPositions,i.imagePositions,T,Be,d,_e,Ye,fe,j,u.WritingMode.horizontal,!1,Ne,A,k);Ve&&(B.horizontal[Ye]=Ve),ze(),Da(J)&&m&&g&&(B.vertical=Ch(O,i.glyphMap,i.glyphPositions,i.imagePositions,T,Be,d,_e,Ye,fe,j,u.WritingMode.vertical,!1,Ne,A,k))}}let ee=!1;if(b.icon&&b.icon.name){const J=i.imageMap[b.icon.name];J&&(G=Cw(i.imagePositions[b.icon.name],e.get("icon-offset").evaluate(b,{},i.canonical),e.get("icon-anchor").evaluate(b,{},i.canonical)),ee=!!J.sdf,i.bucket.sdfIcons===void 0?i.bucket.sdfIcons=ee:i.bucket.sdfIcons!==ee&&st("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(J.pixelRatio!==i.bucket.pixelRatio||e.get("icon-rotate").constantOr(1)!==0)&&(i.bucket.iconsNeedLinear=!0))}const ae=h_(B.horizontal)||B.vertical;i.bucket.iconsInText=!!ae&&ae.iconsInText,(ae||G)&&$w(i.bucket,b,B,G,i.imageMap,a,A,L,j,ee,i.canonical)}i.showCollisionBoxes&&i.bucket.generateCollisionDebugBuffers()},u.perspective=function(i,e,r,a,d){var m,g=1/Math.tan(e/2);return i[0]=g/r,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=g,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,d!=null&&d!==1/0?(i[10]=(d+a)*(m=1/(a-d)),i[14]=2*d*a*m):(i[10]=-1,i[14]=-2*a),i},u.pick=function(i,e){const r={};for(let a=0;a<e.length;a++){const d=e[a];d in i&&(r[d]=i[d])}return r},u.plugin=Ki,u.pointGeometry=D,u.polygonIntersectsPolygon=qg,u.potpack=Py,u.register=Ke,u.registerForPluginStateChange=function(i){return i({pluginStatus:Ei,pluginURL:ro}),Oa.on("pluginStateChange",i),i},u.renderColorRamp=ty,u.rotateX=function(i,e,r){var a=Math.sin(r),d=Math.cos(r),m=e[4],g=e[5],v=e[6],b=e[7],T=e[8],k=e[9],A=e[10],L=e[11];return e!==i&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[4]=m*d+T*a,i[5]=g*d+k*a,i[6]=v*d+A*a,i[7]=b*d+L*a,i[8]=T*d-m*a,i[9]=k*d-g*a,i[10]=A*d-v*a,i[11]=L*d-b*a,i},u.rotateZ=function(i,e,r){var a=Math.sin(r),d=Math.cos(r),m=e[0],g=e[1],v=e[2],b=e[3],T=e[4],k=e[5],A=e[6],L=e[7];return e!==i&&(i[8]=e[8],i[9]=e[9],i[10]=e[10],i[11]=e[11],i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]),i[0]=m*d+T*a,i[1]=g*d+k*a,i[2]=v*d+A*a,i[3]=b*d+L*a,i[4]=T*d-m*a,i[5]=k*d-g*a,i[6]=A*d-v*a,i[7]=L*d-b*a,i},u.sameOrigin=ho,u.scale=function(i,e,r){var a=r[0],d=r[1],m=r[2];return i[0]=e[0]*a,i[1]=e[1]*a,i[2]=e[2]*a,i[3]=e[3]*a,i[4]=e[4]*d,i[5]=e[5]*d,i[6]=e[6]*d,i[7]=e[7]*d,i[8]=e[8]*m,i[9]=e[9]*m,i[10]=e[10]*m,i[11]=e[11]*m,i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15],i},u.setRTLTextPlugin=function(i,e,r=!1){if(Ei===uu||Ei===Fa||Ei===cu)throw new Error("setRTLTextPlugin cannot be called multiple times.");ro=ct.resolveURL(i),Ei=uu,js=e,hu(),r||ch()},u.sphericalToCartesian=function([i,e,r]){return e+=90,e*=Math.PI/180,r*=Math.PI/180,{x:i*Math.cos(e)*Math.sin(r),y:i*Math.sin(e)*Math.sin(r),z:i*Math.cos(r)}},u.toEvaluationFeature=Hs,u.transformMat4=_h,u.translate=function(i,e,r){var a,d,m,g,v,b,T,k,A,L,B,O,G=r[0],j=r[1],ee=r[2];return e===i?(i[12]=e[0]*G+e[4]*j+e[8]*ee+e[12],i[13]=e[1]*G+e[5]*j+e[9]*ee+e[13],i[14]=e[2]*G+e[6]*j+e[10]*ee+e[14],i[15]=e[3]*G+e[7]*j+e[11]*ee+e[15]):(d=e[1],m=e[2],g=e[3],v=e[4],b=e[5],T=e[6],k=e[7],A=e[8],L=e[9],B=e[10],O=e[11],i[0]=a=e[0],i[1]=d,i[2]=m,i[3]=g,i[4]=v,i[5]=b,i[6]=T,i[7]=k,i[8]=A,i[9]=L,i[10]=B,i[11]=O,i[12]=a*G+v*j+A*ee+e[12],i[13]=d*G+b*j+L*ee+e[13],i[14]=m*G+T*j+B*ee+e[14],i[15]=g*G+k*j+O*ee+e[15]),i},u.triggerPluginCompletionEvent=uh,u.unicodeBlockLookup=Ue,u.uniqueId=function(){return Ee++},u.v8Spec=me,u.validateCustomStyleLayer=function(i){const e=[],r=i.id;return r===void 0&&e.push({message:`layers.${r}: missing required property "id"`}),i.render===void 0&&e.push({message:`layers.${r}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&e.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),e},u.validateLight=gp,u.validateStyle=io,u.vectorTile=Jo,u.warnOnce=st,u.wrap=te}),w(["./shared"],function(u){class U{constructor(z){this.keyCache={},z&&this.replace(z)}replace(z){this._layerConfigs={},this._layers={},this.update(z,[])}update(z,R){for(const X of z){this._layerConfigs[X.id]=X;const Y=this._layers[X.id]=u.createStyleLayer(X);Y._featureFilter=u.createFilter(Y.filter),this.keyCache[X.id]&&delete this.keyCache[X.id]}for(const X of R)delete this.keyCache[X],delete this._layerConfigs[X],delete this._layers[X];this.familiesBySource={};const N=u.groupByLayout(Object.values(this._layerConfigs),this.keyCache);for(const X of N){const Y=X.map(ye=>this._layers[ye.id]),oe=Y[0];if(oe.visibility==="none")continue;const ne=oe.source||"";let K=this.familiesBySource[ne];K||(K=this.familiesBySource[ne]={});const se=oe.sourceLayer||"_geojsonTileLayer";let ve=K[se];ve||(ve=K[se]=[]),ve.push(Y)}}}class D{constructor(z){const R={},N=[];for(const ne in z){const K=z[ne],se=R[ne]={};for(const ve in K){const ye=K[+ve];if(!ye||ye.bitmap.width===0||ye.bitmap.height===0)continue;const xe={x:0,y:0,w:ye.bitmap.width+2,h:ye.bitmap.height+2};N.push(xe),se[ve]={rect:xe,metrics:ye.metrics}}}const{w:X,h:Y}=u.potpack(N),oe=new u.AlphaImage({width:X||1,height:Y||1});for(const ne in z){const K=z[ne];for(const se in K){const ve=K[+se];if(!ve||ve.bitmap.width===0||ve.bitmap.height===0)continue;const ye=R[ne][se].rect;u.AlphaImage.copy(ve.bitmap,oe,{x:0,y:0},{x:ye.x+1,y:ye.y+1},ve.bitmap)}}this.image=oe,this.positions=R}}u.register("GlyphAtlas",D);class ue{constructor(z){this.tileID=new u.OverscaledTileID(z.tileID.overscaledZ,z.tileID.wrap,z.tileID.canonical.z,z.tileID.canonical.x,z.tileID.canonical.y),this.uid=z.uid,this.zoom=z.zoom,this.pixelRatio=z.pixelRatio,this.tileSize=z.tileSize,this.source=z.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=z.showCollisionBoxes,this.collectResourceTiming=!!z.collectResourceTiming,this.returnDependencies=!!z.returnDependencies,this.promoteId=z.promoteId}parse(z,R,N,X,Y){this.status="parsing",this.data=z,this.collisionBoxArray=new u.CollisionBoxArray;const oe=new u.DictionaryCoder(Object.keys(z.layers).sort()),ne=new u.FeatureIndex(this.tileID,this.promoteId);ne.bucketLayerIDs=[];const K={},se={featureIndex:ne,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:N},ve=R.familiesBySource[this.source];for(const xt in ve){const Ft=z.layers[xt];if(!Ft)continue;Ft.version===1&&u.warnOnce(`Vector tile source "${this.source}" layer "${xt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Nt=oe.encode(xt),en=[];for(let on=0;on<Ft.length;on++){const gn=Ft.feature(on),Mt=ne.getId(gn,xt);en.push({feature:gn,id:Mt,index:on,sourceLayerIndex:Nt})}for(const on of ve[xt]){const gn=on[0];gn.source!==this.source&&u.warnOnce(`layer.source = ${gn.source} does not equal this.source = ${this.source}`),gn.minzoom&&this.zoom<Math.floor(gn.minzoom)||gn.maxzoom&&this.zoom>=gn.maxzoom||gn.visibility!=="none"&&(ie(on,this.zoom,N),(K[gn.id]=gn.createBucket({index:ne.bucketLayerIDs.length,layers:on,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Nt,sourceID:this.source})).populate(en,se,this.tileID.canonical),ne.bucketLayerIDs.push(on.map(Mt=>Mt.id)))}}let ye,xe,nt,pt;const Je=u.mapObject(se.glyphDependencies,xt=>Object.keys(xt).map(Number));Object.keys(Je).length?X.send("getGlyphs",{uid:this.uid,stacks:Je,source:this.source,tileID:this.tileID,type:"glyphs"},(xt,Ft)=>{ye||(ye=xt,xe=Ft,Ct.call(this))}):xe={};const it=Object.keys(se.iconDependencies);it.length?X.send("getImages",{icons:it,source:this.source,tileID:this.tileID,type:"icons"},(xt,Ft)=>{ye||(ye=xt,nt=Ft,Ct.call(this))}):nt={};const gt=Object.keys(se.patternDependencies);function Ct(){if(ye)return Y(ye);if(xe&&nt&&pt){const xt=new D(xe),Ft=new u.ImageAtlas(nt,pt);for(const Nt in K){const en=K[Nt];en instanceof u.SymbolBucket?(ie(en.layers,this.zoom,N),u.performSymbolLayout({bucket:en,glyphMap:xe,glyphPositions:xt.positions,imageMap:nt,imagePositions:Ft.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):en.hasPattern&&(en instanceof u.LineBucket||en instanceof u.FillBucket||en instanceof u.FillExtrusionBucket)&&(ie(en.layers,this.zoom,N),en.addFeatures(se,this.tileID.canonical,Ft.patternPositions))}this.status="done",Y(null,{buckets:Object.values(K).filter(Nt=>!Nt.isEmpty()),featureIndex:ne,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:xt.image,imageAtlas:Ft,glyphMap:this.returnDependencies?xe:null,iconMap:this.returnDependencies?nt:null,glyphPositions:this.returnDependencies?xt.positions:null})}}gt.length?X.send("getImages",{icons:gt,source:this.source,tileID:this.tileID,type:"patterns"},(xt,Ft)=>{ye||(ye=xt,pt=Ft,Ct.call(this))}):pt={},Ct.call(this)}}function ie($,z,R){const N=new u.EvaluationParameters(z);for(const X of $)X.recalculate(N,R)}function pe($,z){const R=u.getArrayBuffer($.request,(N,X,Y,oe)=>{N?z(N):X&&z(null,{vectorTile:new u.vectorTile.VectorTile(new u.Protobuf(X)),rawData:X,cacheControl:Y,expires:oe})});return()=>{R.cancel(),z()}}class Ce{constructor(z,R,N,X){this.actor=z,this.layerIndex=R,this.availableImages=N,this.loadVectorData=X||pe,this.loading={},this.loaded={}}loadTile(z,R){const N=z.uid;this.loading||(this.loading={});const X=!!(z&&z.request&&z.request.collectResourceTiming)&&new u.RequestPerformance(z.request),Y=this.loading[N]=new ue(z);Y.abort=this.loadVectorData(z,(oe,ne)=>{if(delete this.loading[N],oe||!ne)return Y.status="done",this.loaded[N]=Y,R(oe);const K=ne.rawData,se={};ne.expires&&(se.expires=ne.expires),ne.cacheControl&&(se.cacheControl=ne.cacheControl);const ve={};if(X){const ye=X.finish();ye&&(ve.resourceTiming=JSON.parse(JSON.stringify(ye)))}Y.vectorTile=ne.vectorTile,Y.parse(ne.vectorTile,this.layerIndex,this.availableImages,this.actor,(ye,xe)=>{if(ye||!xe)return R(ye);R(null,u.extend({rawTileData:K.slice(0)},xe,se,ve))}),this.loaded=this.loaded||{},this.loaded[N]=Y})}reloadTile(z,R){const N=this.loaded,X=z.uid,Y=this;if(N&&N[X]){const oe=N[X];oe.showCollisionBoxes=z.showCollisionBoxes;const ne=(K,se)=>{const ve=oe.reloadCallback;ve&&(delete oe.reloadCallback,oe.parse(oe.vectorTile,Y.layerIndex,this.availableImages,Y.actor,ve)),R(K,se)};oe.status==="parsing"?oe.reloadCallback=ne:oe.status==="done"&&(oe.vectorTile?oe.parse(oe.vectorTile,this.layerIndex,this.availableImages,this.actor,ne):ne())}}abortTile(z,R){const N=this.loading,X=z.uid;N&&N[X]&&N[X].abort&&(N[X].abort(),delete N[X]),R()}removeTile(z,R){const N=this.loaded,X=z.uid;N&&N[X]&&delete N[X],R()}}class ke{constructor(){this.loaded={}}loadTile(z,R){const{uid:N,encoding:X,rawImageData:Y}=z,oe=u.isImageBitmap(Y)?this.getImageData(Y):Y,ne=new u.DEMData(N,oe,X);this.loaded=this.loaded||{},this.loaded[N]=ne,R(null,ne)}getImageData(z){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(z.width,z.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=z.width,this.offscreenCanvas.height=z.height,this.offscreenCanvasContext.drawImage(z,0,0,z.width,z.height);const R=this.offscreenCanvasContext.getImageData(-1,-1,z.width+2,z.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new u.RGBAImage({width:R.width,height:R.height},R.data)}removeTile(z){const R=this.loaded,N=z.uid;R&&R[N]&&delete R[N]}}function Pe($,z){if($.length!==0){qe($[0],z);for(var R=1;R<$.length;R++)qe($[R],!z)}}function qe($,z){for(var R=0,N=0,X=0,Y=$.length,oe=Y-1;X<Y;oe=X++){var ne=($[X][0]-$[oe][0])*($[oe][1]+$[X][1]),K=R+ne;N+=Math.abs(R)>=Math.abs(ne)?R-K+ne:ne-K+R,R=K}R+N>=0!=!!z&&$.reverse()}var re=u.getDefaultExportFromCjs(function $(z,R){var N,X=z&&z.type;if(X==="FeatureCollection")for(N=0;N<z.features.length;N++)$(z.features[N],R);else if(X==="GeometryCollection")for(N=0;N<z.geometries.length;N++)$(z.geometries[N],R);else if(X==="Feature")$(z.geometry,R);else if(X==="Polygon")Pe(z.coordinates,R);else if(X==="MultiPolygon")for(N=0;N<z.coordinates.length;N++)Pe(z.coordinates[N],R);return z});const te=u.vectorTile.VectorTileFeature.prototype.toGeoJSON;var le={exports:{}},Ee=u.pointGeometry,Ze=u.vectorTile.VectorTileFeature,Fe=Ae;function Ae($,z){this.options=z||{},this.features=$,this.length=$.length}function We($,z){this.id=typeof $.id=="number"?$.id:void 0,this.type=$.type,this.rawGeometry=$.type===1?[$.geometry]:$.geometry,this.properties=$.tags,this.extent=z||4096}Ae.prototype.feature=function($){return new We(this.features[$],this.options.extent)},We.prototype.loadGeometry=function(){var $=this.rawGeometry;this.geometry=[];for(var z=0;z<$.length;z++){for(var R=$[z],N=[],X=0;X<R.length;X++)N.push(new Ee(R[X][0],R[X][1]));this.geometry.push(N)}return this.geometry},We.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var $=this.geometry,z=1/0,R=-1/0,N=1/0,X=-1/0,Y=0;Y<$.length;Y++)for(var oe=$[Y],ne=0;ne<oe.length;ne++){var K=oe[ne];z=Math.min(z,K.x),R=Math.max(R,K.x),N=Math.min(N,K.y),X=Math.max(X,K.y)}return[z,N,R,X]},We.prototype.toGeoJSON=Ze.prototype.toGeoJSON;var bt=u.pbf,st=Fe;function _t($){var z=new bt;return function(R,N){for(var X in R.layers)N.writeMessage(3,mi,R.layers[X])}($,z),z.finish()}function mi($,z){var R;z.writeVarintField(15,$.version||1),z.writeStringField(1,$.name||""),z.writeVarintField(5,$.extent||4096);var N={keys:[],values:[],keycache:{},valuecache:{}};for(R=0;R<$.length;R++)N.feature=$.feature(R),z.writeMessage(2,qt,N);var X=N.keys;for(R=0;R<X.length;R++)z.writeStringField(3,X[R]);var Y=N.values;for(R=0;R<Y.length;R++)z.writeMessage(4,Xe,Y[R])}function qt($,z){var R=$.feature;R.id!==void 0&&z.writeVarintField(1,R.id),z.writeMessage(2,Kn,$),z.writeVarintField(3,R.type),z.writeMessage(4,En,R)}function Kn($,z){var R=$.feature,N=$.keys,X=$.values,Y=$.keycache,oe=$.valuecache;for(var ne in R.properties){var K=R.properties[ne],se=Y[ne];if(K!==null){se===void 0&&(N.push(ne),Y[ne]=se=N.length-1),z.writeVarint(se);var ve=typeof K;ve!=="string"&&ve!=="boolean"&&ve!=="number"&&(K=JSON.stringify(K));var ye=ve+":"+K,xe=oe[ye];xe===void 0&&(X.push(K),oe[ye]=xe=X.length-1),z.writeVarint(xe)}}}function qn($,z){return(z<<3)+(7&$)}function gi($){return $<<1^$>>31}function En($,z){for(var R=$.loadGeometry(),N=$.type,X=0,Y=0,oe=R.length,ne=0;ne<oe;ne++){var K=R[ne],se=1;N===1&&(se=K.length),z.writeVarint(qn(1,se));for(var ve=N===3?K.length-1:K.length,ye=0;ye<ve;ye++){ye===1&&N!==1&&z.writeVarint(qn(2,ve-1));var xe=K[ye].x-X,nt=K[ye].y-Y;z.writeVarint(gi(xe)),z.writeVarint(gi(nt)),X+=xe,Y+=nt}N===3&&z.writeVarint(qn(7,1))}}function Xe($,z){var R=typeof $;R==="string"?z.writeStringField(1,$):R==="boolean"?z.writeBooleanField(7,$):R==="number"&&($%1!=0?z.writeDoubleField(3,$):$<0?z.writeSVarintField(6,$):z.writeVarintField(5,$))}le.exports=_t,le.exports.fromVectorTileJs=_t,le.exports.fromGeojsonVt=function($,z){z=z||{};var R={};for(var N in $)R[N]=new st($[N].features,z),R[N].name=N,R[N].version=z.version,R[N].extent=z.extent;return _t({layers:R})},le.exports.GeoJSONWrapper=st;var ht=u.getDefaultExportFromCjs(le.exports);const ct={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:$=>$},It=Math.fround||(Bt=new Float32Array(1),$=>(Bt[0]=+$,Bt[0]));var Bt;class zi{constructor(z){this.options=Object.assign(Object.create(ct),z),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(z){const{log:R,minZoom:N,maxZoom:X}=this.options;R&&console.time("total time");const Y=`prepare ${z.length} points`;R&&console.time(Y),this.points=z;const oe=[];for(let K=0;K<z.length;K++){const se=z[K];if(!se.geometry)continue;const[ve,ye]=se.geometry.coordinates,xe=It(Ut(ve)),nt=It(si(ye));oe.push(xe,nt,1/0,K,-1,1),this.options.reduce&&oe.push(0)}let ne=this.trees[X+1]=this._createTree(oe);R&&console.timeEnd(Y);for(let K=X;K>=N;K--){const se=+Date.now();ne=this.trees[K]=this._createTree(this._cluster(ne,K)),R&&console.log("z%d: %d clusters in %dms",K,ne.numItems,+Date.now()-se)}return R&&console.timeEnd("total time"),this}getClusters(z,R){let N=((z[0]+180)%360+360)%360-180;const X=Math.max(-90,Math.min(90,z[1]));let Y=z[2]===180?180:((z[2]+180)%360+360)%360-180;const oe=Math.max(-90,Math.min(90,z[3]));if(z[2]-z[0]>=360)N=-180,Y=180;else if(N>Y){const ye=this.getClusters([N,X,180,oe],R),xe=this.getClusters([-180,X,Y,oe],R);return ye.concat(xe)}const ne=this.trees[this._limitZoom(R)],K=ne.range(Ut(N),si(oe),Ut(Y),si(X)),se=ne.data,ve=[];for(const ye of K){const xe=this.stride*ye;ve.push(se[xe+5]>1?Tn(se,xe,this.clusterProps):this.points[se[xe+3]])}return ve}getChildren(z){const R=this._getOriginId(z),N=this._getOriginZoom(z),X="No cluster with the specified id.",Y=this.trees[N];if(!Y)throw new Error(X);const oe=Y.data;if(R*this.stride>=oe.length)throw new Error(X);const ne=this.options.radius/(this.options.extent*Math.pow(2,N-1)),K=Y.within(oe[R*this.stride],oe[R*this.stride+1],ne),se=[];for(const ve of K){const ye=ve*this.stride;oe[ye+4]===z&&se.push(oe[ye+5]>1?Tn(oe,ye,this.clusterProps):this.points[oe[ye+3]])}if(se.length===0)throw new Error(X);return se}getLeaves(z,R,N){const X=[];return this._appendLeaves(X,z,R=R||10,N=N||0,0),X}getTile(z,R,N){const X=this.trees[this._limitZoom(z)],Y=Math.pow(2,z),{extent:oe,radius:ne}=this.options,K=ne/oe,se=(N-K)/Y,ve=(N+1+K)/Y,ye={features:[]};return this._addTileFeatures(X.range((R-K)/Y,se,(R+1+K)/Y,ve),X.data,R,N,Y,ye),R===0&&this._addTileFeatures(X.range(1-K/Y,se,1,ve),X.data,Y,N,Y,ye),R===Y-1&&this._addTileFeatures(X.range(0,se,K/Y,ve),X.data,-1,N,Y,ye),ye.features.length?ye:null}getClusterExpansionZoom(z){let R=this._getOriginZoom(z)-1;for(;R<=this.options.maxZoom;){const N=this.getChildren(z);if(R++,N.length!==1)break;z=N[0].properties.cluster_id}return R}_appendLeaves(z,R,N,X,Y){const oe=this.getChildren(R);for(const ne of oe){const K=ne.properties;if(K&&K.cluster?Y+K.point_count<=X?Y+=K.point_count:Y=this._appendLeaves(z,K.cluster_id,N,X,Y):Y<X?Y++:z.push(ne),z.length===N)break}return Y}_createTree(z){const R=new u.KDBush(z.length/this.stride|0,this.options.nodeSize,Float32Array);for(let N=0;N<z.length;N+=this.stride)R.add(z[N],z[N+1]);return R.finish(),R.data=z,R}_addTileFeatures(z,R,N,X,Y,oe){for(const ne of z){const K=ne*this.stride,se=R[K+5]>1;let ve,ye,xe;if(se)ve=Di(R,K,this.clusterProps),ye=R[K],xe=R[K+1];else{const Je=this.points[R[K+3]];ve=Je.properties;const[it,gt]=Je.geometry.coordinates;ye=Ut(it),xe=si(gt)}const nt={type:1,geometry:[[Math.round(this.options.extent*(ye*Y-N)),Math.round(this.options.extent*(xe*Y-X))]],tags:ve};let pt;pt=se||this.options.generateId?R[K+3]:this.points[R[K+3]].id,pt!==void 0&&(nt.id=pt),oe.features.push(nt)}}_limitZoom(z){return Math.max(this.options.minZoom,Math.min(Math.floor(+z),this.options.maxZoom+1))}_cluster(z,R){const{radius:N,extent:X,reduce:Y,minPoints:oe}=this.options,ne=N/(X*Math.pow(2,R)),K=z.data,se=[],ve=this.stride;for(let ye=0;ye<K.length;ye+=ve){if(K[ye+2]<=R)continue;K[ye+2]=R;const xe=K[ye],nt=K[ye+1],pt=z.within(K[ye],K[ye+1],ne),Je=K[ye+5];let it=Je;for(const gt of pt){const Ct=gt*ve;K[Ct+2]>R&&(it+=K[Ct+5])}if(it>Je&&it>=oe){let gt,Ct=xe*Je,xt=nt*Je,Ft=-1;const Nt=((ye/ve|0)<<5)+(R+1)+this.points.length;for(const en of pt){const on=en*ve;if(K[on+2]<=R)continue;K[on+2]=R;const gn=K[on+5];Ct+=K[on]*gn,xt+=K[on+1]*gn,K[on+4]=Nt,Y&&(gt||(gt=this._map(K,ye,!0),Ft=this.clusterProps.length,this.clusterProps.push(gt)),Y(gt,this._map(K,on)))}K[ye+4]=Nt,se.push(Ct/it,xt/it,1/0,Nt,-1,it),Y&&se.push(Ft)}else{for(let gt=0;gt<ve;gt++)se.push(K[ye+gt]);if(it>1)for(const gt of pt){const Ct=gt*ve;if(!(K[Ct+2]<=R)){K[Ct+2]=R;for(let xt=0;xt<ve;xt++)se.push(K[Ct+xt])}}}}return se}_getOriginId(z){return z-this.points.length>>5}_getOriginZoom(z){return(z-this.points.length)%32}_map(z,R,N){if(z[R+5]>1){const oe=this.clusterProps[z[R+6]];return N?Object.assign({},oe):oe}const X=this.points[z[R+3]].properties,Y=this.options.map(X);return N&&Y===X?Object.assign({},Y):Y}}function Tn($,z,R){return{type:"Feature",id:$[z+3],properties:Di($,z,R),geometry:{type:"Point",coordinates:[(N=$[z],360*(N-.5)),ho($[z+1])]}};var N}function Di($,z,R){const N=$[z+5],X=N>=1e4?`${Math.round(N/1e3)}k`:N>=1e3?Math.round(N/100)/10+"k":N,Y=$[z+6],oe=Y===-1?{}:Object.assign({},R[Y]);return Object.assign(oe,{cluster:!0,cluster_id:$[z+3],point_count:N,point_count_abbreviated:X})}function Ut($){return $/360+.5}function si($){const z=Math.sin($*Math.PI/180),R=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return R<0?0:R>1?1:R}function ho($){const z=(180-360*$)*Math.PI/180;return 360*Math.atan(Math.exp(z))/Math.PI-90}function yi($,z,R,N){for(var X,Y=N,oe=R-z>>1,ne=R-z,K=$[z],se=$[z+1],ve=$[R],ye=$[R+1],xe=z+3;xe<R;xe+=3){var nt=Jr($[xe],$[xe+1],K,se,ve,ye);if(nt>Y)X=xe,Y=nt;else if(nt===Y){var pt=Math.abs(xe-oe);pt<ne&&(X=xe,ne=pt)}}Y>N&&(X-z>3&&yi($,z,X,N),$[X+2]=Y,R-X>3&&yi($,X,R,N))}function Jr($,z,R,N,X,Y){var oe=X-R,ne=Y-N;if(oe!==0||ne!==0){var K=(($-R)*oe+(z-N)*ne)/(oe*oe+ne*ne);K>1?(R=X,N=Y):K>0&&(R+=oe*K,N+=ne*K)}return(oe=$-R)*oe+(ne=z-N)*ne}function Pt($,z,R,N){var X={id:$===void 0?null:$,type:z,geometry:R,tags:N,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Y){var oe=Y.geometry,ne=Y.type;if(ne==="Point"||ne==="MultiPoint"||ne==="LineString")Zt(Y,oe);else if(ne==="Polygon"||ne==="MultiLineString")for(var K=0;K<oe.length;K++)Zt(Y,oe[K]);else if(ne==="MultiPolygon")for(K=0;K<oe.length;K++)for(var se=0;se<oe[K].length;se++)Zt(Y,oe[K][se])}(X),X}function Zt($,z){for(var R=0;R<z.length;R+=3)$.minX=Math.min($.minX,z[R]),$.minY=Math.min($.minY,z[R+1]),$.maxX=Math.max($.maxX,z[R]),$.maxY=Math.max($.maxY,z[R+1])}function Wt($,z,R,N){if(z.geometry){var X=z.geometry.coordinates,Y=z.geometry.type,oe=Math.pow(R.tolerance/((1<<R.maxZoom)*R.extent),2),ne=[],K=z.id;if(R.promoteId?K=z.properties[R.promoteId]:R.generateId&&(K=N||0),Y==="Point")me(X,ne);else if(Y==="MultiPoint")for(var se=0;se<X.length;se++)me(X[se],ne);else if(Y==="LineString")Rn(X,ne,oe,!1);else if(Y==="MultiLineString"){if(R.lineMetrics){for(se=0;se<X.length;se++)Rn(X[se],ne=[],oe,!1),$.push(Pt(K,"LineString",ne,z.properties));return}_i(X,ne,oe,!1)}else if(Y==="Polygon")_i(X,ne,oe,!0);else{if(Y!=="MultiPolygon"){if(Y==="GeometryCollection"){for(se=0;se<z.geometry.geometries.length;se++)Wt($,{id:K,geometry:z.geometry.geometries[se],properties:z.properties},R,N);return}throw new Error("Input data is not a valid GeoJSON object.")}for(se=0;se<X.length;se++){var ve=[];_i(X[se],ve,oe,!0),ne.push(ve)}}$.push(Pt(K,Y,ne,z.properties))}}function me($,z){z.push(vt($[0])),z.push(dt($[1])),z.push(0)}function Rn($,z,R,N){for(var X,Y,oe=0,ne=0;ne<$.length;ne++){var K=vt($[ne][0]),se=dt($[ne][1]);z.push(K),z.push(se),z.push(0),ne>0&&(oe+=N?(X*se-K*Y)/2:Math.sqrt(Math.pow(K-X,2)+Math.pow(se-Y,2))),X=K,Y=se}var ve=z.length-3;z[2]=1,yi(z,0,ve,R),z[ve+2]=1,z.size=Math.abs(oe),z.start=0,z.end=z.size}function _i($,z,R,N){for(var X=0;X<$.length;X++){var Y=[];Rn($[X],Y,R,N),z.push(Y)}}function vt($){return $/360+.5}function dt($){var z=Math.sin($*Math.PI/180),R=.5-.25*Math.log((1+z)/(1-z))/Math.PI;return R<0?0:R>1?1:R}function un($,z,R,N,X,Y,oe,ne){if(N/=z,Y>=(R/=z)&&oe<N)return $;if(oe<R||Y>=N)return null;for(var K=[],se=0;se<$.length;se++){var ve=$[se],ye=ve.geometry,xe=ve.type,nt=X===0?ve.minX:ve.minY,pt=X===0?ve.maxX:ve.maxY;if(nt>=R&&pt<N)K.push(ve);else if(!(pt<R||nt>=N)){var Je=[];if(xe==="Point"||xe==="MultiPoint")Qr(ye,Je,R,N,X);else if(xe==="LineString")po(ye,Je,R,N,X,!1,ne.lineMetrics);else if(xe==="MultiLineString")Gt(ye,Je,R,N,X,!1);else if(xe==="Polygon")Gt(ye,Je,R,N,X,!0);else if(xe==="MultiPolygon")for(var it=0;it<ye.length;it++){var gt=[];Gt(ye[it],gt,R,N,X,!0),gt.length&&Je.push(gt)}if(Je.length){if(ne.lineMetrics&&xe==="LineString"){for(it=0;it<Je.length;it++)K.push(Pt(ve.id,xe,Je[it],ve.tags));continue}xe!=="LineString"&&xe!=="MultiLineString"||(Je.length===1?(xe="LineString",Je=Je[0]):xe="MultiLineString"),xe!=="Point"&&xe!=="MultiPoint"||(xe=Je.length===3?"Point":"MultiPoint"),K.push(Pt(ve.id,xe,Je,ve.tags))}}}return K.length?K:null}function Qr($,z,R,N,X){for(var Y=0;Y<$.length;Y+=3){var oe=$[Y+X];oe>=R&&oe<=N&&(z.push($[Y]),z.push($[Y+1]),z.push($[Y+2]))}}function po($,z,R,N,X,Y,oe){for(var ne,K,se=fo($),ve=X===0?Lr:Le,ye=$.start,xe=0;xe<$.length-3;xe+=3){var nt=$[xe],pt=$[xe+1],Je=$[xe+2],it=$[xe+3],gt=$[xe+4],Ct=X===0?nt:pt,xt=X===0?it:gt,Ft=!1;oe&&(ne=Math.sqrt(Math.pow(nt-it,2)+Math.pow(pt-gt,2))),Ct<R?xt>R&&(K=ve(se,nt,pt,it,gt,R),oe&&(se.start=ye+ne*K)):Ct>N?xt<N&&(K=ve(se,nt,pt,it,gt,N),oe&&(se.start=ye+ne*K)):Zn(se,nt,pt,Je),xt<R&&Ct>=R&&(K=ve(se,nt,pt,it,gt,R),Ft=!0),xt>N&&Ct<=N&&(K=ve(se,nt,pt,it,gt,N),Ft=!0),!Y&&Ft&&(oe&&(se.end=ye+ne*K),z.push(se),se=fo($)),oe&&(ye+=ne)}var Nt=$.length-3;nt=$[Nt],pt=$[Nt+1],Je=$[Nt+2],(Ct=X===0?nt:pt)>=R&&Ct<=N&&Zn(se,nt,pt,Je),Nt=se.length-3,Y&&Nt>=3&&(se[Nt]!==se[0]||se[Nt+1]!==se[1])&&Zn(se,se[0],se[1],se[2]),se.length&&z.push(se)}function fo($){var z=[];return z.size=$.size,z.start=$.start,z.end=$.end,z}function Gt($,z,R,N,X,Y){for(var oe=0;oe<$.length;oe++)po($[oe],z,R,N,X,Y,!1)}function Zn($,z,R,N){$.push(z),$.push(R),$.push(N)}function Lr($,z,R,N,X,Y){var oe=(Y-z)/(N-z);return $.push(Y),$.push(R+(X-R)*oe),$.push(1),oe}function Le($,z,R,N,X,Y){var oe=(Y-R)/(X-R);return $.push(z+(N-z)*oe),$.push(Y),$.push(1),oe}function Bn($,z){for(var R=[],N=0;N<$.length;N++){var X,Y=$[N],oe=Y.type;if(oe==="Point"||oe==="MultiPoint"||oe==="LineString")X=vi(Y.geometry,z);else if(oe==="MultiLineString"||oe==="Polygon"){X=[];for(var ne=0;ne<Y.geometry.length;ne++)X.push(vi(Y.geometry[ne],z))}else if(oe==="MultiPolygon")for(X=[],ne=0;ne<Y.geometry.length;ne++){for(var K=[],se=0;se<Y.geometry[ne].length;se++)K.push(vi(Y.geometry[ne][se],z));X.push(K)}R.push(Pt(Y.id,oe,X,Y.tags))}return R}function vi($,z){var R=[];R.size=$.size,$.start!==void 0&&(R.start=$.start,R.end=$.end);for(var N=0;N<$.length;N+=3)R.push($[N]+z,$[N+1],$[N+2]);return R}function _r($,z){if($.transformed)return $;var R,N,X,Y=1<<$.z,oe=$.x,ne=$.y;for(R=0;R<$.features.length;R++){var K=$.features[R],se=K.geometry,ve=K.type;if(K.geometry=[],ve===1)for(N=0;N<se.length;N+=2)K.geometry.push(Rr(se[N],se[N+1],z,Y,oe,ne));else for(N=0;N<se.length;N++){var ye=[];for(X=0;X<se[N].length;X+=2)ye.push(Rr(se[N][X],se[N][X+1],z,Y,oe,ne));K.geometry.push(ye)}}return $.transformed=!0,$}function Rr($,z,R,N,X,Y){return[Math.round(R*($*N-X)),Math.round(R*(z*N-Y))]}function Re($,z,R,N,X){for(var Y=z===X.maxZoom?0:X.tolerance/((1<<z)*X.extent),oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:R,y:N,z,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ne=0;ne<$.length;ne++){oe.numFeatures++,wt(oe,$[ne],Y,X);var K=$[ne].minX,se=$[ne].minY,ve=$[ne].maxX,ye=$[ne].maxY;K<oe.minX&&(oe.minX=K),se<oe.minY&&(oe.minY=se),ve>oe.maxX&&(oe.maxX=ve),ye>oe.maxY&&(oe.maxY=ye)}return oe}function wt($,z,R,N){var X=z.geometry,Y=z.type,oe=[];if(Y==="Point"||Y==="MultiPoint")for(var ne=0;ne<X.length;ne+=3)oe.push(X[ne]),oe.push(X[ne+1]),$.numPoints++,$.numSimplified++;else if(Y==="LineString")mt(oe,X,$,R,!1,!1);else if(Y==="MultiLineString"||Y==="Polygon")for(ne=0;ne<X.length;ne++)mt(oe,X[ne],$,R,Y==="Polygon",ne===0);else if(Y==="MultiPolygon")for(var K=0;K<X.length;K++){var se=X[K];for(ne=0;ne<se.length;ne++)mt(oe,se[ne],$,R,!0,ne===0)}if(oe.length){var ve=z.tags||null;if(Y==="LineString"&&N.lineMetrics){for(var ye in ve={},z.tags)ve[ye]=z.tags[ye];ve.mapbox_clip_start=X.start/X.size,ve.mapbox_clip_end=X.end/X.size}var xe={geometry:oe,type:Y==="Polygon"||Y==="MultiPolygon"?3:Y==="LineString"||Y==="MultiLineString"?2:1,tags:ve};z.id!==null&&(xe.id=z.id),$.features.push(xe)}}function mt($,z,R,N,X,Y){var oe=N*N;if(N>0&&z.size<(X?oe:N))R.numPoints+=z.length/3;else{for(var ne=[],K=0;K<z.length;K+=3)(N===0||z[K+2]>oe)&&(R.numSimplified++,ne.push(z[K]),ne.push(z[K+1])),R.numPoints++;X&&function(se,ve){for(var ye=0,xe=0,nt=se.length,pt=nt-2;xe<nt;pt=xe,xe+=2)ye+=(se[xe]-se[pt])*(se[xe+1]+se[pt+1]);if(ye>0===ve)for(xe=0,nt=se.length;xe<nt/2;xe+=2){var Je=se[xe],it=se[xe+1];se[xe]=se[nt-2-xe],se[xe+1]=se[nt-1-xe],se[nt-2-xe]=Je,se[nt-1-xe]=it}}(ne,Y),$.push(ne)}}function Fn($,z){var R=(z=this.options=function(X,Y){for(var oe in Y)X[oe]=Y[oe];return X}(Object.create(this.options),z)).debug;if(R&&console.time("preprocess data"),z.maxZoom<0||z.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(z.promoteId&&z.generateId)throw new Error("promoteId and generateId cannot be used together.");var N=function(X,Y){var oe=[];if(X.type==="FeatureCollection")for(var ne=0;ne<X.features.length;ne++)Wt(oe,X.features[ne],Y,ne);else Wt(oe,X.type==="Feature"?X:{geometry:X},Y);return oe}($,z);this.tiles={},this.tileCoords=[],R&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",z.indexMaxZoom,z.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),N=function(X,Y){var oe=Y.buffer/Y.extent,ne=X,K=un(X,1,-1-oe,oe,0,-1,2,Y),se=un(X,1,1-oe,2+oe,0,-1,2,Y);return(K||se)&&(ne=un(X,1,-oe,1+oe,0,-1,2,Y)||[],K&&(ne=Bn(K,1).concat(ne)),se&&(ne=ne.concat(Bn(se,-1)))),ne}(N,z),N.length&&this.splitTile(N,0,0,0),R&&(N.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function rr($,z,R){return 32*((1<<$)*R+z)+$}function at($,z){return z?$.properties[z]:$.id}function Br($,z){if($==null)return!0;if($.type==="Feature")return at($,z)!=null;if($.type==="FeatureCollection"){const R=new Set;for(const N of $.features){const X=at(N,z);if(X==null||R.has(X))return!1;R.add(X)}return!0}return!1}function eo($,z){const R=new Map;if($!=null)if($.type==="Feature")R.set(at($,z),$);else for(const N of $.features)R.set(at(N,z),N);return R}function No($,z){const R=$.tileID.canonical;if(!this._geoJSONIndex)return z(null,null);const N=this._geoJSONIndex.getTile(R.z,R.x,R.y);if(!N)return z(null,null);const X=new class{constructor(oe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.EXTENT,this.length=oe.length,this._features=oe}feature(oe){return new class{constructor(ne){this._feature=ne,this.extent=u.EXTENT,this.type=ne.type,this.properties=ne.tags,"id"in ne&&!isNaN(ne.id)&&(this.id=parseInt(ne.id,10))}loadGeometry(){if(this._feature.type===1){const ne=[];for(const K of this._feature.geometry)ne.push([new u.Point(K[0],K[1])]);return ne}{const ne=[];for(const K of this._feature.geometry){const se=[];for(const ve of K)se.push(new u.Point(ve[0],ve[1]));ne.push(se)}return ne}}toGeoJSON(ne,K,se){return te.call(this,ne,K,se)}}(this._features[oe])}}(N.features);let Y=ht(X);Y.byteOffset===0&&Y.byteLength===Y.buffer.byteLength||(Y=new Uint8Array(Y)),z(null,{vectorTile:X,rawData:Y.buffer})}Fn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Fn.prototype.splitTile=function($,z,R,N,X,Y,oe){for(var ne=[$,z,R,N],K=this.options,se=K.debug;ne.length;){N=ne.pop(),R=ne.pop(),z=ne.pop(),$=ne.pop();var ve=1<<z,ye=rr(z,R,N),xe=this.tiles[ye];if(!xe&&(se>1&&console.time("creation"),xe=this.tiles[ye]=Re($,z,R,N,K),this.tileCoords.push({z,x:R,y:N}),se)){se>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",z,R,N,xe.numFeatures,xe.numPoints,xe.numSimplified),console.timeEnd("creation"));var nt="z"+z;this.stats[nt]=(this.stats[nt]||0)+1,this.total++}if(xe.source=$,X){if(z===K.maxZoom||z===X)continue;var pt=1<<X-z;if(R!==Math.floor(Y/pt)||N!==Math.floor(oe/pt))continue}else if(z===K.indexMaxZoom||xe.numPoints<=K.indexMaxPoints)continue;if(xe.source=null,$.length!==0){se>1&&console.time("clipping");var Je,it,gt,Ct,xt,Ft,Nt=.5*K.buffer/K.extent,en=.5-Nt,on=.5+Nt,gn=1+Nt;Je=it=gt=Ct=null,xt=un($,ve,R-Nt,R+on,0,xe.minX,xe.maxX,K),Ft=un($,ve,R+en,R+gn,0,xe.minX,xe.maxX,K),$=null,xt&&(Je=un(xt,ve,N-Nt,N+on,1,xe.minY,xe.maxY,K),it=un(xt,ve,N+en,N+gn,1,xe.minY,xe.maxY,K),xt=null),Ft&&(gt=un(Ft,ve,N-Nt,N+on,1,xe.minY,xe.maxY,K),Ct=un(Ft,ve,N+en,N+gn,1,xe.minY,xe.maxY,K),Ft=null),se>1&&console.timeEnd("clipping"),ne.push(Je||[],z+1,2*R,2*N),ne.push(it||[],z+1,2*R,2*N+1),ne.push(gt||[],z+1,2*R+1,2*N),ne.push(Ct||[],z+1,2*R+1,2*N+1)}}},Fn.prototype.getTile=function($,z,R){var N=this.options,X=N.extent,Y=N.debug;if($<0||$>24)return null;var oe=1<<$,ne=rr($,z=(z%oe+oe)%oe,R);if(this.tiles[ne])return _r(this.tiles[ne],X);Y>1&&console.log("drilling down to z%d-%d-%d",$,z,R);for(var K,se=$,ve=z,ye=R;!K&&se>0;)se--,ve=Math.floor(ve/2),ye=Math.floor(ye/2),K=this.tiles[rr(se,ve,ye)];return K&&K.source?(Y>1&&console.log("found parent tile z%d-%d-%d",se,ve,ye),Y>1&&console.time("drilling down"),this.splitTile(K.source,se,ve,ye,$,z,R),Y>1&&console.timeEnd("drilling down"),this.tiles[ne]?_r(this.tiles[ne],X):null):null};class to extends Ce{constructor(z,R,N,X){super(z,R,N,No),this._dataUpdateable=new Map,this.loadGeoJSON=(Y,oe)=>{const{promoteId:ne}=Y;if(Y.request)return u.getJSON(Y.request,(K,se,ve,ye)=>{this._dataUpdateable=Br(se,ne)?eo(se,ne):void 0,oe(K,se,ve,ye)});if(typeof Y.data=="string")try{const K=JSON.parse(Y.data);this._dataUpdateable=Br(K,ne)?eo(K,ne):void 0,oe(null,K)}catch{oe(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}else Y.dataDiff?this._dataUpdateable?(function(K,se,ve){var ye,xe,nt,pt;if(se.removeAll&&K.clear(),se.remove)for(const Je of se.remove)K.delete(Je);if(se.add)for(const Je of se.add){const it=at(Je,ve);it!=null&&K.set(it,Je)}if(se.update)for(const Je of se.update){let it=K.get(Je.id);if(it==null)continue;const gt=!Je.removeAllProperties&&(((ye=Je.removeProperties)===null||ye===void 0?void 0:ye.length)>0||((xe=Je.addOrUpdateProperties)===null||xe===void 0?void 0:xe.length)>0);if((Je.newGeometry||Je.removeAllProperties||gt)&&(it={...it},K.set(Je.id,it),gt&&(it.properties={...it.properties})),Je.newGeometry&&(it.geometry=Je.newGeometry),Je.removeAllProperties)it.properties={};else if(((nt=Je.removeProperties)===null||nt===void 0?void 0:nt.length)>0)for(const Ct of Je.removeProperties)Object.prototype.hasOwnProperty.call(it.properties,Ct)&&delete it.properties[Ct];if(((pt=Je.addOrUpdateProperties)===null||pt===void 0?void 0:pt.length)>0)for(const{key:Ct,value:xt}of Je.addOrUpdateProperties)it.properties[Ct]=xt}}(this._dataUpdateable,Y.dataDiff,ne),oe(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):oe(new Error(`Cannot update existing geojson data in ${Y.source}`)):oe(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},X&&(this.loadGeoJSON=X)}loadData(z,R){var N;(N=this._pendingRequest)===null||N===void 0||N.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const X=!!(z&&z.request&&z.request.collectResourceTiming)&&new u.RequestPerformance(z.request);this._pendingCallback=R,this._pendingRequest=this.loadGeoJSON(z,(Y,oe)=>{if(delete this._pendingCallback,delete this._pendingRequest,Y||!oe)return R(Y);if(typeof oe!="object")return R(new Error(`Input data given to '${z.source}' is not a valid GeoJSON object.`));{re(oe,!0);try{if(z.filter){const K=u.createExpression(z.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(K.result==="error")throw new Error(K.value.map(ve=>`${ve.key}: ${ve.message}`).join(", "));oe={type:"FeatureCollection",features:oe.features.filter(ve=>K.value.evaluate({zoom:0},ve))}}this._geoJSONIndex=z.cluster?new zi(function({superclusterOptions:K,clusterProperties:se}){if(!se||!K)return K;const ve={},ye={},xe={accumulated:null,zoom:0},nt={properties:null},pt=Object.keys(se);for(const Je of pt){const[it,gt]=se[Je],Ct=u.createExpression(gt),xt=u.createExpression(typeof it=="string"?[it,["accumulated"],["get",Je]]:it);ve[Je]=Ct.value,ye[Je]=xt.value}return K.map=Je=>{nt.properties=Je;const it={};for(const gt of pt)it[gt]=ve[gt].evaluate(xe,nt);return it},K.reduce=(Je,it)=>{nt.properties=it;for(const gt of pt)xe.accumulated=Je[gt],Je[gt]=ye[gt].evaluate(xe,nt)},K}(z)).load(oe.features):function(K,se){return new Fn(K,se)}(oe,z.geojsonVtOptions)}catch(K){return R(K)}this.loaded={};const ne={};if(X){const K=X.finish();K&&(ne.resourceTiming={},ne.resourceTiming[z.source]=JSON.parse(JSON.stringify(K)))}R(null,ne)}})}reloadTile(z,R){const N=this.loaded;return N&&N[z.uid]?super.reloadTile(z,R):this.loadTile(z,R)}removeSource(z,R){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),R()}getClusterExpansionZoom(z,R){try{R(null,this._geoJSONIndex.getClusterExpansionZoom(z.clusterId))}catch(N){R(N)}}getClusterChildren(z,R){try{R(null,this._geoJSONIndex.getChildren(z.clusterId))}catch(N){R(N)}}getClusterLeaves(z,R){try{R(null,this._geoJSONIndex.getLeaves(z.clusterId,z.limit,z.offset))}catch(N){R(N)}}}class Gn{constructor(z){this.self=z,this.actor=new u.Actor(z,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:Ce,geojson:to},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(R,N)=>{if(this.workerSourceTypes[R])throw new Error(`Worker source with name "${R}" already registered.`);this.workerSourceTypes[R]=N},this.self.registerRTLTextPlugin=R=>{if(u.plugin.isParsed())throw new Error("RTL text plugin already registered.");u.plugin.applyArabicShaping=R.applyArabicShaping,u.plugin.processBidirectionalText=R.processBidirectionalText,u.plugin.processStyledBidirectionalText=R.processStyledBidirectionalText}}setReferrer(z,R){this.referrer=R}setImages(z,R,N){this.availableImages[z]=R;for(const X in this.workerSources[z]){const Y=this.workerSources[z][X];for(const oe in Y)Y[oe].availableImages=R}N()}setLayers(z,R,N){this.getLayerIndex(z).replace(R),N()}updateLayers(z,R,N){this.getLayerIndex(z).update(R.layers,R.removedIds),N()}loadTile(z,R,N){this.getWorkerSource(z,R.type,R.source).loadTile(R,N)}loadDEMTile(z,R,N){this.getDEMWorkerSource(z,R.source).loadTile(R,N)}reloadTile(z,R,N){this.getWorkerSource(z,R.type,R.source).reloadTile(R,N)}abortTile(z,R,N){this.getWorkerSource(z,R.type,R.source).abortTile(R,N)}removeTile(z,R,N){this.getWorkerSource(z,R.type,R.source).removeTile(R,N)}removeDEMTile(z,R){this.getDEMWorkerSource(z,R.source).removeTile(R)}removeSource(z,R,N){if(!this.workerSources[z]||!this.workerSources[z][R.type]||!this.workerSources[z][R.type][R.source])return;const X=this.workerSources[z][R.type][R.source];delete this.workerSources[z][R.type][R.source],X.removeSource!==void 0?X.removeSource(R,N):N()}loadWorkerSource(z,R,N){try{this.self.importScripts(R.url),N()}catch(X){N(X.toString())}}syncRTLPluginState(z,R,N){try{u.plugin.setState(R);const X=u.plugin.getPluginURL();if(u.plugin.isLoaded()&&!u.plugin.isParsed()&&X!=null){this.self.importScripts(X);const Y=u.plugin.isParsed();N(Y?void 0:new Error(`RTL Text Plugin failed to import scripts from ${X}`),Y)}}catch(X){N(X.toString())}}getAvailableImages(z){let R=this.availableImages[z];return R||(R=[]),R}getLayerIndex(z){let R=this.layerIndexes[z];return R||(R=this.layerIndexes[z]=new U),R}getWorkerSource(z,R,N){if(this.workerSources[z]||(this.workerSources[z]={}),this.workerSources[z][R]||(this.workerSources[z][R]={}),!this.workerSources[z][R][N]){const X={send:(Y,oe,ne)=>{this.actor.send(Y,oe,ne,z)}};this.workerSources[z][R][N]=new this.workerSourceTypes[R](X,this.getLayerIndex(z),this.getAvailableImages(z))}return this.workerSources[z][R][N]}getDEMWorkerSource(z,R){return this.demWorkerSources[z]||(this.demWorkerSources[z]={}),this.demWorkerSources[z][R]||(this.demWorkerSources[z][R]=new ke),this.demWorkerSources[z][R]}}return u.isWorker()&&(self.worker=new Gn(self)),Gn}),w(["./shared"],function(u){var U="3.0.0";class D{static testProp(t){if(!D.docStyle)return t[0];for(let s=0;s<t.length;s++)if(t[s]in D.docStyle)return t[s];return t[0]}static create(t,s,c){const p=window.document.createElement(t);return s!==void 0&&(p.className=s),c&&c.appendChild(p),p}static createNS(t,s){return window.document.createElementNS(t,s)}static disableDrag(){D.docStyle&&D.selectProp&&(D.userSelect=D.docStyle[D.selectProp],D.docStyle[D.selectProp]="none")}static enableDrag(){D.docStyle&&D.selectProp&&(D.docStyle[D.selectProp]=D.userSelect)}static setTransform(t,s){t.style[D.transformProp]=s}static addEventListener(t,s,c,p={}){t.addEventListener(s,c,"passive"in p?p:p.capture)}static removeEventListener(t,s,c,p={}){t.removeEventListener(s,c,"passive"in p?p:p.capture)}static suppressClickInternal(t){t.preventDefault(),t.stopPropagation(),window.removeEventListener("click",D.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",D.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",D.suppressClickInternal,!0)},0)}static mousePos(t,s){const c=t.getBoundingClientRect();return new u.Point(s.clientX-c.left-t.clientLeft,s.clientY-c.top-t.clientTop)}static touchPos(t,s){const c=t.getBoundingClientRect(),p=[];for(let y=0;y<s.length;y++)p.push(new u.Point(s[y].clientX-c.left-t.clientLeft,s[y].clientY-c.top-t.clientTop));return p}static mouseButton(t){return t.button}static remove(t){t.parentNode&&t.parentNode.removeChild(t)}}D.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,D.selectProp=D.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),D.transformProp=D.testProp(["transform","WebkitTransform"]);const ue={supported:!1,testSupport:function(h){!Ce&&pe&&(ke?Pe(h):ie=h)}};let ie,pe,Ce=!1,ke=!1;function Pe(h){const t=h.createTexture();h.bindTexture(h.TEXTURE_2D,t);try{if(h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,pe),h.isContextLost())return;ue.supported=!0}catch{}h.deleteTexture(t),Ce=!0}var qe;typeof document<"u"&&(pe=document.createElement("img"),pe.onload=function(){ie&&Pe(ie),ie=null,ke=!0},pe.onerror=function(){Ce=!0,ie=null},pe.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(h){let t,s,c,p;h.resetRequestQueue=()=>{t=[],s=0,c=0,p={}},h.addThrottleControl=C=>{const M=c++;return p[M]=C,M},h.removeThrottleControl=C=>{delete p[C],E()},h.getImage=(C,M,P=!0)=>{ue.supported&&(C.headers||(C.headers={}),C.headers.accept="image/webp,*/*");const F={requestParameters:C,supportImageRefresh:P,callback:M,cancelled:!1,completed:!1,cancel:()=>{F.completed||F.cancelled||(F.cancelled=!0,F.innerRequest&&(F.innerRequest.cancel(),s--),E())}};return t.push(F),E(),F};const y=C=>{const{requestParameters:M,supportImageRefresh:P,callback:F}=C;return u.extend(M,{type:"image"}),(P!==!1||u.isWorker()||u.getProtocolAction(M.url)||M.headers&&!Object.keys(M.headers).reduce((Z,V)=>Z&&V==="accept",!0)?u.makeRequest:S)(M,(Z,V,q,H)=>{x(C,F,Z,V,q,H)})},x=(C,M,P,F,Z,V)=>{P?M(P):F instanceof HTMLImageElement||F instanceof ImageBitmap?M(null,F):F&&((q,H)=>{typeof createImageBitmap=="function"?u.arrayBufferToImageBitmap(q,H):u.arrayBufferToImage(q,H)})(F,(q,H)=>{q!=null?M(q):H!=null&&M(null,H,{cacheControl:Z,expires:V})}),C.cancelled||(C.completed=!0,s--,E())},E=()=>{const C=(()=>{const M=Object.keys(p);let P=!1;if(M.length>0){for(const F of M)if(P=p[F](),P)break}return P})()?u.config.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.config.MAX_PARALLEL_IMAGE_REQUESTS;for(let M=s;M<C&&t.length>0;M++){const P=t.shift();if(P.cancelled){M--;continue}const F=y(P);s++,P.innerRequest=F}},S=(C,M)=>{const P=new Image,F=C.url;let Z=!1;const V=C.credentials;return V&&V==="include"?P.crossOrigin="use-credentials":(V&&V==="same-origin"||!u.sameOrigin(F))&&(P.crossOrigin="anonymous"),P.fetchPriority="high",P.onload=()=>{M(null,P),P.onerror=P.onload=null},P.onerror=()=>{Z||M(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),P.onerror=P.onload=null},P.src=F,{cancel:()=>{Z=!0,P.src=""}}}}(qe||(qe={})),qe.resetRequestQueue();var re,te=qe;(function(h){h.Glyphs="Glyphs",h.Image="Image",h.Source="Source",h.SpriteImage="SpriteImage",h.SpriteJSON="SpriteJSON",h.Style="Style",h.Tile="Tile",h.Unknown="Unknown"})(re||(re={}));class le{constructor(t){this._transformRequestFn=t}transformRequest(t,s){return this._transformRequestFn&&this._transformRequestFn(t,s)||{url:t}}normalizeSpriteURL(t,s,c){const p=function(y){const x=y.match(Ee);if(!x)throw new Error(`Unable to parse URL "${y}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(t);return p.path+=`${s}${c}`,function(y){const x=y.params.length?`?${y.params.join("&")}`:"";return`${y.protocol}://${y.authority}${y.path}${x}`}(p)}setTransformRequest(t){this._transformRequestFn=t}}const Ee=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Ze(h){var t=new u.ARRAY_TYPE(3);return t[0]=h[0],t[1]=h[1],t[2]=h[2],t}var Fe,Ae=function(h,t,s){return h[0]=t[0]-s[0],h[1]=t[1]-s[1],h[2]=t[2]-s[2],h};Fe=new u.ARRAY_TYPE(3),u.ARRAY_TYPE!=Float32Array&&(Fe[0]=0,Fe[1]=0,Fe[2]=0);var We=function(h){var t=h[0],s=h[1];return t*t+s*s};function bt(h){const t=[];if(typeof h=="string")t.push({id:"default",url:h});else if(h&&h.length>0){const s=[];for(const{id:c,url:p}of h){const y=`${c}${p}`;s.indexOf(y)===-1&&(s.push(y),t.push({id:c,url:p}))}}return t}function st(h,t,s,c,p){if(c)return void h(c);if(p!==Object.values(t).length||p!==Object.values(s).length)return;const y={};for(const x in t){y[x]={};const E=u.exported.getImageCanvasContext(s[x]),S=t[x];for(const C in S){const{width:M,height:P,x:F,y:Z,sdf:V,pixelRatio:q,stretchX:H,stretchY:Q,content:de}=S[C];y[x][C]={data:null,pixelRatio:q,sdf:V,stretchX:H,stretchY:Q,content:de,spriteData:{width:M,height:P,x:F,y:Z,context:E}}}}h(null,y)}(function(){var h=new u.ARRAY_TYPE(2);u.ARRAY_TYPE!=Float32Array&&(h[0]=0,h[1]=0)})();class _t{constructor(t,s,c,p){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(s,p)}update(t,s,c){const{width:p,height:y}=t,x=!(this.size&&this.size[0]===p&&this.size[1]===y||c),{context:E}=this,{gl:S}=E;if(this.useMipmap=!!(s&&s.useMipmap),S.bindTexture(S.TEXTURE_2D,this.texture),E.pixelStoreUnpackFlipY.set(!1),E.pixelStoreUnpack.set(1),E.pixelStoreUnpackPremultiplyAlpha.set(this.format===S.RGBA&&(!s||s.premultiply!==!1)),x)this.size=[p,y],t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||u.isImageBitmap(t)?S.texImage2D(S.TEXTURE_2D,0,this.format,this.format,S.UNSIGNED_BYTE,t):S.texImage2D(S.TEXTURE_2D,0,this.format,p,y,0,this.format,S.UNSIGNED_BYTE,t.data);else{const{x:C,y:M}=c||{x:0,y:0};t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||u.isImageBitmap(t)?S.texSubImage2D(S.TEXTURE_2D,0,C,M,S.RGBA,S.UNSIGNED_BYTE,t):S.texSubImage2D(S.TEXTURE_2D,0,C,M,p,y,S.RGBA,S.UNSIGNED_BYTE,t.data)}this.useMipmap&&this.isSizePowerOfTwo()&&S.generateMipmap(S.TEXTURE_2D)}bind(t,s,c){const{context:p}=this,{gl:y}=p;y.bindTexture(y.TEXTURE_2D,this.texture),c!==y.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=y.LINEAR),t!==this.filter&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,t),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,c||t),this.filter=t),s!==this.wrap&&(y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,s),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}function mi(h){const{userImage:t}=h;return!!(t&&t.render&&t.render())&&(h.data.replace(new Uint8Array(t.data.buffer)),!0)}class qt extends u.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(t){if(this.loaded!==t&&(this.loaded=t,t)){for(const{ids:s,callback:c}of this.requestors)this._notify(s,c);this.requestors=[]}}getImage(t){const s=this.images[t];if(s&&!s.data&&s.spriteData){const c=s.spriteData;s.data=new u.RGBAImage({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),s.spriteData=null}return s}addImage(t,s){if(this.images[t])throw new Error(`Image id ${t} already exist, use updateImage instead`);this._validate(t,s)&&(this.images[t]=s)}_validate(t,s){let c=!0;const p=s.data||s.spriteData;return this._validateStretch(s.stretchX,p&&p.width)||(this.fire(new u.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),c=!1),this._validateStretch(s.stretchY,p&&p.height)||(this.fire(new u.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),c=!1),this._validateContent(s.content,s)||(this.fire(new u.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),c=!1),c}_validateStretch(t,s){if(!t)return!0;let c=0;for(const p of t){if(p[0]<c||p[1]<p[0]||s<p[1])return!1;c=p[1]}return!0}_validateContent(t,s){if(!t)return!0;if(t.length!==4)return!1;const c=s.spriteData,p=c&&c.width||s.data.width,y=c&&c.height||s.data.height;return!(t[0]<0||p<t[0]||t[1]<0||y<t[1]||t[2]<0||p<t[2]||t[3]<0||y<t[3]||t[2]<t[0]||t[3]<t[1])}updateImage(t,s,c=!0){const p=this.getImage(t);if(c&&(p.data.width!==s.data.width||p.data.height!==s.data.height))throw new Error(`size mismatch between old image (${p.data.width}x${p.data.height}) and new image (${s.data.width}x${s.data.height}).`);s.version=p.version+1,this.images[t]=s,this.updatedImages[t]=!0}removeImage(t){const s=this.images[t];delete this.images[t],delete this.patterns[t],s.userImage&&s.userImage.onRemove&&s.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(t,s){let c=!0;if(!this.isLoaded())for(const p of t)this.images[p]||(c=!1);this.isLoaded()||c?this._notify(t,s):this.requestors.push({ids:t,callback:s})}_notify(t,s){const c={};for(const p of t){let y=this.getImage(p);y||(this.fire(new u.Event("styleimagemissing",{id:p})),y=this.getImage(p)),y?c[p]={data:y.data.clone(),pixelRatio:y.pixelRatio,sdf:y.sdf,version:y.version,stretchX:y.stretchX,stretchY:y.stretchY,content:y.content,hasRenderCallback:!!(y.userImage&&y.userImage.render)}:u.warnOnce(`Image "${p}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}s(null,c)}getPixelSize(){const{width:t,height:s}=this.atlasImage;return{width:t,height:s}}getPattern(t){const s=this.patterns[t],c=this.getImage(t);if(!c)return null;if(s&&s.position.version===c.version)return s.position;if(s)s.position.version=c.version;else{const p={w:c.data.width+2,h:c.data.height+2,x:0,y:0},y=new u.ImagePosition(p,c);this.patterns[t]={bin:p,position:y}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const s=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new _t(t,this.atlasImage,s.RGBA),this.atlasTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const y in this.patterns)t.push(this.patterns[y].bin);const{w:s,h:c}=u.potpack(t),p=this.atlasImage;p.resize({width:s||1,height:c||1});for(const y in this.patterns){const{bin:x}=this.patterns[y],E=x.x+1,S=x.y+1,C=this.getImage(y).data,M=C.width,P=C.height;u.RGBAImage.copy(C,p,{x:0,y:0},{x:E,y:S},{width:M,height:P}),u.RGBAImage.copy(C,p,{x:0,y:P-1},{x:E,y:S-1},{width:M,height:1}),u.RGBAImage.copy(C,p,{x:0,y:0},{x:E,y:S+P},{width:M,height:1}),u.RGBAImage.copy(C,p,{x:M-1,y:0},{x:E-1,y:S},{width:1,height:P}),u.RGBAImage.copy(C,p,{x:0,y:0},{x:E+M,y:S},{width:1,height:P})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(t){for(const s of t){if(this.callbackDispatchedThisFrame[s])continue;this.callbackDispatchedThisFrame[s]=!0;const c=this.getImage(s);c||u.warnOnce(`Image with ID: "${s}" was not found`),mi(c)&&this.updateImage(s,c)}}}const Kn=1e20;function qn(h,t,s,c,p,y,x,E,S){for(let C=t;C<t+c;C++)gi(h,s*y+C,y,p,x,E,S);for(let C=s;C<s+p;C++)gi(h,C*y+t,1,c,x,E,S)}function gi(h,t,s,c,p,y,x){y[0]=0,x[0]=-Kn,x[1]=Kn,p[0]=h[t];for(let E=1,S=0,C=0;E<c;E++){p[E]=h[t+E*s];const M=E*E;do{const P=y[S];C=(p[E]-p[P]+M-P*P)/(E-P)/2}while(C<=x[S]&&--S>-1);S++,y[S]=E,x[S]=C,x[S+1]=Kn}for(let E=0,S=0;E<c;E++){for(;x[S+1]<E;)S++;const C=y[S],M=E-C;h[t+E*s]=p[C]+M*M}}class En{constructor(t,s){this.requestManager=t,this.localIdeographFontFamily=s,this.entries={}}setURL(t){this.url=t}getGlyphs(t,s){const c=[];for(const p in t)for(const y of t[p])c.push({stack:p,id:y});u.asyncAll(c,({stack:p,id:y},x)=>{let E=this.entries[p];E||(E=this.entries[p]={glyphs:{},requests:{},ranges:{}});let S=E.glyphs[y];if(S!==void 0)return void x(null,{stack:p,id:y,glyph:S});if(S=this._tinySDF(E,p,y),S)return E.glyphs[y]=S,void x(null,{stack:p,id:y,glyph:S});const C=Math.floor(y/256);if(256*C>65535)return void x(new Error("glyphs > 65535 not supported"));if(E.ranges[C])return void x(null,{stack:p,id:y,glyph:S});if(!this.url)return void x(new Error("glyphsUrl is not set"));let M=E.requests[C];M||(M=E.requests[C]=[],En.loadGlyphRange(p,C,this.url,this.requestManager,(P,F)=>{if(F){for(const Z in F)this._doesCharSupportLocalGlyph(+Z)||(E.glyphs[+Z]=F[+Z]);E.ranges[C]=!0}for(const Z of M)Z(P,F);delete E.requests[C]})),M.push((P,F)=>{P?x(P):F&&x(null,{stack:p,id:y,glyph:F[y]||null})})},(p,y)=>{if(p)s(p);else if(y){const x={};for(const{stack:E,id:S,glyph:C}of y)(x[E]||(x[E]={}))[S]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics};s(null,x)}})}_doesCharSupportLocalGlyph(t){return!!this.localIdeographFontFamily&&(u.unicodeBlockLookup["CJK Unified Ideographs"](t)||u.unicodeBlockLookup["Hangul Syllables"](t)||u.unicodeBlockLookup.Hiragana(t)||u.unicodeBlockLookup.Katakana(t))}_tinySDF(t,s,c){const p=this.localIdeographFontFamily;if(!p||!this._doesCharSupportLocalGlyph(c))return;let y=t.tinySDF;if(!y){let E="400";/bold/i.test(s)?E="900":/medium/i.test(s)?E="500":/light/i.test(s)&&(E="200"),y=t.tinySDF=new En.TinySDF({fontSize:24,buffer:3,radius:8,cutoff:.25,fontFamily:p,fontWeight:E})}const x=y.draw(String.fromCharCode(c));return{id:c,bitmap:new u.AlphaImage({width:x.width||30,height:x.height||30},x.data),metrics:{width:x.glyphWidth||24,height:x.glyphHeight||24,left:x.glyphLeft||0,top:x.glyphTop-27||-8,advance:x.glyphAdvance||24}}}}En.loadGlyphRange=function(h,t,s,c,p){const y=256*t,x=y+255,E=c.transformRequest(s.replace("{fontstack}",h).replace("{range}",`${y}-${x}`),re.Glyphs);u.getArrayBuffer(E,(S,C)=>{if(S)p(S);else if(C){const M={};for(const P of u.parseGlyphPbf(C))M[P.id]=P;p(null,M)}})},En.TinySDF=class{constructor({fontSize:h=24,buffer:t=3,radius:s=8,cutoff:c=.25,fontFamily:p="sans-serif",fontWeight:y="normal",fontStyle:x="normal"}={}){this.buffer=t,this.cutoff=c,this.radius=s;const E=this.size=h+4*t,S=this._createCanvas(E),C=this.ctx=S.getContext("2d",{willReadFrequently:!0});C.font=`${x} ${y} ${h}px ${p}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(h){const t=document.createElement("canvas");return t.width=t.height=h,t}draw(h){const{width:t,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:p,actualBoundingBoxRight:y}=this.ctx.measureText(h),x=Math.ceil(s),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-p))),S=Math.min(this.size-this.buffer,x+Math.ceil(c)),C=E+2*this.buffer,M=S+2*this.buffer,P=Math.max(C*M,0),F=new Uint8ClampedArray(P),Z={data:F,width:C,height:M,glyphWidth:E,glyphHeight:S,glyphTop:x,glyphLeft:0,glyphAdvance:t};if(E===0||S===0)return Z;const{ctx:V,buffer:q,gridInner:H,gridOuter:Q}=this;V.clearRect(q,q,E,S),V.fillText(h,q,q+x);const de=V.getImageData(q,q,E,S);Q.fill(Kn,0,P),H.fill(0,0,P);for(let W=0;W<S;W++)for(let he=0;he<E;he++){const ge=de.data[4*(W*E+he)+3]/255;if(ge===0)continue;const we=(W+q)*C+he+q;if(ge===1)Q[we]=0,H[we]=Kn;else{const Se=.5-ge;Q[we]=Se>0?Se*Se:0,H[we]=Se<0?Se*Se:0}}qn(Q,0,0,C,M,C,this.f,this.v,this.z),qn(H,q,q,E,S,C,this.f,this.v,this.z);for(let W=0;W<P;W++){const he=Math.sqrt(Q[W])-Math.sqrt(H[W]);F[W]=Math.round(255-255*(he/this.radius+this.cutoff))}return Z}};class Xe{constructor(){this.specification=u.v8Spec.light.position}possiblyEvaluate(t,s){return u.sphericalToCartesian(t.expression.evaluate(s))}interpolate(t,s,c){return{x:u.interpolate.number(t.x,s.x,c),y:u.interpolate.number(t.y,s.y,c),z:u.interpolate.number(t.z,s.z,c)}}}const ht="-transition";let ct,It;class Bt extends u.Evented{constructor(t){super(),ct=ct||new u.Properties({anchor:new u.DataConstantProperty(u.v8Spec.light.anchor),position:new Xe,color:new u.DataConstantProperty(u.v8Spec.light.color),intensity:new u.DataConstantProperty(u.v8Spec.light.intensity)}),this._transitionable=new u.Transitionable(ct),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,s={}){if(!this._validate(u.validateLight,t,s))for(const c in t){const p=t[c];c.endsWith(ht)?this._transitionable.setTransition(c.slice(0,-ht.length),p):this._transitionable.setValue(c,p)}}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}_validate(t,s,c){return(!c||c.validate!==!1)&&u.emitValidationErrors(this,t.call(u.validateStyle,u.extend({value:s,style:{glyphs:!0,sprite:!0},styleSpec:u.v8Spec})))}}class zi{constructor(t,s){this.width=t,this.height=s,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(t,s){const c=t.join(",")+String(s);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(t,s)),this.dashEntry[c]}getDashRanges(t,s,c){const p=[];let y=t.length%2==1?-t[t.length-1]*c:0,x=t[0]*c,E=!0;p.push({left:y,right:x,isDash:E,zeroLength:t[0]===0});let S=t[0];for(let C=1;C<t.length;C++){E=!E;const M=t[C];y=S*c,S+=M,x=S*c,p.push({left:y,right:x,isDash:E,zeroLength:M===0})}return p}addRoundDash(t,s,c){const p=s/2;for(let y=-c;y<=c;y++){const x=this.width*(this.nextRow+c+y);let E=0,S=t[E];for(let C=0;C<this.width;C++){C/S.right>1&&(S=t[++E]);const M=Math.abs(C-S.left),P=Math.abs(C-S.right),F=Math.min(M,P);let Z;const V=y/c*(p+1);if(S.isDash){const q=p-Math.abs(V);Z=Math.sqrt(F*F+q*q)}else Z=p-Math.sqrt(F*F+V*V);this.data[x+C]=Math.max(0,Math.min(255,Z+128))}}}addRegularDash(t){for(let E=t.length-1;E>=0;--E){const S=t[E],C=t[E+1];S.zeroLength?t.splice(E,1):C&&C.isDash===S.isDash&&(C.left=S.left,t.splice(E,1))}const s=t[0],c=t[t.length-1];s.isDash===c.isDash&&(s.left=c.left-this.width,c.right=s.right+this.width);const p=this.width*this.nextRow;let y=0,x=t[y];for(let E=0;E<this.width;E++){E/x.right>1&&(x=t[++y]);const S=Math.abs(E-x.left),C=Math.abs(E-x.right),M=Math.min(S,C);this.data[p+E]=Math.max(0,Math.min(255,(x.isDash?M:-M)+128))}}addDash(t,s){const c=s?7:0,p=2*c+1;if(this.nextRow+p>this.height)return u.warnOnce("LineAtlas out of space"),null;let y=0;for(let E=0;E<t.length;E++)y+=t[E];if(y!==0){const E=this.width/y,S=this.getDashRanges(t,this.width,E);s?this.addRoundDash(S,E,c):this.addRegularDash(S)}const x={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:y};return this.nextRow+=p,this.dirty=!0,x}bind(t){const s=t.gl;this.texture?(s.bindTexture(s.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,s.texSubImage2D(s.TEXTURE_2D,0,0,0,this.width,this.height,s.ALPHA,s.UNSIGNED_BYTE,this.data))):(this.texture=s.createTexture(),s.bindTexture(s.TEXTURE_2D,this.texture),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.REPEAT),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texImage2D(s.TEXTURE_2D,0,s.ALPHA,this.width,this.height,0,s.ALPHA,s.UNSIGNED_BYTE,this.data))}}class Tn{constructor(t,s,c){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=c;const p=this.workerPool.acquire(c);for(let y=0;y<p.length;y++){const x=new Tn.Actor(p[y],s,c);x.name=`Worker ${y}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(t,s,c){u.asyncAll(this.actors,(p,y)=>{p.send(t,s,y)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(t=!0){this.actors.forEach(s=>{s.remove()}),this.actors=[],t&&this.workerPool.release(this.id)}}function Di(h,t,s){const c=function(p,y){if(p)return s(p);if(y){const x=u.pick(u.extend(y,h),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);y.vector_layers&&(x.vectorLayers=y.vector_layers,x.vectorLayerIds=x.vectorLayers.map(E=>E.id)),s(null,x)}};return h.url?u.getJSON(t.transformRequest(h.url,re.Source),c):u.exported.frame(()=>c(null,h))}Tn.Actor=u.Actor;class Ut{constructor(t,s){t&&(s?this.setSouthWest(t).setNorthEast(s):Array.isArray(t)&&(t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1])))}setNorthEast(t){return this._ne=t instanceof u.LngLat?new u.LngLat(t.lng,t.lat):u.LngLat.convert(t),this}setSouthWest(t){return this._sw=t instanceof u.LngLat?new u.LngLat(t.lng,t.lat):u.LngLat.convert(t),this}extend(t){const s=this._sw,c=this._ne;let p,y;if(t instanceof u.LngLat)p=t,y=t;else{if(!(t instanceof Ut))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Ut.convert(t)):this.extend(u.LngLat.convert(t)):t&&("lng"in t||"lon"in t)&&"lat"in t?this.extend(u.LngLat.convert(t)):this;if(p=t._sw,y=t._ne,!p||!y)return this}return s||c?(s.lng=Math.min(p.lng,s.lng),s.lat=Math.min(p.lat,s.lat),c.lng=Math.max(y.lng,c.lng),c.lat=Math.max(y.lat,c.lat)):(this._sw=new u.LngLat(p.lng,p.lat),this._ne=new u.LngLat(y.lng,y.lat)),this}getCenter(){return new u.LngLat((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.LngLat(this.getWest(),this.getNorth())}getSouthEast(){return new u.LngLat(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:s,lat:c}=u.LngLat.convert(t);let p=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&p}static convert(t){return t instanceof Ut?t:t&&new Ut(t)}static fromLngLat(t,s=0){const c=360*s/40075017,p=c/Math.cos(Math.PI/180*t.lat);return new Ut(new u.LngLat(t.lng-p,t.lat-c),new u.LngLat(t.lng+p,t.lat+c))}}class si{constructor(t,s,c){this.bounds=Ut.convert(this.validateBounds(t)),this.minzoom=s||0,this.maxzoom=c||24}validateBounds(t){return Array.isArray(t)&&t.length===4?[Math.max(-180,t[0]),Math.max(-90,t[1]),Math.min(180,t[2]),Math.min(90,t[3])]:[-180,-90,180,90]}contains(t){const s=Math.pow(2,t.z),c=Math.floor(u.mercatorXfromLng(this.bounds.getWest())*s),p=Math.floor(u.mercatorYfromLat(this.bounds.getNorth())*s),y=Math.ceil(u.mercatorXfromLng(this.bounds.getEast())*s),x=Math.ceil(u.mercatorYfromLat(this.bounds.getSouth())*s);return t.x>=c&&t.x<y&&t.y>=p&&t.y<x}}class ho extends u.Evented{constructor(t,s,c,p){if(super(),this.id=t,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.extend(this,u.pick(s,["url","scheme","tileSize","promoteId"])),this._options=u.extend({type:"vector"},s),this._collectResourceTiming=s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(p)}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Di(this._options,this.map._requestManager,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),t?this.fire(new u.ErrorEvent(t)):s&&(u.extend(this,s),s.bounds&&(this.tileBounds=new si(s.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}onAdd(t){this.map=t,this.load()}setSourceProperty(t){this._tileJSONRequest&&this._tileJSONRequest.cancel(),t(),this.load()}setTiles(t){return this.setSourceProperty(()=>{this._options.tiles=t}),this}setUrl(t){return this.setSourceProperty(()=>{this.url=t,this._options.url=t}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}loadTile(t,s){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),p={request:this.map._requestManager.transformRequest(c,re.Tile),uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function y(x,E){return delete t.request,t.aborted?s(null):x&&x.status!==404?s(x):(E&&E.resourceTiming&&(t.resourceTiming=E.resourceTiming),this.map._refreshExpiredTiles&&E&&t.setExpiryData(E),t.loadVectorData(E,this.map.painter),s(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}p.request.collectResourceTiming=this._collectResourceTiming,t.actor&&t.state!=="expired"?t.state==="loading"?t.reloadCallback=s:t.request=t.actor.send("reloadTile",p,y.bind(this)):(t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",p,y.bind(this)))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.actor&&t.actor.send("abortTile",{uid:t.uid,type:this.type,source:this.id},void 0)}unloadTile(t){t.unloadVectorData(),t.actor&&t.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class yi extends u.Evented{constructor(t,s,c,p){super(),this.id=t,this.dispatcher=c,this.setEventedParent(p),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.extend({type:"raster"},s),u.extend(this,u.pick(s,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Di(this._options,this.map._requestManager,(t,s)=>{this._tileJSONRequest=null,this._loaded=!0,t?this.fire(new u.ErrorEvent(t)):s&&(u.extend(this,s),s.bounds&&(this.tileBounds=new si(s.bounds,this.minzoom,this.maxzoom)),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(t){this.map=t,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return u.extend({},this._options)}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,s){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);t.request=te.getImage(this.map._requestManager.transformRequest(c,re.Tile),(p,y,x)=>{if(delete t.request,t.aborted)t.state="unloaded",s(null);else if(p)t.state="errored",s(p);else if(y){this.map._refreshExpiredTiles&&x&&t.setExpiryData(x);const E=this.map.painter.context,S=E.gl;t.texture=this.map.painter.getTileTexture(y.width),t.texture?t.texture.update(y,{useMipmap:!0}):(t.texture=new _t(E,y,S.RGBA,{useMipmap:!0}),t.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE,S.LINEAR_MIPMAP_NEAREST),E.extTextureFilterAnisotropic&&S.texParameterf(S.TEXTURE_2D,E.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,E.extTextureFilterAnisotropicMax)),t.state="loaded",s(null)}},this.map._refreshExpiredTiles)}abortTile(t,s){t.request&&(t.request.cancel(),delete t.request),s()}unloadTile(t,s){t.texture&&this.map.painter.saveTileTexture(t.texture),s()}hasTransition(){return!1}}class Jr extends yi{constructor(t,s,c,p){super(t,s,c,p),this.type="raster-dem",this.maxzoom=22,this._options=u.extend({type:"raster-dem"},s),this.encoding=s.encoding||"mapbox"}serialize(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}}loadTile(t,s){const c=t.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);function p(y,x){y&&(t.state="errored",s(y)),x&&(t.dem=x,t.needsHillshadePrepare=!0,t.needsTerrainPrepare=!0,t.state="loaded",s(null))}t.request=te.getImage(this.map._requestManager.transformRequest(c,re.Tile),function(y,x){if(delete t.request,t.aborted)t.state="unloaded",s(null);else if(y)t.state="errored",s(y);else if(x){this.map._refreshExpiredTiles&&t.setExpiryData(x),delete x.cacheControl,delete x.expires;const E=u.isImageBitmap(x)&&(It==null&&(It=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),It)?x:u.exported.getImageData(x,1),S={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:E,encoding:this.encoding};t.actor&&t.state!=="expired"||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",S,p.bind(this)))}}.bind(this),this.map._refreshExpiredTiles),t.neighboringTiles=this._getNeighboringTiles(t.tileID)}_getNeighboringTiles(t){const s=t.canonical,c=Math.pow(2,s.z),p=(s.x-1+c)%c,y=s.x===0?t.wrap-1:t.wrap,x=(s.x+1+c)%c,E=s.x+1===c?t.wrap+1:t.wrap,S={};return S[new u.OverscaledTileID(t.overscaledZ,y,s.z,p,s.y).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,E,s.z,x,s.y).key]={backfilled:!1},s.y>0&&(S[new u.OverscaledTileID(t.overscaledZ,y,s.z,p,s.y-1).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,t.wrap,s.z,s.x,s.y-1).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,E,s.z,x,s.y-1).key]={backfilled:!1}),s.y+1<c&&(S[new u.OverscaledTileID(t.overscaledZ,y,s.z,p,s.y+1).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,t.wrap,s.z,s.x,s.y+1).key]={backfilled:!1},S[new u.OverscaledTileID(t.overscaledZ,E,s.z,x,s.y+1).key]={backfilled:!1}),S}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded",t.actor&&t.actor.send("removeDEMTile",{uid:t.uid,source:this.id})}}class Pt extends u.Evented{constructor(t,s,c,p){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(p),this._data=s.data,this._options=u.extend({},s),this._collectResourceTiming=s.collectResourceTiming,s.maxzoom!==void 0&&(this.maxzoom=s.maxzoom),s.type&&(this.type=s.type),s.attribution&&(this.attribution=s.attribution),this.promoteId=s.promoteId;const y=u.EXTENT/this.tileSize;this.workerOptions=u.extend({source:this.id,cluster:s.cluster||!1,geojsonVtOptions:{buffer:(s.buffer!==void 0?s.buffer:128)*y,tolerance:(s.tolerance!==void 0?s.tolerance:.375)*y,extent:u.EXTENT,maxZoom:this.maxzoom,lineMetrics:s.lineMetrics||!1,generateId:s.generateId||!1},superclusterOptions:{maxZoom:s.clusterMaxZoom!==void 0?s.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,s.clusterMinPoints||2),extent:u.EXTENT,radius:(s.clusterRadius||50)*y,log:!1,generateId:s.generateId||!1},clusterProperties:s.clusterProperties,filter:s.filter},s.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}load(){this._updateWorkerData()}onAdd(t){this.map=t,this.load()}setData(t){return this._data=t,this._updateWorkerData(),this}updateData(t){return this._updateWorkerData(t),this}setClusterOptions(t){return this.workerOptions.cluster=t.cluster,t&&(t.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=t.clusterRadius),t.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=t.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(t,s){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id},s),this}getClusterChildren(t,s){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id},s),this}getClusterLeaves(t,s,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:t,limit:s,offset:c},p),this}_updateWorkerData(t){const s=u.extend({},this.workerOptions);t?s.dataDiff=t:typeof this._data=="string"?(s.request=this.map._requestManager.transformRequest(u.exported.resolveURL(this._data),re.Source),s.request.collectResourceTiming=this._collectResourceTiming):s.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.Event("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,s,(c,p)=>{if(this._pendingLoads--,this._removed||p&&p.abandoned)return void this.fire(new u.Event("dataabort",{dataType:"source"}));let y=null;if(p&&p.resourceTiming&&p.resourceTiming[this.id]&&(y=p.resourceTiming[this.id].slice(0)),c)return void this.fire(new u.ErrorEvent(c));const x={dataType:"source"};this._collectResourceTiming&&y&&y.length>0&&u.extend(x,{resourceTiming:y}),this.fire(new u.Event("data",{...x,sourceDataType:"metadata"})),this.fire(new u.Event("data",{...x,sourceDataType:"content"}))})}loaded(){return this._pendingLoads===0}loadTile(t,s){const c=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const p={type:this.type,uid:t.uid,tileID:t.tileID,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};t.request=this.actor.send(c,p,(y,x)=>(delete t.request,t.unloadVectorData(),t.aborted?s(null):y?s(y):(t.loadVectorData(x,this.map.painter,c==="reloadTile"),s(null))))}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}serialize(){return u.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}}var Zt=u.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Wt extends u.Evented{constructor(t,s,c,p){super(),this.id=t,this.dispatcher=c,this.coordinates=s.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(p),this.options=s}load(t,s){this._loaded=!1,this.fire(new u.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=te.getImage(this.map._requestManager.transformRequest(this.url,re.Image),(c,p)=>{this._request=null,this._loaded=!0,c?this.fire(new u.ErrorEvent(c)):p&&(this.image=p,t&&(this.coordinates=t),s&&s(),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return t.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=t.url,this.load(t.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(t){this.coordinates=t;const s=t.map(u.MercatorCoordinate.fromLngLat);this.tileID=function(p){let y=1/0,x=1/0,E=-1/0,S=-1/0;for(const F of p)y=Math.min(y,F.x),x=Math.min(x,F.y),E=Math.max(E,F.x),S=Math.max(S,F.y);const C=Math.max(E-y,S-x),M=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),P=Math.pow(2,M);return new u.CanonicalTileID(M,Math.floor((y+E)/2*P),Math.floor((x+S)/2*P))}(s),this.minzoom=this.maxzoom=this.tileID.z;const c=s.map(p=>this.tileID.getTilePoint(p)._round());return this._boundsArray=new u.RasterBoundsArray,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,u.EXTENT,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,u.EXTENT),this._boundsArray.emplaceBack(c[2].x,c[2].y,u.EXTENT,u.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const t=this.map.painter.context,s=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Zt.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new _t(t,this.image,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let c=!1;for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new u.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}loadTile(t,s){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},s(null)):(t.state="errored",s(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class me extends Wt{constructor(t,s,c,p){super(t,s,c,p),this.roundZoom=!0,this.type="video",this.options=s}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const s of t.urls)this.urls.push(this.map._requestManager.transformRequest(s,re.Source).url);u.getVideo(this.urls,(s,c)=>{this._loaded=!0,s?this.fire(new u.ErrorEvent(s)):c&&(this.video=c,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const s=this.video.seekable;t<s.start(0)||t>s.end(0)?this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${s.start(0)} and ${s.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,s=t.gl;this.boundsBuffer||(this.boundsBuffer=t.createVertexBuffer(this._boundsArray,Zt.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE),s.texSubImage2D(s.TEXTURE_2D,0,0,0,s.RGBA,s.UNSIGNED_BYTE,this.video)):(this.texture=new _t(t,this.video,s.RGBA),this.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE));let c=!1;for(const p in this.tiles){const y=this.tiles[p];y.state!=="loaded"&&(y.state="loaded",y.texture=this.texture,c=!0)}c&&this.fire(new u.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}}class Rn extends Wt{constructor(t,s,c,p){super(t,s,c,p),s.coordinates?Array.isArray(s.coordinates)&&s.coordinates.length===4&&!s.coordinates.some(y=>!Array.isArray(y)||y.length!==2||y.some(x=>typeof x!="number"))||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'missing required property "coordinates"'))),s.animate&&typeof s.animate!="boolean"&&this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),s.canvas?typeof s.canvas=="string"||s.canvas instanceof HTMLCanvasElement||this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.ErrorEvent(new u.ValidationError(`sources.${t}`,null,'missing required property "canvas"'))),this.options=s,this.animate=s.animate===void 0||s.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const s=this.map.painter.context,c=s.gl;this.boundsBuffer||(this.boundsBuffer=s.createVertexBuffer(this._boundsArray,Zt.members)),this.boundsSegments||(this.boundsSegments=u.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new _t(s,this.canvas,c.RGBA,{premultiply:!0});let p=!1;for(const y in this.tiles){const x=this.tiles[y];x.state!=="loaded"&&(x.state="loaded",x.texture=this.texture,p=!0)}p&&this.fire(new u.Event("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}}const _i={vector:ho,raster:yi,"raster-dem":Jr,geojson:Pt,video:me,image:Wt,canvas:Rn};function vt(h,t){const s=u.create();return u.translate(s,s,[1,1,0]),u.scale(s,s,[.5*h.width,.5*h.height,1]),u.multiply(s,s,h.calculatePosMatrix(t.toUnwrapped()))}function dt(h,t,s,c,p,y){const x=function(P,F,Z){if(P)for(const V of P){const q=F[V];if(q&&q.source===Z&&q.type==="fill-extrusion")return!0}else for(const V in F){const q=F[V];if(q.source===Z&&q.type==="fill-extrusion")return!0}return!1}(p&&p.layers,t,h.id),E=y.maxPitchScaleFactor(),S=h.tilesIn(c,E,x);S.sort(un);const C=[];for(const P of S)C.push({wrappedTileID:P.tileID.wrapped().key,queryResults:P.tile.queryRenderedFeatures(t,s,h._state,P.queryGeometry,P.cameraQueryGeometry,P.scale,p,y,E,vt(h.transform,P.tileID))});const M=function(P){const F={},Z={};for(const V of P){const q=V.queryResults,H=V.wrappedTileID,Q=Z[H]=Z[H]||{};for(const de in q){const W=q[de],he=Q[de]=Q[de]||{},ge=F[de]=F[de]||[];for(const we of W)he[we.featureIndex]||(he[we.featureIndex]=!0,ge.push(we))}}return F}(C);for(const P in M)M[P].forEach(F=>{const Z=F.feature,V=h.getFeatureState(Z.layer["source-layer"],Z.id);Z.source=Z.layer.source,Z.layer["source-layer"]&&(Z.sourceLayer=Z.layer["source-layer"]),Z.state=V});return M}function un(h,t){const s=h.tileID,c=t.tileID;return s.overscaledZ-c.overscaledZ||s.canonical.y-c.canonical.y||s.wrap-c.wrap||s.canonical.x-c.canonical.x}class Qr{constructor(t,s){this.timeAdded=0,this.fadeEndTime=0,this.tileID=t,this.uid=u.uniqueId(),this.uses=0,this.tileSize=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(t){const s=t+this.timeAdded;s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(t){this.demTexture&&t.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(t,s,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(p,y){const x={};if(!y)return x;for(const E of p){const S=E.layerIds.map(C=>y.getLayer(C)).filter(Boolean);if(S.length!==0){E.layers=S,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map(C=>S.filter(M=>M.id===C)[0]));for(const C of S)x[C.id]=E}}return x}(t.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const y=this.buckets[p];if(y instanceof u.SymbolBucket){if(this.hasSymbolBuckets=!0,!c)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const y=this.buckets[p];if(y instanceof u.SymbolBucket&&y.hasRTLText){this.hasRTLText=!0,u.lazyLoadRTLTextPlugin();break}}this.queryPadding=0;for(const p in this.buckets){const y=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(y))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage)}else this.collisionBoxArray=new u.CollisionBoxArray}unloadVectorData(){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const p=this.buckets[c];p.uploadPending()&&p.upload(t)}const s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new _t(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new _t(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,s,c,p,y,x,E,S,C,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:p,cameraQueryGeometry:y,scale:x,tileSize:this.tileSize,pixelPosMatrix:M,transform:S,params:E,queryPadding:this.queryPadding*C},t,s,c):{}}querySourceFeatures(t,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const p=c.loadVTLayers(),y=s&&s.sourceLayer?s.sourceLayer:"",x=p._geojsonTileLayer||p[y];if(!x)return;const E=u.createFilter(s&&s.filter),{z:S,x:C,y:M}=this.tileID.canonical,P={z:S,x:C,y:M};for(let F=0;F<x.length;F++){const Z=x.feature(F);if(E.needGeometry){const H=u.toEvaluationFeature(Z,!0);if(!E.filter(new u.EvaluationParameters(this.tileID.overscaledZ),H,this.tileID.canonical))continue}else if(!E.filter(new u.EvaluationParameters(this.tileID.overscaledZ),Z))continue;const V=c.getId(Z,y),q=new u.GeoJSONFeature(Z,S,C,M,V);q.tile=P,t.push(q)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const s=this.expirationTime;if(t.cacheControl){const c=u.parseCacheControl(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let p=!1;if(this.expirationTime>c)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const y=this.expirationTime-s;y?this.expirationTime=c+Math.max(y,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!s.style.hasLayer(p))continue;const y=this.buckets[p],x=y.layers[0].sourceLayer||"_geojsonTileLayer",E=c[x],S=t[x];if(!E||!S||Object.keys(S).length===0)continue;y.update(S,E,this.imageAtlas&&this.imageAtlas.patternPositions||{});const C=s&&s.style&&s.style.getLayer(p);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(y)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<u.exported.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=u.exported.now()+t}setDependencies(t,s){const c={};for(const p of s)c[p]=!0;this.dependencies[t]=c}hasDependency(t,s){for(const c of t){const p=this.dependencies[c];if(p){for(const y of s)if(p[y])return!0}}return!1}}class po{constructor(t,s){this.max=t,this.onRemove=s,this.reset()}reset(){for(const t in this.data)for(const s of this.data[t])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(t,s,c){const p=t.wrapped().key;this.data[p]===void 0&&(this.data[p]=[]);const y={value:s,timeout:void 0};if(c!==void 0&&(y.timeout=setTimeout(()=>{this.remove(t,y)},c)),this.data[p].push(y),this.order.push(p),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const s=this.data[t].shift();return s.timeout&&clearTimeout(s.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),s.value}getByKey(t){const s=this.data[t];return s?s[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,s){if(!this.has(t))return this;const c=t.wrapped().key,p=s===void 0?0:this.data[c].indexOf(s),y=this.data[c][p];return this.data[c].splice(p,1),y.timeout&&clearTimeout(y.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(y.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(t){const s=[];for(const c in this.data)for(const p of this.data[c])t(p.value)||s.push(p);for(const c of s)this.remove(c.value.tileID,c)}}class fo{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,s,c){const p=String(s);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][p]=this.stateChanges[t][p]||{},u.extend(this.stateChanges[t][p],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const y in this.state[t])y!==p&&(this.deletedStates[t][y]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][p]===null){this.deletedStates[t][p]={};for(const y in this.state[t][p])c[y]||(this.deletedStates[t][p][y]=null)}else for(const y in c)this.deletedStates[t]&&this.deletedStates[t][p]&&this.deletedStates[t][p][y]===null&&delete this.deletedStates[t][p][y]}removeFeatureState(t,s,c){if(this.deletedStates[t]===null)return;const p=String(s);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&s!==void 0)this.deletedStates[t][p]!==null&&(this.deletedStates[t][p]=this.deletedStates[t][p]||{},this.deletedStates[t][p][c]=null);else if(s!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][p])for(c in this.deletedStates[t][p]={},this.stateChanges[t][p])this.deletedStates[t][p][c]=null;else this.deletedStates[t][p]=null;else this.deletedStates[t]=null}getState(t,s){const c=String(s),p=u.extend({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const y=this.deletedStates[t][s];if(y===null)return{};for(const x in y)delete p[x]}return p}initializeTileState(t,s){t.setFeatureState(this.state,s)}coalesceChanges(t,s){const c={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const y={};for(const x in this.stateChanges[p])this.state[p][x]||(this.state[p][x]={}),u.extend(this.state[p][x],this.stateChanges[p][x]),y[x]=this.state[p][x];c[p]=y}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const y={};if(this.deletedStates[p]===null)for(const x in this.state[p])y[x]={},this.state[p][x]={};else for(const x in this.deletedStates[p]){if(this.deletedStates[p][x]===null)this.state[p][x]={};else for(const E of Object.keys(this.deletedStates[p][x]))delete this.state[p][x][E];y[x]=this.state[p][x]}c[p]=c[p]||{},u.extend(c[p],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const p in t)t[p].setFeatureState(c,s)}}class Gt extends u.Evented{constructor(t,s,c){super(),this.id=t,this.dispatcher=c,this.on("data",p=>{p.dataType==="source"&&p.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&p.dataType==="source"&&p.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=function(p,y,x,E){const S=new _i[y.type](p,y,x,E);if(S.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${S.id}`);return u.bindAll(["load","abort","unload","serialize","prepare"],S),S}(t,s,c,this),this._tiles={},this._cache=new po(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new fo,this._didEmitContent=!1,this._updated=!1}onAdd(t){this.map=t,this._maxTileCacheSize=t?t._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(t)}onRemove(t){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(t)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const t in this._tiles){const s=this._tiles[t];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(t,s){return this._source.loadTile(t,s)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){this._source.abortTile&&this._source.abortTile(t,()=>{}),this._source.fire(new u.Event("dataabort",{tile:t,coord:t.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(t){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(t=>t.tileID).sort(Zn).map(t=>t.key)}getRenderableIds(t){const s=[];for(const c in this._tiles)this._isIdRenderable(c,t)&&s.push(this._tiles[c]);return t?s.sort((c,p)=>{const y=c.tileID,x=p.tileID,E=new u.Point(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),S=new u.Point(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-x.overscaledZ||S.y-E.y||S.x-E.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(Zn).map(c=>c.key)}hasRenderableParent(t){const s=this.findLoadedParent(t,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(t,s){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(s||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(t,"reloading")}}_reloadTile(t,s){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,t,s)))}_tileLoaded(t,s,c,p){if(p)return t.state="errored",void(p.status!==404?this._source.fire(new u.ErrorEvent(p,{tile:t})):this.update(this.transform,this.terrain));t.timeAdded=u.exported.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(s,t),this.getSource().type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),t.aborted||this._source.fire(new u.Event("data",{dataType:"source",tile:t,coord:t.tileID}))}_backfillDEM(t){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const y=s[p];if(t.neighboringTiles&&t.neighboringTiles[y]){const x=this.getTileByID(y);c(t,x),c(x,t)}}function c(p,y){p.needsHillshadePrepare=!0,p.needsTerrainPrepare=!0;let x=y.tileID.canonical.x-p.tileID.canonical.x;const E=y.tileID.canonical.y-p.tileID.canonical.y,S=Math.pow(2,p.tileID.canonical.z),C=y.tileID.key;x===0&&E===0||Math.abs(E)>1||(Math.abs(x)>1&&(Math.abs(x+S)===1?x+=S:Math.abs(x-S)===1&&(x-=S)),y.dem&&p.dem&&(p.dem.backfillBorder(y.dem,x,E),p.neighboringTiles&&p.neighboringTiles[C]&&(p.neighboringTiles[C].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,s,c,p){for(const y in this._tiles){let x=this._tiles[y];if(p[y]||!x.hasData()||x.tileID.overscaledZ<=s||x.tileID.overscaledZ>c)continue;let E=x.tileID;for(;x&&x.tileID.overscaledZ>s+1;){const C=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[C.key],x&&x.hasData()&&(E=C)}let S=E;for(;S.overscaledZ>s;)if(S=S.scaledTo(S.overscaledZ-1),t[S.key]){p[E.key]=E;break}}}findLoadedParent(t,s){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=t.overscaledZ-1;c>=s;c--){const p=t.scaledTo(c),y=this._getLoadedTile(p);if(y)return y}}_getLoadedTile(t){const s=this._tiles[t.key];return s&&s.hasData()?s:this._cache.getByKey(t.wrapped().key)}updateCacheSize(t){const s=Math.ceil(t.width/this._source.tileSize)+1,c=Math.ceil(t.height/this._source.tileSize)+1,p=Math.floor(s*c*5),y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,p):p;this._cache.setMaxSize(y)}handleWrapJump(t){const s=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,s){const c={};for(const p in this._tiles){const y=this._tiles[p];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+s),c[y.tileID.key]=y}this._tiles=c;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(p,this._tiles[p])}}update(t,s){if(this.transform=t,this.terrain=s,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(t),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new u.OverscaledTileID(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(c=t.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:s}),this._source.hasTile&&(c=c.filter(M=>this._source.hasTile(M)))):c=[];const p=t.coveringZoomLevel(this._source),y=Math.max(p-Gt.maxOverzooming,this._source.minzoom),x=Math.max(p+Gt.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const M={};for(const P of c)if(P.canonical.z>this._source.minzoom){const F=P.scaledTo(P.canonical.z-1);M[F.key]=F;const Z=P.scaledTo(Math.max(this._source.minzoom,Math.min(P.canonical.z,5)));M[Z.key]=Z}c=c.concat(Object.values(M))}const E=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,E&&this.fire(new u.Event("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const S=this._updateRetainedTiles(c,p);if(Lr(this._source.type)){const M={},P={},F=Object.keys(S),Z=u.exported.now();for(const V of F){const q=S[V],H=this._tiles[V];if(!H||H.fadeEndTime!==0&&H.fadeEndTime<=Z)continue;const Q=this.findLoadedParent(q,y);Q&&(this._addTile(Q.tileID),M[Q.tileID.key]=Q.tileID),P[V]=q}this._retainLoadedChildren(P,p,x,S);for(const V in M)S[V]||(this._coveredTiles[V]=!0,S[V]=M[V]);if(s){const V={},q={};for(const H of c)this._tiles[H.key].hasData()?V[H.key]=H:q[H.key]=H;for(const H in q){const Q=q[H].children(this._source.maxzoom);this._tiles[Q[0].key]&&this._tiles[Q[1].key]&&this._tiles[Q[2].key]&&this._tiles[Q[3].key]&&(V[Q[0].key]=S[Q[0].key]=Q[0],V[Q[1].key]=S[Q[1].key]=Q[1],V[Q[2].key]=S[Q[2].key]=Q[2],V[Q[3].key]=S[Q[3].key]=Q[3],delete q[H])}for(const H in q){const Q=this.findLoadedParent(q[H],this._source.minzoom);if(Q){V[Q.tileID.key]=S[Q.tileID.key]=Q.tileID;for(const de in V)V[de].isChildOf(Q.tileID)&&delete V[de]}}for(const H in this._tiles)V[H]||(this._coveredTiles[H]=!0)}}for(const M in S)this._tiles[M].clearFadeHold();const C=u.keysDifference(this._tiles,S);for(const M of C){const P=this._tiles[M];P.hasSymbolBuckets&&!P.holdingForFade()?P.setHoldDuration(this.map._fadeDuration):P.hasSymbolBuckets&&!P.symbolFadeFinished()||this._removeTile(M)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(t)}_updateRetainedTiles(t,s){const c={},p={},y=Math.max(s-Gt.maxOverzooming,this._source.minzoom),x=Math.max(s+Gt.maxUnderzooming,this._source.minzoom),E={};for(const S of t){const C=this._addTile(S);c[S.key]=S,C.hasData()||s<this._source.maxzoom&&(E[S.key]=S)}this._retainLoadedChildren(E,s,x,c);for(const S of t){let C=this._tiles[S.key];if(C.hasData())continue;if(s+1>this._source.maxzoom){const P=S.children(this._source.maxzoom)[0],F=this.getTile(P);if(F&&F.hasData()){c[P.key]=P;continue}}else{const P=S.children(this._source.maxzoom);if(c[P[0].key]&&c[P[1].key]&&c[P[2].key]&&c[P[3].key])continue}let M=C.wasRequested();for(let P=S.overscaledZ-1;P>=y;--P){const F=S.scaledTo(P);if(p[F.key])break;if(p[F.key]=!0,C=this.getTile(F),!C&&M&&(C=this._addTile(F)),C){const Z=C.hasData();if((M||Z)&&(c[F.key]=F),M=C.wasRequested(),Z)break}}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const s=[];let c,p=this._tiles[t].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){c=this._loadedParentTiles[p.key];break}s.push(p.key);const y=p.scaledTo(p.overscaledZ-1);if(c=this._getLoadedTile(y),c)break;p=y}for(const y of s)this._loadedParentTiles[y]=c}}_addTile(t){let s=this._tiles[t.key];if(s)return s;s=this._cache.getAndRemove(t),s&&(this._setTileReloadTimer(t.key,s),s.tileID=t,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,s)));const c=s;return s||(s=new Qr(t,this._source.tileSize*t.overscaleFactor()),this._loadTile(s,this._tileLoaded.bind(this,s,t.key,s.state))),s.uses++,this._tiles[t.key]=s,c||this._source.fire(new u.Event("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s}_setTileReloadTimer(t,s){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=s.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const s=this._tiles[t];s&&(s.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(t);this._cache.reset()}tilesIn(t,s,c){const p=[],y=this.transform;if(!y)return p;const x=c?y.getCameraQueryGeometry(t):t,E=t.map(V=>y.pointCoordinate(V,this.terrain)),S=x.map(V=>y.pointCoordinate(V,this.terrain)),C=this.getIds();let M=1/0,P=1/0,F=-1/0,Z=-1/0;for(const V of S)M=Math.min(M,V.x),P=Math.min(P,V.y),F=Math.max(F,V.x),Z=Math.max(Z,V.y);for(let V=0;V<C.length;V++){const q=this._tiles[C[V]];if(q.holdingForFade())continue;const H=q.tileID,Q=Math.pow(2,y.zoom-q.tileID.overscaledZ),de=s*q.queryPadding*u.EXTENT/q.tileSize/Q,W=[H.getTilePoint(new u.MercatorCoordinate(M,P)),H.getTilePoint(new u.MercatorCoordinate(F,Z))];if(W[0].x-de<u.EXTENT&&W[0].y-de<u.EXTENT&&W[1].x+de>=0&&W[1].y+de>=0){const he=E.map(we=>H.getTilePoint(we)),ge=S.map(we=>H.getTilePoint(we));p.push({tile:q,tileID:H,queryGeometry:he,cameraQueryGeometry:ge,scale:Q})}}return p}getVisibleCoordinates(t){const s=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);for(const c of s)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(Lr(this._source.type)){const t=u.exported.now();for(const s in this._tiles)if(this._tiles[s].fadeEndTime>=t)return!0}return!1}setFeatureState(t,s,c){this._state.updateState(t=t||"_geojsonTileLayer",s,c)}removeFeatureState(t,s,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",s,c)}getFeatureState(t,s){return this._state.getState(t=t||"_geojsonTileLayer",s)}setDependencies(t,s,c){const p=this._tiles[t];p&&p.setDependencies(s,c)}reloadTilesForDependencies(t,s){for(const c in this._tiles)this._tiles[c].hasDependency(t,s)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(t,s))}}function Zn(h,t){const s=Math.abs(2*h.wrap)-+(h.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return h.overscaledZ-t.overscaledZ||c-s||t.canonical.y-h.canonical.y||t.canonical.x-h.canonical.x}function Lr(h){return h==="raster"||h==="image"||h==="video"}Gt.maxOverzooming=10,Gt.maxUnderzooming=3;const Le="mapboxgl_preloaded_worker_pool";class Bn{constructor(){this.active={}}acquire(t){if(!this.workers)for(this.workers=[];this.workers.length<Bn.workerCount;)this.workers.push(new Worker(u.config.WORKER_URL));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.numActive()===0&&(this.workers.forEach(s=>{s.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Le]}numActive(){return Object.keys(this.active).length}}const vi=Math.floor(u.exported.hardwareConcurrency/2);let _r;function Rr(){return _r||(_r=new Bn),_r}Bn.workerCount=u.isSafari(globalThis)?Math.max(Math.min(vi,3),1):1;class Re{constructor(t,s){this.reset(t,s)}reset(t,s){this.points=t||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(this.points.length===1)return this.points[0];t=u.clamp(t,0,1);let s=1,c=this._distances[s];const p=t*this.paddedLength+this.padding;for(;c<p&&s<this._distances.length;)c=this._distances[++s];const y=s-1,x=this._distances[y],E=c-x,S=E>0?(p-x)/E:0;return this.points[y].mult(1-S).add(this.points[s].mult(S))}}function wt(h,t){let s=!0;return h==="always"||h!=="never"&&t!=="never"||(s=!1),s}class mt{constructor(t,s,c){const p=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(t/c),this.yCellCount=Math.ceil(s/c);for(let x=0;x<this.xCellCount*this.yCellCount;x++)p.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=t,this.height=s,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(t,s,c,p,y){this._forEachCell(s,c,p,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(y)}insertCircle(t,s,c,p){this._forEachCell(s-p,c-p,s+p,c+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(t),this.circles.push(s),this.circles.push(c),this.circles.push(p)}_insertBoxCell(t,s,c,p,y,x){this.boxCells[y].push(x)}_insertCircleCell(t,s,c,p,y,x){this.circleCells[y].push(x)}_query(t,s,c,p,y,x,E){if(c<0||t>this.width||p<0||s>this.height)return[];const S=[];if(t<=0&&s<=0&&this.width<=c&&this.height<=p){if(y)return[{key:null,x1:t,y1:s,x2:c,y2:p}];for(let C=0;C<this.boxKeys.length;C++)S.push({key:this.boxKeys[C],x1:this.bboxes[4*C],y1:this.bboxes[4*C+1],x2:this.bboxes[4*C+2],y2:this.bboxes[4*C+3]});for(let C=0;C<this.circleKeys.length;C++){const M=this.circles[3*C],P=this.circles[3*C+1],F=this.circles[3*C+2];S.push({key:this.circleKeys[C],x1:M-F,y1:P-F,x2:M+F,y2:P+F})}}else this._forEachCell(t,s,c,p,this._queryCell,S,{hitTest:y,overlapMode:x,seenUids:{box:{},circle:{}}},E);return S}query(t,s,c,p){return this._query(t,s,c,p,!1,null)}hitTest(t,s,c,p,y,x){return this._query(t,s,c,p,!0,y,x).length>0}hitTestCircle(t,s,c,p,y){const x=t-c,E=t+c,S=s-c,C=s+c;if(E<0||x>this.width||C<0||S>this.height)return!1;const M=[];return this._forEachCell(x,S,E,C,this._queryCellCircle,M,{hitTest:!0,overlapMode:p,circle:{x:t,y:s,radius:c},seenUids:{box:{},circle:{}}},y),M.length>0}_queryCell(t,s,c,p,y,x,E,S){const{seenUids:C,hitTest:M,overlapMode:P}=E,F=this.boxCells[y];if(F!==null){const V=this.bboxes;for(const q of F)if(!C.box[q]){C.box[q]=!0;const H=4*q,Q=this.boxKeys[q];if(t<=V[H+2]&&s<=V[H+3]&&c>=V[H+0]&&p>=V[H+1]&&(!S||S(Q))&&(!M||!wt(P,Q.overlapMode))&&(x.push({key:Q,x1:V[H],y1:V[H+1],x2:V[H+2],y2:V[H+3]}),M))return!0}}const Z=this.circleCells[y];if(Z!==null){const V=this.circles;for(const q of Z)if(!C.circle[q]){C.circle[q]=!0;const H=3*q,Q=this.circleKeys[q];if(this._circleAndRectCollide(V[H],V[H+1],V[H+2],t,s,c,p)&&(!S||S(Q))&&(!M||!wt(P,Q.overlapMode))){const de=V[H],W=V[H+1],he=V[H+2];if(x.push({key:Q,x1:de-he,y1:W-he,x2:de+he,y2:W+he}),M)return!0}}}return!1}_queryCellCircle(t,s,c,p,y,x,E,S){const{circle:C,seenUids:M,overlapMode:P}=E,F=this.boxCells[y];if(F!==null){const V=this.bboxes;for(const q of F)if(!M.box[q]){M.box[q]=!0;const H=4*q,Q=this.boxKeys[q];if(this._circleAndRectCollide(C.x,C.y,C.radius,V[H+0],V[H+1],V[H+2],V[H+3])&&(!S||S(Q))&&!wt(P,Q.overlapMode))return x.push(!0),!0}}const Z=this.circleCells[y];if(Z!==null){const V=this.circles;for(const q of Z)if(!M.circle[q]){M.circle[q]=!0;const H=3*q,Q=this.circleKeys[q];if(this._circlesCollide(V[H],V[H+1],V[H+2],C.x,C.y,C.radius)&&(!S||S(Q))&&!wt(P,Q.overlapMode))return x.push(!0),!0}}}_forEachCell(t,s,c,p,y,x,E,S){const C=this._convertToXCellCoord(t),M=this._convertToYCellCoord(s),P=this._convertToXCellCoord(c),F=this._convertToYCellCoord(p);for(let Z=C;Z<=P;Z++)for(let V=M;V<=F;V++)if(y.call(this,t,s,c,p,this.xCellCount*V+Z,x,E,S))return}_convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}_convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}_circlesCollide(t,s,c,p,y,x){const E=p-t,S=y-s,C=c+x;return C*C>E*E+S*S}_circleAndRectCollide(t,s,c,p,y,x,E){const S=(x-p)/2,C=Math.abs(t-(p+S));if(C>S+c)return!1;const M=(E-y)/2,P=Math.abs(s-(y+M));if(P>M+c)return!1;if(C<=S||P<=M)return!0;const F=C-S,Z=P-M;return F*F+Z*Z<=c*c}}function Fn(h,t,s,c,p){const y=u.create();return t?(u.scale(y,y,[1/p,1/p,1]),s||u.rotateZ(y,y,c.angle)):u.multiply(y,c.labelPlaneMatrix,h),y}function rr(h,t,s,c,p){if(t){const y=u.clone(h);return u.scale(y,y,[p,p,1]),s||u.rotateZ(y,y,-c.angle),y}return c.glCoordMatrix}function at(h,t,s){let c;s?(c=[h.x,h.y,s(h.x,h.y),1],u.transformMat4(c,c,t)):(c=[h.x,h.y,0,1],K(c,c,t));const p=c[3];return{point:new u.Point(c[0]/p,c[1]/p),signedDistanceFromCamera:p}}function Br(h,t){return .5+h/t*.5}function eo(h,t){const s=h[0]/h[3],c=h[1]/h[3];return s>=-t[0]&&s<=t[0]&&c>=-t[1]&&c<=t[1]}function No(h,t,s,c,p,y,x,E,S,C){const M=c?h.textSizeData:h.iconSizeData,P=u.evaluateSizeForZoom(M,s.transform.zoom),F=[256/s.width*2+1,256/s.height*2+1],Z=c?h.text.dynamicLayoutVertexArray:h.icon.dynamicLayoutVertexArray;Z.clear();const V=h.lineVertexArray,q=c?h.text.placedSymbolArray:h.icon.placedSymbolArray,H=s.transform.width/s.transform.height;let Q=!1;for(let de=0;de<q.length;de++){const W=q.get(de);if(W.hidden||W.writingMode===u.WritingMode.vertical&&!Q){ne(W.numGlyphs,Z);continue}let he;if(Q=!1,C?(he=[W.anchorX,W.anchorY,C(W.anchorX,W.anchorY),1],u.transformMat4(he,he,t)):(he=[W.anchorX,W.anchorY,0,1],K(he,he,t)),!eo(he,F)){ne(W.numGlyphs,Z);continue}const ge=Br(s.transform.cameraToCenterDistance,he[3]),we=u.evaluateSizeForFeature(M,P,W),Se=x?we/ge:we*ge,Ie=new u.Point(W.anchorX,W.anchorY),be=at(Ie,p,C).point,je={projections:{},offsets:{}},rt=$(W,Se,!1,E,t,p,y,h.glyphOffsetArray,V,Z,be,Ie,je,H,S,C);Q=rt.useVertical,(rt.notEnoughRoom||Q||rt.needsFlipping&&$(W,Se,!0,E,t,p,y,h.glyphOffsetArray,V,Z,be,Ie,je,H,S,C).notEnoughRoom)&&ne(W.numGlyphs,Z)}c?h.text.dynamicLayoutVertexBuffer.updateData(Z):h.icon.dynamicLayoutVertexBuffer.updateData(Z)}function to(h,t,s,c,p,y,x,E,S,C,M,P,F){const Z=E.glyphStartIndex+E.numGlyphs,V=E.lineStartIndex,q=E.lineStartIndex+E.lineLength,H=t.getoffsetX(E.glyphStartIndex),Q=t.getoffsetX(Z-1),de=Y(h*H,s,c,p,y,x,E.segment,V,q,S,C,M,P,F);if(!de)return null;const W=Y(h*Q,s,c,p,y,x,E.segment,V,q,S,C,M,P,F);return W?{first:de,last:W}:null}function Gn(h,t,s,c){return h===u.WritingMode.horizontal&&Math.abs(s.y-t.y)>Math.abs(s.x-t.x)*c?{useVertical:!0}:(h===u.WritingMode.vertical?t.y<s.y:t.x>s.x)?{needsFlipping:!0}:null}function $(h,t,s,c,p,y,x,E,S,C,M,P,F,Z,V,q){const H=t/24,Q=h.lineOffsetX*H,de=h.lineOffsetY*H;let W;if(h.numGlyphs>1){const he=h.glyphStartIndex+h.numGlyphs,ge=h.lineStartIndex,we=h.lineStartIndex+h.lineLength,Se=to(H,E,Q,de,s,M,P,h,S,y,F,V,q);if(!Se)return{notEnoughRoom:!0};const Ie=at(Se.first.point,x,q).point,be=at(Se.last.point,x,q).point;if(c&&!s){const je=Gn(h.writingMode,Ie,be,Z);if(je)return je}W=[Se.first];for(let je=h.glyphStartIndex+1;je<he-1;je++)W.push(Y(H*E.getoffsetX(je),Q,de,s,M,P,h.segment,ge,we,S,y,F,V,q));W.push(Se.last)}else{if(c&&!s){const ge=at(P,p,q).point,we=h.lineStartIndex+h.segment+1,Se=new u.Point(S.getx(we),S.gety(we)),Ie=at(Se,p,q),be=Ie.signedDistanceFromCamera>0?Ie.point:z(P,Se,ge,1,p,q),je=Gn(h.writingMode,ge,be,Z);if(je)return je}const he=Y(H*E.getoffsetX(h.glyphStartIndex),Q,de,s,M,P,h.segment,h.lineStartIndex,h.lineStartIndex+h.lineLength,S,y,F,V,q);if(!he)return{notEnoughRoom:!0};W=[he]}for(const he of W)u.addDynamicAttributes(C,he.point,he.angle);return{}}function z(h,t,s,c,p,y){const x=at(h.add(h.sub(t)._unit()),p,y).point,E=s.sub(x);return s.add(E._mult(c/E.mag()))}function R(h,t){const{projectionCache:s,lineVertexArray:c,labelPlaneMatrix:p,tileAnchorPoint:y,distanceFromAnchor:x,getElevation:E,previousVertex:S,direction:C,absOffsetX:M}=t;if(s.projections[h])return s.projections[h];const P=new u.Point(c.getx(h),c.gety(h)),F=at(P,p,E);if(F.signedDistanceFromCamera>0)return s.projections[h]=F.point,F.point;const Z=h-C;return z(x===0?y:new u.Point(c.getx(Z),c.gety(Z)),P,S,M-x+1,p,E)}function N(h,t,s){return h._unit()._perp()._mult(t*s)}function X(h,t,s,c,p,y,x,E){const{projectionCache:S,direction:C}=E;if(S.offsets[h])return S.offsets[h];const M=s.add(t);if(h+C<c||h+C>=p)return S.offsets[h]=M,M;const P=R(h+C,E),F=N(P.sub(s),x,C),Z=s.add(F),V=P.add(F);return S.offsets[h]=u.findLineIntersection(y,M,Z,V)||M,S.offsets[h]}function Y(h,t,s,c,p,y,x,E,S,C,M,P,F,Z){const V=c?h-t:h+t;let q=V>0?1:-1,H=0;c&&(q*=-1,H=Math.PI),q<0&&(H+=Math.PI);let Q,de,W=q>0?E+x:E+x+1,he=p,ge=p,we=0,Se=0;const Ie=Math.abs(V),be=[];let je;for(;we+Se<=Ie;){if(W+=q,W<E||W>=S)return null;we+=Se,ge=he,de=Q;const De={projectionCache:P,lineVertexArray:C,labelPlaneMatrix:M,tileAnchorPoint:y,distanceFromAnchor:we,getElevation:Z,previousVertex:ge,direction:q,absOffsetX:Ie};if(he=R(W,De),s===0)be.push(ge),je=he.sub(ge);else{let ut;const Ge=he.sub(ge);ut=Ge.mag()===0?N(R(W+q,De).sub(he),s,q):N(Ge,s,q),de||(de=ge.add(ut)),Q=X(W,ut,he,E,S,de,s,De),be.push(de),je=Q.sub(de)}Se=je.mag()}const rt=je._mult((Ie-we)/Se)._add(de||ge),ft=H+Math.atan2(he.y-ge.y,he.x-ge.x);return be.push(rt),{point:rt,angle:F?ft:0,path:be}}const oe=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function ne(h,t){for(let s=0;s<h;s++){const c=t.length;t.resize(c+4),t.float32.set(oe,3*c)}}function K(h,t,s){const c=t[0],p=t[1];return h[0]=s[0]*c+s[4]*p+s[12],h[1]=s[1]*c+s[5]*p+s[13],h[3]=s[3]*c+s[7]*p+s[15],h}const se=100;class ve{constructor(t,s=new mt(t.width+200,t.height+200,25),c=new mt(t.width+200,t.height+200,25)){this.transform=t,this.grid=s,this.ignoredGrid=c,this.pitchfactor=Math.cos(t._pitch)*t.cameraToCenterDistance,this.screenRightBoundary=t.width+se,this.screenBottomBoundary=t.height+se,this.gridRightBoundary=t.width+200,this.gridBottomBoundary=t.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(t,s,c,p,y,x){const E=this.projectAndGetPerspectiveRatio(p,t.anchorPointX,t.anchorPointY,x),S=c*E.perspectiveRatio,C=t.x1*S+E.point.x,M=t.y1*S+E.point.y,P=t.x2*S+E.point.x,F=t.y2*S+E.point.y;return!this.isInsideGrid(C,M,P,F)||s!=="always"&&this.grid.hitTest(C,M,P,F,s,y)||E.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[C,M,P,F],offscreen:this.isOffscreen(C,M,P,F)}}placeCollisionCircles(t,s,c,p,y,x,E,S,C,M,P,F,Z,V){const q=[],H=new u.Point(s.anchorX,s.anchorY),Q=at(H,x,V),de=Br(this.transform.cameraToCenterDistance,Q.signedDistanceFromCamera),W=(M?y/de:y*de)/u.ONE_EM,he=at(H,E,V).point,ge=to(W,p,s.lineOffsetX*W,s.lineOffsetY*W,!1,he,H,s,c,E,{projections:{},offsets:{}},!1,V);let we=!1,Se=!1,Ie=!0;if(ge){const be=.5*F*de+Z,je=new u.Point(-100,-100),rt=new u.Point(this.screenRightBoundary,this.screenBottomBoundary),ft=new Re,De=ge.first,ut=ge.last;let Ge=[];for(let Dt=De.path.length-1;Dt>=1;Dt--)Ge.push(De.path[Dt]);for(let Dt=1;Dt<ut.path.length;Dt++)Ge.push(ut.path[Dt]);const zt=2.5*be;if(S){const Dt=Ge.map(yt=>at(yt,S,V));Ge=Dt.some(yt=>yt.signedDistanceFromCamera<=0)?[]:Dt.map(yt=>yt.point)}let _n=[];if(Ge.length>0){const Dt=Ge[0].clone(),yt=Ge[0].clone();for(let pn=1;pn<Ge.length;pn++)Dt.x=Math.min(Dt.x,Ge[pn].x),Dt.y=Math.min(Dt.y,Ge[pn].y),yt.x=Math.max(yt.x,Ge[pn].x),yt.y=Math.max(yt.y,Ge[pn].y);_n=Dt.x>=je.x&&yt.x<=rt.x&&Dt.y>=je.y&&yt.y<=rt.y?[Ge]:yt.x<je.x||Dt.x>rt.x||yt.y<je.y||Dt.y>rt.y?[]:u.clipLine([Ge],je.x,je.y,rt.x,rt.y)}for(const Dt of _n){ft.reset(Dt,.25*be);let yt=0;yt=ft.length<=.5*be?1:Math.ceil(ft.paddedLength/zt)+1;for(let pn=0;pn<yt;pn++){const ai=pn/Math.max(yt-1,1),vn=ft.lerp(ai),Un=vn.x+se,Bi=vn.y+se;q.push(Un,Bi,be,0);const sr=Un-be,ar=Bi-be,li=Un+be,Tr=Bi+be;if(Ie=Ie&&this.isOffscreen(sr,ar,li,Tr),Se=Se||this.isInsideGrid(sr,ar,li,Tr),t!=="always"&&this.grid.hitTestCircle(Un,Bi,be,t,P)&&(we=!0,!C))return{circles:[],offscreen:!1,collisionDetected:we}}}}return{circles:!C&&we||!Se||de<this.perspectiveRatioCutoff?[]:q,offscreen:Ie,collisionDetected:we}}queryRenderedSymbols(t){if(t.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let c=1/0,p=1/0,y=-1/0,x=-1/0;for(const M of t){const P=new u.Point(M.x+se,M.y+se);c=Math.min(c,P.x),p=Math.min(p,P.y),y=Math.max(y,P.x),x=Math.max(x,P.y),s.push(P)}const E=this.grid.query(c,p,y,x).concat(this.ignoredGrid.query(c,p,y,x)),S={},C={};for(const M of E){const P=M.key;if(S[P.bucketInstanceId]===void 0&&(S[P.bucketInstanceId]={}),S[P.bucketInstanceId][P.featureIndex])continue;const F=[new u.Point(M.x1,M.y1),new u.Point(M.x2,M.y1),new u.Point(M.x2,M.y2),new u.Point(M.x1,M.y2)];u.polygonIntersectsPolygon(s,F)&&(S[P.bucketInstanceId][P.featureIndex]=!0,C[P.bucketInstanceId]===void 0&&(C[P.bucketInstanceId]=[]),C[P.bucketInstanceId].push(P.featureIndex))}return C}insertCollisionBox(t,s,c,p,y,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:x,overlapMode:s},t[0],t[1],t[2],t[3])}insertCollisionCircles(t,s,c,p,y,x){const E=c?this.ignoredGrid:this.grid,S={bucketInstanceId:p,featureIndex:y,collisionGroupID:x,overlapMode:s};for(let C=0;C<t.length;C+=4)E.insertCircle(S,t[C],t[C+1],t[C+2])}projectAndGetPerspectiveRatio(t,s,c,p){let y;return p?(y=[s,c,p(s,c),1],u.transformMat4(y,y,t)):(y=[s,c,0,1],K(y,y,t)),{point:new u.Point((y[0]/y[3]+1)/2*this.transform.width+se,(-y[1]/y[3]+1)/2*this.transform.height+se),perspectiveRatio:.5+this.transform.cameraToCenterDistance/y[3]*.5}}isOffscreen(t,s,c,p){return c<se||t>=this.screenRightBoundary||p<se||s>this.screenBottomBoundary}isInsideGrid(t,s,c,p){return c>=0&&t<this.gridRightBoundary&&p>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const t=u.identity([]);return u.translate(t,t,[-100,-100,0]),t}}function ye(h,t,s){return t*(u.EXTENT/(h.tileSize*Math.pow(2,s-h.tileID.overscaledZ)))}class xe{constructor(t,s,c,p){this.opacity=t?Math.max(0,Math.min(1,t.opacity+(t.placed?s:-s))):p&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class nt{constructor(t,s,c,p,y){this.text=new xe(t?t.text:null,s,c,y),this.icon=new xe(t?t.icon:null,s,p,y)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class pt{constructor(t,s,c){this.text=t,this.icon=s,this.skipFade=c}}class Je{constructor(){this.invProjMatrix=u.create(),this.viewportMatrix=u.create(),this.circles=[]}}class it{constructor(t,s,c,p,y){this.bucketInstanceId=t,this.featureIndex=s,this.sourceLayerIndex=c,this.bucketIndex=p,this.tileID=y}}class gt{constructor(t){this.crossSourceCollisions=t,this.maxGroupID=0,this.collisionGroups={}}get(t){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[t]){const s=++this.maxGroupID;this.collisionGroups[t]={ID:s,predicate:c=>c.collisionGroupID===s}}return this.collisionGroups[t]}}function Ct(h,t,s,c,p){const{horizontalAlign:y,verticalAlign:x}=u.getAnchorAlignment(h),E=-(y-.5)*t,S=-(x-.5)*s,C=u.evaluateVariableOffset(h,c);return new u.Point(E+C[0]*p,S+C[1]*p)}function xt(h,t,s,c,p,y){const{x1:x,x2:E,y1:S,y2:C,anchorPointX:M,anchorPointY:P}=h,F=new u.Point(t,s);return c&&F._rotate(p?y:-y),{x1:x+F.x,y1:S+F.y,x2:E+F.x,y2:C+F.y,anchorPointX:M,anchorPointY:P}}class Ft{constructor(t,s,c,p,y){this.transform=t.clone(),this.terrain=s,this.collisionIndex=new ve(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new gt(p),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,s,c,p){const y=c.getBucket(s),x=c.latestFeatureIndex;if(!y||!x||s.id!==y.layerIds[0])return;const E=c.collisionBoxArray,S=y.layers[0].layout,C=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),M=c.tileSize/u.EXTENT,P=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),F=S.get("text-pitch-alignment")==="map",Z=S.get("text-rotation-alignment")==="map",V=ye(c,1,this.transform.zoom),q=Fn(P,F,Z,this.transform,V);let H=null;if(F){const de=rr(P,F,Z,this.transform,V);H=u.multiply([],this.transform.labelPlaneMatrix,de)}this.retainedQueryData[y.bucketInstanceId]=new it(y.bucketInstanceId,x,y.sourceLayerIndex,y.index,c.tileID);const Q={bucket:y,layout:S,posMatrix:P,textLabelPlaneMatrix:q,labelToScreenMatrix:H,scale:C,textPixelRatio:M,holdingForFade:c.holdingForFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:u.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(p)for(const de of y.sortKeyRanges){const{sortKey:W,symbolInstanceStart:he,symbolInstanceEnd:ge}=de;t.push({sortKey:W,symbolInstanceStart:he,symbolInstanceEnd:ge,parameters:Q})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:Q})}attemptAnchorPlacement(t,s,c,p,y,x,E,S,C,M,P,F,Z,V,q,H){const Q=[F.textOffset0,F.textOffset1],de=Ct(t,c,p,Q,y),W=this.collisionIndex.placeCollisionBox(xt(s,de.x,de.y,x,E,this.transform.angle),P,S,C,M.predicate,H);if((!q||this.collisionIndex.placeCollisionBox(xt(q,de.x,de.y,x,E,this.transform.angle),P,S,C,M.predicate,H).box.length!==0)&&W.box.length>0){let he;if(this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(he=this.prevPlacement.variableOffsets[F.crossTileID].anchor),F.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[F.crossTileID]={textOffset:Q,width:c,height:p,anchor:t,textBoxScale:y,prevAnchor:he},this.markUsedJustification(Z,t,F,V),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,V,F),this.placedOrientations[F.crossTileID]=V),{shift:de,placedGlyphBoxes:W}}}placeLayerBucketPart(t,s,c){const{bucket:p,layout:y,posMatrix:x,textLabelPlaneMatrix:E,labelToScreenMatrix:S,textPixelRatio:C,holdingForFade:M,collisionBoxArray:P,partiallyEvaluatedTextSize:F,collisionGroup:Z}=t.parameters,V=y.get("text-optional"),q=y.get("icon-optional"),H=u.getOverlapMode(y,"text-overlap","text-allow-overlap"),Q=H==="always",de=u.getOverlapMode(y,"icon-overlap","icon-allow-overlap"),W=de==="always",he=y.get("text-rotation-alignment")==="map",ge=y.get("text-pitch-alignment")==="map",we=y.get("icon-text-fit")!=="none",Se=y.get("symbol-z-order")==="viewport-y",Ie=Q&&(W||!p.hasIconData()||q),be=W&&(Q||!p.hasTextData()||V);!p.collisionArrays&&P&&p.deserializeCollisionBoxes(P);const je=this.retainedQueryData[p.bucketInstanceId].tileID,rt=this.terrain?(De,ut)=>this.terrain.getElevation(je,De,ut):null,ft=(De,ut)=>{if(s[De.crossTileID])return;if(M)return void(this.placements[De.crossTileID]=new pt(!1,!1,!1));let Ge=!1,zt=!1,_n=!0,Dt=null,yt={box:null,offscreen:null},pn={box:null,offscreen:null},ai=null,vn=null,Un=null,Bi=0,sr=0,ar=0;ut.textFeatureIndex?Bi=ut.textFeatureIndex:De.useRuntimeCollisionCircles&&(Bi=De.featureIndex),ut.verticalTextFeatureIndex&&(sr=ut.verticalTextFeatureIndex);const li=ut.textBox;if(li){const Jn=Rt=>{let An=u.WritingMode.horizontal;if(p.allowVerticalPlacement&&!Rt&&this.prevPlacement){const Vn=this.prevPlacement.placedOrientations[De.crossTileID];Vn&&(this.placedOrientations[De.crossTileID]=Vn,An=Vn,this.markUsedOrientation(p,An,De))}return An},Nn=(Rt,An)=>{if(p.allowVerticalPlacement&&De.numVerticalGlyphVertices>0&&ut.verticalTextBox){for(const Vn of p.writingModes)if(Vn===u.WritingMode.vertical?(yt=An(),pn=yt):yt=Rt(),yt&&yt.box&&yt.box.length)break}else yt=Rt()};if(y.get("text-variable-anchor")){let Rt=y.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[De.crossTileID]){const Ot=this.prevPlacement.variableOffsets[De.crossTileID];Rt.indexOf(Ot.anchor)>0&&(Rt=Rt.filter(zn=>zn!==Ot.anchor),Rt.unshift(Ot.anchor))}const An=(Ot,zn,Fi)=>{const Ka=Ot.x2-Ot.x1,Ur=Ot.y2-Ot.y1,xp=De.textBoxScale,fh=we&&de==="never"?zn:null;let nn={box:[],offscreen:!1};const wu=H!=="never"?2*Rt.length:Rt.length;for(let Xs=0;Xs<wu;++Xs){const Nr=this.attemptAnchorPlacement(Rt[Xs%Rt.length],Ot,Ka,Ur,xp,he,ge,C,x,Z,Xs>=Rt.length?H:"never",De,p,Fi,fh,rt);if(Nr&&(nn=Nr.placedGlyphBoxes,nn&&nn.box&&nn.box.length)){Ge=!0,Dt=Nr.shift;break}}return nn};Nn(()=>An(li,ut.iconBox,u.WritingMode.horizontal),()=>{const Ot=ut.verticalTextBox;return p.allowVerticalPlacement&&!(yt&&yt.box&&yt.box.length)&&De.numVerticalGlyphVertices>0&&Ot?An(Ot,ut.verticalIconBox,u.WritingMode.vertical):{box:null,offscreen:null}}),yt&&(Ge=yt.box,_n=yt.offscreen);const Vn=Jn(yt&&yt.box);if(!Ge&&this.prevPlacement){const Ot=this.prevPlacement.variableOffsets[De.crossTileID];Ot&&(this.variableOffsets[De.crossTileID]=Ot,this.markUsedJustification(p,Ot.anchor,De,Vn))}}else{const Rt=(An,Vn)=>{const Ot=this.collisionIndex.placeCollisionBox(An,H,C,x,Z.predicate,rt);return Ot&&Ot.box&&Ot.box.length&&(this.markUsedOrientation(p,Vn,De),this.placedOrientations[De.crossTileID]=Vn),Ot};Nn(()=>Rt(li,u.WritingMode.horizontal),()=>{const An=ut.verticalTextBox;return p.allowVerticalPlacement&&De.numVerticalGlyphVertices>0&&An?Rt(An,u.WritingMode.vertical):{box:null,offscreen:null}}),Jn(yt&&yt.box&&yt.box.length)}}if(ai=yt,Ge=ai&&ai.box&&ai.box.length>0,_n=ai&&ai.offscreen,De.useRuntimeCollisionCircles){const Jn=p.text.placedSymbolArray.get(De.centerJustifiedTextSymbolIndex),Nn=u.evaluateSizeForFeature(p.textSizeData,F,Jn),Rt=y.get("text-padding");vn=this.collisionIndex.placeCollisionCircles(H,Jn,p.lineVertexArray,p.glyphOffsetArray,Nn,x,E,S,c,ge,Z.predicate,De.collisionCircleDiameter,Rt,rt),vn.circles.length&&vn.collisionDetected&&!c&&u.warnOnce("Collisions detected, but collision boxes are not shown"),Ge=Q||vn.circles.length>0&&!vn.collisionDetected,_n=_n&&vn.offscreen}if(ut.iconFeatureIndex&&(ar=ut.iconFeatureIndex),ut.iconBox){const Jn=Nn=>{const Rt=we&&Dt?xt(Nn,Dt.x,Dt.y,he,ge,this.transform.angle):Nn;return this.collisionIndex.placeCollisionBox(Rt,de,C,x,Z.predicate,rt)};pn&&pn.box&&pn.box.length&&ut.verticalIconBox?(Un=Jn(ut.verticalIconBox),zt=Un.box.length>0):(Un=Jn(ut.iconBox),zt=Un.box.length>0),_n=_n&&Un.offscreen}const Tr=V||De.numHorizontalGlyphVertices===0&&De.numVerticalGlyphVertices===0,Ws=q||De.numIconVertices===0;if(Tr||Ws?Ws?Tr||(zt=zt&&Ge):Ge=zt&&Ge:zt=Ge=zt&&Ge,Ge&&ai&&ai.box&&this.collisionIndex.insertCollisionBox(ai.box,H,y.get("text-ignore-placement"),p.bucketInstanceId,pn&&pn.box&&sr?sr:Bi,Z.ID),zt&&Un&&this.collisionIndex.insertCollisionBox(Un.box,de,y.get("icon-ignore-placement"),p.bucketInstanceId,ar,Z.ID),vn&&(Ge&&this.collisionIndex.insertCollisionCircles(vn.circles,H,y.get("text-ignore-placement"),p.bucketInstanceId,Bi,Z.ID),c)){const Jn=p.bucketInstanceId;let Nn=this.collisionCircleArrays[Jn];Nn===void 0&&(Nn=this.collisionCircleArrays[Jn]=new Je);for(let Rt=0;Rt<vn.circles.length;Rt+=4)Nn.circles.push(vn.circles[Rt+0]),Nn.circles.push(vn.circles[Rt+1]),Nn.circles.push(vn.circles[Rt+2]),Nn.circles.push(vn.collisionDetected?1:0)}if(De.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(p.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[De.crossTileID]=new pt(Ge||Ie,zt||be,_n||p.justReloaded),s[De.crossTileID]=!0};if(Se){if(t.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const De=p.getSortedSymbolIndexes(this.transform.angle);for(let ut=De.length-1;ut>=0;--ut){const Ge=De[ut];ft(p.symbolInstances.get(Ge),p.collisionArrays[Ge])}}else for(let De=t.symbolInstanceStart;De<t.symbolInstanceEnd;De++)ft(p.symbolInstances.get(De),p.collisionArrays[De]);if(c&&p.bucketInstanceId in this.collisionCircleArrays){const De=this.collisionCircleArrays[p.bucketInstanceId];u.invert(De.invProjMatrix,x),De.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(t,s,c,p){let y;y=p===u.WritingMode.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[u.getAnchorJustification(s)];const x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const E of x)E>=0&&(t.text.placedSymbolArray.get(E).crossTileID=y>=0&&E!==y?0:c.crossTileID)}markUsedOrientation(t,s,c){const p=s===u.WritingMode.horizontal||s===u.WritingMode.horizontalOnly?s:0,y=s===u.WritingMode.vertical?s:0,x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const E of x)t.text.placedSymbolArray.get(E).placedOrientation=p;c.verticalPlacedTextSymbolIndex&&(t.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=y)}commit(t){this.commitTime=t,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let c=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const p=s?s.symbolFadeChange(t):1,y=s?s.opacities:{},x=s?s.variableOffsets:{},E=s?s.placedOrientations:{};for(const S in this.placements){const C=this.placements[S],M=y[S];M?(this.opacities[S]=new nt(M,p,C.text,C.icon),c=c||C.text!==M.text.placed||C.icon!==M.icon.placed):(this.opacities[S]=new nt(null,p,C.text,C.icon,C.skipFade),c=c||C.text||C.icon)}for(const S in y){const C=y[S];if(!this.opacities[S]){const M=new nt(C,p,!1,!1);M.isHidden()||(this.opacities[S]=M,c=c||C.text.placed||C.icon.placed)}}for(const S in x)this.variableOffsets[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.variableOffsets[S]=x[S]);for(const S in E)this.placedOrientations[S]||!this.opacities[S]||this.opacities[S].isHidden()||(this.placedOrientations[S]=E[S]);if(s&&s.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=t:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:t)}updateLayerOpacities(t,s){const c={};for(const p of s){const y=p.getBucket(t);y&&p.latestFeatureIndex&&t.id===y.layerIds[0]&&this.updateBucketOpacities(y,c,p.collisionBoxArray)}}updateBucketOpacities(t,s,c){t.hasTextData()&&(t.text.opacityVertexArray.clear(),t.text.hasVisibleVertices=!1),t.hasIconData()&&(t.icon.opacityVertexArray.clear(),t.icon.hasVisibleVertices=!1),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const p=t.layers[0].layout,y=new nt(null,0,!1,!1,!0),x=p.get("text-allow-overlap"),E=p.get("icon-allow-overlap"),S=p.get("text-variable-anchor"),C=p.get("text-rotation-alignment")==="map",M=p.get("text-pitch-alignment")==="map",P=p.get("icon-text-fit")!=="none",F=new nt(null,0,x&&(E||!t.hasIconData()||p.get("icon-optional")),E&&(x||!t.hasTextData()||p.get("text-optional")),!0);!t.collisionArrays&&c&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(c);const Z=(V,q,H)=>{for(let Q=0;Q<q/4;Q++)V.opacityVertexArray.emplaceBack(H);V.hasVisibleVertices=V.hasVisibleVertices||H!==Yn};for(let V=0;V<t.symbolInstances.length;V++){const q=t.symbolInstances.get(V),{numHorizontalGlyphVertices:H,numVerticalGlyphVertices:Q,crossTileID:de}=q;let W=this.opacities[de];s[de]?W=y:W||(W=F,this.opacities[de]=W),s[de]=!0;const he=q.numIconVertices>0,ge=this.placedOrientations[q.crossTileID],we=ge===u.WritingMode.vertical,Se=ge===u.WritingMode.horizontal||ge===u.WritingMode.horizontalOnly;if(H>0||Q>0){const Ie=xi(W.text);Z(t.text,H,we?Yn:Ie),Z(t.text,Q,Se?Yn:Ie);const be=W.text.isHidden();[q.rightJustifiedTextSymbolIndex,q.centerJustifiedTextSymbolIndex,q.leftJustifiedTextSymbolIndex].forEach(ft=>{ft>=0&&(t.text.placedSymbolArray.get(ft).hidden=be||we?1:0)}),q.verticalPlacedTextSymbolIndex>=0&&(t.text.placedSymbolArray.get(q.verticalPlacedTextSymbolIndex).hidden=be||Se?1:0);const je=this.variableOffsets[q.crossTileID];je&&this.markUsedJustification(t,je.anchor,q,ge);const rt=this.placedOrientations[q.crossTileID];rt&&(this.markUsedJustification(t,"left",q,rt),this.markUsedOrientation(t,rt,q))}if(he){const Ie=xi(W.icon),be=!(P&&q.verticalPlacedIconSymbolIndex&&we);q.placedIconSymbolIndex>=0&&(Z(t.icon,q.numIconVertices,be?Ie:Yn),t.icon.placedSymbolArray.get(q.placedIconSymbolIndex).hidden=W.icon.isHidden()),q.verticalPlacedIconSymbolIndex>=0&&(Z(t.icon,q.numVerticalIconVertices,be?Yn:Ie),t.icon.placedSymbolArray.get(q.verticalPlacedIconSymbolIndex).hidden=W.icon.isHidden())}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const Ie=t.collisionArrays[V];if(Ie){let be=new u.Point(0,0);if(Ie.textBox||Ie.verticalTextBox){let rt=!0;if(S){const ft=this.variableOffsets[de];ft?(be=Ct(ft.anchor,ft.width,ft.height,ft.textOffset,ft.textBoxScale),C&&be._rotate(M?this.transform.angle:-this.transform.angle)):rt=!1}Ie.textBox&&Nt(t.textCollisionBox.collisionVertexArray,W.text.placed,!rt||we,be.x,be.y),Ie.verticalTextBox&&Nt(t.textCollisionBox.collisionVertexArray,W.text.placed,!rt||Se,be.x,be.y)}const je=!!(!Se&&Ie.verticalIconBox);Ie.iconBox&&Nt(t.iconCollisionBox.collisionVertexArray,W.icon.placed,je,P?be.x:0,P?be.y:0),Ie.verticalIconBox&&Nt(t.iconCollisionBox.collisionVertexArray,W.icon.placed,!je,P?be.x:0,P?be.y:0)}}}if(t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.text.opacityVertexArray.length!==t.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${t.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${t.text.layoutVertexArray.length}) / 4`);if(t.icon.opacityVertexArray.length!==t.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${t.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${t.icon.layoutVertexArray.length}) / 4`);if(t.bucketInstanceId in this.collisionCircleArrays){const V=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=V.invProjMatrix,t.placementViewportMatrix=V.viewportMatrix,t.collisionCircleArray=V.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(t){return this.fadeDuration===0?1:(t-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(t){return Math.max(0,(this.transform.zoom-t)/1.5)}hasTransitions(t){return this.stale||t-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(t,s){const c=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*c>t}setStale(){this.stale=!0}}function Nt(h,t,s,c,p){h.emplaceBack(t?1:0,s?1:0,c||0,p||0),h.emplaceBack(t?1:0,s?1:0,c||0,p||0),h.emplaceBack(t?1:0,s?1:0,c||0,p||0),h.emplaceBack(t?1:0,s?1:0,c||0,p||0)}const en=Math.pow(2,25),on=Math.pow(2,24),gn=Math.pow(2,17),Mt=Math.pow(2,16),Fl=Math.pow(2,9),Ol=Math.pow(2,8),Li=Math.pow(2,1);function xi(h){if(h.opacity===0&&!h.placed)return 0;if(h.opacity===1&&h.placed)return 4294967295;const t=h.placed?1:0,s=Math.floor(127*h.opacity);return s*en+t*on+s*gn+t*Mt+s*Fl+t*Ol+s*Li+t}const Yn=0;class Dc{constructor(t){this._sortAcrossTiles=t.layout.get("symbol-z-order")!=="viewport-y"&&!t.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(t,s,c,p,y){const x=this._bucketParts;for(;this._currentTileIndex<t.length;)if(s.getBucketParts(x,p,t[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((E,S)=>E.sortKey-S.sortKey));this._currentPartIndex<x.length;)if(s.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,y())return!0;return!1}}class pa{constructor(t,s,c,p,y,x,E,S){this.placement=new Ft(t,s,x,E,S),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(t,s,c){const p=u.exported.now(),y=()=>!this._forceFullPlacement&&u.exported.now()-p>2;for(;this._currentPlacementIndex>=0;){const x=s[t[this._currentPlacementIndex]],E=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=E)&&(!x.maxzoom||x.maxzoom>E)){if(this._inProgressLayer||(this._inProgressLayer=new Dc(x)),this._inProgressLayer.continuePlacement(c[x.source],this.placement,this._showCollisionBoxes,x,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(t){return this.placement.commit(t),this.placement}}const sn=512/u.EXTENT/2;class Cs{constructor(t,s,c){this.tileID=t,this.bucketInstanceId=c,this._symbolsByKey={};const p=new Map;for(let y=0;y<s.length;y++){const x=s.get(y),E=x.key,S=p.get(E);S?S.push(x):p.set(E,[x])}for(const[y,x]of p){const E={positions:x.map(S=>({x:Math.floor(S.anchorX*sn),y:Math.floor(S.anchorY*sn)})),crossTileIDs:x.map(S=>S.crossTileID)};if(E.positions.length>128){const S=new u.KDBush(E.positions.length,16,Uint16Array);for(const{x:C,y:M}of E.positions)S.add(C,M);S.finish(),delete E.positions,E.index=S}this._symbolsByKey[y]=E}}getScaledCoordinates(t,s){const{x:c,y:p,z:y}=this.tileID.canonical,{x,y:E,z:S}=s.canonical,C=sn/Math.pow(2,S-y),M=(E*u.EXTENT+t.anchorY)*C,P=p*u.EXTENT*sn;return{x:Math.floor((x*u.EXTENT+t.anchorX)*C-c*u.EXTENT*sn),y:Math.floor(M-P)}}findMatches(t,s,c){const p=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z);for(let y=0;y<t.length;y++){const x=t.get(y);if(x.crossTileID)continue;const E=this._symbolsByKey[x.key];if(!E)continue;const S=this.getScaledCoordinates(x,s);if(E.index){const C=E.index.range(S.x-p,S.y-p,S.x+p,S.y+p).sort();for(const M of C){const P=E.crossTileIDs[M];if(!c[P]){c[P]=!0,x.crossTileID=P;break}}}else if(E.positions)for(let C=0;C<E.positions.length;C++){const M=E.positions[C],P=E.crossTileIDs[C];if(Math.abs(M.x-S.x)<=p&&Math.abs(M.y-S.y)<=p&&!c[P]){c[P]=!0,x.crossTileID=P;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:t})=>t)}}class mo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class On{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(t){const s=Math.round((t-this.lng)/360);if(s!==0)for(const c in this.indexes){const p=this.indexes[c],y={};for(const x in p){const E=p[x];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+s),y[E.tileID.key]=E}this.indexes[c]=y}this.lng=t}addBucket(t,s,c){if(this.indexes[t.overscaledZ]&&this.indexes[t.overscaledZ][t.key]){if(this.indexes[t.overscaledZ][t.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(t.overscaledZ,this.indexes[t.overscaledZ][t.key])}for(let y=0;y<s.symbolInstances.length;y++)s.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[t.overscaledZ]||(this.usedCrossTileIDs[t.overscaledZ]={});const p=this.usedCrossTileIDs[t.overscaledZ];for(const y in this.indexes){const x=this.indexes[y];if(Number(y)>t.overscaledZ)for(const E in x){const S=x[E];S.tileID.isChildOf(t)&&S.findMatches(s.symbolInstances,t,p)}else{const E=x[t.scaledTo(Number(y)).key];E&&E.findMatches(s.symbolInstances,t,p)}}for(let y=0;y<s.symbolInstances.length;y++){const x=s.symbolInstances.get(y);x.crossTileID||(x.crossTileID=c.generate(),p[x.crossTileID]=!0)}return this.indexes[t.overscaledZ]===void 0&&(this.indexes[t.overscaledZ]={}),this.indexes[t.overscaledZ][t.key]=new Cs(t,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(t,s){for(const c of s.getCrossTileIDsLists())for(const p of c)delete this.usedCrossTileIDs[t][p]}removeStaleBuckets(t){let s=!1;for(const c in this.indexes){const p=this.indexes[c];for(const y in p)t[p[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,p[y]),delete p[y],s=!0)}return s}}class Is{constructor(){this.layerIndexes={},this.crossTileIDs=new mo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(t,s,c){let p=this.layerIndexes[t.id];p===void 0&&(p=this.layerIndexes[t.id]=new On);let y=!1;const x={};p.handleWrapJump(c);for(const E of s){const S=E.getBucket(t);S&&t.id===S.layerIds[0]&&(S.bucketInstanceId||(S.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(E.tileID,S,this.crossTileIDs)&&(y=!0),x[S.bucketInstanceId]=!0)}return p.removeStaleBuckets(x)&&(y=!0),y}pruneUnusedLayers(t){const s={};t.forEach(c=>{s[c]=!0});for(const c in this.layerIndexes)s[c]||delete this.layerIndexes[c]}}const wi=(h,t)=>u.emitValidationErrors(h,t&&t.filter(s=>s.identifier!=="source.canvas")),Lc=u.pick(u.operations,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),no=u.pick(u.operations,["setCenter","setZoom","setBearing","setPitch"]),np=u.emptyStyle();class or extends u.Evented{constructor(t,s={}){super(),this.map=t,this.dispatcher=new Tn(Rr(),this,t._getMapId()),this.imageManager=new qt,this.imageManager.setEventedParent(this),this.glyphManager=new En(t._requestManager,s.localIdeographFontFamily),this.lineAtlas=new zi(256,512),this.crossTileSymbolIndex=new Is,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.getReferrer());const c=this;this._rtlTextPluginCallback=or.registerForPluginStateChange(p=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:p.pluginStatus,pluginURL:p.pluginURL},(y,x)=>{if(u.triggerPluginCompletionEvent(y),x&&x.every(E=>E))for(const E in c.sourceCaches){const S=c.sourceCaches[E].getSource().type;S!=="vector"&&S!=="geojson"||c.sourceCaches[E].reload()}})}),this.on("data",p=>{if(p.dataType!=="source"||p.sourceDataType!=="metadata")return;const y=this.sourceCaches[p.sourceId];if(!y)return;const x=y.getSource();if(x&&x.vectorLayerIds)for(const E in this._layers){const S=this._layers[E];S.source===x.id&&this._validateLayer(S)}})}loadURL(t,s={},c){this.fire(new u.Event("dataloading",{dataType:"style"})),s.validate=typeof s.validate!="boolean"||s.validate;const p=this.map._requestManager.transformRequest(t,re.Style);this._request=u.getJSON(p,(y,x)=>{this._request=null,y?this.fire(new u.ErrorEvent(y)):x&&this._load(x,s,c)})}loadJSON(t,s={},c){this.fire(new u.Event("dataloading",{dataType:"style"})),this._request=u.exported.frame(()=>{this._request=null,s.validate=s.validate!==!1,this._load(t,s,c)})}loadEmpty(){this.fire(new u.Event("dataloading",{dataType:"style"})),this._load(np,{validate:!1})}_load(t,s,c){const p=s.transformStyle?s.transformStyle(c,t):t;if(!s.validate||!wi(this,u.validateStyle(p))){this._loaded=!0,this.stylesheet=p;for(const y in p.sources)this.addSource(y,p.sources[y],{validate:!1});p.sprite?this._loadSprite(p.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(p.glyphs),this._createLayers(),this.light=new Bt(this.stylesheet.light),this.map.setTerrain(this.stylesheet.terrain),this.fire(new u.Event("data",{dataType:"style"})),this.fire(new u.Event("style.load"))}}_createLayers(){const t=u.derefLayers(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",t),this._order=t.map(s=>s.id),this._layers={},this._serializedLayers=null;for(const s of t){const c=u.createStyleLayer(s);c.setEventedParent(this,{layer:{id:s.id}}),this._layers[s.id]=c}}_loadSprite(t,s=!1,c){this.imageManager.setLoaded(!1),this._spriteRequest=function(p,y,x,E){const S=bt(p),C=S.length,M=x>1?"@2x":"",P={},F={},Z={};for(const{id:V,url:q}of S){const H=y.transformRequest(y.normalizeSpriteURL(q,M,".json"),re.SpriteJSON),Q=`${V}_${H.url}`;P[Q]=u.getJSON(H,(he,ge)=>{delete P[Q],F[V]=ge,st(E,F,Z,he,C)});const de=y.transformRequest(y.normalizeSpriteURL(q,M,".png"),re.SpriteImage),W=`${V}_${de.url}`;P[W]=te.getImage(de,(he,ge)=>{delete P[W],Z[V]=ge,st(E,F,Z,he,C)})}return{cancel(){for(const V of Object.values(P))V.cancel()}}}(t,this.map._requestManager,this.map.getPixelRatio(),(p,y)=>{if(this._spriteRequest=null,p)this.fire(new u.ErrorEvent(p));else if(y)for(const x in y){this._spritesImagesIds[x]=[];const E=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(S=>!(S in y)):[];for(const S of E)this.imageManager.removeImage(S),this._changedImages[S]=!0;for(const S in y[x]){const C=x==="default"?S:`${x}:${S}`;this._spritesImagesIds[x].push(C),C in this.imageManager.images?this.imageManager.updateImage(C,y[x][S],!1):this.imageManager.addImage(C,y[x][S]),s&&(this._changedImages[C]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),s&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"})),c&&c(p)})}_unloadSprite(){for(const t of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(t),this._changedImages[t]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}_validateLayer(t){const s=this.sourceCaches[t.source];if(!s)return;const c=t.sourceLayer;if(!c)return;const p=s.getSource();(p.type==="geojson"||p.vectorLayerIds&&p.vectorLayerIds.indexOf(c)===-1)&&this.fire(new u.ErrorEvent(new Error(`Source layer "${c}" does not exist on source "${p.id}" as specified by style layer "${t.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const t in this.sourceCaches)if(!this.sourceCaches[t].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(t){const s=this._serializedAllLayers();if(!t||t.length===0)return Object.values(s);const c=[];for(const p of t)s[p]&&c.push(s[p]);return c}_serializedAllLayers(){let t=this._serializedLayers;if(t)return t;t=this._serializedLayers={};const s=Object.keys(this._layers);for(const c of s){const p=this._layers[c];p.type!=="custom"&&(t[c]=p.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const t in this.sourceCaches)if(this.sourceCaches[t].hasTransition())return!0;for(const t in this._layers)if(this._layers[t].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(t){if(!this._loaded)return;const s=this._changed;if(this._changed){const p=Object.keys(this._updatedLayers),y=Object.keys(this._removedLayers);(p.length||y.length)&&this._updateWorkerLayers(p,y);for(const x in this._updatedSources){const E=this._updatedSources[x];if(E==="reload")this._reloadSource(x);else{if(E!=="clear")throw new Error(`Invalid action ${E}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(t);this.light.updateTransitions(t),this._resetUpdates()}const c={};for(const p in this.sourceCaches){const y=this.sourceCaches[p];c[p]=y.used,y.used=!1}for(const p of this._order){const y=this._layers[p];y.recalculate(t,this._availableImages),!y.isHidden(t.zoom)&&y.source&&(this.sourceCaches[y.source].used=!0)}for(const p in c){const y=this.sourceCaches[p];c[p]!==y.used&&y.fire(new u.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:p}))}this.light.recalculate(t),this.z=t.zoom,s&&this.fire(new u.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const t=Object.keys(this._changedImages);if(t.length){for(const s in this.sourceCaches)this.sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],t);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const t in this.sourceCaches)this.sourceCaches[t].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(t,s){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(t),removedIds:s})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(t,s={}){this._checkLoaded();const c=this.serialize();if(t=s.transformStyle?s.transformStyle(c,t):t,wi(this,u.validateStyle(t)))return!1;(t=u.clone$1(t)).layers=u.derefLayers(t.layers);const p=u.diffStyles(c,t).filter(x=>!(x.command in no));if(p.length===0)return!1;const y=p.filter(x=>!(x.command in Lc));if(y.length>0)throw new Error(`Unimplemented: ${y.map(x=>x.command).join(", ")}.`);for(const x of p)x.command!=="setTransition"&&this[x.command].apply(this,x.args);return this.stylesheet=t,!0}addImage(t,s){if(this.getImage(t))return this.fire(new u.ErrorEvent(new Error(`An image named "${t}" already exists.`)));this.imageManager.addImage(t,s),this._afterImageUpdated(t)}updateImage(t,s){this.imageManager.updateImage(t,s)}getImage(t){return this.imageManager.getImage(t)}removeImage(t){if(!this.getImage(t))return this.fire(new u.ErrorEvent(new Error(`An image named "${t}" does not exist.`)));this.imageManager.removeImage(t),this._afterImageUpdated(t)}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(t,s,c={}){if(this._checkLoaded(),this.sourceCaches[t]!==void 0)throw new Error(`Source "${t}" already exists.`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(u.validateStyle.source,`sources.${t}`,s,null,c))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const p=this.sourceCaches[t]=new Gt(t,s,this.dispatcher);p.style=this,p.setEventedParent(this,()=>({isSourceLoaded:p.loaded(),source:p.serialize(),sourceId:t})),p.onAdd(this.map),this._changed=!0}removeSource(t){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===t)return this.fire(new u.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${c}" is using it.`)));const s=this.sourceCaches[t];delete this.sourceCaches[t],delete this._updatedSources[t],s.fire(new u.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:t})),s.setEventedParent(null),s.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(t,s){if(this._checkLoaded(),this.sourceCaches[t]===void 0)throw new Error(`There is no source with this ID=${t}`);const c=this.sourceCaches[t].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(s),this._changed=!0}getSource(t){return this.sourceCaches[t]&&this.sourceCaches[t].getSource()}addLayer(t,s,c={}){this._checkLoaded();const p=t.id;if(this.getLayer(p))return void this.fire(new u.ErrorEvent(new Error(`Layer "${p}" already exists on this map.`)));let y;if(t.type==="custom"){if(wi(this,u.validateCustomStyleLayer(t)))return;y=u.createStyleLayer(t)}else{if(typeof t.source=="object"&&(this.addSource(p,t.source),t=u.clone$1(t),t=u.extend(t,{source:p})),this._validate(u.validateStyle.layer,`layers.${p}`,t,{arrayIndex:-1},c))return;y=u.createStyleLayer(t),this._validateLayer(y),y.setEventedParent(this,{layer:{id:p}})}const x=s?this._order.indexOf(s):this._order.length;if(s&&x===-1)this.fire(new u.ErrorEvent(new Error(`Cannot add layer "${p}" before non-existing layer "${s}".`)));else{if(this._order.splice(x,0,p),this._layerOrderChanged=!0,this._layers[p]=y,this._removedLayers[p]&&y.source&&y.type!=="custom"){const E=this._removedLayers[p];delete this._removedLayers[p],E.type!==y.type?this._updatedSources[y.source]="clear":(this._updatedSources[y.source]="reload",this.sourceCaches[y.source].pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map)}}moveLayer(t,s){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new u.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===s)return;const c=this._order.indexOf(t);this._order.splice(c,1);const p=s?this._order.indexOf(s):this._order.length;s&&p===-1?this.fire(new u.ErrorEvent(new Error(`Cannot move layer "${t}" before non-existing layer "${s}".`))):(this._order.splice(p,0,t),this._layerOrderChanged=!0)}removeLayer(t){this._checkLoaded();const s=this._layers[t];if(!s)return void this.fire(new u.ErrorEvent(new Error(`Cannot remove non-existing layer "${t}".`)));s.setEventedParent(null);const c=this._order.indexOf(t);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=s,delete this._layers[t],this._serializedLayers&&delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],s.onRemove&&s.onRemove(this.map)}getLayer(t){return this._layers[t]}hasLayer(t){return t in this._layers}setLayerZoomRange(t,s,c){this._checkLoaded();const p=this.getLayer(t);p?p.minzoom===s&&p.maxzoom===c||(s!=null&&(p.minzoom=s),c!=null&&(p.maxzoom=c),this._updateLayer(p)):this.fire(new u.ErrorEvent(new Error(`Cannot set the zoom range of non-existing layer "${t}".`)))}setFilter(t,s,c={}){this._checkLoaded();const p=this.getLayer(t);if(p){if(!u.deepEqual(p.filter,s))return s==null?(p.filter=void 0,void this._updateLayer(p)):void(this._validate(u.validateStyle.filter,`layers.${p.id}.filter`,s,null,c)||(p.filter=u.clone$1(s),this._updateLayer(p)))}else this.fire(new u.ErrorEvent(new Error(`Cannot filter non-existing layer "${t}".`)))}getFilter(t){return u.clone$1(this.getLayer(t).filter)}setLayoutProperty(t,s,c,p={}){this._checkLoaded();const y=this.getLayer(t);y?u.deepEqual(y.getLayoutProperty(s),c)||(y.setLayoutProperty(s,c,p),this._updateLayer(y)):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getLayoutProperty(t,s){const c=this.getLayer(t);if(c)return c.getLayoutProperty(s);this.fire(new u.ErrorEvent(new Error(`Cannot get style of non-existing layer "${t}".`)))}setPaintProperty(t,s,c,p={}){this._checkLoaded();const y=this.getLayer(t);y?u.deepEqual(y.getPaintProperty(s),c)||(y.setPaintProperty(s,c,p)&&this._updateLayer(y),this._changed=!0,this._updatedPaintProps[t]=!0):this.fire(new u.ErrorEvent(new Error(`Cannot style non-existing layer "${t}".`)))}getPaintProperty(t,s){return this.getLayer(t).getPaintProperty(s)}setFeatureState(t,s){this._checkLoaded();const c=t.source,p=t.sourceLayer,y=this.sourceCaches[c];if(y===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const x=y.getSource().type;x==="geojson"&&p?this.fire(new u.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||p?(t.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),y.setFeatureState(p,t.id,s)):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(t,s){this._checkLoaded();const c=t.source,p=this.sourceCaches[c];if(p===void 0)return void this.fire(new u.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)));const y=p.getSource().type,x=y==="vector"?t.sourceLayer:void 0;y!=="vector"||x?s&&typeof t.id!="string"&&typeof t.id!="number"?this.fire(new u.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):p.removeFeatureState(x,t.id,s):this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(t){this._checkLoaded();const s=t.source,c=t.sourceLayer,p=this.sourceCaches[s];if(p!==void 0)return p.getSource().type!=="vector"||c?(t.id===void 0&&this.fire(new u.ErrorEvent(new Error("The feature id parameter must be provided."))),p.getFeatureState(c,t.id)):void this.fire(new u.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.ErrorEvent(new Error(`The source '${s}' does not exist in the map's style.`)))}getTransition(){return u.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t=u.mapObject(this.sourceCaches,p=>p.serialize()),s=this._serializeByIds(this._order),c=this.stylesheet;return u.filterObject({version:c.version,name:c.name,metadata:c.metadata,light:c.light,center:c.center,zoom:c.zoom,bearing:c.bearing,pitch:c.pitch,sprite:c.sprite,glyphs:c.glyphs,transition:c.transition,sources:t,layers:s},p=>p!==void 0)}_updateLayer(t){this._updatedLayers[t.id]=!0,t.source&&!this._updatedSources[t.source]&&this.sourceCaches[t.source].getSource().type!=="raster"&&(this._updatedSources[t.source]="reload",this.sourceCaches[t.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(t){const s=x=>this._layers[x].type==="fill-extrusion",c={},p=[];for(let x=this._order.length-1;x>=0;x--){const E=this._order[x];if(s(E)){c[E]=x;for(const S of t){const C=S[E];if(C)for(const M of C)p.push(M)}}}p.sort((x,E)=>E.intersectionZ-x.intersectionZ);const y=[];for(let x=this._order.length-1;x>=0;x--){const E=this._order[x];if(s(E))for(let S=p.length-1;S>=0;S--){const C=p[S].feature;if(c[C.layer.id]<x)break;y.push(C),p.pop()}else for(const S of t){const C=S[E];if(C)for(const M of C)y.push(M.feature)}}return y}queryRenderedFeatures(t,s,c){s&&s.filter&&this._validate(u.validateStyle.filter,"queryRenderedFeatures.filter",s.filter,null,s);const p={};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new u.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const E of s.layers){const S=this._layers[E];if(!S)return this.fire(new u.ErrorEvent(new Error(`The layer '${E}' does not exist in the map's style and cannot be queried for features.`))),[];p[S.source]=!0}}const y=[];s.availableImages=this._availableImages;const x=this._serializedAllLayers();for(const E in this.sourceCaches)s.layers&&!p[E]||y.push(dt(this.sourceCaches[E],this._layers,x,t,s,c));return this.placement&&y.push(function(E,S,C,M,P,F,Z){const V={},q=F.queryRenderedSymbols(M),H=[];for(const Q of Object.keys(q).map(Number))H.push(Z[Q]);H.sort(un);for(const Q of H){const de=Q.featureIndex.lookupSymbolFeatures(q[Q.bucketInstanceId],S,Q.bucketIndex,Q.sourceLayerIndex,P.filter,P.layers,P.availableImages,E);for(const W in de){const he=V[W]=V[W]||[],ge=de[W];ge.sort((we,Se)=>{const Ie=Q.featureSortOrder;if(Ie){const be=Ie.indexOf(we.featureIndex);return Ie.indexOf(Se.featureIndex)-be}return Se.featureIndex-we.featureIndex});for(const we of ge)he.push(we)}}for(const Q in V)V[Q].forEach(de=>{const W=de.feature,he=C[E[Q].source].getFeatureState(W.layer["source-layer"],W.id);W.source=W.layer.source,W.layer["source-layer"]&&(W.sourceLayer=W.layer["source-layer"]),W.state=he});return V}(this._layers,x,this.sourceCaches,t,s,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(y)}querySourceFeatures(t,s){s&&s.filter&&this._validate(u.validateStyle.filter,"querySourceFeatures.filter",s.filter,null,s);const c=this.sourceCaches[t];return c?function(p,y){const x=p.getRenderableIds().map(C=>p.getTileByID(C)),E=[],S={};for(let C=0;C<x.length;C++){const M=x[C],P=M.tileID.canonical.key;S[P]||(S[P]=!0,M.querySourceFeatures(E,y))}return E}(c,s):[]}addSourceType(t,s,c){return or.getSourceType(t)?c(new Error(`A source type called "${t}" already exists.`)):(or.setSourceType(t,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:t,url:s.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(t,s={}){this._checkLoaded();const c=this.light.getLight();let p=!1;for(const x in t)if(!u.deepEqual(t[x],c[x])){p=!0;break}if(!p)return;const y={now:u.exported.now(),transition:u.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(t,s),this.light.updateTransitions(y)}_validate(t,s,c,p,y={}){return(!y||y.validate!==!1)&&wi(this,t.call(u.validateStyle,u.extend({key:s,style:this.serialize(),value:c,styleSpec:u.v8Spec},p)))}_remove(t=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const s in this._layers)this._layers[s].setEventedParent(null);for(const s in this.sourceCaches){const c=this.sourceCaches[s];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(t)}_clearSource(t){this.sourceCaches[t].clearTiles()}_reloadSource(t){this.sourceCaches[t].resume(),this.sourceCaches[t].reload()}_updateSources(t){for(const s in this.sourceCaches)this.sourceCaches[s].update(t,this.map.terrain)}_generateCollisionBoxes(){for(const t in this.sourceCaches)this._reloadSource(t)}_updatePlacement(t,s,c,p,y=!1){let x=!1,E=!1;const S={};for(const C of this._order){const M=this._layers[C];if(M.type!=="symbol")continue;if(!S[M.source]){const F=this.sourceCaches[M.source];S[M.source]=F.getRenderableIds(!0).map(Z=>F.getTileByID(Z)).sort((Z,V)=>V.tileID.overscaledZ-Z.tileID.overscaledZ||(Z.tileID.isLessThan(V.tileID)?-1:1))}const P=this.crossTileSymbolIndex.addLayer(M,S[M.source],t.center.lng);x=x||P}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((y=y||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.exported.now(),t.zoom))&&(this.pauseablePlacement=new pa(t,this.map.terrain,this._order,y,s,c,p,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,S),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.exported.now()),E=!0),x&&this.pauseablePlacement.placement.setStale()),E||x)for(const C of this._order){const M=this._layers[C];M.type==="symbol"&&this.placement.updateLayerOpacities(M,S[M.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.exported.now())}_releaseSymbolFadeTiles(){for(const t in this.sourceCaches)this.sourceCaches[t].releaseSymbolFadeTiles()}getImages(t,s,c){this.imageManager.getImages(s.icons,c),this._updateTilesForChangedImages();const p=this.sourceCaches[s.source];p&&p.setDependencies(s.tileID.key,s.type,s.icons)}getGlyphs(t,s,c){this.glyphManager.getGlyphs(s.stacks,c);const p=this.sourceCaches[s.source];p&&p.setDependencies(s.tileID.key,s.type,[""])}getResource(t,s,c){return u.makeRequest(s,c)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(t,s={}){this._checkLoaded(),t&&this._validate(u.validateStyle.glyphs,"glyphs",t,null,s)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=t,this.glyphManager.entries={},this.glyphManager.setURL(t))}addSprite(t,s,c={},p){this._checkLoaded();const y=[{id:t,url:s}],x=[...bt(this.stylesheet.sprite),...y];this._validate(u.validateStyle.sprite,"sprite",x,null,c)||(this.stylesheet.sprite=x,this._loadSprite(y,!0,p))}removeSprite(t){this._checkLoaded();const s=bt(this.stylesheet.sprite);if(s.find(c=>c.id===t)){if(this._spritesImagesIds[t])for(const c of this._spritesImagesIds[t])this.imageManager.removeImage(c),this._changedImages[c]=!0;s.splice(s.findIndex(c=>c.id===t),1),this.stylesheet.sprite=s.length>0?s:void 0,delete this._spritesImagesIds[t],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.Event("data",{dataType:"style"}))}else this.fire(new u.ErrorEvent(new Error(`Sprite "${t}" doesn't exists on this map.`)))}getSprite(){return bt(this.stylesheet.sprite)}setSprite(t,s={},c){this._checkLoaded(),t&&this._validate(u.validateStyle.sprite,"sprite",t,null,s)||(this.stylesheet.sprite=t,t?this._loadSprite(t,!0,c):(this._unloadSprite(),c&&c(null)))}}or.getSourceType=function(h){return _i[h]},or.setSourceType=function(h,t){_i[h]=t},or.registerForPluginStateChange=u.registerForPluginStateChange;var Vo=u.createLayout([{name:"a_pos",type:"Int16",components:2}]),$o="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Wi={prelude:Vt(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Vt(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Vt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Vt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Vt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Vt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Vt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Vt("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Vt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Vt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Vt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Vt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Vt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Vt(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Vt(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Vt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Vt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Vt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Vt(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Vt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Vt(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Vt(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Vt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Vt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Vt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Vt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Vt("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",$o),terrainDepth:Vt("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",$o),terrainCoords:Vt("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",$o)};function Vt(h,t){const s=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=t.match(/attribute ([\w]+) ([\w]+)/g),p=h.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),y=t.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=y?y.concat(p):p,E={};return{fragmentSource:h=h.replace(s,(S,C,M,P,F)=>(E[F]=!0,C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${M} ${P} ${F};
#else
uniform ${M} ${P} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${M} ${P} ${F} = u_${F};
#endif
`)),vertexSource:t=t.replace(s,(S,C,M,P,F)=>{const Z=P==="float"?"vec2":"vec4",V=F.match(/color/)?"color":Z;return E[F]?C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${M} ${Z} a_${F};
varying ${M} ${P} ${F};
#else
uniform ${M} ${P} u_${F};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${M} ${P} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${V}(a_${F}, u_${F}_t);
#else
    ${M} ${P} ${F} = u_${F};
#endif
`:C==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${M} ${Z} a_${F};
#else
uniform ${M} ${P} u_${F};
#endif
`:V==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${M} ${P} ${F} = a_${F};
#else
    ${M} ${P} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${M} ${P} ${F} = unpack_mix_${V}(a_${F}, u_${F}_t);
#else
    ${M} ${P} ${F} = u_${F};
#endif
`}),staticAttributes:c,staticUniforms:x}}class fa{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(t,s,c,p,y,x,E,S,C){this.context=t;let M=this.boundPaintVertexBuffers.length!==p.length;for(let P=0;!M&&P<p.length;P++)this.boundPaintVertexBuffers[P]!==p[P]&&(M=!0);!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==c||M||this.boundIndexBuffer!==y||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==E||this.boundDynamicVertexBuffer2!==S||this.boundDynamicVertexBuffer3!==C?this.freshBind(s,c,p,y,x,E,S,C):(t.bindVertexArray.set(this.vao),E&&E.bind(),y&&y.dynamicDraw&&y.bind(),S&&S.bind(),C&&C.bind())}freshBind(t,s,c,p,y,x,E,S){const C=t.numAttributes,M=this.context,P=M.gl;this.vao&&this.destroy(),this.vao=M.createVertexArray(),M.bindVertexArray.set(this.vao),this.boundProgram=t,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=p,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=E,this.boundDynamicVertexBuffer3=S,s.enableAttributes(P,t);for(const F of c)F.enableAttributes(P,t);x&&x.enableAttributes(P,t),E&&E.enableAttributes(P,t),S&&S.enableAttributes(P,t),s.bind(),s.setVertexAttribPointers(P,t,y);for(const F of c)F.bind(),F.setVertexAttribPointers(P,t,y);x&&(x.bind(),x.setVertexAttribPointers(P,t,y)),p&&p.bind(),E&&(E.bind(),E.setVertexAttribPointers(P,t,y)),S&&(S.bind(),S.setVertexAttribPointers(P,t,y)),M.currentNumAttributes=C}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function Ul(h){const t=[];for(let s=0;s<h.length;s++){if(h[s]===null)continue;const c=h[s].split(" ");t.push(c.pop())}return t}class ip{constructor(t,s,c,p,y,x,E){const S=t.gl;this.program=S.createProgram();const C=Ul(c.staticAttributes),M=p?p.getBinderAttributes():[],P=C.concat(M),F=Wi.prelude.staticUniforms?Ul(Wi.prelude.staticUniforms):[],Z=c.staticUniforms?Ul(c.staticUniforms):[],V=p?p.getBinderUniforms():[],q=F.concat(Z).concat(V),H=[];for(const Se of q)H.indexOf(Se)<0&&H.push(Se);const Q=p?p.defines():[];x&&Q.push("#define OVERDRAW_INSPECTOR;"),E&&Q.push("#define TERRAIN3D;");const de=Q.concat(Wi.prelude.fragmentSource,c.fragmentSource).join(`
`),W=Q.concat(Wi.prelude.vertexSource,c.vertexSource).join(`
`),he=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(he,de),S.compileShader(he),S.attachShader(this.program,he);const ge=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(ge,W),S.compileShader(ge),S.attachShader(this.program,ge),this.attributes={};const we={};this.numAttributes=P.length;for(let Se=0;Se<this.numAttributes;Se++)P[Se]&&(S.bindAttribLocation(this.program,Se,P[Se]),this.attributes[P[Se]]=Se);S.linkProgram(this.program),S.deleteShader(ge),S.deleteShader(he);for(let Se=0;Se<H.length;Se++){const Ie=H[Se];if(Ie&&!we[Ie]){const be=S.getUniformLocation(this.program,Ie);be&&(we[Ie]=be)}}this.fixedUniforms=y(t,we),this.terrainUniforms=((Se,Ie)=>({u_depth:new u.Uniform1i(Se,Ie.u_depth),u_terrain:new u.Uniform1i(Se,Ie.u_terrain),u_terrain_dim:new u.Uniform1f(Se,Ie.u_terrain_dim),u_terrain_matrix:new u.UniformMatrix4f(Se,Ie.u_terrain_matrix),u_terrain_unpack:new u.Uniform4f(Se,Ie.u_terrain_unpack),u_terrain_exaggeration:new u.Uniform1f(Se,Ie.u_terrain_exaggeration)}))(t,we),this.binderUniforms=p?p.getUniforms(t,we):[]}draw(t,s,c,p,y,x,E,S,C,M,P,F,Z,V,q,H,Q,de){const W=t.gl;if(this.failedToCreate)return;if(t.program.set(this.program),t.setDepthMode(c),t.setStencilMode(p),t.setColorMode(y),t.setCullFace(x),S){t.activeTexture.set(W.TEXTURE2),W.bindTexture(W.TEXTURE_2D,S.depthTexture),t.activeTexture.set(W.TEXTURE3),W.bindTexture(W.TEXTURE_2D,S.texture);for(const ge in this.terrainUniforms)this.terrainUniforms[ge].set(S[ge])}for(const ge in this.fixedUniforms)this.fixedUniforms[ge].set(E[ge]);q&&q.setUniforms(t,this.binderUniforms,Z,{zoom:V});let he=0;switch(s){case W.LINES:he=2;break;case W.TRIANGLES:he=3;break;case W.LINE_STRIP:he=1}for(const ge of F.get()){const we=ge.vaos||(ge.vaos={});(we[C]||(we[C]=new fa)).bind(t,this,M,q?q.getPaintVertexBuffers():[],P,ge.vertexOffset,H,Q,de),W.drawElements(s,ge.primitiveLength*he,W.UNSIGNED_SHORT,ge.primitiveOffset*he*2)}}}function ma(h,t,s){const c=1/ye(s,1,t.transform.tileZoom),p=Math.pow(2,s.tileID.overscaledZ),y=s.tileSize*Math.pow(2,t.transform.tileZoom)/p,x=y*(s.tileID.canonical.x+s.tileID.wrap*p),E=y*s.tileID.canonical.y;return{u_image:0,u_texsize:s.imageAtlasTexture.size,u_scale:[c,h.fromScale,h.toScale],u_fade:h.t,u_pixel_coord_upper:[x>>16,E>>16],u_pixel_coord_lower:[65535&x,65535&E]}}const Rc=(h,t,s,c)=>{const p=t.style.light,y=p.properties.get("position"),x=[y.x,y.y,y.z],E=function(){var C=new u.ARRAY_TYPE(9);return u.ARRAY_TYPE!=Float32Array&&(C[1]=0,C[2]=0,C[3]=0,C[5]=0,C[6]=0,C[7]=0),C[0]=1,C[4]=1,C[8]=1,C}();p.properties.get("anchor")==="viewport"&&function(C,M){var P=Math.sin(M),F=Math.cos(M);C[0]=F,C[1]=P,C[2]=0,C[3]=-P,C[4]=F,C[5]=0,C[6]=0,C[7]=0,C[8]=1}(E,-t.transform.angle),function(C,M,P){var F=M[0],Z=M[1],V=M[2];C[0]=F*P[0]+Z*P[3]+V*P[6],C[1]=F*P[1]+Z*P[4]+V*P[7],C[2]=F*P[2]+Z*P[5]+V*P[8]}(x,x,E);const S=p.properties.get("color");return{u_matrix:h,u_lightpos:x,u_lightintensity:p.properties.get("intensity"),u_lightcolor:[S.r,S.g,S.b],u_vertical_gradient:+s,u_opacity:c}},Bc=(h,t,s,c,p,y,x)=>u.extend(Rc(h,t,s,c),ma(y,t,x),{u_height_factor:-Math.pow(2,p.overscaledZ)/x.tileSize/8}),Fc=h=>({u_matrix:h}),Nl=(h,t,s,c)=>u.extend(Fc(h),ma(s,t,c)),rp=(h,t)=>({u_matrix:h,u_world:t}),Vl=(h,t,s,c,p)=>u.extend(Nl(h,t,s,c),{u_world:p}),Oc=(h,t,s,c)=>{const p=h.transform;let y,x;if(c.paint.get("circle-pitch-alignment")==="map"){const E=ye(s,1,p.zoom);y=!0,x=[E,E]}else y=!1,x=p.pixelsToGLUnits;return{u_camera_to_center_distance:p.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:h.translatePosMatrix(t.posMatrix,s,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:h.pixelRatio,u_extrude_scale:x}},Uc=(h,t,s)=>{const c=ye(s,1,t.zoom),p=Math.pow(2,t.zoom-s.tileID.overscaledZ),y=s.tileID.overscaleFactor();return{u_matrix:h,u_camera_to_center_distance:t.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[t.pixelsToGLUnits[0]/(c*p),t.pixelsToGLUnits[1]/(c*p)],u_overscale_factor:y}},$l=(h,t,s=1)=>({u_matrix:h,u_color:t,u_overlay:0,u_overlay_scale:s}),jl=h=>({u_matrix:h}),go=(h,t,s,c)=>({u_matrix:h,u_extrude_scale:ye(t,1,s),u_intensity:c});function ga(h,t){const s=Math.pow(2,t.canonical.z),c=t.canonical.y;return[new u.MercatorCoordinate(0,c/s).toLngLat().lat,new u.MercatorCoordinate(0,(c+1)/s).toLngLat().lat]}const bi=(h,t,s,c)=>{const p=h.transform;return{u_matrix:Ms(h,t,s,c),u_ratio:1/ye(t,1,p.zoom),u_device_pixel_ratio:h.pixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},ya=(h,t,s,c,p)=>u.extend(bi(h,t,s,p),{u_image:0,u_image_height:c}),_a=(h,t,s,c,p)=>{const y=h.transform,x=Ps(t,y);return{u_matrix:Ms(h,t,s,p),u_texsize:t.imageAtlasTexture.size,u_ratio:1/ye(t,1,y.zoom),u_device_pixel_ratio:h.pixelRatio,u_image:0,u_scale:[x,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},ks=(h,t,s,c,p,y)=>{const x=h.lineAtlas,E=Ps(t,h.transform),S=s.layout.get("line-cap")==="round",C=x.getDash(c.from,S),M=x.getDash(c.to,S),P=C.width*p.fromScale,F=M.width*p.toScale;return u.extend(bi(h,t,s,y),{u_patternscale_a:[E/P,-C.height/2],u_patternscale_b:[E/F,-M.height/2],u_sdfgamma:x.width/(256*Math.min(P,F)*h.pixelRatio)/2,u_image:0,u_tex_y_a:C.y,u_tex_y_b:M.y,u_mix:p.t})};function Ps(h,t){return 1/ye(h,1,t.tileZoom)}function Ms(h,t,s,c){return h.translatePosMatrix(c?c.posMatrix:t.tileID.posMatrix,t,s.paint.get("line-translate"),s.paint.get("line-translate-anchor"))}const As=(h,t,s,c,p)=>{return{u_matrix:h,u_tl_parent:t,u_scale_parent:s,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*p.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:p.paint.get("raster-brightness-min"),u_brightness_high:p.paint.get("raster-brightness-max"),u_saturation_factor:(x=p.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(y=p.paint.get("raster-contrast"),y>0?1/(1-y):1+y),u_spin_weights:zs(p.paint.get("raster-hue-rotate"))};var y,x};function zs(h){h*=Math.PI/180;const t=Math.sin(h),s=Math.cos(h);return[(2*s+1)/3,(-Math.sqrt(3)*t-s+1)/3,(Math.sqrt(3)*t-s+1)/3]}const Ds=(h,t,s,c,p,y,x,E,S,C)=>{const M=p.transform;return{u_is_size_zoom_constant:+(h==="constant"||h==="source"),u_is_size_feature_constant:+(h==="constant"||h==="camera"),u_size_t:t?t.uSizeT:0,u_size:t?t.uSize:0,u_camera_to_center_distance:M.cameraToCenterDistance,u_pitch:M.pitch/360*2*Math.PI,u_rotate_symbol:+s,u_aspect_ratio:M.width/M.height,u_fade_change:p.options.fadeDuration?p.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:x,u_coord_matrix:E,u_is_text:+S,u_pitch_with_map:+c,u_texsize:C,u_texture:0}},Si=(h,t,s,c,p,y,x,E,S,C,M)=>{const P=p.transform;return u.extend(Ds(h,t,s,c,p,y,x,E,S,C),{u_gamma_scale:c?Math.cos(P._pitch)*P.cameraToCenterDistance:1,u_device_pixel_ratio:p.pixelRatio,u_is_halo:+M})},Ri=(h,t,s,c,p,y,x,E,S,C)=>u.extend(Si(h,t,s,c,p,y,x,E,!0,S,!0),{u_texsize_icon:C,u_texture_icon:1}),ql=(h,t,s)=>({u_matrix:h,u_opacity:t,u_color:s}),va=(h,t,s,c,p,y)=>u.extend(function(x,E,S,C){const M=S.imageManager.getPattern(x.from.toString()),P=S.imageManager.getPattern(x.to.toString()),{width:F,height:Z}=S.imageManager.getPixelSize(),V=Math.pow(2,C.tileID.overscaledZ),q=C.tileSize*Math.pow(2,S.transform.tileZoom)/V,H=q*(C.tileID.canonical.x+C.tileID.wrap*V),Q=q*C.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:M.tl,u_pattern_br_a:M.br,u_pattern_tl_b:P.tl,u_pattern_br_b:P.br,u_texsize:[F,Z],u_mix:E.t,u_pattern_size_a:M.displaySize,u_pattern_size_b:P.displaySize,u_scale_a:E.fromScale,u_scale_b:E.toScale,u_tile_units_to_pixels:1/ye(C,1,S.transform.tileZoom),u_pixel_coord_upper:[H>>16,Q>>16],u_pixel_coord_lower:[65535&H,65535&Q]}}(c,y,s,p),{u_matrix:h,u_opacity:t}),xa={fillExtrusion:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_lightpos:new u.Uniform3f(h,t.u_lightpos),u_lightintensity:new u.Uniform1f(h,t.u_lightintensity),u_lightcolor:new u.Uniform3f(h,t.u_lightcolor),u_vertical_gradient:new u.Uniform1f(h,t.u_vertical_gradient),u_opacity:new u.Uniform1f(h,t.u_opacity)}),fillExtrusionPattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_lightpos:new u.Uniform3f(h,t.u_lightpos),u_lightintensity:new u.Uniform1f(h,t.u_lightintensity),u_lightcolor:new u.Uniform3f(h,t.u_lightcolor),u_vertical_gradient:new u.Uniform1f(h,t.u_vertical_gradient),u_height_factor:new u.Uniform1f(h,t.u_height_factor),u_image:new u.Uniform1i(h,t.u_image),u_texsize:new u.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,t.u_scale),u_fade:new u.Uniform1f(h,t.u_fade),u_opacity:new u.Uniform1f(h,t.u_opacity)}),fill:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix)}),fillPattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_image:new u.Uniform1i(h,t.u_image),u_texsize:new u.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,t.u_scale),u_fade:new u.Uniform1f(h,t.u_fade)}),fillOutline:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_world:new u.Uniform2f(h,t.u_world)}),fillOutlinePattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_world:new u.Uniform2f(h,t.u_world),u_image:new u.Uniform1i(h,t.u_image),u_texsize:new u.Uniform2f(h,t.u_texsize),u_pixel_coord_upper:new u.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,t.u_pixel_coord_lower),u_scale:new u.Uniform3f(h,t.u_scale),u_fade:new u.Uniform1f(h,t.u_fade)}),circle:(h,t)=>({u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_scale_with_map:new u.Uniform1i(h,t.u_scale_with_map),u_pitch_with_map:new u.Uniform1i(h,t.u_pitch_with_map),u_extrude_scale:new u.Uniform2f(h,t.u_extrude_scale),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_matrix:new u.UniformMatrix4f(h,t.u_matrix)}),collisionBox:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_pixels_to_tile_units:new u.Uniform1f(h,t.u_pixels_to_tile_units),u_extrude_scale:new u.Uniform2f(h,t.u_extrude_scale),u_overscale_factor:new u.Uniform1f(h,t.u_overscale_factor)}),collisionCircle:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_inv_matrix:new u.UniformMatrix4f(h,t.u_inv_matrix),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_viewport_size:new u.Uniform2f(h,t.u_viewport_size)}),debug:(h,t)=>({u_color:new u.UniformColor(h,t.u_color),u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_overlay:new u.Uniform1i(h,t.u_overlay),u_overlay_scale:new u.Uniform1f(h,t.u_overlay_scale)}),clippingMask:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix)}),heatmap:(h,t)=>({u_extrude_scale:new u.Uniform1f(h,t.u_extrude_scale),u_intensity:new u.Uniform1f(h,t.u_intensity),u_matrix:new u.UniformMatrix4f(h,t.u_matrix)}),heatmapTexture:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_world:new u.Uniform2f(h,t.u_world),u_image:new u.Uniform1i(h,t.u_image),u_color_ramp:new u.Uniform1i(h,t.u_color_ramp),u_opacity:new u.Uniform1f(h,t.u_opacity)}),hillshade:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_image:new u.Uniform1i(h,t.u_image),u_latrange:new u.Uniform2f(h,t.u_latrange),u_light:new u.Uniform2f(h,t.u_light),u_shadow:new u.UniformColor(h,t.u_shadow),u_highlight:new u.UniformColor(h,t.u_highlight),u_accent:new u.UniformColor(h,t.u_accent)}),hillshadePrepare:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_image:new u.Uniform1i(h,t.u_image),u_dimension:new u.Uniform2f(h,t.u_dimension),u_zoom:new u.Uniform1f(h,t.u_zoom),u_unpack:new u.Uniform4f(h,t.u_unpack)}),line:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_ratio:new u.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,t.u_units_to_pixels)}),lineGradient:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_ratio:new u.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,t.u_units_to_pixels),u_image:new u.Uniform1i(h,t.u_image),u_image_height:new u.Uniform1f(h,t.u_image_height)}),linePattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_texsize:new u.Uniform2f(h,t.u_texsize),u_ratio:new u.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_image:new u.Uniform1i(h,t.u_image),u_units_to_pixels:new u.Uniform2f(h,t.u_units_to_pixels),u_scale:new u.Uniform3f(h,t.u_scale),u_fade:new u.Uniform1f(h,t.u_fade)}),lineSDF:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_ratio:new u.Uniform1f(h,t.u_ratio),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_units_to_pixels:new u.Uniform2f(h,t.u_units_to_pixels),u_patternscale_a:new u.Uniform2f(h,t.u_patternscale_a),u_patternscale_b:new u.Uniform2f(h,t.u_patternscale_b),u_sdfgamma:new u.Uniform1f(h,t.u_sdfgamma),u_image:new u.Uniform1i(h,t.u_image),u_tex_y_a:new u.Uniform1f(h,t.u_tex_y_a),u_tex_y_b:new u.Uniform1f(h,t.u_tex_y_b),u_mix:new u.Uniform1f(h,t.u_mix)}),raster:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_tl_parent:new u.Uniform2f(h,t.u_tl_parent),u_scale_parent:new u.Uniform1f(h,t.u_scale_parent),u_buffer_scale:new u.Uniform1f(h,t.u_buffer_scale),u_fade_t:new u.Uniform1f(h,t.u_fade_t),u_opacity:new u.Uniform1f(h,t.u_opacity),u_image0:new u.Uniform1i(h,t.u_image0),u_image1:new u.Uniform1i(h,t.u_image1),u_brightness_low:new u.Uniform1f(h,t.u_brightness_low),u_brightness_high:new u.Uniform1f(h,t.u_brightness_high),u_saturation_factor:new u.Uniform1f(h,t.u_saturation_factor),u_contrast_factor:new u.Uniform1f(h,t.u_contrast_factor),u_spin_weights:new u.Uniform3f(h,t.u_spin_weights)}),symbolIcon:(h,t)=>({u_is_size_zoom_constant:new u.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,t.u_size_t),u_size:new u.Uniform1f(h,t.u_size),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,t.u_pitch),u_rotate_symbol:new u.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,t.u_fade_change),u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new u.Uniform1i(h,t.u_is_text),u_pitch_with_map:new u.Uniform1i(h,t.u_pitch_with_map),u_texsize:new u.Uniform2f(h,t.u_texsize),u_texture:new u.Uniform1i(h,t.u_texture)}),symbolSDF:(h,t)=>({u_is_size_zoom_constant:new u.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,t.u_size_t),u_size:new u.Uniform1f(h,t.u_size),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,t.u_pitch),u_rotate_symbol:new u.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,t.u_fade_change),u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new u.Uniform1i(h,t.u_is_text),u_pitch_with_map:new u.Uniform1i(h,t.u_pitch_with_map),u_texsize:new u.Uniform2f(h,t.u_texsize),u_texture:new u.Uniform1i(h,t.u_texture),u_gamma_scale:new u.Uniform1f(h,t.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(h,t.u_is_halo)}),symbolTextAndIcon:(h,t)=>({u_is_size_zoom_constant:new u.Uniform1i(h,t.u_is_size_zoom_constant),u_is_size_feature_constant:new u.Uniform1i(h,t.u_is_size_feature_constant),u_size_t:new u.Uniform1f(h,t.u_size_t),u_size:new u.Uniform1f(h,t.u_size),u_camera_to_center_distance:new u.Uniform1f(h,t.u_camera_to_center_distance),u_pitch:new u.Uniform1f(h,t.u_pitch),u_rotate_symbol:new u.Uniform1i(h,t.u_rotate_symbol),u_aspect_ratio:new u.Uniform1f(h,t.u_aspect_ratio),u_fade_change:new u.Uniform1f(h,t.u_fade_change),u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_label_plane_matrix:new u.UniformMatrix4f(h,t.u_label_plane_matrix),u_coord_matrix:new u.UniformMatrix4f(h,t.u_coord_matrix),u_is_text:new u.Uniform1i(h,t.u_is_text),u_pitch_with_map:new u.Uniform1i(h,t.u_pitch_with_map),u_texsize:new u.Uniform2f(h,t.u_texsize),u_texsize_icon:new u.Uniform2f(h,t.u_texsize_icon),u_texture:new u.Uniform1i(h,t.u_texture),u_texture_icon:new u.Uniform1i(h,t.u_texture_icon),u_gamma_scale:new u.Uniform1f(h,t.u_gamma_scale),u_device_pixel_ratio:new u.Uniform1f(h,t.u_device_pixel_ratio),u_is_halo:new u.Uniform1i(h,t.u_is_halo)}),background:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_opacity:new u.Uniform1f(h,t.u_opacity),u_color:new u.UniformColor(h,t.u_color)}),backgroundPattern:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_opacity:new u.Uniform1f(h,t.u_opacity),u_image:new u.Uniform1i(h,t.u_image),u_pattern_tl_a:new u.Uniform2f(h,t.u_pattern_tl_a),u_pattern_br_a:new u.Uniform2f(h,t.u_pattern_br_a),u_pattern_tl_b:new u.Uniform2f(h,t.u_pattern_tl_b),u_pattern_br_b:new u.Uniform2f(h,t.u_pattern_br_b),u_texsize:new u.Uniform2f(h,t.u_texsize),u_mix:new u.Uniform1f(h,t.u_mix),u_pattern_size_a:new u.Uniform2f(h,t.u_pattern_size_a),u_pattern_size_b:new u.Uniform2f(h,t.u_pattern_size_b),u_scale_a:new u.Uniform1f(h,t.u_scale_a),u_scale_b:new u.Uniform1f(h,t.u_scale_b),u_pixel_coord_upper:new u.Uniform2f(h,t.u_pixel_coord_upper),u_pixel_coord_lower:new u.Uniform2f(h,t.u_pixel_coord_lower),u_tile_units_to_pixels:new u.Uniform1f(h,t.u_tile_units_to_pixels)}),terrain:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_texture:new u.Uniform1i(h,t.u_texture),u_ele_delta:new u.Uniform1f(h,t.u_ele_delta)}),terrainDepth:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_ele_delta:new u.Uniform1f(h,t.u_ele_delta)}),terrainCoords:(h,t)=>({u_matrix:new u.UniformMatrix4f(h,t.u_matrix),u_texture:new u.Uniform1i(h,t.u_texture),u_terrain_coords_id:new u.Uniform1f(h,t.u_terrain_coords_id),u_ele_delta:new u.Uniform1f(h,t.u_ele_delta)})};class Zl{constructor(t,s,c){this.context=t;const p=t.gl;this.buffer=p.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),t.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(t){const s=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,t.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gl={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class wa{constructor(t,s,c,p){this.length=s.length,this.attributes=c,this.itemSize=s.bytesPerElement,this.dynamicDraw=p,this.context=t;const y=t.gl;this.buffer=y.createBuffer(),t.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete s.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(t){if(t.length!==this.length)throw new Error(`Length of new data is ${t.length}, which doesn't match current length of ${this.length}`);const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,t.arrayBuffer)}enableAttributes(t,s){for(let c=0;c<this.attributes.length;c++){const p=s.attributes[this.attributes[c].name];p!==void 0&&t.enableVertexAttribArray(p)}}setVertexAttribPointers(t,s,c){for(let p=0;p<this.attributes.length;p++){const y=this.attributes[p],x=s.attributes[y.name];x!==void 0&&t.vertexAttribPointer(x,y.components,t[Gl[y.type]],!1,this.itemSize,y.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class At{constructor(t){this.gl=t.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(t){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Wl extends At{getDefault(){return u.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.clearColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class ba extends At{getDefault(){return 1}set(t){(t!==this.current||this.dirty)&&(this.gl.clearDepth(t),this.current=t,this.dirty=!1)}}class Nc extends At{getDefault(){return 0}set(t){(t!==this.current||this.dirty)&&(this.gl.clearStencil(t),this.current=t,this.dirty=!1)}}class Vc extends At{getDefault(){return[!0,!0,!0,!0]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.colorMask(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class jo extends At{getDefault(){return!0}set(t){(t!==this.current||this.dirty)&&(this.gl.depthMask(t),this.current=t,this.dirty=!1)}}class op extends At{getDefault(){return 255}set(t){(t!==this.current||this.dirty)&&(this.gl.stencilMask(t),this.current=t,this.dirty=!1)}}class sp extends At{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(t){const s=this.current;(t.func!==s.func||t.ref!==s.ref||t.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(t.func,t.ref,t.mask),this.current=t,this.dirty=!1)}}class ap extends At{getDefault(){const t=this.gl;return[t.KEEP,t.KEEP,t.KEEP]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(t[0],t[1],t[2]),this.current=t,this.dirty=!1)}}class lp extends At{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=t,this.dirty=!1}}class up extends At{getDefault(){return[0,1]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.depthRange(t[0],t[1]),this.current=t,this.dirty=!1)}}class cp extends At{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=t,this.dirty=!1}}class Xl extends At{getDefault(){return this.gl.LESS}set(t){(t!==this.current||this.dirty)&&(this.gl.depthFunc(t),this.current=t,this.dirty=!1)}}class Sa extends At{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.BLEND):s.disable(s.BLEND),this.current=t,this.dirty=!1}}class Hl extends At{getDefault(){const t=this.gl;return[t.ONE,t.ZERO]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||this.dirty)&&(this.gl.blendFunc(t[0],t[1]),this.current=t,this.dirty=!1)}}class Kl extends At{getDefault(){return u.Color.transparent}set(t){const s=this.current;(t.r!==s.r||t.g!==s.g||t.b!==s.b||t.a!==s.a||this.dirty)&&(this.gl.blendColor(t.r,t.g,t.b,t.a),this.current=t,this.dirty=!1)}}class qo extends At{getDefault(){return this.gl.FUNC_ADD}set(t){(t!==this.current||this.dirty)&&(this.gl.blendEquation(t),this.current=t,this.dirty=!1)}}class $c extends At{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;t?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=t,this.dirty=!1}}class jc extends At{getDefault(){return this.gl.BACK}set(t){(t!==this.current||this.dirty)&&(this.gl.cullFace(t),this.current=t,this.dirty=!1)}}class Yl extends At{getDefault(){return this.gl.CCW}set(t){(t!==this.current||this.dirty)&&(this.gl.frontFace(t),this.current=t,this.dirty=!1)}}class yo extends At{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}}class qc extends At{getDefault(){return this.gl.TEXTURE0}set(t){(t!==this.current||this.dirty)&&(this.gl.activeTexture(t),this.current=t,this.dirty=!1)}}class Zo extends At{getDefault(){const t=this.gl;return[0,0,t.drawingBufferWidth,t.drawingBufferHeight]}set(t){const s=this.current;(t[0]!==s[0]||t[1]!==s[1]||t[2]!==s[2]||t[3]!==s[3]||this.dirty)&&(this.gl.viewport(t[0],t[1],t[2],t[3]),this.current=t,this.dirty=!1)}}class Go extends At{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,t),this.current=t,this.dirty=!1}}class Zc extends At{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Jl extends At{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,t),this.current=t,this.dirty=!1}}class $t extends At{getDefault(){return null}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class Ea extends At{getDefault(){return null}set(t){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,t),this.current=t,this.dirty=!1}}class hp extends At{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.bindVertexArray(t),this.current=t,this.dirty=!1)}}class Gc extends At{getDefault(){return 4}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,t),this.current=t,this.dirty=!1}}class Ls extends At{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t),this.current=t,this.dirty=!1}}class dp extends At{getDefault(){return!1}set(t){if(t===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,t),this.current=t,this.dirty=!1}}class Ql extends At{constructor(t,s){super(t),this.context=t,this.parent=s}getDefault(){return null}}class Wc extends Ql{setDirty(){this.dirty=!0}set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,t,0),this.current=t,this.dirty=!1}}class pp extends Ql{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class eu extends Ql{set(t){if(t===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,t),this.current=t,this.dirty=!1}}class Ta{constructor(t,s,c,p,y){this.context=t,this.width=s,this.height=c;const x=t.gl,E=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new Wc(t,E),p)this.depthAttachment=y?new eu(t,E):new pp(t,E);else if(y)throw new Error("Stencil cannot be setted without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const t=this.context.gl,s=this.colorAttachment.get();if(s&&t.deleteTexture(s),this.depthAttachment){const c=this.depthAttachment.get();c&&t.deleteRenderbuffer(c)}t.deleteFramebuffer(this.framebuffer)}}class an{constructor(t,s,c){this.blendFunction=t,this.blendColor=s,this.mask=c}}an.Replace=[1,0],an.disabled=new an(an.Replace,u.Color.transparent,[!1,!1,!1,!1]),an.unblended=new an(an.Replace,u.Color.transparent,[!0,!0,!0,!0]),an.alphaBlended=new an([1,771],u.Color.transparent,[!0,!0,!0,!0]);class tu{constructor(t){this.gl=t,this.clearColor=new Wl(this),this.clearDepth=new ba(this),this.clearStencil=new Nc(this),this.colorMask=new Vc(this),this.depthMask=new jo(this),this.stencilMask=new op(this),this.stencilFunc=new sp(this),this.stencilOp=new ap(this),this.stencilTest=new lp(this),this.depthRange=new up(this),this.depthTest=new cp(this),this.depthFunc=new Xl(this),this.blend=new Sa(this),this.blendFunc=new Hl(this),this.blendColor=new Kl(this),this.blendEquation=new qo(this),this.cullFace=new $c(this),this.cullFaceSide=new jc(this),this.frontFace=new Yl(this),this.program=new yo(this),this.activeTexture=new qc(this),this.viewport=new Zo(this),this.bindFramebuffer=new Go(this),this.bindRenderbuffer=new Zc(this),this.bindTexture=new Jl(this),this.bindVertexBuffer=new $t(this),this.bindElementBuffer=new Ea(this),this.bindVertexArray=new hp(this),this.pixelStoreUnpack=new Gc(this),this.pixelStoreUnpackPremultiplyAlpha=new Ls(this),this.pixelStoreUnpackFlipY=new dp(this),this.extTextureFilterAnisotropic=t.getExtension("EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=t.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.HALF_FLOAT=t.HALF_FLOAT,t.getExtension("EXT_color_buffer_half_float"),this.RGBA16F=t.RGBA16F,this.RGB16F=t.RGB16F}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(t,s){return new Zl(this,t,s)}createVertexBuffer(t,s,c){return new wa(this,t,s,c)}createRenderbuffer(t,s,c){const p=this.gl,y=p.createRenderbuffer();return this.bindRenderbuffer.set(y),p.renderbufferStorage(p.RENDERBUFFER,t,s,c),this.bindRenderbuffer.set(null),y}createFramebuffer(t,s,c,p){return new Ta(this,t,s,c,p)}clear({color:t,depth:s,stencil:c}){const p=this.gl;let y=0;t&&(y|=p.COLOR_BUFFER_BIT,this.clearColor.set(t),this.colorMask.set([!0,!0,!0,!0])),s!==void 0&&(y|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),c!==void 0&&(y|=p.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),p.clear(y)}setCullFace(t){t.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(t.mode),this.frontFace.set(t.frontFace))}setDepthMode(t){t.func!==this.gl.ALWAYS||t.mask?(this.depthTest.set(!0),this.depthFunc.set(t.func),this.depthMask.set(t.mask),this.depthRange.set(t.range)):this.depthTest.set(!1)}setStencilMode(t){t.test.func!==this.gl.ALWAYS||t.mask?(this.stencilTest.set(!0),this.stencilMask.set(t.mask),this.stencilOp.set([t.fail,t.depthFail,t.pass]),this.stencilFunc.set({func:t.test.func,ref:t.ref,mask:t.test.mask})):this.stencilTest.set(!1)}setColorMode(t){u.deepEqual(t.blendFunction,an.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(t.blendFunction),this.blendColor.set(t.blendColor)),this.colorMask.set(t.mask)}createVertexArray(){return this.gl.createVertexArray()}deleteVertexArray(t){return this.gl.deleteVertexArray(t)}unbindVAO(){this.bindVertexArray.set(null)}}class Tt{constructor(t,s,c){this.func=t,this.mask=s,this.range=c}}Tt.ReadOnly=!1,Tt.ReadWrite=!0,Tt.disabled=new Tt(519,Tt.ReadOnly,[0,1]);const Ca=7680;class Kt{constructor(t,s,c,p,y,x){this.test=t,this.ref=s,this.mask=c,this.fail=p,this.depthFail=y,this.pass=x}}Kt.disabled=new Kt({func:519,mask:0},0,0,Ca,Ca,Ca);class Ht{constructor(t,s,c){this.enable=t,this.mode=s,this.frontFace=c}}let Wo;function Xc(h,t,s,c,p,y,x){const E=h.context,S=E.gl,C=h.useProgram("collisionBox"),M=[];let P=0,F=0;for(let W=0;W<c.length;W++){const he=c[W],ge=t.getTile(he),we=ge.getBucket(s);if(!we)continue;let Se=he.posMatrix;p[0]===0&&p[1]===0||(Se=h.translatePosMatrix(he.posMatrix,ge,p,y));const Ie=x?we.textCollisionBox:we.iconCollisionBox,be=we.collisionCircleArray;if(be.length>0){const je=u.create(),rt=Se;u.mul(je,we.placementInvProjMatrix,h.transform.glCoordMatrix),u.mul(je,je,we.placementViewportMatrix),M.push({circleArray:be,circleOffset:F,transform:rt,invTransform:je,coord:he}),P+=be.length/4,F=P}Ie&&C.draw(E,S.LINES,Tt.disabled,Kt.disabled,h.colorModeForRenderPass(),Ht.disabled,Uc(Se,h.transform,ge),h.style.map.terrain&&h.style.map.terrain.getTerrainData(he),s.id,Ie.layoutVertexBuffer,Ie.indexBuffer,Ie.segments,null,h.transform.zoom,null,null,Ie.collisionVertexBuffer)}if(!x||!M.length)return;const Z=h.useProgram("collisionCircle"),V=new u.CollisionCircleLayoutArray;V.resize(4*P),V._trim();let q=0;for(const W of M)for(let he=0;he<W.circleArray.length/4;he++){const ge=4*he,we=W.circleArray[ge+0],Se=W.circleArray[ge+1],Ie=W.circleArray[ge+2],be=W.circleArray[ge+3];V.emplace(q++,we,Se,Ie,be,0),V.emplace(q++,we,Se,Ie,be,1),V.emplace(q++,we,Se,Ie,be,2),V.emplace(q++,we,Se,Ie,be,3)}(!Wo||Wo.length<2*P)&&(Wo=function(W){const he=2*W,ge=new u.QuadTriangleArray;ge.resize(he),ge._trim();for(let we=0;we<he;we++){const Se=6*we;ge.uint16[Se+0]=4*we+0,ge.uint16[Se+1]=4*we+1,ge.uint16[Se+2]=4*we+2,ge.uint16[Se+3]=4*we+2,ge.uint16[Se+4]=4*we+3,ge.uint16[Se+5]=4*we+0}return ge}(P));const H=E.createIndexBuffer(Wo,!0),Q=E.createVertexBuffer(V,u.collisionCircleLayout.members,!0);for(const W of M){const he={u_matrix:W.transform,u_inv_matrix:W.invTransform,u_camera_to_center_distance:(de=h.transform).cameraToCenterDistance,u_viewport_size:[de.width,de.height]};Z.draw(E,S.TRIANGLES,Tt.disabled,Kt.disabled,h.colorModeForRenderPass(),Ht.disabled,he,h.style.map.terrain&&h.style.map.terrain.getTerrainData(W.coord),s.id,Q,H,u.SegmentVector.simpleSegment(0,2*W.circleOffset,W.circleArray.length,W.circleArray.length/2),null,h.transform.zoom,null,null,null)}var de;Q.destroy(),H.destroy()}Ht.disabled=new Ht(!1,1029,2305),Ht.backCCW=new Ht(!0,1029,2305);const nu=u.identity(new Float32Array(16));function fp(h,t,s,c,p,y){const{horizontalAlign:x,verticalAlign:E}=u.getAnchorAlignment(h),S=-(x-.5)*t,C=-(E-.5)*s,M=u.evaluateVariableOffset(h,c);return new u.Point((S/p+M[0])*y,(C/p+M[1])*y)}function Hc(h,t,s,c,p,y,x,E,S,C,M){const P=h.text.placedSymbolArray,F=h.text.dynamicLayoutVertexArray,Z=h.icon.dynamicLayoutVertexArray,V={};F.clear();for(let q=0;q<P.length;q++){const H=P.get(q),Q=H.hidden||!H.crossTileID||h.allowVerticalPlacement&&!H.placedOrientation?null:c[H.crossTileID];if(Q){const de=new u.Point(H.anchorX,H.anchorY),W=at(de,s?x:y,M),he=Br(p.cameraToCenterDistance,W.signedDistanceFromCamera);let ge=u.evaluateSizeForFeature(h.textSizeData,S,H)*he/u.ONE_EM;s&&(ge*=h.tilePixelRatio/E);const{width:we,height:Se,anchor:Ie,textOffset:be,textBoxScale:je}=Q,rt=fp(Ie,we,Se,be,je,ge),ft=s?at(de.add(rt),y,M).point:W.point.add(t?rt.rotate(-p.angle):rt),De=h.allowVerticalPlacement&&H.placedOrientation===u.WritingMode.vertical?Math.PI/2:0;for(let ut=0;ut<H.numGlyphs;ut++)u.addDynamicAttributes(F,ft,De);C&&H.associatedIconIndex>=0&&(V[H.associatedIconIndex]={shiftedAnchor:ft,angle:De})}else ne(H.numGlyphs,F)}if(C){Z.clear();const q=h.icon.placedSymbolArray;for(let H=0;H<q.length;H++){const Q=q.get(H);if(Q.hidden)ne(Q.numGlyphs,Z);else{const de=V[H];if(de)for(let W=0;W<Q.numGlyphs;W++)u.addDynamicAttributes(Z,de.shiftedAnchor,de.angle);else ne(Q.numGlyphs,Z)}}h.icon.dynamicLayoutVertexBuffer.updateData(Z)}h.text.dynamicLayoutVertexBuffer.updateData(F)}function Ia(h,t,s){return s.iconsInText&&t?"symbolTextAndIcon":h?"symbolSDF":"symbolIcon"}function ka(h,t,s,c,p,y,x,E,S,C,M,P){const F=h.context,Z=F.gl,V=h.transform,q=E==="map",H=S==="map",Q=E!=="viewport"&&s.layout.get("symbol-placement")!=="point",de=q&&!H&&!Q,W=!s.layout.get("symbol-sort-key").isConstant();let he=!1;const ge=h.depthModeForSublayer(0,Tt.ReadOnly),we=s.layout.get("text-variable-anchor"),Se=[];for(const Ie of c){const be=t.getTile(Ie),je=be.getBucket(s);if(!je)continue;const rt=p?je.text:je.icon;if(!rt||!rt.segments.get().length||!rt.hasVisibleVertices)continue;const ft=rt.programConfigurations.get(s.id),De=p||je.sdfIcons,ut=p?je.textSizeData:je.iconSizeData,Ge=H||V.pitch!==0,zt=h.useProgram(Ia(De,p,je),ft),_n=u.evaluateSizeForZoom(ut,V.zoom),Dt=h.style.map.terrain&&h.style.map.terrain.getTerrainData(Ie);let yt,pn,ai,vn,Un=[0,0],Bi=null;if(p)pn=be.glyphAtlasTexture,ai=Z.LINEAR,yt=be.glyphAtlasTexture.size,je.iconsInText&&(Un=be.imageAtlasTexture.size,Bi=be.imageAtlasTexture,vn=Ge||h.options.rotating||h.options.zooming||ut.kind==="composite"||ut.kind==="camera"?Z.LINEAR:Z.NEAREST);else{const zn=s.layout.get("icon-size").constantOr(0)!==1||je.iconsNeedLinear;pn=be.imageAtlasTexture,ai=De||h.options.rotating||h.options.zooming||zn||Ge?Z.LINEAR:Z.NEAREST,yt=be.imageAtlasTexture.size}const sr=ye(be,1,h.transform.zoom),ar=Fn(Ie.posMatrix,H,q,h.transform,sr),li=rr(Ie.posMatrix,H,q,h.transform,sr),Tr=we&&je.hasTextData(),Ws=s.layout.get("icon-text-fit")!=="none"&&Tr&&je.hasIconData();if(Q){const zn=h.style.map.terrain?(Ka,Ur)=>h.style.map.terrain.getElevation(Ie,Ka,Ur):null,Fi=s.layout.get("text-rotation-alignment")==="map";No(je,Ie.posMatrix,h,p,ar,li,H,C,Fi,zn)}const Jn=h.translatePosMatrix(Ie.posMatrix,be,y,x),Nn=Q||p&&we||Ws?nu:ar,Rt=h.translatePosMatrix(li,be,y,x,!0),An=De&&s.paint.get(p?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Vn;Vn=De?je.iconsInText?Ri(ut.kind,_n,de,H,h,Jn,Nn,Rt,yt,Un):Si(ut.kind,_n,de,H,h,Jn,Nn,Rt,p,yt,!0):Ds(ut.kind,_n,de,H,h,Jn,Nn,Rt,p,yt);const Ot={program:zt,buffers:rt,uniformValues:Vn,atlasTexture:pn,atlasTextureIcon:Bi,atlasInterpolation:ai,atlasInterpolationIcon:vn,isSDF:De,hasHalo:An};if(W&&je.canOverlap){he=!0;const zn=rt.segments.get();for(const Fi of zn)Se.push({segments:new u.SegmentVector([Fi]),sortKey:Fi.sortKey,state:Ot,terrainData:Dt})}else Se.push({segments:rt.segments,sortKey:0,state:Ot,terrainData:Dt})}he&&Se.sort((Ie,be)=>Ie.sortKey-be.sortKey);for(const Ie of Se){const be=Ie.state;if(F.activeTexture.set(Z.TEXTURE0),be.atlasTexture.bind(be.atlasInterpolation,Z.CLAMP_TO_EDGE),be.atlasTextureIcon&&(F.activeTexture.set(Z.TEXTURE1),be.atlasTextureIcon&&be.atlasTextureIcon.bind(be.atlasInterpolationIcon,Z.CLAMP_TO_EDGE)),be.isSDF){const je=be.uniformValues;be.hasHalo&&(je.u_is_halo=1,iu(be.buffers,Ie.segments,s,h,be.program,ge,M,P,je,Ie.terrainData)),je.u_is_halo=0}iu(be.buffers,Ie.segments,s,h,be.program,ge,M,P,be.uniformValues,Ie.terrainData)}}function iu(h,t,s,c,p,y,x,E,S,C){const M=c.context;p.draw(M,M.gl.TRIANGLES,y,x,E,Ht.disabled,S,C,s.id,h.layoutVertexBuffer,h.indexBuffer,t,s.paint,c.transform.zoom,h.programConfigurations.get(s.id),h.dynamicLayoutVertexBuffer,h.opacityVertexBuffer)}function ru(h,t,s,c,p){if(!s||!c||!c.imageAtlas)return;const y=c.imageAtlas.patternPositions;let x=y[s.to.toString()],E=y[s.from.toString()];if(!x||!E){const S=p.getPaintProperty(t);x=y[S],E=y[S]}x&&E&&h.setConstantPatternPositions(x,E)}function Rs(h,t,s,c,p,y,x){const E=h.context.gl,S="fill-pattern",C=s.paint.get(S),M=C&&C.constantOr(1),P=s.getCrossfadeParameters();let F,Z,V,q,H;x?(Z=M&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=E.LINES):(Z=M?"fillPattern":"fill",F=E.TRIANGLES);const Q=C.constantOr(null);for(const de of c){const W=t.getTile(de);if(M&&!W.patternsLoaded())continue;const he=W.getBucket(s);if(!he)continue;const ge=he.programConfigurations.get(s.id),we=h.useProgram(Z,ge),Se=h.style.map.terrain&&h.style.map.terrain.getTerrainData(de);M&&(h.context.activeTexture.set(E.TEXTURE0),W.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),ge.updatePaintBuffers(P)),ru(ge,S,Q,W,s);const Ie=Se?de:null,be=h.translatePosMatrix(Ie?Ie.posMatrix:de.posMatrix,W,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor"));if(x){q=he.indexBuffer2,H=he.segments2;const je=[E.drawingBufferWidth,E.drawingBufferHeight];V=Z==="fillOutlinePattern"&&M?Vl(be,h,P,W,je):rp(be,je)}else q=he.indexBuffer,H=he.segments,V=M?Nl(be,h,P,W):Fc(be);we.draw(h.context,F,p,h.stencilModeForClipping(de),y,Ht.disabled,V,Se,s.id,he.layoutVertexBuffer,q,H,s.paint,h.transform.zoom,ge)}}function Bs(h,t,s,c,p,y,x){const E=h.context,S=E.gl,C="fill-extrusion-pattern",M=s.paint.get(C),P=M.constantOr(1),F=s.getCrossfadeParameters(),Z=s.paint.get("fill-extrusion-opacity"),V=M.constantOr(null);for(const q of c){const H=t.getTile(q),Q=H.getBucket(s);if(!Q)continue;const de=h.style.map.terrain&&h.style.map.terrain.getTerrainData(q),W=Q.programConfigurations.get(s.id),he=h.useProgram(P?"fillExtrusionPattern":"fillExtrusion",W);P&&(h.context.activeTexture.set(S.TEXTURE0),H.imageAtlasTexture.bind(S.LINEAR,S.CLAMP_TO_EDGE),W.updatePaintBuffers(F)),ru(W,C,V,H,s);const ge=h.translatePosMatrix(q.posMatrix,H,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),we=s.paint.get("fill-extrusion-vertical-gradient"),Se=P?Bc(ge,h,we,Z,q,F,H):Rc(ge,h,we,Z);he.draw(E,E.gl.TRIANGLES,p,y,x,Ht.backCCW,Se,de,s.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,s.paint,h.transform.zoom,W,h.style.map.terrain&&Q.centroidVertexBuffer)}}function mp(h,t,s,c,p,y,x){const E=h.context,S=E.gl,C=s.fbo;if(!C)return;const M=h.useProgram("hillshade"),P=h.style.map.terrain&&h.style.map.terrain.getTerrainData(t);E.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,C.colorAttachment.get()),M.draw(E,S.TRIANGLES,p,y,x,Ht.disabled,((F,Z,V,q)=>{const H=V.paint.get("hillshade-shadow-color"),Q=V.paint.get("hillshade-highlight-color"),de=V.paint.get("hillshade-accent-color");let W=V.paint.get("hillshade-illumination-direction")*(Math.PI/180);V.paint.get("hillshade-illumination-anchor")==="viewport"&&(W-=F.transform.angle);const he=!F.options.moving;return{u_matrix:q?q.posMatrix:F.transform.calculatePosMatrix(Z.tileID.toUnwrapped(),he),u_image:0,u_latrange:ga(0,Z.tileID),u_light:[V.paint.get("hillshade-exaggeration"),W],u_shadow:H,u_highlight:Q,u_accent:de}})(h,s,c,P?t:null),P,c.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}function Kc(h,t,s,c,p,y){const x=h.context,E=x.gl,S=t.dem;if(S&&S.data){const C=S.dim,M=S.stride,P=S.getPixels();if(x.activeTexture.set(E.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),t.demTexture=t.demTexture||h.getTileTexture(M),t.demTexture){const Z=t.demTexture;Z.update(P,{premultiply:!1}),Z.bind(E.NEAREST,E.CLAMP_TO_EDGE)}else t.demTexture=new _t(x,P,E.RGBA,{premultiply:!1}),t.demTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE);x.activeTexture.set(E.TEXTURE0);let F=t.fbo;if(!F){const Z=new _t(x,{width:C,height:C,data:null},E.RGBA);Z.bind(E.LINEAR,E.CLAMP_TO_EDGE),F=t.fbo=x.createFramebuffer(C,C,!0,!1),F.colorAttachment.set(Z.texture)}x.bindFramebuffer.set(F.framebuffer),x.viewport.set([0,0,C,C]),h.useProgram("hillshadePrepare").draw(x,E.TRIANGLES,c,p,y,Ht.disabled,((Z,V)=>{const q=V.stride,H=u.create();return u.ortho(H,0,u.EXTENT,-u.EXTENT,0,0,1),u.translate(H,H,[0,-u.EXTENT,0]),{u_matrix:H,u_image:1,u_dimension:[q,q],u_zoom:Z.overscaledZ,u_unpack:V.getUnpackVector()}})(t.tileID,S),null,s.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments),t.needsHillshadePrepare=!1}}function yn(h,t,s,c,p,y){const x=c.paint.get("raster-fade-duration");if(!y&&x>0){const E=u.exported.now(),S=(E-h.timeAdded)/x,C=t?(E-t.timeAdded)/x:-1,M=s.getSource(),P=p.coveringZoomLevel({tileSize:M.tileSize,roundZoom:M.roundZoom}),F=!t||Math.abs(t.tileID.overscaledZ-P)>Math.abs(h.tileID.overscaledZ-P),Z=F&&h.refreshedUponExpiration?1:u.clamp(F?S:1-C,0,1);return h.refreshedUponExpiration&&S>=1&&(h.refreshedUponExpiration=!1),t?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}const _o=new u.Color(1,0,0,1),Xi=new u.Color(0,1,0,1),Yc=new u.Color(0,0,1,1),ou=new u.Color(1,0,1,1),Jc=new u.Color(0,1,1,1);function vo(h,t,s,c){Xo(h,0,t+s/2,h.transform.width,s,c)}function Fs(h,t,s,c){Xo(h,t-s/2,0,s,h.transform.height,c)}function Xo(h,t,s,c,p,y){const x=h.context,E=x.gl;E.enable(E.SCISSOR_TEST),E.scissor(t*h.pixelRatio,s*h.pixelRatio,c*h.pixelRatio,p*h.pixelRatio),x.clear({color:y}),E.disable(E.SCISSOR_TEST)}function Qc(h,t,s){const c=h.context,p=c.gl,y=s.posMatrix,x=h.useProgram("debug"),E=Tt.disabled,S=Kt.disabled,C=h.colorModeForRenderPass(),M="$debug",P=h.style.map.terrain&&h.style.map.terrain.getTerrainData(s);c.activeTexture.set(p.TEXTURE0);const F=t.getTileByID(s.key).latestRawTileData,Z=Math.floor((F&&F.byteLength||0)/1024),V=t.getTile(s).tileSize,q=512/Math.min(V,512)*(s.overscaledZ/h.transform.zoom)*.5;let H=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(H+=` => ${s.overscaledZ}`),function(Q,de){Q.initDebugOverlayCanvas();const W=Q.debugOverlayCanvas,he=Q.context.gl,ge=Q.debugOverlayCanvas.getContext("2d");ge.clearRect(0,0,W.width,W.height),ge.shadowColor="white",ge.shadowBlur=2,ge.lineWidth=1.5,ge.strokeStyle="white",ge.textBaseline="top",ge.font="bold 36px Open Sans, sans-serif",ge.fillText(de,5,5),ge.strokeText(de,5,5),Q.debugOverlayTexture.update(W),Q.debugOverlayTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE)}(h,`${H} ${Z}kB`),x.draw(c,p.TRIANGLES,E,S,an.alphaBlended,Ht.disabled,$l(y,u.Color.transparent,q),null,M,h.debugBuffer,h.quadTriangleIndexBuffer,h.debugSegments),x.draw(c,p.LINE_STRIP,E,S,C,Ht.disabled,$l(y,u.Color.red),P,M,h.debugBuffer,h.tileBorderIndexBuffer,h.debugSegments)}function su(h,t,s){const c=h.context,p=c.gl,y=h.colorModeForRenderPass(),x=new Tt(p.LEQUAL,Tt.ReadWrite,h.depthRangeFor3D),E=h.useProgram("terrain"),S=t.getTerrainMesh();c.bindFramebuffer.set(null),c.viewport.set([0,0,h.width,h.height]);for(const C of s){const M=h.renderToTexture.getTexture(C),P=t.getTerrainData(C.tileID);c.activeTexture.set(p.TEXTURE0),p.bindTexture(p.TEXTURE_2D,M.texture);const F={u_matrix:h.transform.calculatePosMatrix(C.tileID.toUnwrapped()),u_texture:0,u_ele_delta:t.getMeshFrameDelta(h.transform.zoom)};E.draw(c,p.TRIANGLES,x,Kt.disabled,y,Ht.backCCW,F,P,"terrain",S.vertexBuffer,S.indexBuffer,S.segments)}}const au={symbol:function(h,t,s,c,p){if(h.renderPass!=="translucent")return;const y=Kt.disabled,x=h.colorModeForRenderPass();s.layout.get("text-variable-anchor")&&function(E,S,C,M,P,F,Z){const V=S.transform,q=P==="map",H=F==="map";for(const Q of E){const de=M.getTile(Q),W=de.getBucket(C);if(!W||!W.text||!W.text.segments.get().length)continue;const he=u.evaluateSizeForZoom(W.textSizeData,V.zoom),ge=ye(de,1,S.transform.zoom),we=Fn(Q.posMatrix,H,q,S.transform,ge),Se=C.layout.get("icon-text-fit")!=="none"&&W.hasIconData();if(he){const Ie=Math.pow(2,V.zoom-de.tileID.overscaledZ);Hc(W,q,H,Z,V,we,Q.posMatrix,Ie,he,Se,S.style.map.terrain?(be,je)=>S.style.map.terrain.getElevation(Q,be,je):null)}}}(c,h,s,t,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),p),s.paint.get("icon-opacity").constantOr(1)!==0&&ka(h,t,s,c,!1,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),s.layout.get("icon-rotation-alignment"),s.layout.get("icon-pitch-alignment"),s.layout.get("icon-keep-upright"),y,x),s.paint.get("text-opacity").constantOr(1)!==0&&ka(h,t,s,c,!0,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),s.layout.get("text-keep-upright"),y,x),t.map.showCollisionBoxes&&(Xc(h,t,s,c,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),Xc(h,t,s,c,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(h,t,s,c){if(h.renderPass!=="translucent")return;const p=s.paint.get("circle-opacity"),y=s.paint.get("circle-stroke-width"),x=s.paint.get("circle-stroke-opacity"),E=!s.layout.get("circle-sort-key").isConstant();if(p.constantOr(1)===0&&(y.constantOr(1)===0||x.constantOr(1)===0))return;const S=h.context,C=S.gl,M=h.depthModeForSublayer(0,Tt.ReadOnly),P=Kt.disabled,F=h.colorModeForRenderPass(),Z=[];for(let V=0;V<c.length;V++){const q=c[V],H=t.getTile(q),Q=H.getBucket(s);if(!Q)continue;const de=Q.programConfigurations.get(s.id),W=h.useProgram("circle",de),he=Q.layoutVertexBuffer,ge=Q.indexBuffer,we=h.style.map.terrain&&h.style.map.terrain.getTerrainData(q),Se={programConfiguration:de,program:W,layoutVertexBuffer:he,indexBuffer:ge,uniformValues:Oc(h,q,H,s),terrainData:we};if(E){const Ie=Q.segments.get();for(const be of Ie)Z.push({segments:new u.SegmentVector([be]),sortKey:be.sortKey,state:Se})}else Z.push({segments:Q.segments,sortKey:0,state:Se})}E&&Z.sort((V,q)=>V.sortKey-q.sortKey);for(const V of Z){const{programConfiguration:q,program:H,layoutVertexBuffer:Q,indexBuffer:de,uniformValues:W,terrainData:he}=V.state;H.draw(S,C.TRIANGLES,M,P,F,Ht.disabled,W,he,s.id,Q,de,V.segments,s.paint,h.transform.zoom,q)}},heatmap:function(h,t,s,c){if(s.paint.get("heatmap-opacity")!==0)if(h.renderPass==="offscreen"){const p=h.context,y=p.gl,x=Kt.disabled,E=new an([y.ONE,y.ONE],u.Color.transparent,[!0,!0,!0,!0]);(function(S,C,M){const P=S.gl;S.activeTexture.set(P.TEXTURE1),S.viewport.set([0,0,C.width/4,C.height/4]);let F=M.heatmapFbo;if(F)P.bindTexture(P.TEXTURE_2D,F.colorAttachment.get()),S.bindFramebuffer.set(F.framebuffer);else{const Z=P.createTexture();P.bindTexture(P.TEXTURE_2D,Z),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_S,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_WRAP_T,P.CLAMP_TO_EDGE),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MIN_FILTER,P.LINEAR),P.texParameteri(P.TEXTURE_2D,P.TEXTURE_MAG_FILTER,P.LINEAR),F=M.heatmapFbo=S.createFramebuffer(C.width/4,C.height/4,!1,!1),function(V,q,H,Q){var de,W;const he=V.gl,ge=(de=V.HALF_FLOAT)!==null&&de!==void 0?de:he.UNSIGNED_BYTE,we=(W=V.RGBA16F)!==null&&W!==void 0?W:he.RGBA;he.texImage2D(he.TEXTURE_2D,0,we,q.width/4,q.height/4,0,he.RGBA,ge,null),Q.colorAttachment.set(H)}(S,C,Z,F)}})(p,h,s),p.clear({color:u.Color.transparent});for(let S=0;S<c.length;S++){const C=c[S];if(t.hasRenderableParent(C))continue;const M=t.getTile(C),P=M.getBucket(s);if(!P)continue;const F=P.programConfigurations.get(s.id),Z=h.useProgram("heatmap",F),{zoom:V}=h.transform;Z.draw(p,y.TRIANGLES,Tt.disabled,x,E,Ht.disabled,go(C.posMatrix,M,V,s.paint.get("heatmap-intensity")),null,s.id,P.layoutVertexBuffer,P.indexBuffer,P.segments,s.paint,h.transform.zoom,F)}p.viewport.set([0,0,h.width,h.height])}else h.renderPass==="translucent"&&(h.context.setColorMode(h.colorModeForRenderPass()),function(p,y){const x=p.context,E=x.gl,S=y.heatmapFbo;if(!S)return;x.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,S.colorAttachment.get()),x.activeTexture.set(E.TEXTURE1);let C=y.colorRampTexture;C||(C=y.colorRampTexture=new _t(x,y.colorRamp,E.RGBA)),C.bind(E.LINEAR,E.CLAMP_TO_EDGE),p.useProgram("heatmapTexture").draw(x,E.TRIANGLES,Tt.disabled,Kt.disabled,p.colorModeForRenderPass(),Ht.disabled,((M,P,F,Z)=>{const V=u.create();u.ortho(V,0,M.width,M.height,0,0,1);const q=M.context.gl;return{u_matrix:V,u_world:[q.drawingBufferWidth,q.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:P.paint.get("heatmap-opacity")}})(p,y),null,y.id,p.viewportBuffer,p.quadTriangleIndexBuffer,p.viewportSegments,y.paint,p.transform.zoom)}(h,s))},line:function(h,t,s,c){if(h.renderPass!=="translucent")return;const p=s.paint.get("line-opacity"),y=s.paint.get("line-width");if(p.constantOr(1)===0||y.constantOr(1)===0)return;const x=h.depthModeForSublayer(0,Tt.ReadOnly),E=h.colorModeForRenderPass(),S=s.paint.get("line-dasharray"),C=s.paint.get("line-pattern"),M=C.constantOr(1),P=s.paint.get("line-gradient"),F=s.getCrossfadeParameters(),Z=M?"linePattern":S?"lineSDF":P?"lineGradient":"line",V=h.context,q=V.gl;let H=!0;for(const Q of c){const de=t.getTile(Q);if(M&&!de.patternsLoaded())continue;const W=de.getBucket(s);if(!W)continue;const he=W.programConfigurations.get(s.id),ge=h.context.program.get(),we=h.useProgram(Z,he),Se=H||we.program!==ge,Ie=h.style.map.terrain&&h.style.map.terrain.getTerrainData(Q),be=C.constantOr(null);if(be&&de.imageAtlas){const ft=de.imageAtlas,De=ft.patternPositions[be.to.toString()],ut=ft.patternPositions[be.from.toString()];De&&ut&&he.setConstantPatternPositions(De,ut)}const je=Ie?Q:null,rt=M?_a(h,de,s,F,je):S?ks(h,de,s,S,F,je):P?ya(h,de,s,W.lineClipsArray.length,je):bi(h,de,s,je);if(M)V.activeTexture.set(q.TEXTURE0),de.imageAtlasTexture.bind(q.LINEAR,q.CLAMP_TO_EDGE),he.updatePaintBuffers(F);else if(S&&(Se||h.lineAtlas.dirty))V.activeTexture.set(q.TEXTURE0),h.lineAtlas.bind(V);else if(P){const ft=W.gradients[s.id];let De=ft.texture;if(s.gradientVersion!==ft.version){let ut=256;if(s.stepInterpolant){const Ge=t.getSource().maxzoom,zt=Q.canonical.z===Ge?Math.ceil(1<<h.transform.maxZoom-Q.canonical.z):1;ut=u.clamp(u.nextPowerOfTwo(W.maxLineLength/u.EXTENT*1024*zt),256,V.maxTextureSize)}ft.gradient=u.renderColorRamp({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:ut,image:ft.gradient||void 0,clips:W.lineClipsArray}),ft.texture?ft.texture.update(ft.gradient):ft.texture=new _t(V,ft.gradient,q.RGBA),ft.version=s.gradientVersion,De=ft.texture}V.activeTexture.set(q.TEXTURE0),De.bind(s.stepInterpolant?q.NEAREST:q.LINEAR,q.CLAMP_TO_EDGE)}we.draw(V,q.TRIANGLES,x,h.stencilModeForClipping(Q),E,Ht.disabled,rt,Ie,s.id,W.layoutVertexBuffer,W.indexBuffer,W.segments,s.paint,h.transform.zoom,he,W.layoutVertexBuffer2),H=!1}},fill:function(h,t,s,c){const p=s.paint.get("fill-color"),y=s.paint.get("fill-opacity");if(y.constantOr(1)===0)return;const x=h.colorModeForRenderPass(),E=s.paint.get("fill-pattern"),S=h.opaquePassEnabledForLayer()&&!E.constantOr(1)&&p.constantOr(u.Color.transparent).a===1&&y.constantOr(0)===1?"opaque":"translucent";if(h.renderPass===S){const C=h.depthModeForSublayer(1,h.renderPass==="opaque"?Tt.ReadWrite:Tt.ReadOnly);Rs(h,t,s,c,C,x,!1)}if(h.renderPass==="translucent"&&s.paint.get("fill-antialias")){const C=h.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,Tt.ReadOnly);Rs(h,t,s,c,C,x,!0)}},"fill-extrusion":function(h,t,s,c){const p=s.paint.get("fill-extrusion-opacity");if(p!==0&&h.renderPass==="translucent"){const y=new Tt(h.context.gl.LEQUAL,Tt.ReadWrite,h.depthRangeFor3D);if(p!==1||s.paint.get("fill-extrusion-pattern").constantOr(1))Bs(h,t,s,c,y,Kt.disabled,an.disabled),Bs(h,t,s,c,y,h.stencilModeFor3D(),h.colorModeForRenderPass());else{const x=h.colorModeForRenderPass();Bs(h,t,s,c,y,Kt.disabled,x)}}},hillshade:function(h,t,s,c){if(h.renderPass!=="offscreen"&&h.renderPass!=="translucent")return;const p=h.context,y=h.depthModeForSublayer(0,Tt.ReadOnly),x=h.colorModeForRenderPass(),[E,S]=h.renderPass==="translucent"?h.stencilConfigForOverlap(c):[{},c];for(const C of S){const M=t.getTile(C);M.needsHillshadePrepare!==void 0&&M.needsHillshadePrepare&&h.renderPass==="offscreen"?Kc(h,M,s,y,Kt.disabled,x):h.renderPass==="translucent"&&mp(h,C,M,s,y,E[C.overscaledZ],x)}p.viewport.set([0,0,h.width,h.height])},raster:function(h,t,s,c){if(h.renderPass!=="translucent"||s.paint.get("raster-opacity")===0||!c.length)return;const p=h.context,y=p.gl,x=t.getSource(),E=h.useProgram("raster"),S=h.colorModeForRenderPass(),[C,M]=x instanceof Wt?[{},c]:h.stencilConfigForOverlap(c),P=M[M.length-1].overscaledZ,F=!h.options.moving;for(const Z of M){const V=h.depthModeForSublayer(Z.overscaledZ-P,s.paint.get("raster-opacity")===1?Tt.ReadWrite:Tt.ReadOnly,y.LESS),q=t.getTile(Z);q.registerFadeDuration(s.paint.get("raster-fade-duration"));const H=t.findLoadedParent(Z,0),Q=yn(q,H,t,s,h.transform,h.style.map.terrain);let de,W;const he=s.paint.get("raster-resampling")==="nearest"?y.NEAREST:y.LINEAR;p.activeTexture.set(y.TEXTURE0),q.texture.bind(he,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST),p.activeTexture.set(y.TEXTURE1),H?(H.texture.bind(he,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST),de=Math.pow(2,H.tileID.overscaledZ-q.tileID.overscaledZ),W=[q.tileID.canonical.x*de%1,q.tileID.canonical.y*de%1]):q.texture.bind(he,y.CLAMP_TO_EDGE,y.LINEAR_MIPMAP_NEAREST);const ge=h.style.map.terrain&&h.style.map.terrain.getTerrainData(Z),we=ge?Z:null,Se=we?we.posMatrix:h.transform.calculatePosMatrix(Z.toUnwrapped(),F),Ie=As(Se,W||[0,0],de||1,Q,s);x instanceof Wt?E.draw(p,y.TRIANGLES,V,Kt.disabled,S,Ht.disabled,Ie,ge,s.id,x.boundsBuffer,h.quadTriangleIndexBuffer,x.boundsSegments):E.draw(p,y.TRIANGLES,V,C[Z.overscaledZ],S,Ht.disabled,Ie,ge,s.id,h.rasterBoundsBuffer,h.quadTriangleIndexBuffer,h.rasterBoundsSegments)}},background:function(h,t,s,c){const p=s.paint.get("background-color"),y=s.paint.get("background-opacity");if(y===0)return;const x=h.context,E=x.gl,S=h.transform,C=S.tileSize,M=s.paint.get("background-pattern");if(h.isPatternMissing(M))return;const P=!M&&p.a===1&&y===1&&h.opaquePassEnabledForLayer()?"opaque":"translucent";if(h.renderPass!==P)return;const F=Kt.disabled,Z=h.depthModeForSublayer(0,P==="opaque"?Tt.ReadWrite:Tt.ReadOnly),V=h.colorModeForRenderPass(),q=h.useProgram(M?"backgroundPattern":"background"),H=c||S.coveringTiles({tileSize:C,terrain:h.style.map.terrain});M&&(x.activeTexture.set(E.TEXTURE0),h.imageManager.bind(h.context));const Q=s.getCrossfadeParameters();for(const de of H){const W=c?de.posMatrix:h.transform.calculatePosMatrix(de.toUnwrapped()),he=M?va(W,y,h,M,{tileID:de,tileSize:C},Q):ql(W,y,p),ge=h.style.map.terrain&&h.style.map.terrain.getTerrainData(de);q.draw(x,E.TRIANGLES,Z,F,V,Ht.disabled,he,ge,s.id,h.tileExtentBuffer,h.quadTriangleIndexBuffer,h.tileExtentSegments)}},debug:function(h,t,s){for(let c=0;c<s.length;c++)Qc(h,t,s[c])},custom:function(h,t,s){const c=h.context,p=s.implementation;if(h.renderPass==="offscreen"){const y=p.prerender;y&&(h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),y.call(p,c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState())}else if(h.renderPass==="translucent"){h.setCustomLayerDefaults(),c.setColorMode(h.colorModeForRenderPass()),c.setStencilMode(Kt.disabled);const y=p.renderingMode==="3d"?new Tt(h.context.gl.LEQUAL,Tt.ReadWrite,h.depthRangeFor3D):h.depthModeForSublayer(0,Tt.ReadOnly);c.setDepthMode(y),p.render(c.gl,h.transform.customLayerMatrix()),c.setDirty(),h.setBaseState(),c.bindFramebuffer.set(null)}}};class eh{constructor(t,s){this.context=new tu(t),this.transform=s,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.create(),renderTime:0},this.setup(),this.numSublayers=Gt.maxUnderzooming+Gt.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Is}resize(t,s,c){if(this.width=t*c,this.height=s*c,this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style._order)this.style._layers[p].resize()}setup(){const t=this.context,s=new u.PosArray;s.emplaceBack(0,0),s.emplaceBack(u.EXTENT,0),s.emplaceBack(0,u.EXTENT),s.emplaceBack(u.EXTENT,u.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(s,Vo.members),this.tileExtentSegments=u.SegmentVector.simpleSegment(0,0,4,2);const c=new u.PosArray;c.emplaceBack(0,0),c.emplaceBack(u.EXTENT,0),c.emplaceBack(0,u.EXTENT),c.emplaceBack(u.EXTENT,u.EXTENT),this.debugBuffer=t.createVertexBuffer(c,Vo.members),this.debugSegments=u.SegmentVector.simpleSegment(0,0,4,5);const p=new u.RasterBoundsArray;p.emplaceBack(0,0,0,0),p.emplaceBack(u.EXTENT,0,u.EXTENT,0),p.emplaceBack(0,u.EXTENT,0,u.EXTENT),p.emplaceBack(u.EXTENT,u.EXTENT,u.EXTENT,u.EXTENT),this.rasterBoundsBuffer=t.createVertexBuffer(p,Zt.members),this.rasterBoundsSegments=u.SegmentVector.simpleSegment(0,0,4,2);const y=new u.PosArray;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(y,Vo.members),this.viewportSegments=u.SegmentVector.simpleSegment(0,0,4,2);const x=new u.LineStripIndexArray;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=t.createIndexBuffer(x);const E=new u.TriangleIndexArray;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(E);const S=this.context.gl;this.stencilClearMode=new Kt({func:S.ALWAYS,mask:0},0,255,S.ZERO,S.ZERO,S.ZERO)}clearStencil(){const t=this.context,s=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=u.create();u.ortho(c,0,this.width,this.height,0,0,1),u.scale(c,c,[s.drawingBufferWidth,s.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(t,s.TRIANGLES,Tt.disabled,this.stencilClearMode,an.disabled,Ht.disabled,jl(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(t,s){if(this.currentStencilSource===t.source||!t.isTileClipped()||!s||!s.length)return;this.currentStencilSource=t.source;const c=this.context,p=c.gl;this.nextStencilID+s.length>256&&this.clearStencil(),c.setColorMode(an.disabled),c.setDepthMode(Tt.disabled);const y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of s){const E=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,S=this.style.map.terrain&&this.style.map.terrain.getTerrainData(x);y.draw(c,p.TRIANGLES,Tt.disabled,new Kt({func:p.ALWAYS,mask:0},E,255,p.KEEP,p.KEEP,p.REPLACE),an.disabled,Ht.disabled,jl(x.posMatrix),S,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,s=this.context.gl;return new Kt({func:s.NOTEQUAL,mask:255},t,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(t){const s=this.context.gl;return new Kt({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(t){const s=this.context.gl,c=t.sort((x,E)=>E.overscaledZ-x.overscaledZ),p=c[c.length-1].overscaledZ,y=c[0].overscaledZ-p+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const x={};for(let E=0;E<y;E++)x[E+p]=new Kt({func:s.GEQUAL,mask:255},E+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=y,[x,c]}return[{[p]:Kt.disabled},c]}colorModeForRenderPass(){const t=this.context.gl;return this._showOverdrawInspector?new an([t.CONSTANT_COLOR,t.ONE],new u.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?an.unblended:an.alphaBlended}depthModeForSublayer(t,s,c){if(!this.opaquePassEnabledForLayer())return Tt.disabled;const p=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new Tt(c||this.context.gl.LEQUAL,s,[p,p])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,s){this.style=t,this.options=s,this.lineAtlas=t.lineAtlas,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(u.exported.now()),this.imageManager.beginFrame();const c=this.style._order,p=this.style.sourceCaches,y={},x={},E={};for(const S in p){const C=p[S];C.used&&C.prepare(this.context),y[S]=C.getVisibleCoordinates(),x[S]=y[S].slice().reverse(),E[S]=C.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let S=0;S<c.length;S++)if(this.style._layers[c[S]].is3D()){this.opaquePassCutoff=S;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const S=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!u.equals(this.terrainFacilitator.matrix,this.transform.projMatrix)||S.length)&&(u.copy(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(C,M){const P=C.context,F=P.gl,Z=an.unblended,V=new Tt(F.LEQUAL,Tt.ReadWrite,[0,1]),q=M.getTerrainMesh(),H=M.sourceCache.getRenderableTiles(),Q=C.useProgram("terrainDepth");P.bindFramebuffer.set(M.getFramebuffer("depth").framebuffer),P.viewport.set([0,0,C.width/devicePixelRatio,C.height/devicePixelRatio]),P.clear({color:u.Color.transparent,depth:1});for(const de of H){const W=M.getTerrainData(de.tileID),he={u_matrix:C.transform.calculatePosMatrix(de.tileID.toUnwrapped()),u_ele_delta:M.getMeshFrameDelta(C.transform.zoom)};Q.draw(P,F.TRIANGLES,V,Kt.disabled,Z,Ht.backCCW,he,W,"terrain",q.vertexBuffer,q.indexBuffer,q.segments)}P.bindFramebuffer.set(null),P.viewport.set([0,0,C.width,C.height])}(this,this.style.map.terrain),function(C,M){const P=C.context,F=P.gl,Z=an.unblended,V=new Tt(F.LEQUAL,Tt.ReadWrite,[0,1]),q=M.getTerrainMesh(),H=M.getCoordsTexture(),Q=M.sourceCache.getRenderableTiles(),de=C.useProgram("terrainCoords");P.bindFramebuffer.set(M.getFramebuffer("coords").framebuffer),P.viewport.set([0,0,C.width/devicePixelRatio,C.height/devicePixelRatio]),P.clear({color:u.Color.transparent,depth:1}),M.coordsIndex=[];for(const W of Q){const he=M.getTerrainData(W.tileID);P.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,H.texture);const ge={u_matrix:C.transform.calculatePosMatrix(W.tileID.toUnwrapped()),u_terrain_coords_id:(255-M.coordsIndex.length)/255,u_texture:0,u_ele_delta:M.getMeshFrameDelta(C.transform.zoom)};de.draw(P,F.TRIANGLES,V,Kt.disabled,Z,Ht.backCCW,ge,he,"terrain",q.vertexBuffer,q.indexBuffer,q.segments),M.coordsIndex.push(W.tileID.key)}P.bindFramebuffer.set(null),P.viewport.set([0,0,C.width,C.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const S of c){const C=this.style._layers[S];if(!C.hasOffscreenPass()||C.isHidden(this.transform.zoom))continue;const M=x[C.source];(C.type==="custom"||M.length)&&this.renderLayer(this,p[C.source],C,M)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:s.showOverdrawInspector?u.Color.black:u.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.depthRangeFor3D=[0,1-(t._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const S=this.style._layers[c[this.currentLayer]],C=p[S.source],M=y[S.source];this._renderTileClippingMasks(S,M),this.renderLayer(this,C,S,M)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const S=this.style._layers[c[this.currentLayer]],C=p[S.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(S))continue;const M=(S.type==="symbol"?E:x)[S.source];this._renderTileClippingMasks(S,y[S.source]),this.renderLayer(this,C,S,M)}if(this.options.showTileBoundaries){const S=function(C,M){let P=null;const F=Object.values(C._layers).flatMap(H=>H.source&&!H.isHidden(M)?[C.sourceCaches[H.source]]:[]),Z=F.filter(H=>H.getSource().type==="vector"),V=F.filter(H=>H.getSource().type!=="vector"),q=H=>{(!P||P.getSource().maxzoom<H.getSource().maxzoom)&&(P=H)};return Z.forEach(H=>q(H)),P||V.forEach(H=>q(H)),P}(this.style,this.transform.zoom);S&&au.debug(this,S,S.getVisibleCoordinates())}this.options.showPadding&&function(S){const C=S.transform.padding;vo(S,S.transform.height-(C.top||0),3,_o),vo(S,C.bottom||0,3,Xi),Fs(S,C.left||0,3,Yc),Fs(S,S.transform.width-(C.right||0),3,ou);const M=S.transform.centerPoint;(function(P,F,Z,V){Xo(P,F-1,Z-10,2,20,V),Xo(P,F-10,Z-1,20,2,V)})(S,M.x,S.transform.height-M.y,Jc)}(this),this.context.setDefault()}renderLayer(t,s,c,p){c.isHidden(this.transform.zoom)||(c.type==="background"||c.type==="custom"||(p||[]).length)&&(this.id=c.id,au[c.type](t,s,c,p,this.style.placement.variableOffsets))}translatePosMatrix(t,s,c,p,y){if(!c[0]&&!c[1])return t;const x=y?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(x){const C=Math.sin(x),M=Math.cos(x);c=[c[0]*M-c[1]*C,c[0]*C+c[1]*M]}const E=[y?c[0]:ye(s,c[0],this.transform.zoom),y?c[1]:ye(s,c[1],this.transform.zoom),0],S=new Float32Array(16);return u.translate(S,t,E),S}saveTileTexture(t){const s=this._tileTextures[t.size[0]];s?s.push(t):this._tileTextures[t.size[0]]=[t]}getTileTexture(t){const s=this._tileTextures[t];return s&&s.length>0?s.pop():null}isPatternMissing(t){if(!t)return!1;if(!t.from||!t.to)return!0;const s=this.imageManager.getPattern(t.from.toString()),c=this.imageManager.getPattern(t.to.toString());return!s||!c}useProgram(t,s){this.cache=this.cache||{};const c=t+(s?s.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new ip(this.context,t,Wi[t],s,xa[t],this._showOverdrawInspector,this.style.map.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const t=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(t.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new _t(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}}class Pa{constructor(t,s){this.points=t,this.planes=s}static fromInvProjectionMatrix(t,s,c){const p=Math.pow(2,c),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const S=1/(E=u.transformMat4([],E,t))[3]/s*p;return u.mul$1(E,E,[S,S,1/E[3],S])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const S=function(F,Z){var V=Z[0],q=Z[1],H=Z[2],Q=V*V+q*q+H*H;return Q>0&&(Q=1/Math.sqrt(Q)),F[0]=Z[0]*Q,F[1]=Z[1]*Q,F[2]=Z[2]*Q,F}([],function(F,Z,V){var q=Z[0],H=Z[1],Q=Z[2],de=V[0],W=V[1],he=V[2];return F[0]=H*he-Q*W,F[1]=Q*de-q*he,F[2]=q*W-H*de,F}([],Ae([],y[E[0]],y[E[1]]),Ae([],y[E[2]],y[E[1]]))),C=-((M=S)[0]*(P=y[E[1]])[0]+M[1]*P[1]+M[2]*P[2]);var M,P;return S.concat(C)});return new Pa(y,x)}}class vr{constructor(t,s){this.min=t,this.max=s,this.center=function(c,p,y){return c[0]=.5*p[0],c[1]=.5*p[1],c[2]=.5*p[2],c}([],function(c,p,y){return c[0]=p[0]+y[0],c[1]=p[1]+y[1],c[2]=p[2]+y[2],c}([],this.min,this.max))}quadrant(t){const s=[t%2==0,t<2],c=Ze(this.min),p=Ze(this.max);for(let y=0;y<s.length;y++)c[y]=s[y]?this.min[y]:this.center[y],p[y]=s[y]?this.center[y]:this.max[y];return p[2]=this.max[2],new vr(c,p)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}intersects(t){const s=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let p=0;p<t.planes.length;p++){const y=t.planes[p];let x=0;for(let E=0;E<s.length;E++)u.dot(y,s[E])>=0&&x++;if(x===0)return 0;x!==s.length&&(c=!1)}if(c)return 2;for(let p=0;p<3;p++){let y=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let E=0;E<t.points.length;E++){const S=t.points[E][p]-this.min[p];y=Math.min(y,S),x=Math.max(x,S)}if(x<0||y>this.max[p]-this.min[p])return 0}return 1}}class Ma{constructor(t=0,s=0,c=0,p=0){if(isNaN(t)||t<0||isNaN(s)||s<0||isNaN(c)||c<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=t,this.bottom=s,this.left=c,this.right=p}interpolate(t,s,c){return s.top!=null&&t.top!=null&&(this.top=u.interpolate.number(t.top,s.top,c)),s.bottom!=null&&t.bottom!=null&&(this.bottom=u.interpolate.number(t.bottom,s.bottom,c)),s.left!=null&&t.left!=null&&(this.left=u.interpolate.number(t.left,s.left,c)),s.right!=null&&t.right!=null&&(this.right=u.interpolate.number(t.right,s.right,c)),this}getCenter(t,s){const c=u.clamp((this.left+t-this.right)/2,0,t),p=u.clamp((this.top+s-this.bottom)/2,0,s);return new u.Point(c,p)}equals(t){return this.top===t.top&&this.bottom===t.bottom&&this.left===t.left&&this.right===t.right}clone(){return new Ma(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class Aa{constructor(t,s,c,p,y){this.tileSize=512,this.maxValidLatitude=85.051129,this.freezeElevation=!1,this._renderWorldCopies=y===void 0||!!y,this._minZoom=t||0,this._maxZoom=s||22,this._minPitch=c??0,this._maxPitch=p??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.LngLat(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Ma,this._posMatrixCache={},this._alignedPosMatrixCache={}}clone(){const t=new Aa(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return t.apply(this),t}apply(t){this.tileSize=t.tileSize,this.latRange=t.latRange,this.width=t.width,this.height=t.height,this._center=t._center,this._elevation=t._elevation,this.zoom=t.zoom,this.angle=t.angle,this._fov=t._fov,this._pitch=t._pitch,this._unmodified=t._unmodified,this._edgeInsets=t._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(t){this._minZoom!==t&&(this._minZoom=t,this.zoom=Math.max(this.zoom,t))}get maxZoom(){return this._maxZoom}set maxZoom(t){this._maxZoom!==t&&(this._maxZoom=t,this.zoom=Math.min(this.zoom,t))}get minPitch(){return this._minPitch}set minPitch(t){this._minPitch!==t&&(this._minPitch=t,this.pitch=Math.max(this.pitch,t))}get maxPitch(){return this._maxPitch}set maxPitch(t){this._maxPitch!==t&&(this._maxPitch=t,this.pitch=Math.min(this.pitch,t))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(t){t===void 0?t=!0:t===null&&(t=!1),this._renderWorldCopies=t}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.Point(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(t){const s=-u.wrap(t,-180,180)*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=function(){var c=new u.ARRAY_TYPE(4);return u.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c}(),function(c,p,y){var x=p[0],E=p[1],S=p[2],C=p[3],M=Math.sin(y),P=Math.cos(y);c[0]=x*P+S*M,c[1]=E*P+C*M,c[2]=x*-M+S*P,c[3]=E*-M+C*P}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const s=u.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=t/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(t){const s=Math.min(Math.max(t,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._zoom=s,this.tileZoom=Math.max(0,Math.floor(s)),this.scale=this.zoomScale(s),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(t){t.lat===this._center.lat&&t.lng===this._center.lng||(this._unmodified=!1,this._center=t,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(t){t!==this._elevation&&(this._elevation=t,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(t){this._edgeInsets.equals(t)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,t,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(t){return this._edgeInsets.equals(t)}interpolatePadding(t,s,c){this._unmodified=!1,this._edgeInsets.interpolate(t,s,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(t){const s=(t.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/t.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(t){const s=[new u.UnwrappedTileID(0,t)];if(this._renderWorldCopies){const c=this.pointCoordinate(new u.Point(0,0)),p=this.pointCoordinate(new u.Point(this.width,0)),y=this.pointCoordinate(new u.Point(this.width,this.height)),x=this.pointCoordinate(new u.Point(0,this.height)),E=Math.floor(Math.min(c.x,p.x,y.x,x.x)),S=Math.floor(Math.max(c.x,p.x,y.x,x.x)),C=1;for(let M=E-C;M<=S+C;M++)M!==0&&s.push(new u.UnwrappedTileID(M,t))}return s}coveringTiles(t){var s,c;let p=this.coveringZoomLevel(t);const y=p;if(t.minzoom!==void 0&&p<t.minzoom)return[];t.maxzoom!==void 0&&p>t.maxzoom&&(p=t.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),E=u.MercatorCoordinate.fromLngLat(this.center),S=Math.pow(2,p),C=[S*x.x,S*x.y,0],M=[S*E.x,S*E.y,0],P=Pa.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,p);let F=t.minzoom||0;!t.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(F=p);const Z=t.terrain?2/Math.min(this.tileSize,t.tileSize)*this.tileSize:3,V=W=>({aabb:new vr([W*S,0,0],[(W+1)*S,S,0]),zoom:0,x:0,y:0,wrap:W,fullyVisible:!1}),q=[],H=[],Q=p,de=t.reparseOverscaled?y:p;if(this._renderWorldCopies)for(let W=1;W<=3;W++)q.push(V(-W)),q.push(V(W));for(q.push(V(0));q.length>0;){const W=q.pop(),he=W.x,ge=W.y;let we=W.fullyVisible;if(!we){const rt=W.aabb.intersects(P);if(rt===0)continue;we=rt===2}const Se=t.terrain?C:M,Ie=W.aabb.distanceX(Se),be=W.aabb.distanceY(Se),je=Math.max(Math.abs(Ie),Math.abs(be));if(W.zoom===Q||je>Z+(1<<Q-W.zoom)-2&&W.zoom>=F){const rt=Q-W.zoom,ft=C[0]-.5-(he<<rt),De=C[1]-.5-(ge<<rt);H.push({tileID:new u.OverscaledTileID(W.zoom===Q?de:W.zoom,W.wrap,W.zoom,he,ge),distanceSq:We([M[0]-.5-he,M[1]-.5-ge]),tileDistanceToCamera:Math.sqrt(ft*ft+De*De)})}else for(let rt=0;rt<4;rt++){const ft=(he<<1)+rt%2,De=(ge<<1)+(rt>>1),ut=W.zoom+1;let Ge=W.aabb.quadrant(rt);if(t.terrain){const zt=new u.OverscaledTileID(ut,W.wrap,ut,ft,De),_n=t.terrain.getMinMaxElevation(zt),Dt=(s=_n.minElevation)!==null&&s!==void 0?s:this.elevation,yt=(c=_n.maxElevation)!==null&&c!==void 0?c:this.elevation;Ge=new vr([Ge.min[0],Ge.min[1],Dt],[Ge.max[0],Ge.max[1],yt])}q.push({aabb:Ge,zoom:ut,x:ft,y:De,wrap:W.wrap,fullyVisible:we})}}return H.sort((W,he)=>W.distanceSq-he.distanceSq).map(W=>W.tileID)}resize(t,s){this.width=t,this.height=s,this.pixelsToGLUnits=[2/t,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(t){return Math.pow(2,t)}scaleZoom(t){return Math.log(t)/Math.LN2}project(t){const s=u.clamp(t.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.Point(u.mercatorXfromLng(t.lng)*this.worldSize,u.mercatorYfromLat(s)*this.worldSize)}unproject(t){return new u.MercatorCoordinate(t.x/this.worldSize,t.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}updateElevation(t){this.freezeElevation||(this.elevation=t?this.getElevation(this._center,t):0)}getElevation(t,s){const c=u.MercatorCoordinate.fromLngLat(t.wrap()),p=(1<<this.tileZoom)*u.EXTENT,y=c.x*p,x=c.y*p,E=Math.floor(y/u.EXTENT),S=Math.floor(x/u.EXTENT),C=new u.OverscaledTileID(this.tileZoom,0,this.tileZoom,E,S);return s.getElevation(C,y%u.EXTENT,x%u.EXTENT,u.EXTENT)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(t){const s=this.pointLocation(this.centerPoint,t),c=this.getElevation(s,t);if(!(this.elevation-c))return;const p=this.getCameraPosition(),y=u.MercatorCoordinate.fromLngLat(p.lngLat,p.altitude),x=u.MercatorCoordinate.fromLngLat(s,c),E=y.x-x.x,S=y.y-x.y,C=y.z-x.z,M=Math.sqrt(E*E+S*S+C*C),P=this.scaleZoom(this.cameraToCenterDistance/M/this.tileSize);this._elevation=c,this._center=s,this.zoom=P}setLocationAtPoint(t,s){const c=this.pointCoordinate(s),p=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(t),x=new u.MercatorCoordinate(y.x-(c.x-p.x),y.y-(c.y-p.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(t,s){return s?this.coordinatePoint(this.locationCoordinate(t),this.getElevation(t,s),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(t))}pointLocation(t,s){return this.coordinateLocation(this.pointCoordinate(t,s))}locationCoordinate(t){return u.MercatorCoordinate.fromLngLat(t)}coordinateLocation(t){return t&&t.toLngLat()}pointCoordinate(t,s){if(s){const F=s.pointCoordinate(t);if(F!=null)return F}const c=[t.x,t.y,0,1],p=[t.x,t.y,1,1];u.transformMat4(c,c,this.pixelMatrixInverse),u.transformMat4(p,p,this.pixelMatrixInverse);const y=c[3],x=p[3],E=c[1]/y,S=p[1]/x,C=c[2]/y,M=p[2]/x,P=C===M?0:(0-C)/(M-C);return new u.MercatorCoordinate(u.interpolate.number(c[0]/y,p[0]/x,P)/this.worldSize,u.interpolate.number(E,S,P)/this.worldSize)}coordinatePoint(t,s=0,c=this.pixelMatrix){const p=[t.x*this.worldSize,t.y*this.worldSize,s,1];return u.transformMat4(p,p,c),new u.Point(p[0]/p[3],p[1]/p[3])}getBounds(){const t=Math.max(0,this.height/2-this.getHorizon());return new Ut().extend(this.pointLocation(new u.Point(0,t))).extend(this.pointLocation(new u.Point(this.width,t))).extend(this.pointLocation(new u.Point(this.width,this.height))).extend(this.pointLocation(new u.Point(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new Ut([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(t){t?(this.lngRange=[t.getWest(),t.getEast()],this.latRange=[t.getSouth(),t.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(t,s=!1){const c=t.key,p=s?this._alignedPosMatrixCache:this._posMatrixCache;if(p[c])return p[c];const y=t.canonical,x=this.worldSize/this.zoomScale(y.z),E=y.x+Math.pow(2,y.z)*t.wrap,S=u.identity(new Float64Array(16));return u.translate(S,S,[E*x,y.y*x,0]),u.scale(S,S,[x/u.EXTENT,x/u.EXTENT,1]),u.multiply(S,s?this.alignedProjMatrix:this.projMatrix,S),p[c]=new Float32Array(S),p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let t,s,c,p,y=-90,x=90,E=-180,S=180;const C=this.size,M=this._unmodified;if(this.latRange){const Z=this.latRange;y=u.mercatorYfromLat(Z[1])*this.worldSize,x=u.mercatorYfromLat(Z[0])*this.worldSize,t=x-y<C.y?C.y/(x-y):0}if(this.lngRange){const Z=this.lngRange;E=u.wrap(u.mercatorXfromLng(Z[0])*this.worldSize,0,this.worldSize),S=u.wrap(u.mercatorXfromLng(Z[1])*this.worldSize,0,this.worldSize),S<E&&(S+=this.worldSize),s=S-E<C.x?C.x/(S-E):0}const P=this.point,F=Math.max(s||0,t||0);if(F)return this.center=this.unproject(new u.Point(s?(S+E)/2:P.x,t?(x+y)/2:P.y)),this.zoom+=this.scaleZoom(F),this._unmodified=M,void(this._constraining=!1);if(this.latRange){const Z=P.y,V=C.y/2;Z-V<y&&(p=y+V),Z+V>x&&(p=x-V)}if(this.lngRange){const Z=(E+S)/2,V=u.wrap(P.x,Z-this.worldSize/2,Z+this.worldSize/2),q=C.x/2;V-q<E&&(c=E+q),V+q>S&&(c=S-q)}c===void 0&&p===void 0||(this.center=this.unproject(new u.Point(c!==void 0?c:P.x,p!==void 0?p:P.y)).wrap()),this._unmodified=M,this._constraining=!1}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,s=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.mercatorZfromAltitude(1,this.center.lat)*this.worldSize;let p=u.identity(new Float64Array(16));u.scale(p,p,[this.width/2,-this.height/2,1]),u.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=u.identity(new Float64Array(16)),u.scale(p,p,[1,-1,1]),u.translate(p,p,[-1,-1,0]),u.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.cameraToSeaLevelDistance=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch);const y=this._elevation<0?this.cameraToCenterDistance:this.cameraToSeaLevelDistance,x=Math.PI/2+this._pitch,E=this._fov*(.5+t.y/this.height),S=Math.sin(E)*y/Math.sin(u.clamp(Math.PI-x-E,.01,Math.PI-.01)),C=this.getHorizon(),M=2*Math.atan(C/this.cameraToCenterDistance)*(.5+t.y/(2*C)),P=Math.sin(M)*y/Math.sin(u.clamp(Math.PI-x-M,.01,Math.PI-.01)),F=Math.min(S,P),Z=1.01*(Math.cos(Math.PI/2-this._pitch)*F+y),V=this.height/50;p=new Float64Array(16),u.perspective(p,this._fov,this.width/this.height,V,Z),p[8]=2*-t.x/this.width,p[9]=2*t.y/this.height,u.scale(p,p,[1,-1,1]),u.translate(p,p,[0,0,-this.cameraToCenterDistance]),u.rotateX(p,p,this._pitch),u.rotateZ(p,p,this.angle),u.translate(p,p,[-s,-c,0]),this.mercatorMatrix=u.scale([],p,[this.worldSize,this.worldSize,this.worldSize]),u.scale(p,p,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.multiply(new Float64Array(16),this.labelPlaneMatrix,p),u.translate(p,p,[0,0,-this.elevation]),this.projMatrix=p,this.invProjMatrix=u.invert([],p),this.pixelMatrix3D=u.multiply(new Float64Array(16),this.labelPlaneMatrix,p);const q=this.width%2/2,H=this.height%2/2,Q=Math.cos(this.angle),de=Math.sin(this.angle),W=s-Math.round(s)+Q*q+de*H,he=c-Math.round(c)+Q*H+de*q,ge=new Float64Array(p);if(u.translate(ge,ge,[W>.5?W-1:W,he>.5?he-1:he,0]),this.alignedProjMatrix=ge,p=u.invert(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");this.pixelMatrixInverse=p,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const t=this.pointCoordinate(new u.Point(0,0)),s=[t.x*this.worldSize,t.y*this.worldSize,0,1];return u.transformMat4(s,s,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.Point(0,t))}getCameraQueryGeometry(t){const s=this.getCameraPoint();if(t.length===1)return[t[0],s];{let c=s.x,p=s.y,y=s.x,x=s.y;for(const E of t)c=Math.min(c,E.x),p=Math.min(p,E.y),y=Math.max(y,E.x),x=Math.max(x,E.y);return[new u.Point(c,p),new u.Point(y,p),new u.Point(y,x),new u.Point(c,x),new u.Point(c,p)]}}}class th{constructor(t){this._hashName=t&&encodeURIComponent(t),u.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=function(s,c){let p=!1,y=null;const x=()=>{y=null,p&&(s(),y=setTimeout(x,300),p=!1)};return()=>(p=!0,y||x(),y)}(this._updateHashUnthrottled.bind(this))}addTo(t){return this._map=t,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(t){const s=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,p=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,p),x=Math.round(s.lng*y)/y,E=Math.round(s.lat*y)/y,S=this._map.getBearing(),C=this._map.getPitch();let M="";if(M+=t?`/${x}/${E}/${c}`:`${c}/${E}/${x}`,(S||C)&&(M+="/"+Math.round(10*S)/10),C&&(M+=`/${Math.round(C)}`),this._hashName){const P=this._hashName;let F=!1;const Z=window.location.hash.slice(1).split("&").map(V=>{const q=V.split("=")[0];return q===P?(F=!0,`${q}=${M}`):V}).filter(V=>V);return F||Z.push(`${P}=${M}`),`#${Z.join("&")}`}return`#${M}`}_getCurrentHash(){const t=window.location.hash.replace("#","");if(this._hashName){let s;return t.split("&").map(c=>c.split("=")).forEach(c=>{c[0]===this._hashName&&(s=c)}),(s&&s[1]||"").split("/")}return t.split("/")}_onHashChange(){const t=this._getCurrentHash();if(t.length>=3&&!t.some(s=>isNaN(s))){const s=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(t[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:s,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,t)}catch{}}}const Os={linearity:.3,easing:u.bezier(0,0,.3,1)},nh=u.extend({deceleration:2500,maxSpeed:1400},Os),ih=u.extend({deceleration:20,maxSpeed:1400},Os),Us=u.extend({deceleration:1e3,maxSpeed:360},Os),rh=u.extend({deceleration:1e3,maxSpeed:90},Os);class xr{constructor(t){this._map=t,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,s=u.exported.now();for(;t.length>0&&s-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const s={zoom:0,bearing:0,pitch:0,pan:new u.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)s.zoom+=y.zoomDelta||0,s.bearing+=y.bearingDelta||0,s.pitch+=y.pitchDelta||0,y.panDelta&&s.pan._add(y.panDelta),y.around&&(s.around=y.around),y.pinchAround&&(s.pinchAround=y.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,p={};if(s.pan.mag()){const y=Ns(s.pan.mag(),c,u.extend({},nh,t||{}));p.offset=s.pan.mult(y.amount/s.pan.mag()),p.center=this._map.transform.center,Hi(p,y)}if(s.zoom){const y=Ns(s.zoom,c,ih);p.zoom=this._map.transform.zoom+y.amount,Hi(p,y)}if(s.bearing){const y=Ns(s.bearing,c,Us);p.bearing=this._map.transform.bearing+u.clamp(y.amount,-179,179),Hi(p,y)}if(s.pitch){const y=Ns(s.pitch,c,rh);p.pitch=this._map.transform.pitch+y.amount,Hi(p,y)}if(p.zoom||p.bearing){const y=s.pinchAround===void 0?s.around:s.pinchAround;p.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),u.extend(p,{noMoveStart:!0})}}function Hi(h,t){(!h.duration||h.duration<t.duration)&&(h.duration=t.duration,h.easing=t.easing)}function Ns(h,t,s){const{maxSpeed:c,linearity:p,deceleration:y}=s,x=u.clamp(h*p/(t/1e3),-c,c),E=Math.abs(x)/(y*p);return{easing:s.easing,duration:1e3*E,amount:x*(E/2)}}class Cn extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,c,p={}){const y=D.mousePos(s.getCanvasContainer(),c),x=s.unproject(y);super(t,u.extend({point:y,lngLat:x,originalEvent:c},p)),this._defaultPrevented=!1,this.target=s}}class io extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,c){const p=t==="touchend"?c.changedTouches:c.touches,y=D.touchPos(s.getCanvasContainer(),p),x=y.map(S=>s.unproject(S)),E=y.reduce((S,C,M,P)=>S.add(C.div(P.length)),new u.Point(0,0));super(t,{points:y,point:E,lngLats:x,lngLat:s.unproject(E),originalEvent:c}),this._defaultPrevented=!1}}class gp extends u.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,s,c){super(t,{originalEvent:c}),this._defaultPrevented=!1}}class yp{constructor(t,s){this._map=t,this._clickTolerance=s.clickTolerance}reset(){delete this._mousedownPos}wheel(t){return this._firePreventable(new gp(t.type,this._map,t))}mousedown(t,s){return this._mousedownPos=s,this._firePreventable(new Cn(t.type,this._map,t))}mouseup(t){this._map.fire(new Cn(t.type,this._map,t))}click(t,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||this._map.fire(new Cn(t.type,this._map,t))}dblclick(t){return this._firePreventable(new Cn(t.type,this._map,t))}mouseover(t){this._map.fire(new Cn(t.type,this._map,t))}mouseout(t){this._map.fire(new Cn(t.type,this._map,t))}touchstart(t){return this._firePreventable(new io(t.type,this._map,t))}touchmove(t){this._map.fire(new io(t.type,this._map,t))}touchend(t){this._map.fire(new io(t.type,this._map,t))}touchcancel(t){this._map.fire(new io(t.type,this._map,t))}_firePreventable(t){if(this._map.fire(t),t.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _p{constructor(t){this._map=t}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(t){this._map.fire(new Cn(t.type,this._map,t))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Cn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(t){this._delayContextMenu?this._contextMenuEvent=t:this._ignoreContextMenu||this._map.fire(new Cn(t.type,this._map,t)),this._map.listens("contextmenu")&&t.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ho{constructor(t){this._map=t}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(t){return this.transform.pointLocation(u.Point.convert(t),this._map.terrain)}}class Vs{constructor(t,s){this._map=t,this._tr=new Ho(t),this._el=t.getCanvasContainer(),this._container=t.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(t,s){this.isEnabled()&&t.shiftKey&&t.button===0&&(D.disableDrag(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(t,s){if(!this._active)return;const c=s;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const p=this._startPos;this._lastPos=c,this._box||(this._box=D.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",t));const y=Math.min(p.x,c.x),x=Math.max(p.x,c.x),E=Math.min(p.y,c.y),S=Math.max(p.y,c.y);D.setTransform(this._box,`translate(${y}px,${E}px)`),this._box.style.width=x-y+"px",this._box.style.height=S-E+"px"}mouseupWindow(t,s){if(!this._active||t.button!==0)return;const c=this._startPos,p=s;if(this.reset(),D.suppressClick(),c.x!==p.x||c.y!==p.y)return this._map.fire(new u.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:y=>y.fitScreenCoordinates(c,p,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",t)}keydown(t){this._active&&t.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",t))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(t,s){return this._map.fire(new u.Event(t,{originalEvent:s}))}}function wr(h,t){if(h.length!==t.length)throw new Error(`The number of touches and points are not equal - touches ${h.length}, points ${t.length}`);const s={};for(let c=0;c<h.length;c++)s[h[c].identifier]=t[c];return s}class Ke{constructor(t){this.reset(),this.numTouches=t.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(t,s,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=t.timeStamp),c.length===this.numTouches&&(this.centroid=function(p){const y=new u.Point(0,0);for(const x of p)y._add(x);return y.div(p.length)}(s),this.touches=wr(c,s)))}touchmove(t,s,c){if(this.aborted||!this.centroid)return;const p=wr(c,s);for(const y in this.touches){const x=p[y];(!x||x.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(t,s,c){if((!this.centroid||t.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const p=!this.aborted&&this.centroid;if(this.reset(),p)return p}}}class za{constructor(t){this.singleTap=new Ke(t),this.numTaps=t.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(t,s,c){this.singleTap.touchstart(t,s,c)}touchmove(t,s,c){this.singleTap.touchmove(t,s,c)}touchend(t,s,c){const p=this.singleTap.touchend(t,s,c);if(p){const y=t.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(p)<30;if(y&&x||this.reset(),this.count++,this.lastTime=t.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}}}class $s{constructor(t){this._tr=new Ho(t),this._zoomIn=new za({numTouches:1,numTaps:2}),this._zoomOut=new za({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(t,s,c){this._zoomIn.touchstart(t,s,c),this._zoomOut.touchstart(t,s,c)}touchmove(t,s,c){this._zoomIn.touchmove(t,s,c),this._zoomOut.touchmove(t,s,c)}touchend(t,s,c){const p=this._zoomIn.touchend(t,s,c),y=this._zoomOut.touchend(t,s,c),x=this._tr;return p?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(p)},{originalEvent:t})}):y?(this._active=!0,t.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(y)},{originalEvent:t})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fr{constructor(t){this._enabled=!!t.enable,this._moveStateManager=t.moveStateManager,this._clickTolerance=t.clickTolerance||1,this._moveFunction=t.move,this._activateOnStart=!!t.activateOnStart,t.assignEvents(this),this.reset()}reset(t){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(t)}_move(...t){const s=this._moveFunction(...t);if(s.bearingDelta||s.pitchDelta||s.around||s.panDelta)return this._active=!0,s}dragStart(t,s){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(t)&&(this._moveStateManager.startMove(t),this._lastPoint=s.length?s[0]:s,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(t,s){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(t.preventDefault(),!this._moveStateManager.isValidMoveEvent(t))return void this.reset(t);const p=s.length?s[0]:s;return!this._moved&&p.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=p,this._move(c,p))}dragEnd(t){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(t)&&(this._moved&&D.suppressClick(),this.reset(t))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const oh={0:1,2:2};class Ue{constructor(t){this._correctEvent=t.checkCorrectEvent}startMove(t){const s=D.mouseButton(t);this._eventButton=s}endMove(t){delete this._eventButton}isValidStartEvent(t){return this._correctEvent(t)}isValidMoveEvent(t){return!function(s,c){const p=oh[c];return s.buttons===void 0||(s.buttons&p)!==p}(t,this._eventButton)}isValidEndEvent(t){return D.mouseButton(t)===this._eventButton}}class Da{constructor(){this._firstTouch=void 0}_isOneFingerTouch(t){return t.targetTouches.length===1}_isSameTouchEvent(t){return t.targetTouches[0].identifier===this._firstTouch}startMove(t){this._firstTouch=t.targetTouches[0].identifier}endMove(t){delete this._firstTouch}isValidStartEvent(t){return this._isOneFingerTouch(t)}isValidMoveEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}isValidEndEvent(t){return this._isOneFingerTouch(t)&&this._isSameTouchEvent(t)}}const lu=h=>{h.mousedown=h.dragStart,h.mousemoveWindow=h.dragMove,h.mouseup=h.dragEnd,h.contextmenu=function(t){t.preventDefault()}},sh=({enable:h,clickTolerance:t,bearingDegreesPerPixelMoved:s=.8})=>{const c=new Ue({checkCorrectEvent:p=>D.mouseButton(p)===0&&p.ctrlKey||D.mouseButton(p)===2});return new Fr({clickTolerance:t,move:(p,y)=>({bearingDelta:(y.x-p.x)*s}),moveStateManager:c,enable:h,assignEvents:lu})},La=({enable:h,clickTolerance:t,pitchDegreesPerPixelMoved:s=-.5})=>{const c=new Ue({checkCorrectEvent:p=>D.mouseButton(p)===0&&p.ctrlKey||D.mouseButton(p)===2});return new Fr({clickTolerance:t,move:(p,y)=>({pitchDelta:(y.y-p.y)*s}),moveStateManager:c,enable:h,assignEvents:lu})};class ah{constructor(t,s){this._minTouches=t.cooperativeGestures?2:1,this._clickTolerance=t.clickTolerance||1,this._map=s,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.Point(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(t,s,c){return this._calculateTransform(t,s,c)}touchmove(t,s,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(t,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return t.preventDefault(),this._calculateTransform(t,s,c)}touchend(t,s,c){this._calculateTransform(t,s,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,s,c){c.length>0&&(this._active=!0);const p=wr(c,s),y=new u.Point(0,0),x=new u.Point(0,0);let E=0;for(const C in p){const M=p[C],P=this._touches[C];P&&(y._add(M),x._add(M.sub(P)),E++,p[C]=M)}if(this._touches=p,E<this._minTouches||!x.mag())return;const S=x.div(E);return this._sum._add(S),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(E),panDelta:S}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ra{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(t){}_move(t,s,c){return{}}touchstart(t,s,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([s[0],s[1]]))}touchmove(t,s,c){if(!this._firstTwoTouches)return;t.preventDefault();const[p,y]=this._firstTwoTouches,x=Ba(c,s,p),E=Ba(c,s,y);if(!x||!E)return;const S=this._aroundCenter?null:x.add(E).div(2);return this._move([x,E],S,t)}touchend(t,s,c){if(!this._firstTwoTouches)return;const[p,y]=this._firstTwoTouches,x=Ba(c,s,p),E=Ba(c,s,y);x&&E||(this._active&&D.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(t){this._enabled=!0,this._aroundCenter=!!t&&t.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ba(h,t,s){for(let c=0;c<h.length;c++)if(h[c].identifier===s)return t[c]}function lh(h,t){return Math.log(h/t)/Math.LN2}class uu extends Ra{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(t){this._startDistance=this._distance=t[0].dist(t[1])}_move(t,s){const c=this._distance;if(this._distance=t[0].dist(t[1]),this._active||!(Math.abs(lh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:lh(this._distance,c),pinchAround:s}}}function Fa(h,t){return 180*h.angleWith(t)/Math.PI}class cu extends Ra{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(t){this._startVector=this._vector=t[0].sub(t[1]),this._minDiameter=t[0].dist(t[1])}_move(t,s){const c=this._vector;if(this._vector=t[0].sub(t[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:Fa(this._vector,c),pinchAround:s}}_isBelowThreshold(t){this._minDiameter=Math.min(this._minDiameter,t.mag());const s=25/(Math.PI*this._minDiameter)*360,c=Fa(t,this._startVector);return Math.abs(c)<s}}function js(h){return Math.abs(h.y)>Math.abs(h.x)}class Ei extends Ra{constructor(t){super(),this._map=t}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(t,s,c){super.touchstart(t,s,c),this._currentTouchCount=c.length}_start(t){this._lastPoints=t,js(t[0].sub(t[1]))&&(this._valid=!1)}_move(t,s,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const p=t[0].sub(this._lastPoints[0]),y=t[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(p,y,c.timeStamp),this._valid?(this._lastPoints=t,this._active=!0,{pitchDelta:(p.y+y.y)/2*-.5}):void 0}gestureBeginsVertically(t,s,c){if(this._valid!==void 0)return this._valid;const p=t.mag()>=2,y=s.mag()>=2;if(!p&&!y)return;if(!p||!y)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const x=t.y>0==s.y>0;return js(t)&&js(s)&&x}}const ro={panStep:100,bearingStep:15,pitchStep:10};class uh{constructor(t){this._tr=new Ho(t);const s=ro;this._panStep=s.panStep,this._bearingStep=s.bearingStep,this._pitchStep=s.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(t){if(t.altKey||t.ctrlKey||t.metaKey)return;let s=0,c=0,p=0,y=0,x=0;switch(t.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:t.shiftKey?c=-1:(t.preventDefault(),y=-1);break;case 39:t.shiftKey?c=1:(t.preventDefault(),y=1);break;case 38:t.shiftKey?p=1:(t.preventDefault(),x=-1);break;case 40:t.shiftKey?p=-1:(t.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(c=0,p=0),{cameraAnimation:E=>{const S=this._tr;E.easeTo({duration:300,easeId:"keyboardHandler",easing:hu,zoom:s?Math.round(S.zoom)+s*(t.shiftKey?2:1):S.zoom,bearing:S.bearing+c*this._bearingStep,pitch:S.pitch+p*this._pitchStep,offset:[-y*this._panStep,-x*this._panStep],center:S.center},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function hu(h){return h*(2-h)}const Oa=4.000244140625;class du{constructor(t,s){this._map=t,this._tr=new Ho(t),this._el=t.getCanvasContainer(),this._handler=s,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,u.bindAll(["_onTimeout"],this)}setZoomRate(t){this._defaultZoomRate=t}setWheelZoomRate(t){this._wheelZoomRate=t}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(t){this.isEnabled()||(this._enabled=!0,this._aroundCenter=t&&t.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!t[this._map._metaKey])return;t.preventDefault()}let s=t.deltaMode===WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const c=u.exported.now(),p=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,s!==0&&s%Oa==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=s,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(p*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),t.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=t,this._delta-=s,this._active||this._start(t)),t.preventDefault()}_onTimeout(t){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(t)}_start(t){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=D.mousePos(this._el,t),c=this._tr;this._around=u.LngLat.convert(this._aroundCenter?c.center:c.unproject(s)),this._aroundPoint=c.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const t=this._tr.transform;if(this._delta!==0){const E=this._type==="wheel"&&Math.abs(this._delta)>Oa?this._wheelZoomRate:this._defaultZoomRate;let S=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&S!==0&&(S=1/S);const C=typeof this._targetZoom=="number"?t.zoomScale(this._targetZoom):t.scale;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(C*S))),this._type==="wheel"&&(this._startZoom=t.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const s=typeof this._targetZoom=="number"?this._targetZoom:t.zoom,c=this._startZoom,p=this._easing;let y,x=!1;if(this._type==="wheel"&&c&&p){const E=Math.min((u.exported.now()-this._lastWheelEventTime)/200,1),S=p(E);y=u.interpolate.number(c,s,S),E<1?this._frameId||(this._frameId=!0):x=!0}else y=s,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:y-t.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let s=u.ease;if(this._prevEase){const c=this._prevEase,p=(u.exported.now()-c.start)/c.duration,y=c.easing(p+.01)-c.easing(p),x=.27/Math.sqrt(y*y+1e-4)*.01,E=Math.sqrt(.0729-x*x);s=u.bezier(x,E,.25,1)}return this._prevEase={start:u.exported.now(),duration:t,easing:s},s}reset(){this._active=!1}}class ch{constructor(t,s){this._clickZoom=t,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ki{constructor(t){this._tr=new Ho(t),this.reset()}reset(){this._active=!1}dblclick(t,s){return t.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(t.shiftKey?-1:1),around:this._tr.unproject(s)},{originalEvent:t})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class tn{constructor(){this._tap=new za({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(t,s,c){this._swipePoint||(this._tapTime&&t.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?c.length>0&&(this._swipePoint=s[0],this._swipeTouch=c[0].identifier):this._tap.touchstart(t,s,c))}touchmove(t,s,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const p=s[0],y=p.y-this._swipePoint.y;return this._swipePoint=p,t.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(t,s,c)}touchend(t,s,c){this._tapTime?this._swipePoint&&c.length===0&&this.reset():this._tap.touchend(t,s,c)&&(this._tapTime=t.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ua{constructor(t,s,c){this._el=t,this._mousePan=s,this._touchPan=c}enable(t){this._inertiaOptions=t||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class pu{constructor(t,s,c){this._pitchWithRotate=t.pitchWithRotate,this._mouseRotate=s,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class hh{constructor(t,s,c,p){this._el=t,this._touchZoom=s,this._touchRotate=c,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0}enable(t){this._touchZoom.enable(t),this._rotationDisabled||this._touchRotate.enable(t),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const qs=h=>h.zoom||h.drag||h.pitch||h.rotate;class dh extends u.Event{}function fu(h){return h.panDelta&&h.panDelta.mag()||h.zoomDelta||h.bearingDelta||h.pitchDelta}class br{constructor(t,s){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xr(t),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(s),u.bindAll(["handleEvent","handleWindowEvent"],this);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[p,y,x]of this._listeners)D.addEventListener(p,y,p===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[t,s,c]of this._listeners)D.removeEventListener(t,s,t===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(t){const s=this._map,c=s.getCanvasContainer();this._add("mapEvent",new yp(s,t));const p=s.boxZoom=new Vs(s,t);this._add("boxZoom",p);const y=new $s(s),x=new Ki(s);s.doubleClickZoom=new ch(x,y),this._add("tapZoom",y),this._add("clickZoom",x);const E=new tn;this._add("tapDragZoom",E);const S=s.touchPitch=new Ei(s);this._add("touchPitch",S);const C=sh(t),M=La(t);s.dragRotate=new pu(t,C,M),this._add("mouseRotate",C,["mousePitch"]),this._add("mousePitch",M,["mouseRotate"]);const P=(({enable:Q,clickTolerance:de})=>{const W=new Ue({checkCorrectEvent:he=>D.mouseButton(he)===0&&!he.ctrlKey});return new Fr({clickTolerance:de,move:(he,ge)=>({around:ge,panDelta:ge.sub(he)}),activateOnStart:!0,moveStateManager:W,enable:Q,assignEvents:lu})})(t),F=new ah(t,s);s.dragPan=new Ua(c,P,F),this._add("mousePan",P),this._add("touchPan",F,["touchZoom","touchRotate"]);const Z=new cu,V=new uu;s.touchZoomRotate=new hh(c,V,Z,E),this._add("touchRotate",Z,["touchPan","touchZoom"]),this._add("touchZoom",V,["touchPan","touchRotate"]);const q=s.scrollZoom=new du(s,this);this._add("scrollZoom",q,["mousePan"]);const H=s.keyboard=new uh(s);this._add("keyboard",H),this._add("blockableMapEvent",new _p(s));for(const Q of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])t.interactive&&t[Q]&&s[Q].enable(t[Q])}_add(t,s,c){this._handlers.push({handlerName:t,handler:s,allowed:c}),this._handlersById[t]=s}stop(t){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},t),this._changes=[]}}isActive(){for(const{handler:t}of this._handlers)if(t.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!qs(this._eventsInProgress)||this.isZooming()}_blockedByActive(t,s,c){for(const p in t)if(p!==c&&(!s||s.indexOf(p)<0))return!0;return!1}handleWindowEvent(t){this.handleEvent(t,`${t.type}Window`)}_getMapTouches(t){const s=[];for(const c of t)this._el.contains(c.target)&&s.push(c);return s}handleEvent(t,s){if(t.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const c=t.type==="renderFrame"?void 0:t,p={needsRenderFrame:!1},y={},x={},E=t.touches,S=E?this._getMapTouches(E):void 0,C=S?D.touchPos(this._el,S):D.mousePos(this._el,t);for(const{handlerName:F,handler:Z,allowed:V}of this._handlers){if(!Z.isEnabled())continue;let q;this._blockedByActive(x,V,F)?Z.reset():Z[s||t.type]&&(q=Z[s||t.type](t,C,S),this.mergeHandlerResult(p,y,q,F,c),q&&q.needsRenderFrame&&this._triggerRenderFrame()),(q||Z.isActive())&&(x[F]=Z)}const M={};for(const F in this._previousActiveHandlers)x[F]||(M[F]=c);this._previousActiveHandlers=x,(Object.keys(M).length||fu(p))&&(this._changes.push([p,y,M]),this._triggerRenderFrame()),(Object.keys(x).length||fu(p))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:P}=p;P&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],P(this._map))}mergeHandlerResult(t,s,c,p,y){if(!c)return;u.extend(t,c);const x={handlerName:p,originalEvent:c.originalEvent||y};c.zoomDelta!==void 0&&(s.zoom=x),c.panDelta!==void 0&&(s.drag=x),c.pitchDelta!==void 0&&(s.pitch=x),c.bearingDelta!==void 0&&(s.rotate=x)}_applyChanges(){const t={},s={},c={};for(const[p,y,x]of this._changes)p.panDelta&&(t.panDelta=(t.panDelta||new u.Point(0,0))._add(p.panDelta)),p.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+p.zoomDelta),p.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+p.bearingDelta),p.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+p.pitchDelta),p.around!==void 0&&(t.around=p.around),p.pinchAround!==void 0&&(t.pinchAround=p.pinchAround),p.noInertia&&(t.noInertia=p.noInertia),u.extend(s,y),u.extend(c,x);this._updateMapTransform(t,s,c),this._changes=[]}_updateMapTransform(t,s,c){const p=this._map,y=p._getTransformForUpdate(),x=p.terrain;if(!(fu(t)||x&&this._terrainMovement))return this._fireEvents(s,c,!0);let{panDelta:E,zoomDelta:S,bearingDelta:C,pitchDelta:M,around:P,pinchAround:F}=t;F!==void 0&&(P=F),p._stop(!0),P=P||p.transform.centerPoint;const Z=y.pointLocation(E?P.sub(E):P);C&&(y.bearing+=C),M&&(y.pitch+=M),S&&(y.zoom+=S),x?this._terrainMovement||!s.drag&&!s.zoom?s.drag&&this._terrainMovement?y.center=y.pointLocation(y.centerPoint.sub(E)):y.setLocationAtPoint(Z,P):(this._terrainMovement=!0,y.freezeElevation=!0,y.setLocationAtPoint(Z,P),this._map.once("moveend",()=>{y.freezeElevation=!1,this._terrainMovement=!1,y.recalculateZoom(p.terrain)})):y.setLocationAtPoint(Z,P),p._applyUpdatedTransform(y),this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(s,c,!0)}_fireEvents(t,s,c){const p=qs(this._eventsInProgress),y=qs(t),x={};for(const M in t){const{originalEvent:P}=t[M];this._eventsInProgress[M]||(x[`${M}start`]=P),this._eventsInProgress[M]=t[M]}!p&&y&&this._fireEvent("movestart",y.originalEvent);for(const M in x)this._fireEvent(M,x[M]);y&&this._fireEvent("move",y.originalEvent);for(const M in t){const{originalEvent:P}=t[M];this._fireEvent(M,P)}const E={};let S;for(const M in this._eventsInProgress){const{handlerName:P,originalEvent:F}=this._eventsInProgress[M];this._handlersById[P].isActive()||(delete this._eventsInProgress[M],S=s[P]||F,E[`${M}end`]=S)}for(const M in E)this._fireEvent(M,E[M]);const C=qs(this._eventsInProgress);if(c&&(p||y)&&!C){this._updatingCamera=!0;const M=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),P=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;M?(P(M.bearing||this._map.getBearing())&&(M.bearing=0),M.freezeElevation=!0,this._map.easeTo(M,{originalEvent:S})):(this._map.fire(new u.Event("moveend",{originalEvent:S})),P(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,s){this._map.fire(new u.Event(t,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(t=>{delete this._frameId,this.handleEvent(new dh("renderFrame",{timeStamp:t})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Na={extend:(h,...t)=>u.extend(h,...t),run(h){h()},logToElement(h,t=!1,s="log"){const c=window.document.getElementById(s);c&&(t&&(c.innerHTML=""),c.innerHTML+=`<br>${h}`)}};class et extends u.Evented{constructor(t,s){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=s.bearingSnap,u.bindAll(["_renderFrameCallback"],this),this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(t,s){return this.jumpTo({center:t},s)}panBy(t,s,c){return t=u.Point.convert(t).mult(-1),this.panTo(this.transform.center,u.extend({offset:t},s),c)}panTo(t,s,c){return this.easeTo(u.extend({center:t},s),c)}getZoom(){return this.transform.zoom}setZoom(t,s){return this.jumpTo({zoom:t},s),this}zoomTo(t,s,c){return this.easeTo(u.extend({zoom:t},s),c)}zoomIn(t,s){return this.zoomTo(this.getZoom()+1,t,s),this}zoomOut(t,s){return this.zoomTo(this.getZoom()-1,t,s),this}getBearing(){return this.transform.bearing}setBearing(t,s){return this.jumpTo({bearing:t},s),this}getPadding(){return this.transform.padding}setPadding(t,s){return this.jumpTo({padding:t},s),this}rotateTo(t,s,c){return this.easeTo(u.extend({bearing:t},s),c)}resetNorth(t,s){return this.rotateTo(0,u.extend({duration:1e3},t),s),this}resetNorthPitch(t,s){return this.easeTo(u.extend({bearing:0,pitch:0,duration:1e3},t),s),this}snapToNorth(t,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(t,s):this}getPitch(){return this.transform.pitch}setPitch(t,s){return this.jumpTo({pitch:t},s),this}cameraForBounds(t,s){t=Ut.convert(t);const c=s&&s.bearing||0;return this._cameraForBoxAndBearing(t.getNorthWest(),t.getSouthEast(),c,s)}_cameraForBoxAndBearing(t,s,c,p){const y={top:0,bottom:0,right:0,left:0};if(typeof(p=u.extend({padding:y,offset:[0,0],maxZoom:this.transform.maxZoom},p)).padding=="number"){const ge=p.padding;p.padding={top:ge,bottom:ge,right:ge,left:ge}}p.padding=u.extend(y,p.padding);const x=this.transform,E=x.padding,S=x.project(u.LngLat.convert(t)),C=x.project(u.LngLat.convert(s)),M=S.rotate(-c*Math.PI/180),P=C.rotate(-c*Math.PI/180),F=new u.Point(Math.max(M.x,P.x),Math.max(M.y,P.y)),Z=new u.Point(Math.min(M.x,P.x),Math.min(M.y,P.y)),V=F.sub(Z),q=(x.width-(E.left+E.right+p.padding.left+p.padding.right))/V.x,H=(x.height-(E.top+E.bottom+p.padding.top+p.padding.bottom))/V.y;if(H<0||q<0)return void u.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Q=Math.min(x.scaleZoom(x.scale*Math.min(q,H)),p.maxZoom),de=u.Point.convert(p.offset),W=new u.Point((p.padding.left-p.padding.right)/2,(p.padding.top-p.padding.bottom)/2).rotate(c*Math.PI/180),he=de.add(W).mult(x.scale/x.zoomScale(Q));return{center:x.unproject(S.add(C).div(2).sub(he)),zoom:Q,bearing:c}}fitBounds(t,s,c){return this._fitInternal(this.cameraForBounds(t,s),s,c)}fitScreenCoordinates(t,s,c,p,y){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.Point.convert(t)),this.transform.pointLocation(u.Point.convert(s)),c,p),p,y)}_fitInternal(t,s,c){return t?(delete(s=u.extend(t,s)).padding,s.linear?this.easeTo(s,c):this.flyTo(s,c)):this}jumpTo(t,s){this.stop();const c=this._getTransformForUpdate();let p=!1,y=!1,x=!1;return"zoom"in t&&c.zoom!==+t.zoom&&(p=!0,c.zoom=+t.zoom),t.center!==void 0&&(c.center=u.LngLat.convert(t.center)),"bearing"in t&&c.bearing!==+t.bearing&&(y=!0,c.bearing=+t.bearing),"pitch"in t&&c.pitch!==+t.pitch&&(x=!0,c.pitch=+t.pitch),t.padding==null||c.isPaddingEqual(t.padding)||(c.padding=t.padding),this._applyUpdatedTransform(c),this.fire(new u.Event("movestart",s)).fire(new u.Event("move",s)),p&&this.fire(new u.Event("zoomstart",s)).fire(new u.Event("zoom",s)).fire(new u.Event("zoomend",s)),y&&this.fire(new u.Event("rotatestart",s)).fire(new u.Event("rotate",s)).fire(new u.Event("rotateend",s)),x&&this.fire(new u.Event("pitchstart",s)).fire(new u.Event("pitch",s)).fire(new u.Event("pitchend",s)),this.fire(new u.Event("moveend",s))}calculateCameraOptionsFromTo(t,s,c,p=0){const y=u.MercatorCoordinate.fromLngLat(t,s),x=u.MercatorCoordinate.fromLngLat(c,p),E=x.x-y.x,S=x.y-y.y,C=x.z-y.z,M=Math.hypot(E,S,C);if(M===0)throw new Error("Can't calculate camera options with same From and To");const P=Math.hypot(E,S),F=this.transform.scaleZoom(this.transform.cameraToCenterDistance/M/this.transform.tileSize),Z=180*Math.atan2(E,-S)/Math.PI;let V=180*Math.acos(P/M)/Math.PI;return V=C<0?90-V:90+V,{center:x.toLngLat(),zoom:F,pitch:V,bearing:Z}}easeTo(t,s){this._stop(!1,t.easeId),((t=u.extend({offset:[0,0],duration:500,easing:u.ease},t)).animate===!1||!t.essential&&u.exported.prefersReducedMotion)&&(t.duration=0);const c=this._getTransformForUpdate(),p=this.getZoom(),y=this.getBearing(),x=this.getPitch(),E=this.getPadding(),S="zoom"in t?+t.zoom:p,C="bearing"in t?this._normalizeBearing(t.bearing,y):y,M="pitch"in t?+t.pitch:x,P="padding"in t?t.padding:c.padding,F=u.Point.convert(t.offset);let Z=c.centerPoint.add(F);const V=c.pointLocation(Z),q=u.LngLat.convert(t.center||V);this._normalizeCenter(q);const H=c.project(V),Q=c.project(q).sub(H),de=c.zoomScale(S-p);let W,he;t.around&&(W=u.LngLat.convert(t.around),he=c.locationPoint(W));const ge={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||S!==p,this._rotating=this._rotating||y!==C,this._pitching=this._pitching||M!==x,this._padding=!c.isPaddingEqual(P),this._easeId=t.easeId,this._prepareEase(s,t.noMoveStart,ge),this.terrain&&this._prepareElevation(q),this._ease(we=>{if(this._zooming&&(c.zoom=u.interpolate.number(p,S,we)),this._rotating&&(c.bearing=u.interpolate.number(y,C,we)),this._pitching&&(c.pitch=u.interpolate.number(x,M,we)),this._padding&&(c.interpolatePadding(E,P,we),Z=c.centerPoint.add(F)),this.terrain&&!t.freezeElevation&&this._updateElevation(we),W)c.setLocationAtPoint(W,he);else{const Se=c.zoomScale(c.zoom-p),Ie=S>p?Math.min(2,de):Math.max(.5,de),be=Math.pow(Ie,1-we),je=c.unproject(H.add(Q.mult(we*be)).mult(Se));c.setLocationAtPoint(c.renderWorldCopies?je.wrap():je,Z)}this._applyUpdatedTransform(c),this._fireMoveEvents(s)},we=>{this.terrain&&this._finalizeElevation(),this._afterEase(s,we)},t),this}_prepareEase(t,s,c={}){this._moving=!0,s||c.moving||this.fire(new u.Event("movestart",t)),this._zooming&&!c.zooming&&this.fire(new u.Event("zoomstart",t)),this._rotating&&!c.rotating&&this.fire(new u.Event("rotatestart",t)),this._pitching&&!c.pitching&&this.fire(new u.Event("pitchstart",t))}_prepareElevation(t){this._elevationCenter=t,this._elevationStart=this.transform.elevation,this._elevationTarget=this.transform.getElevation(t,this.terrain),this.transform.freezeElevation=!0}_updateElevation(t){const s=this.transform.getElevation(this._elevationCenter,this.terrain);if(t<1&&s!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=t*(c-(s-(c*t+this._elevationStart))/(1-t)),this._elevationTarget=s}this.transform.elevation=u.interpolate.number(this._elevationStart,this._elevationTarget,t)}_finalizeElevation(){this.transform.freezeElevation=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(t){if(!this.transformCameraUpdate)return;const s=t.clone(),{center:c,zoom:p,pitch:y,bearing:x,elevation:E}=this.transformCameraUpdate(s);c&&(s.center=c),p!==void 0&&(s.zoom=p),y!==void 0&&(s.pitch=y),x!==void 0&&(s.bearing=x),E!==void 0&&(s.elevation=E),this.transform.apply(s)}_fireMoveEvents(t){this.fire(new u.Event("move",t)),this._zooming&&this.fire(new u.Event("zoom",t)),this._rotating&&this.fire(new u.Event("rotate",t)),this._pitching&&this.fire(new u.Event("pitch",t))}_afterEase(t,s){if(this._easeId&&s&&this._easeId===s)return;delete this._easeId;const c=this._zooming,p=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new u.Event("zoomend",t)),p&&this.fire(new u.Event("rotateend",t)),y&&this.fire(new u.Event("pitchend",t)),this.fire(new u.Event("moveend",t))}flyTo(t,s){if(!t.essential&&u.exported.prefersReducedMotion){const Ge=u.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ge,s)}this.stop(),t=u.extend({offset:[0,0],speed:1.2,curve:1.42,easing:u.ease},t);const c=this._getTransformForUpdate(),p=this.getZoom(),y=this.getBearing(),x=this.getPitch(),E=this.getPadding(),S="zoom"in t?u.clamp(+t.zoom,c.minZoom,c.maxZoom):p,C="bearing"in t?this._normalizeBearing(t.bearing,y):y,M="pitch"in t?+t.pitch:x,P="padding"in t?t.padding:c.padding,F=c.zoomScale(S-p),Z=u.Point.convert(t.offset);let V=c.centerPoint.add(Z);const q=c.pointLocation(V),H=u.LngLat.convert(t.center||q);this._normalizeCenter(H);const Q=c.project(q),de=c.project(H).sub(Q);let W=t.curve;const he=Math.max(c.width,c.height),ge=he/F,we=de.mag();if("minZoom"in t){const Ge=u.clamp(Math.min(t.minZoom,p,S),c.minZoom,c.maxZoom),zt=he/c.zoomScale(Ge-p);W=Math.sqrt(zt/we*2)}const Se=W*W;function Ie(Ge){const zt=(ge*ge-he*he+(Ge?-1:1)*Se*Se*we*we)/(2*(Ge?ge:he)*Se*we);return Math.log(Math.sqrt(zt*zt+1)-zt)}function be(Ge){return(Math.exp(Ge)-Math.exp(-Ge))/2}function je(Ge){return(Math.exp(Ge)+Math.exp(-Ge))/2}const rt=Ie(0);let ft=function(Ge){return je(rt)/je(rt+W*Ge)},De=function(Ge){return he*((je(rt)*(be(zt=rt+W*Ge)/je(zt))-be(rt))/Se)/we;var zt},ut=(Ie(1)-rt)/W;if(Math.abs(we)<1e-6||!isFinite(ut)){if(Math.abs(he-ge)<1e-6)return this.easeTo(t,s);const Ge=ge<he?-1:1;ut=Math.abs(Math.log(ge/he))/W,De=function(){return 0},ft=function(zt){return Math.exp(Ge*W*zt)}}return t.duration="duration"in t?+t.duration:1e3*ut/("screenSpeed"in t?+t.screenSpeed/W:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0),this._zooming=!0,this._rotating=y!==C,this._pitching=M!==x,this._padding=!c.isPaddingEqual(P),this._prepareEase(s,!1),this.terrain&&this._prepareElevation(H),this._ease(Ge=>{const zt=Ge*ut,_n=1/ft(zt);c.zoom=Ge===1?S:p+c.scaleZoom(_n),this._rotating&&(c.bearing=u.interpolate.number(y,C,Ge)),this._pitching&&(c.pitch=u.interpolate.number(x,M,Ge)),this._padding&&(c.interpolatePadding(E,P,Ge),V=c.centerPoint.add(Z)),this.terrain&&!t.freezeElevation&&this._updateElevation(Ge);const Dt=Ge===1?H:c.unproject(Q.add(de.mult(De(zt))).mult(_n));c.setLocationAtPoint(c.renderWorldCopies?Dt.wrap():Dt,V),this._applyUpdatedTransform(c),this._fireMoveEvents(s)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(s)},t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(t,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,s)}if(!t){const c=this.handlers;c&&c.stop(!1)}return this}_ease(t,s,c){c.animate===!1||c.duration===0?(t(1),s()):(this._easeStart=u.exported.now(),this._easeOptions=c,this._onEaseFrame=t,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((u.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,s){t=u.wrap(t,-180,180);const c=Math.abs(t-s);return Math.abs(t-360-s)<c&&(t-=360),Math.abs(t+360-s)<c&&(t+=360),t}_normalizeCenter(t){const s=this.transform;if(!s.renderWorldCopies||s.lngRange)return;const c=t.lng-s.center.lng;t.lng+=c>180?-360:c<-180?360:0}queryTerrainElevation(t){return this.terrain?this.transform.getElevation(u.LngLat.convert(t),this.terrain)-this.transform.elevation:null}}class lt{constructor(t={}){this.options=t,u.bindAll(["_toggleAttribution","_updateData","_updateCompact","_updateCompactMinimize"],this)}getDefaultPosition(){return"bottom-right"}onAdd(t){return this._map=t,this._compact=this.options&&this.options.compact,this._container=D.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=D.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(t,s){const c=this._map._getUIString(`AttributionControl.${s}`);t.title=c,t.setAttribute("aria-label",c)}_toggleAttribution(){this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))}_updateData(t){!t||t.sourceDataType!=="metadata"&&t.sourceDataType!=="visibility"&&t.dataType!=="style"&&t.type!=="terrain"||this._updateAttributions()}_updateAttributions(){if(!this._map.style)return;let t=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?t=t.concat(this.options.customAttribution.map(p=>typeof p!="string"?"":p)):typeof this.options.customAttribution=="string"&&t.push(this.options.customAttribution)),this._map.style.stylesheet){const p=this._map.style.stylesheet;this.styleOwner=p.owner,this.styleId=p.id}const s=this._map.style.sourceCaches;for(const p in s){const y=s[p];if(y.used||y.usedForTerrain){const x=y.getSource();x.attribution&&t.indexOf(x.attribution)<0&&t.push(x.attribution)}}t=t.filter(p=>String(p).trim()),t.sort((p,y)=>p.length-y.length),t=t.filter((p,y)=>{for(let x=y+1;x<t.length;x++)if(t[x].indexOf(p)>=0)return!1;return!0});const c=t.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,t.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))}_updateCompactMinimize(){this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")}}class Zs{constructor(t={}){this.options=t,u.bindAll(["_updateCompact"],this)}getDefaultPosition(){return"bottom-left"}onAdd(t){this._map=t,this._compact=this.options&&this.options.compact,this._container=D.create("div","maplibregl-ctrl");const s=D.create("a","maplibregl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://maplibre.org/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){D.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}_updateCompact(){const t=this._container.children;if(t.length){const s=t[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&s.classList.add("maplibregl-compact"):s.classList.remove("maplibregl-compact")}}}class mu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(t){const s=++this._id;return this._queue.push({callback:t,id:s,cancelled:!1}),s}remove(t){const s=this._currentlyRunning,c=s?this._queue.concat(s):this._queue;for(const p of c)if(p.id===t)return void(p.cancelled=!0)}run(t=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const s=this._currentlyRunning=this._queue;this._queue=[];for(const c of s)if(!c.cancelled&&(c.callback(t),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const gu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var Ti=u.createLayout([{name:"a_pos3d",type:"Int16",components:3}]);class Va extends u.Evented{constructor(t){super(),this.sourceCache=t,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,t.usedForTerrain=!0,t.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(t,s){this.sourceCache.update(t,s),this._renderableTilesKeys=[];const c={};for(const p of t.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:s}))c[p.key]=!0,this._renderableTilesKeys.push(p.key),this._tiles[p.key]||(p.posMatrix=new Float64Array(16),u.ortho(p.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),this._tiles[p.key]=new Qr(p,this.tileSize));for(const p in this._tiles)c[p]||delete this._tiles[p]}freeRtt(t){for(const s in this._tiles){const c=this._tiles[s];(!t||c.tileID.equals(t)||c.tileID.isChildOf(t)||t.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(t=>this.getTileByID(t))}getTileByID(t){return this._tiles[t]}getTerrainCoords(t){const s={};for(const c of this._renderableTilesKeys){const p=this._tiles[c].tileID;if(p.canonical.equals(t.canonical)){const y=t.clone();y.posMatrix=new Float64Array(16),u.ortho(y.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),s[c]=y}else if(p.canonical.isChildOf(t.canonical)){const y=t.clone();y.posMatrix=new Float64Array(16);const x=p.canonical.z-t.canonical.z,E=p.canonical.x-(p.canonical.x>>x<<x),S=p.canonical.y-(p.canonical.y>>x<<x),C=u.EXTENT>>x;u.ortho(y.posMatrix,0,C,0,C,0,1),u.translate(y.posMatrix,y.posMatrix,[-E*C,-S*C,0]),s[c]=y}else if(t.canonical.isChildOf(p.canonical)){const y=t.clone();y.posMatrix=new Float64Array(16);const x=t.canonical.z-p.canonical.z,E=t.canonical.x-(t.canonical.x>>x<<x),S=t.canonical.y-(t.canonical.y>>x<<x),C=u.EXTENT>>x;u.ortho(y.posMatrix,0,u.EXTENT,0,u.EXTENT,0,1),u.translate(y.posMatrix,y.posMatrix,[E*C,S*C,0]),u.scale(y.posMatrix,y.posMatrix,[1/2**x,1/2**x,0]),s[c]=y}}return s}getSourceTile(t,s){const c=this.sourceCache._source;let p=t.overscaledZ-this.deltaZoom;if(p>c.maxzoom&&(p=c.maxzoom),p<c.minzoom)return null;this._sourceTileCache[t.key]||(this._sourceTileCache[t.key]=t.scaledTo(p).key);let y=this.sourceCache.getTileByID(this._sourceTileCache[t.key]);if((!y||!y.dem)&&s)for(;p>=c.minzoom&&(!y||!y.dem);)y=this.sourceCache.getTileByID(t.scaledTo(p--).key);return y}tilesAfterTime(t=Date.now()){return Object.values(this._tiles).filter(s=>s.timeAdded>=t)}}class Sr{constructor(t,s,c){this.painter=t,this.sourceCache=new Va(s),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(t,s,c,p=u.EXTENT){if(!(s>=0&&s<p&&c>=0&&c<p))return 0;let y=0;const x=this.getTerrainData(t);if(x.tile&&x.tile.dem){const E=function(V,q,H){var Q=q[0],de=q[1];return V[0]=H[0]*Q+H[4]*de+H[12],V[1]=H[1]*Q+H[5]*de+H[13],V}([],[s/p*u.EXTENT,c/p*u.EXTENT],x.u_terrain_matrix),S=[E[0]*x.tile.dem.dim,E[1]*x.tile.dem.dim],C=[Math.floor(S[0]),Math.floor(S[1])],M=x.tile.dem.get(C[0],C[1]),P=x.tile.dem.get(C[0],C[1]+1),F=x.tile.dem.get(C[0]+1,C[1]),Z=x.tile.dem.get(C[0]+1,C[1]+1);y=u.interpolate.number(u.interpolate.number(M,P,S[0]-C[0]),u.interpolate.number(F,Z,S[0]-C[0]),S[1]-C[1])}return y}getElevation(t,s,c,p=u.EXTENT){return this.getDEMElevation(t,s,c,p)*this.exaggeration}getTerrainData(t){if(!this._emptyDemTexture){const p=this.painter.context,y=new u.RGBAImage({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new _t(p,y,p.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new _t(p,new u.RGBAImage({width:1,height:1}),p.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.identity([])}const s=this.sourceCache.getSourceTile(t,!0);if(s&&s.dem&&(!s.demTexture||s.needsTerrainPrepare)){const p=this.painter.context;s.demTexture=this.painter.getTileTexture(s.dem.stride),s.demTexture?s.demTexture.update(s.dem.getPixels(),{premultiply:!1}):s.demTexture=new _t(p,s.dem.getPixels(),p.gl.RGBA,{premultiply:!1}),s.demTexture.bind(p.gl.NEAREST,p.gl.CLAMP_TO_EDGE),s.needsTerrainPrepare=!1}const c=s&&s+s.tileID.key+t.key;if(c&&!this._demMatrixCache[c]){const p=this.sourceCache.sourceCache._source.maxzoom;let y=t.canonical.z-s.tileID.canonical.z;t.overscaledZ>t.canonical.z&&(t.canonical.z>=p?y=t.canonical.z-p:u.warnOnce("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=t.canonical.x-(t.canonical.x>>y<<y),E=t.canonical.y-(t.canonical.y>>y<<y),S=u.fromScaling(new Float64Array(16),[1/(u.EXTENT<<y),1/(u.EXTENT<<y),0]);u.translate(S,S,[x*u.EXTENT,E*u.EXTENT,0]),this._demMatrixCache[t.key]={matrix:S,coord:t}}return{u_depth:2,u_terrain:3,u_terrain_dim:s&&s.dem&&s.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[t.key].matrix:this._emptyDemMatrix,u_terrain_unpack:s&&s.dem&&s.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(s&&s.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:s}}getFramebuffer(t){const s=this.painter,c=s.width/devicePixelRatio,p=s.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===p||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new _t(s.context,{width:c,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new _t(s.context,{width:c,height:p,data:null},s.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(s.context.gl.NEAREST,s.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=s.context.createFramebuffer(c,p,!0,!1),this._fbo.depthAttachment.set(s.context.createRenderbuffer(s.context.gl.DEPTH_COMPONENT16,c,p))),this._fbo.colorAttachment.set(t==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const t=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const s=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let y=0,x=0;y<this._coordsTextureSize;y++)for(let E=0;E<this._coordsTextureSize;E++,x+=4)s[x+0]=255&E,s[x+1]=255&y,s[x+2]=E>>8<<4|y>>8,s[x+3]=0;const c=new u.RGBAImage({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(s.buffer)),p=new _t(t,c,t.gl.RGBA,{premultiply:!1});return p.bind(t.gl.NEAREST,t.gl.CLAMP_TO_EDGE),this._coordsTexture=p,p}pointCoordinate(t){const s=new Uint8Array(4),c=this.painter.context,p=c.gl;c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),p.readPixels(t.x,this.painter.height/devicePixelRatio-t.y-1,1,1,p.RGBA,p.UNSIGNED_BYTE,s),c.bindFramebuffer.set(null);const y=s[0]+(s[2]>>4<<8),x=s[1]+((15&s[2])<<8),E=this.coordsIndex[255-s[3]],S=E&&this.sourceCache.getTileByID(E);if(!S)return null;const C=this._coordsTextureSize,M=(1<<S.tileID.canonical.z)*C;return new u.MercatorCoordinate((S.tileID.canonical.x*C+y)/M,(S.tileID.canonical.y*C+x)/M,this.getElevation(S.tileID,y,x,C))}getTerrainMesh(){if(this._mesh)return this._mesh;const t=this.painter.context,s=new u.Pos3dArray,c=new u.TriangleIndexArray,p=this.meshSize,y=u.EXTENT/p,x=p*p;for(let P=0;P<=p;P++)for(let F=0;F<=p;F++)s.emplaceBack(F*y,P*y,0);for(let P=0;P<x;P+=p+1)for(let F=0;F<p;F++)c.emplaceBack(F+P,p+F+P+1,p+F+P+2),c.emplaceBack(F+P,p+F+P+2,F+P+1);const E=s.length,S=E+2*(p+1);for(const P of[0,1])for(let F=0;F<=p;F++)for(const Z of[0,1])s.emplaceBack(F*y,P*u.EXTENT,Z);for(let P=0;P<2*p;P+=2)c.emplaceBack(S+P,S+P+1,S+P+3),c.emplaceBack(S+P,S+P+3,S+P+2),c.emplaceBack(E+P,E+P+3,E+P+1),c.emplaceBack(E+P,E+P+2,E+P+3);const C=s.length,M=C+2*(p+1);for(const P of[0,1])for(let F=0;F<=p;F++)for(const Z of[0,1])s.emplaceBack(P*u.EXTENT,F*y,Z);for(let P=0;P<2*p;P+=2)c.emplaceBack(C+P,C+P+1,C+P+3),c.emplaceBack(C+P,C+P+3,C+P+2),c.emplaceBack(M+P,M+P+3,M+P+1),c.emplaceBack(M+P,M+P+2,M+P+3);return this._mesh={indexBuffer:t.createIndexBuffer(c),vertexBuffer:t.createVertexBuffer(s,Ti.members),segments:u.SegmentVector.simpleSegment(0,0,s.length,c.length)},this._mesh}getMeshFrameDelta(t){return 2*Math.PI*u.earthRadius/Math.pow(2,t)/5}getMinMaxElevation(t){const s=this.getTerrainData(t).tile,c={minElevation:null,maxElevation:null};return s&&s.dem&&(c.minElevation=s.dem.min*this.exaggeration,c.maxElevation=s.dem.max*this.exaggeration),c}}class vp{constructor(t,s,c){this._context=t,this._size=s,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const t of this._objects)t.texture.destroy(),t.fbo.destroy()}_createObject(t){const s=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new _t(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),s.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),s.colorAttachment.set(c.texture),{id:t,fbo:s,texture:c,stamp:-1,inUse:!1}}getObjectForId(t){return this._objects[t]}useObject(t){t.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(s=>t.id!==s),this._recentlyUsed.push(t.id)}stampObject(t){t.stamp=++this._stamp}getOrCreateFreeObject(){for(const s of this._recentlyUsed)if(!this._objects[s].inUse)return this._objects[s];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const t=this._createObject(this._objects.length);return this._objects.push(t),t}freeObject(t){t.inUse=!1}freeAllObjects(){for(const t of this._objects)this.freeObject(t)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(t=>!t.inUse)===!1}}const Or={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class dn{constructor(t,s){this.painter=t,this.terrain=s,this.pool=new vp(t.context,30,s.sourceCache.tileSize*s.qualityFactor)}destruct(){this.pool.destruct()}getTexture(t){return this.pool.getObjectForId(t.rtt[this._stacks.length-1].id).texture}prepareForRender(t,s){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=t._order.filter(c=>!t._layers[c].isHidden(s)),this._coordsDescendingInv={};for(const c in t.sourceCaches){this._coordsDescendingInv[c]={};const p=t.sourceCaches[c].getVisibleCoordinates();for(const y of p){const x=this.terrain.sourceCache.getTerrainCoords(y);for(const E in x)this._coordsDescendingInv[c][E]||(this._coordsDescendingInv[c][E]=[]),this._coordsDescendingInv[c][E].push(x[E])}}this._coordsDescendingInvStr={};for(const c of t._order){const p=t._layers[c],y=p.source;if(Or[p.type]&&!this._coordsDescendingInvStr[y]){this._coordsDescendingInvStr[y]={};for(const x in this._coordsDescendingInv[y])this._coordsDescendingInvStr[y][x]=this._coordsDescendingInv[y][x].map(E=>E.key).sort().join()}}for(const c of this._renderableTiles)for(const p in this._coordsDescendingInvStr){const y=this._coordsDescendingInvStr[p][c.tileID.key];y&&y!==c.rttCoords[p]&&(c.rtt=[])}}renderLayer(t){if(t.isHidden(this.painter.transform.zoom))return!1;const s=t.type,c=this.painter,p=this._renderableLayerIds[this._renderableLayerIds.length-1]===t.id;if(Or[s]&&(this._prevType&&Or[this._prevType]||this._stacks.push([]),this._prevType=s,this._stacks[this._stacks.length-1].push(t.id),!p))return!0;if(Or[this._prevType]||Or[s]&&p){this._prevType=s;const y=this._stacks.length-1,x=this._stacks[y]||[];for(const E of this._renderableTiles){if(this.pool.isFull()&&(su(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(E),E.rtt[y]){const C=this.pool.getObjectForId(E.rtt[y].id);if(C.stamp===E.rtt[y].stamp){this.pool.useObject(C);continue}}const S=this.pool.getOrCreateFreeObject();this.pool.useObject(S),this.pool.stampObject(S),E.rtt[y]={id:S.id,stamp:S.stamp},c.context.bindFramebuffer.set(S.fbo.framebuffer),c.context.clear({color:u.Color.transparent,stencil:0}),c.currentStencilSource=void 0;for(let C=0;C<x.length;C++){const M=c.style._layers[x[C]],P=M.source?this._coordsDescendingInv[M.source][E.tileID.key]:[E.tileID];c.context.viewport.set([0,0,S.fbo.width,S.fbo.height]),c._renderTileClippingMasks(M,P),c.renderLayer(c,c.style.sourceCaches[M.source],M,P),M.source&&(E.rttCoords[M.source]=this._coordsDescendingInvStr[M.source][E.tileID.key])}}return su(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),Or[s]}return!1}}const In=U,ph={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0},Ko=h=>{h.touchstart=h.dragStart,h.touchmoveWindow=h.dragMove,h.touchend=h.dragEnd},$a={showCompass:!0,showZoom:!0,visualizePitch:!1};class yu{constructor(t,s,c=!1){this._clickTolerance=10;const p=t.dragRotate._mouseRotate.getClickTolerance(),y=t.dragRotate._mousePitch.getClickTolerance();this.element=s,this.mouseRotate=sh({clickTolerance:p,enable:!0}),this.touchRotate=(({enable:x,clickTolerance:E,bearingDegreesPerPixelMoved:S=.8})=>{const C=new Da;return new Fr({clickTolerance:E,move:(M,P)=>({bearingDelta:(P.x-M.x)*S}),moveStateManager:C,enable:x,assignEvents:Ko})})({clickTolerance:p,enable:!0}),this.map=t,c&&(this.mousePitch=La({clickTolerance:y,enable:!0}),this.touchPitch=(({enable:x,clickTolerance:E,pitchDegreesPerPixelMoved:S=-.5})=>{const C=new Da;return new Fr({clickTolerance:E,move:(M,P)=>({pitchDelta:(P.y-M.y)*S}),moveStateManager:C,enable:x,assignEvents:Ko})})({clickTolerance:y,enable:!0})),u.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),D.addEventListener(s,"mousedown",this.mousedown),D.addEventListener(s,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(s,"touchcancel",this.reset)}startMouse(t,s){this.mouseRotate.dragStart(t,s),this.mousePitch&&this.mousePitch.dragStart(t,s),D.disableDrag()}startTouch(t,s){this.touchRotate.dragStart(t,s),this.touchPitch&&this.touchPitch.dragStart(t,s),D.disableDrag()}moveMouse(t,s){const c=this.map,{bearingDelta:p}=this.mouseRotate.dragMove(t,s)||{};if(p&&c.setBearing(c.getBearing()+p),this.mousePitch){const{pitchDelta:y}=this.mousePitch.dragMove(t,s)||{};y&&c.setPitch(c.getPitch()+y)}}moveTouch(t,s){const c=this.map,{bearingDelta:p}=this.touchRotate.dragMove(t,s)||{};if(p&&c.setBearing(c.getBearing()+p),this.touchPitch){const{pitchDelta:y}=this.touchPitch.dragMove(t,s)||{};y&&c.setPitch(c.getPitch()+y)}}off(){const t=this.element;D.removeEventListener(t,"mousedown",this.mousedown),D.removeEventListener(t,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend),D.removeEventListener(t,"touchcancel",this.reset),this.offTemp()}offTemp(){D.enableDrag(),D.removeEventListener(window,"mousemove",this.mousemove),D.removeEventListener(window,"mouseup",this.mouseup),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend)}mousedown(t){this.startMouse(u.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),D.mousePos(this.element,t)),D.addEventListener(window,"mousemove",this.mousemove),D.addEventListener(window,"mouseup",this.mouseup)}mousemove(t){this.moveMouse(t,D.mousePos(this.element,t))}mouseup(t){this.mouseRotate.dragEnd(t),this.mousePitch&&this.mousePitch.dragEnd(t),this.offTemp()}touchstart(t){t.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,t.targetTouches)[0],this.startTouch(t,this._startPos),D.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.addEventListener(window,"touchend",this.touchend))}touchmove(t){t.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,t.targetTouches)[0],this.moveTouch(t,this._lastPos))}touchend(t){t.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}let Er;function ja(h,t,s){if(h=new u.LngLat(h.lng,h.lat),t){const c=new u.LngLat(h.lng-360,h.lat),p=new u.LngLat(h.lng+360,h.lat),y=s.locationPoint(h).distSqr(t);s.locationPoint(c).distSqr(t)<y?h=c:s.locationPoint(p).distSqr(t)<y&&(h=p)}for(;Math.abs(h.lng-s.center.lng)>180;){const c=s.locationPoint(h);if(c.x>=0&&c.y>=0&&c.x<=s.width&&c.y<=s.height)break;h.lng>s.center.lng?h.lng-=360:h.lng+=360}return h}const xo={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function qa(h,t,s){const c=h.classList;for(const p in xo)c.remove(`maplibregl-${s}-anchor-${p}`);c.add(`maplibregl-${s}-anchor-${t}`)}class Gs extends u.Evented{constructor(t,s){if(super(),(t instanceof HTMLElement||s)&&(t=u.extend({element:t},s)),u.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment!=="auto"?t.pitchAlignment:this._rotationAlignment,t&&t.element)this._element=t.element,this._offset=u.Point.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");const c=D.createNS("http://www.w3.org/2000/svg","svg"),p=41,y=27;c.setAttributeNS(null,"display","block"),c.setAttributeNS(null,"height",`${p}px`),c.setAttributeNS(null,"width",`${y}px`),c.setAttributeNS(null,"viewBox",`0 0 ${y} ${p}`);const x=D.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"stroke","none"),x.setAttributeNS(null,"stroke-width","1"),x.setAttributeNS(null,"fill","none"),x.setAttributeNS(null,"fill-rule","evenodd");const E=D.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill-rule","nonzero");const S=D.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"transform","translate(3.0, 29.0)"),S.setAttributeNS(null,"fill","#000000");const C=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const de of C){const W=D.createNS("http://www.w3.org/2000/svg","ellipse");W.setAttributeNS(null,"opacity","0.04"),W.setAttributeNS(null,"cx","10.5"),W.setAttributeNS(null,"cy","5.80029008"),W.setAttributeNS(null,"rx",de.rx),W.setAttributeNS(null,"ry",de.ry),S.appendChild(W)}const M=D.createNS("http://www.w3.org/2000/svg","g");M.setAttributeNS(null,"fill",this._color);const P=D.createNS("http://www.w3.org/2000/svg","path");P.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),M.appendChild(P);const F=D.createNS("http://www.w3.org/2000/svg","g");F.setAttributeNS(null,"opacity","0.25"),F.setAttributeNS(null,"fill","#000000");const Z=D.createNS("http://www.w3.org/2000/svg","path");Z.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),F.appendChild(Z);const V=D.createNS("http://www.w3.org/2000/svg","g");V.setAttributeNS(null,"transform","translate(6.0, 7.0)"),V.setAttributeNS(null,"fill","#FFFFFF");const q=D.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(8.0, 8.0)");const H=D.createNS("http://www.w3.org/2000/svg","circle");H.setAttributeNS(null,"fill","#000000"),H.setAttributeNS(null,"opacity","0.25"),H.setAttributeNS(null,"cx","5.5"),H.setAttributeNS(null,"cy","5.5"),H.setAttributeNS(null,"r","5.4999962");const Q=D.createNS("http://www.w3.org/2000/svg","circle");Q.setAttributeNS(null,"fill","#FFFFFF"),Q.setAttributeNS(null,"cx","5.5"),Q.setAttributeNS(null,"cy","5.5"),Q.setAttributeNS(null,"r","5.4999962"),q.appendChild(H),q.appendChild(Q),E.appendChild(S),E.appendChild(M),E.appendChild(F),E.appendChild(V),E.appendChild(q),c.appendChild(E),c.setAttributeNS(null,"height",p*this._scale+"px"),c.setAttributeNS(null,"width",y*this._scale+"px"),this._element.appendChild(c),this._offset=u.Point.convert(t&&t.offset||[0,-14])}this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",c=>{c.preventDefault()}),this._element.addEventListener("mousedown",c=>{c.preventDefault()}),qa(this._element,this._anchor,"marker"),this._popup=null}addTo(t){return this.remove(),this._map=t,t.getCanvasContainer().appendChild(this._element),t.on("move",this._update),t.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=u.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(t){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),t){if(!("offset"in t.options)){const p=Math.sqrt(Math.pow(13.5,2)/2);t.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(38.1-13.5+p)],"bottom-right":[-p,-1*(38.1-13.5+p)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=t,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(t){const s=t.code,c=t.charCode||t.keyCode;s!=="Space"&&s!=="Enter"&&c!==32&&c!==13||this.togglePopup()}_onMapClick(t){const s=t.originalEvent.target,c=this._element;this._popup&&(s===c||c.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const t=this._popup;return t?(t.isOpen()?t.remove():t.addTo(this._map),this):this}_update(t){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=ja(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let s="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?s=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(s=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let c="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?c="rotateX(0deg)":this._pitchAlignment==="map"&&(c=`rotateX(${this._map.getPitch()}deg)`),t&&t.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,`${xo[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${c} ${s}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const p=this._map.unproject(this._pos),y=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=p.distanceTo(this._lngLat)>20*y?"0.2":"1.0",this._opacityTimeout=null},100))}getOffset(){return this._offset}setOffset(t){return this._offset=u.Point.convert(t),this._update(),this}_onMove(t){if(!this._isDragging){const s=this._clickTolerance||this._map._clickTolerance;this._isDragging=t.point.dist(this._pointerdownPos)>=s}this._isDragging&&(this._pos=t.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.Event("dragstart"))),this.fire(new u.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.Event("dragend")),this._state="inactive"}_addDragHandler(t){this._element.contains(t.originalEvent.target)&&(t.preventDefault(),this._positionDelta=t.point.sub(this._pos).add(this._offset),this._pointerdownPos=t.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(t){return this._draggable=!!t,this._map&&(t?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(t){return this._rotation=t||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(t){return this._rotationAlignment=t||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(t){return this._pitchAlignment=t&&t!=="auto"?t:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const _u={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Yo=0,wo=!1;const vu={maxWidth:100,unit:"metric"};function Za(h,t,s){const c=s&&s.maxWidth||100,p=h._container.clientHeight/2,y=h.unproject([0,p]),x=h.unproject([c,p]),E=y.distanceTo(x);if(s&&s.unit==="imperial"){const S=3.2808*E;S>5280?bo(t,c,S/5280,h._getUIString("ScaleControl.Miles")):bo(t,c,S,h._getUIString("ScaleControl.Feet"))}else s&&s.unit==="nautical"?bo(t,c,E/1852,h._getUIString("ScaleControl.NauticalMiles")):E>=1e3?bo(t,c,E/1e3,h._getUIString("ScaleControl.Kilometers")):bo(t,c,E,h._getUIString("ScaleControl.Meters"))}function bo(h,t,s,c){const p=function(y){const x=Math.pow(10,`${Math.floor(y)}`.length-1);let E=y/x;return E=E>=10?10:E>=5?5:E>=3?3:E>=2?2:E>=1?1:function(S){const C=Math.pow(10,Math.ceil(-Math.log(S)/Math.LN10));return Math.round(S*C)/C}(E),x*E}(s);h.style.width=t*(p/s)+"px",h.innerHTML=`${p}&nbsp;${c}`}const Ga={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},xu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Wa(h){if(h){if(typeof h=="number"){const t=Math.round(Math.sqrt(.5*Math.pow(h,2)));return{center:new u.Point(0,0),top:new u.Point(0,h),"top-left":new u.Point(t,t),"top-right":new u.Point(-t,t),bottom:new u.Point(0,-h),"bottom-left":new u.Point(t,-t),"bottom-right":new u.Point(-t,-t),left:new u.Point(h,0),right:new u.Point(-h,0)}}if(h instanceof u.Point||Array.isArray(h)){const t=u.Point.convert(h);return{center:t,top:t,"top-left":t,"top-right":t,bottom:t,"bottom-left":t,"bottom-right":t,left:t,right:t}}return{center:u.Point.convert(h.center||[0,0]),top:u.Point.convert(h.top||[0,0]),"top-left":u.Point.convert(h["top-left"]||[0,0]),"top-right":u.Point.convert(h["top-right"]||[0,0]),bottom:u.Point.convert(h.bottom||[0,0]),"bottom-left":u.Point.convert(h["bottom-left"]||[0,0]),"bottom-right":u.Point.convert(h["bottom-right"]||[0,0]),left:u.Point.convert(h.left||[0,0]),right:u.Point.convert(h.right||[0,0])}}return Wa(new u.Point(0,0))}const Xa=U,Ha={setRTLTextPlugin:u.setRTLTextPlugin,getRTLTextPluginStatus:u.getRTLTextPluginStatus,Map:class extends et{constructor(h){var t;if(u.PerformanceUtils.mark(u.PerformanceMarkers.create),(h=u.extend({},ph,h)).minZoom!=null&&h.maxZoom!=null&&h.minZoom>h.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(h.minPitch!=null&&h.maxPitch!=null&&h.minPitch>h.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(h.minPitch!=null&&h.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(h.maxPitch!=null&&h.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Aa(h.minZoom,h.maxZoom,h.minPitch,h.maxPitch,h.renderWorldCopies),{bearingSnap:h.bearingSnap}),this._interactive=h.interactive,this._cooperativeGestures=h.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=h.maxTileCacheSize,this._failIfMajorPerformanceCaveat=h.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=h.preserveDrawingBuffer,this._antialias=h.antialias,this._trackResize=h.trackResize,this._bearingSnap=h.bearingSnap,this._refreshExpiredTiles=h.refreshExpiredTiles,this._fadeDuration=h.fadeDuration,this._crossSourceCollisions=h.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=h.collectResourceTiming,this._renderTaskQueue=new mu,this._controls=[],this._mapId=u.uniqueId(),this._locale=u.extend({},gu,h.locale),this._clickTolerance=h.clickTolerance,this._pixelRatio=(t=h.pixelRatio)!==null&&t!==void 0?t:devicePixelRatio,this.transformCameraUpdate=h.transformCameraUpdate,this._imageQueueHandle=te.addThrottleControl(()=>this.isMoving()),this._requestManager=new le(h.transformRequest),typeof h.container=="string"){if(this._container=document.getElementById(h.container),!this._container)throw new Error(`Container '${h.container}' not found.`)}else{if(!(h.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=h.container}if(h.maxBounds&&this.setMaxBounds(h.maxBounds),u.bindAll(["_onWindowOnline","_onMapScroll","_cooperativeGesturesOnWheel","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let s=!1;this._resizeObserver=new ResizeObserver(c=>{s?this._trackResize&&this.resize(c)._update():s=!0}),this._resizeObserver.observe(this._container)}this.handlers=new br(this,h),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=h.hash&&new th(typeof h.hash=="string"&&h.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:h.center,zoom:h.zoom,bearing:h.bearing,pitch:h.pitch}),h.bounds&&(this.resize(),this.fitBounds(h.bounds,u.extend({},h.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=h.localIdeographFontFamily,this._validateStyle=h.validateStyle,h.style&&this.setStyle(h.style,{localIdeographFontFamily:h.localIdeographFontFamily}),h.attributionControl&&this.addControl(new lt({customAttribution:h.customAttribution})),h.maplibreLogo&&this.addControl(new Zs,h.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new u.Event(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new u.Event(`${s.dataType}dataloading`,s))}),this.on("dataabort",s=>{this.fire(new u.Event("sourcedataabort",s))})}_getMapId(){return this._mapId}addControl(h,t){if(t===void 0&&(t=h.getDefaultPosition?h.getDefaultPosition():"top-right"),!h||!h.onAdd)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=h.onAdd(this);this._controls.push(h);const c=this._controlPositions[t];return t.indexOf("bottom")!==-1?c.insertBefore(s,c.firstChild):c.appendChild(s),this}removeControl(h){if(!h||!h.onRemove)return this.fire(new u.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const t=this._controls.indexOf(h);return t>-1&&this._controls.splice(t,1),h.onRemove(this),this}hasControl(h){return this._controls.indexOf(h)>-1}calculateCameraOptionsFromTo(h,t,s,c){return c==null&&this.terrain&&(c=this.transform.getElevation(s,this.terrain)),super.calculateCameraOptionsFromTo(h,t,s,c)}resize(h){var t;const s=this._containerDimensions(),c=s[0],p=s[1];this._resizeCanvas(c,p,this.getPixelRatio()),this.transform.resize(c,p),(t=this._requestedCameraState)===null||t===void 0||t.resize(c,p),this.painter.resize(c,p,this.getPixelRatio());const y=!this._moving;return y&&(this.stop(),this.fire(new u.Event("movestart",h)).fire(new u.Event("move",h))),this.fire(new u.Event("resize",h)),y&&this.fire(new u.Event("moveend",h)),this}getPixelRatio(){return this._pixelRatio}setPixelRatio(h){const[t,s]=this._containerDimensions();this._pixelRatio=h,this._resizeCanvas(t,s,h),this.painter.resize(t,s,h)}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(h){return this.transform.setMaxBounds(Ut.convert(h)),this._update()}setMinZoom(h){if((h=h??-2)>=-2&&h<=this.transform.maxZoom)return this.transform.minZoom=h,this._update(),this.getZoom()<h&&this.setZoom(h),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(h){if((h=h??22)>=this.transform.minZoom)return this.transform.maxZoom=h,this._update(),this.getZoom()>h&&this.setZoom(h),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(h){if((h=h??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(h>=0&&h<=this.transform.maxPitch)return this.transform.minPitch=h,this._update(),this.getPitch()<h&&this.setPitch(h),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(h){if((h=h??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(h>=this.transform.minPitch)return this.transform.maxPitch=h,this._update(),this.getPitch()>h&&this.setPitch(h),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(h){return this.transform.renderWorldCopies=h,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(h){return this._cooperativeGestures=h,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(h){return this.transform.locationPoint(u.LngLat.convert(h),this.style&&this.terrain)}unproject(h){return this.transform.pointLocation(u.Point.convert(h),this.terrain)}isMoving(){var h;return this._moving||((h=this.handlers)===null||h===void 0?void 0:h.isMoving())}isZooming(){var h;return this._zooming||((h=this.handlers)===null||h===void 0?void 0:h.isZooming())}isRotating(){var h;return this._rotating||((h=this.handlers)===null||h===void 0?void 0:h.isRotating())}_createDelegatedListener(h,t,s){if(h==="mouseenter"||h==="mouseover"){let c=!1;return{layer:t,listener:s,delegates:{mousemove:y=>{const x=this.getLayer(t)?this.queryRenderedFeatures(y.point,{layers:[t]}):[];x.length?c||(c=!0,s.call(this,new Cn(h,this,y.originalEvent,{features:x}))):c=!1},mouseout:()=>{c=!1}}}}if(h==="mouseleave"||h==="mouseout"){let c=!1;return{layer:t,listener:s,delegates:{mousemove:x=>{(this.getLayer(t)?this.queryRenderedFeatures(x.point,{layers:[t]}):[]).length?c=!0:c&&(c=!1,s.call(this,new Cn(h,this,x.originalEvent)))},mouseout:x=>{c&&(c=!1,s.call(this,new Cn(h,this,x.originalEvent)))}}}}{const c=p=>{const y=this.getLayer(t)?this.queryRenderedFeatures(p.point,{layers:[t]}):[];y.length&&(p.features=y,s.call(this,p),delete p.features)};return{layer:t,listener:s,delegates:{[h]:c}}}}on(h,t,s){if(s===void 0)return super.on(h,t);const c=this._createDelegatedListener(h,t,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[h]=this._delegatedListeners[h]||[],this._delegatedListeners[h].push(c);for(const p in c.delegates)this.on(p,c.delegates[p]);return this}once(h,t,s){if(s===void 0)return super.once(h,t);const c=this._createDelegatedListener(h,t,s);for(const p in c.delegates)this.once(p,c.delegates[p]);return this}off(h,t,s){return s===void 0?super.off(h,t):(this._delegatedListeners&&this._delegatedListeners[h]&&(c=>{const p=this._delegatedListeners[h];for(let y=0;y<p.length;y++){const x=p[y];if(x.layer===t&&x.listener===s){for(const E in x.delegates)this.off(E,x.delegates[E]);return p.splice(y,1),this}}})(),this)}queryRenderedFeatures(h,t){if(!this.style)return[];let s;const c=h instanceof u.Point||Array.isArray(h),p=c?h:[[0,0],[this.transform.width,this.transform.height]];if(t=t||(c?{}:h)||{},p instanceof u.Point||typeof p[0]=="number")s=[u.Point.convert(p)];else{const y=u.Point.convert(p[0]),x=u.Point.convert(p[1]);s=[y,new u.Point(x.x,y.y),x,new u.Point(y.x,x.y),y]}return this.style.queryRenderedFeatures(s,t,this.transform)}querySourceFeatures(h,t){return this.style.querySourceFeatures(h,t)}setStyle(h,t){return(t=u.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},t)).diff!==!1&&t.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&h?(this._diffStyle(h,t),this):(this._localIdeographFontFamily=t.localIdeographFontFamily,this._updateStyle(h,t))}setTransformRequest(h){return this._requestManager.setTransformRequest(h),this}_getUIString(h){const t=this._locale[h];if(t==null)throw new Error(`Missing UI string '${h}'`);return t}_updateStyle(h,t){if(t.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(h,t));const s=this.style&&t.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!h)),h?(this.style=new or(this,t||{}),this.style.setEventedParent(this,{style:this.style}),typeof h=="string"?this.style.loadURL(h,t,s):this.style.loadJSON(h,t,s),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new or(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(h,t){if(typeof h=="string"){const s=this._requestManager.transformRequest(h,re.Style);u.getJSON(s,(c,p)=>{c?this.fire(new u.ErrorEvent(c)):p&&this._updateDiff(p,t)})}else typeof h=="object"&&this._updateDiff(h,t)}_updateDiff(h,t){try{this.style.setState(h,t)&&this._update(!0)}catch(s){u.warnOnce(`Unable to perform style diff: ${s.message||s.error||s}.  Rebuilding the style from scratch.`),this._updateStyle(h,t)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.warnOnce("There is no style added to the map.")}addSource(h,t){return this._lazyInitEmptyStyle(),this.style.addSource(h,t),this._update(!0)}isSourceLoaded(h){const t=this.style&&this.style.sourceCaches[h];if(t!==void 0)return t.loaded();this.fire(new u.ErrorEvent(new Error(`There is no source with ID '${h}'`)))}setTerrain(h){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),h){const t=this.style.sourceCaches[h.source];if(!t)throw new Error(`cannot load terrain, because there exists no source with ID: ${h.source}`);for(const s in this.style._layers){const c=this.style._layers[s];c.type==="hillshade"&&c.source===h.source&&u.warnOnce("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Sr(this.painter,t,h),this.painter.renderToTexture=new dn(this.painter,this.terrain),this.transform.updateElevation(this.terrain),this._terrainDataCallback=s=>{s.dataType==="style"?this.terrain.sourceCache.freeRtt():s.dataType==="source"&&s.tile&&(s.sourceId===h.source&&this.transform.updateElevation(this.terrain),this.terrain.sourceCache.freeRtt(s.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform.updateElevation(this.terrain);return this.fire(new u.Event("terrain",{terrain:h})),this}getTerrain(){return this.terrain&&this.terrain.options}areTilesLoaded(){const h=this.style&&this.style.sourceCaches;for(const t in h){const s=h[t]._tiles;for(const c in s){const p=s[c];if(p.state!=="loaded"&&p.state!=="errored")return!1}}return!0}addSourceType(h,t,s){return this._lazyInitEmptyStyle(),this.style.addSourceType(h,t,s)}removeSource(h){return this.style.removeSource(h),this._update(!0)}getSource(h){return this.style.getSource(h)}addImage(h,t,{pixelRatio:s=1,sdf:c=!1,stretchX:p,stretchY:y,content:x}={}){if(this._lazyInitEmptyStyle(),t instanceof HTMLImageElement||u.isImageBitmap(t)){const{width:E,height:S,data:C}=u.exported.getImageData(t);this.style.addImage(h,{data:new u.RGBAImage({width:E,height:S},C),pixelRatio:s,stretchX:p,stretchY:y,content:x,sdf:c,version:0})}else{if(t.width===void 0||t.height===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:E,height:S,data:C}=t,M=t;this.style.addImage(h,{data:new u.RGBAImage({width:E,height:S},new Uint8Array(C)),pixelRatio:s,stretchX:p,stretchY:y,content:x,sdf:c,version:0,userImage:M}),M.onAdd&&M.onAdd(this,h)}}}updateImage(h,t){const s=this.style.getImage(h);if(!s)return this.fire(new u.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=t instanceof HTMLImageElement||u.isImageBitmap(t)?u.exported.getImageData(t):t,{width:p,height:y,data:x}=c;if(p===void 0||y===void 0)return this.fire(new u.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(p!==s.data.width||y!==s.data.height)return this.fire(new u.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image")));const E=!(t instanceof HTMLImageElement||u.isImageBitmap(t));s.data.replace(x,E),this.style.updateImage(h,s)}getImage(h){return this.style.getImage(h)}hasImage(h){return h?!!this.style.getImage(h):(this.fire(new u.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(h){this.style.removeImage(h)}loadImage(h,t){te.getImage(this._requestManager.transformRequest(h,re.Image),t)}listImages(){return this.style.listImages()}addLayer(h,t){return this._lazyInitEmptyStyle(),this.style.addLayer(h,t),this._update(!0)}moveLayer(h,t){return this.style.moveLayer(h,t),this._update(!0)}removeLayer(h){return this.style.removeLayer(h),this._update(!0)}getLayer(h){return this.style.getLayer(h)}setLayerZoomRange(h,t,s){return this.style.setLayerZoomRange(h,t,s),this._update(!0)}setFilter(h,t,s={}){return this.style.setFilter(h,t,s),this._update(!0)}getFilter(h){return this.style.getFilter(h)}setPaintProperty(h,t,s,c={}){return this.style.setPaintProperty(h,t,s,c),this._update(!0)}getPaintProperty(h,t){return this.style.getPaintProperty(h,t)}setLayoutProperty(h,t,s,c={}){return this.style.setLayoutProperty(h,t,s,c),this._update(!0)}getLayoutProperty(h,t){return this.style.getLayoutProperty(h,t)}setGlyphs(h,t={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(h,t),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(h,t,s={}){return this._lazyInitEmptyStyle(),this.style.addSprite(h,t,s,c=>{c||this._update(!0)}),this}removeSprite(h){return this._lazyInitEmptyStyle(),this.style.removeSprite(h),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(h,t={}){return this._lazyInitEmptyStyle(),this.style.setSprite(h,t,s=>{s||this._update(!0)}),this}setLight(h,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(h,t),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(h,t){return this.style.setFeatureState(h,t),this._update()}removeFeatureState(h,t){return this.style.removeFeatureState(h,t),this._update()}getFeatureState(h){return this.style.getFeatureState(h)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let h=0,t=0;return this._container&&(h=this._container.clientWidth||400,t=this._container.clientHeight||300),[h,t]}_setupContainer(){const h=this._container;h.classList.add("maplibregl-map");const t=this._canvasContainer=D.create("div","maplibregl-canvas-container",h);this._interactive&&t.classList.add("maplibregl-interactive"),this._canvas=D.create("canvas","maplibregl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const s=this._containerDimensions();this._resizeCanvas(s[0],s[1],this.getPixelRatio());const c=this._controlContainer=D.create("div","maplibregl-control-container",h),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{p[y]=D.create("div",`maplibregl-ctrl-${y} `,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_cooperativeGesturesOnWheel(h){this._onCooperativeGesture(h,h[this._metaKey],1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=D.create("div","maplibregl-cooperative-gesture-screen",this._container);let h=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(h=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use ⌘ + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${h}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){D.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(h,t,s){this._canvas.width=s*h,this._canvas.height=s*t,this._canvas.style.width=`${h}px`,this._canvas.style.height=`${t}px`}_setupPainter(){const h={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let t=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{t={requestedAttributes:h},c&&(t.statusMessage=c.statusMessage,t.type=c.type)},{once:!0});const s=this._canvas.getContext("webgl2",h);if(!s){const c="Failed to initialize WebGL";throw t?(t.message=c,new Error(JSON.stringify(t))):new Error(c)}this.painter=new eh(s,this.transform),ue.testSupport(s)}_contextLost(h){h.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.Event("webglcontextlost",{originalEvent:h}))}_contextRestored(h){this._setupPainter(),this.resize(),this._update(),this.fire(new u.Event("webglcontextrestored",{originalEvent:h}))}_onMapScroll(h){if(h.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}_onCooperativeGesture(h,t,s){return!t&&s<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(h){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||h,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(h){return this._update(),this._renderTaskQueue.add(h)}_cancelRenderFrame(h){this._renderTaskQueue.remove(h)}_render(h){const t=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(h),this._removed)return;let s=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const p=this.transform.zoom,y=u.exported.now();this.style.zoomHistory.update(p,y);const x=new u.EvaluationParameters(p,{now:y,fadeDuration:t,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),E=x.crossFadingFactor();E===1&&E===this._crossFadingFactor||(s=!0,this._crossFadingFactor=E),this.style.update(x)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain&&this.terrain.sourceCache.update(this.transform,this.terrain),this.transform.updateElevation(this.terrain),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,t,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:t,showPadding:this.showPadding}),this.fire(new u.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.load),this.fire(new u.Event("load"))),this.style&&(this.style.hasTransitions()||s)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const c=this._sourcesDirty||this._styleDirty||this._placementDirty;return c||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.Event("idle")),!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,u.PerformanceUtils.mark(u.PerformanceMarkers.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var h;this._hash&&this._hash.remove();for(const s of this._controls)s.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),te.removeThrottleControl(this._imageQueueHandle),(h=this._resizeObserver)===null||h===void 0||h.disconnect();const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),D.remove(this._canvasContainer),D.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),u.PerformanceUtils.clearMetrics(),this._removed=!0,this.fire(new u.Event("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=u.exported.frame(h=>{u.PerformanceUtils.frame(h),this._frame=null,this._render(h)}))}_onWindowOnline(){this._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(h){this._showTileBoundaries!==h&&(this._showTileBoundaries=h,this._update())}get showPadding(){return!!this._showPadding}set showPadding(h){this._showPadding!==h&&(this._showPadding=h,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(h){this._showCollisionBoxes!==h&&(this._showCollisionBoxes=h,h?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(h){this._showOverdrawInspector!==h&&(this._showOverdrawInspector=h,this._update())}get repaint(){return!!this._repaint}set repaint(h){this._repaint!==h&&(this._repaint=h,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(h){this._vertices=h,this._update()}get version(){return In}getCameraTargetElevation(){return this.transform.elevation}},NavigationControl:class{constructor(h){this.options=u.extend({},$a,h),this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",t=>t.preventDefault()),this.options.showZoom&&(u.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",t=>this._map.zoomIn({},{originalEvent:t})),D.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",t=>this._map.zoomOut({},{originalEvent:t})),D.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(u.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("maplibregl-ctrl-compass",t=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:t}):this._map.resetNorth({},{originalEvent:t})}),this._compassIcon=D.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const h=this._map.getZoom(),t=h===this._map.getMaxZoom(),s=h===this._map.getMinZoom();this._zoomInButton.disabled=t,this._zoomOutButton.disabled=s,this._zoomInButton.setAttribute("aria-disabled",t.toString()),this._zoomOutButton.setAttribute("aria-disabled",s.toString())}_rotateCompassArrow(){const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=h}onAdd(h){return this._map=h,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new yu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(h,t){const s=D.create("button",h,this._container);return s.type="button",s.addEventListener("click",t),s}_setButtonTitle(h,t){const s=this._map._getUIString(`NavigationControl.${t}`);h.title=s,h.setAttribute("aria-label",s)}},GeolocateControl:class extends u.Evented{constructor(h){super(),this.options=u.extend({},_u,h),u.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}onAdd(h){return this._map=h,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(t,s=!1){Er===void 0||s?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(c=>{Er=c.state!=="denied",t(Er)}).catch(()=>{Er=!!window.navigator.geolocation,t(Er)}):(Er=!!window.navigator.geolocation,t(Er)):t(Er)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Yo=0,wo=!1}_isOutOfMapMaxBounds(h){const t=this._map.getMaxBounds(),s=h.coords;return t&&(s.longitude<t.getWest()||s.longitude>t.getEast()||s.latitude<t.getSouth()||s.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_onSuccess(h){if(this._map){if(this._isOutOfMapMaxBounds(h))return this._setErrorState(),this.fire(new u.Event("outofmaxbounds",h)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=h,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(h),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(h),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.Event("geolocate",h)),this._finish()}}_updateCamera(h){const t=new u.LngLat(h.coords.longitude,h.coords.latitude),s=h.coords.accuracy,c=this._map.getBearing(),p=u.extend({bearing:c},this.options.fitBoundsOptions),y=Ut.fromLngLat(t,s);this._map.fitBounds(y,p,{geolocateSource:!0})}_updateMarker(h){if(h){const t=new u.LngLat(h.coords.longitude,h.coords.latitude);this._accuracyCircleMarker.setLngLat(t).addTo(this._map),this._userLocationDotMarker.setLngLat(t).addTo(this._map),this._accuracy=h.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const h=this._map.getBounds(),t=h.getSouthEast(),s=h.getNorthEast(),c=t.distanceTo(s),p=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${p}px`,this._circleElement.style.height=`${p}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_onError(h){if(this._map){if(this.options.trackUserLocation)if(h.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(h.code===3&&wo)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.Event("error",h)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(h){if(this._map){if(this._container.addEventListener("contextmenu",t=>t.preventDefault()),this._geolocateButton=D.create("button","maplibregl-ctrl-geolocate",this._container),D.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",h===!1){u.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}else{const t=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=t,this._geolocateButton.setAttribute("aria-label",t)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Gs(this._dotElement),this._circleElement=D.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Gs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",t=>{t.geolocateSource||this._watchState!=="ACTIVE_LOCK"||t.originalEvent&&t.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.Event("trackuserlocationend")))})}}trigger(){if(!this._setup)return u.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Yo--,wo=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.Event("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let h;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Yo++,Yo>1?(h={maximumAge:6e5,timeout:0},wo=!0):(h=this.options.positionOptions,wo=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,h)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:lt,LogoControl:Zs,ScaleControl:class{constructor(h){this.options=u.extend({},vu,h),u.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){Za(this._map,this._container,this.options)}onAdd(h){return this._map=h,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-scale",h.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(h){this.options.unit=h,Za(this._map,this._container,this.options)}},FullscreenControl:class extends u.Evented{constructor(h={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,h&&h.container&&(h.container instanceof HTMLElement?this._container=h.container:u.warnOnce("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(h){return this._map=h,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){D.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const h=this._fullscreenButton=D.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);D.create("span","maplibregl-ctrl-icon",h).setAttribute("aria-hidden","true"),h.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const h=this._getTitle();this._fullscreenButton.setAttribute("aria-label",h),this._fullscreenButton.title=h}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.Event("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new u.Event("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},TerrainControl:class{constructor(h){this.options=h,u.bindAll(["_toggleTerrain","_updateTerrainIcon"],this)}onAdd(h){return this._map=h,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=D.create("button","maplibregl-ctrl-terrain",this._container),D.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){D.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}_toggleTerrain(){this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()}_updateTerrainIcon(){this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))}},Popup:class extends u.Evented{constructor(h){super(),this.options=u.extend(Object.create(Ga),h),u.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}addTo(h){return this._map&&this.remove(),this._map=h,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=u.LngLat.convert(h),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(h){return this.setDOMContent(document.createTextNode(h))}setHTML(h){const t=document.createDocumentFragment(),s=document.createElement("body");let c;for(s.innerHTML=h;c=s.firstChild,c;)t.appendChild(c);return this.setDOMContent(t)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(h){return this.options.maxWidth=h,this._update(),this}setDOMContent(h){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(h),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(h){this._container&&this._container.classList.add(h)}removeClassName(h){this._container&&this._container.classList.remove(h)}setOffset(h){return this.options.offset=h,this._update(),this}toggleClassName(h){if(this._container)return this._container.classList.toggle(h)}_createCloseButton(){this.options.closeButton&&(this._closeButton=D.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(h){this._update(h.point)}_onMouseMove(h){this._update(h.point)}_onDrag(h){this._update(h.point)}_update(h){if(!this._map||!this._lngLat&&!this._trackPointer||!this._content||(this._container||(this._container=D.create("div","maplibregl-popup",this._map.getContainer()),this._tip=D.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(y=>this._container.classList.add(y)),this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=ja(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!h))return;const t=this._pos=this._trackPointer&&h?h:this._map.project(this._lngLat);let s=this.options.anchor;const c=Wa(this.options.offset);if(!s){const y=this._container.offsetWidth,x=this._container.offsetHeight;let E;E=t.y+c.bottom.y<x?["top"]:t.y>this._map.transform.height-x?["bottom"]:[],t.x<y/2?E.push("left"):t.x>this._map.transform.width-y/2&&E.push("right"),s=E.length===0?"bottom":E.join("-")}const p=t.add(c[s]).round();D.setTransform(this._container,`${xo[s]} translate(${p.x}px,${p.y}px)`),qa(this._container,s,"popup")}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const h=this._container.querySelector(xu);h&&h.focus()}_onClose(){this.remove()}},Marker:Gs,Style:or,LngLat:u.LngLat,LngLatBounds:Ut,Point:u.Point,MercatorCoordinate:u.MercatorCoordinate,Evented:u.Evented,AJAXError:u.AJAXError,config:u.config,CanvasSource:Rn,GeoJSONSource:Pt,ImageSource:Wt,RasterDEMTileSource:Jr,RasterTileSource:yi,VectorTileSource:ho,VideoSource:me,prewarm:function(){Rr().acquire(Le)},clearPrewarmedResources:function(){const h=_r;h&&(h.isPreloaded()&&h.numActive()===1?(h.release(Le),_r=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get version(){return Xa},get workerCount(){return Bn.workerCount},set workerCount(h){Bn.workerCount=h},get maxParallelImageRequests(){return u.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(h){u.config.MAX_PARALLEL_IMAGE_REQUESTS=h},get workerUrl(){return u.config.WORKER_URL},set workerUrl(h){u.config.WORKER_URL=h},addProtocol(h,t){u.config.REGISTERED_PROTOCOLS[h]=t},removeProtocol(h){delete u.config.REGISTERED_PROTOCOLS[h]}};return Na.extend(Ha,{isSafari:u.isSafari,getPerformanceMetrics:u.PerformanceUtils.getPerformanceMetrics}),Ha});var I=_;return I})})(o1);var KS=o1.exports;const YS=$v(KS);const JS=n=>fetch(n).then(o=>{var l;return(l=o.headers.get("content-type"))!=null&&l.includes("json")?o.json():o.text()}),QS=({latitude:n,longitude:o,zIndex:l,onClick:f,children:_})=>kt.jsx(jS,{latitude:n,longitude:o,onClick:w=>{f&&f(w)},anchor:"bottom",style:l?{zIndex:l}:{},children:_});const eE=({latitude:n,longitude:o,title:l,desc:f,photo:_,icon:w})=>{const{current:I}=Ng(),[u,U]=$e.useState(7);$e.useEffect(()=>{I&&I.on("zoomend",ue=>{U(ue.viewState.zoom)})},[]);const D=$e.useCallback(ue=>{I&&u<16&&I.flyTo({center:[o,n],zoom:u+4})},[I,u]);return kt.jsx(QS,{latitude:n,longitude:o,onClick:D,children:kt.jsx("div",{className:"IconMarkerWrap",title:l+" "+f,style:{opacity:(()=>u?u<8?.7:u<9?.75:u<12?.8:u<13?.85:u<14?.9:1:1)()},children:kt.jsx("div",{className:"IconMarkerBalloon",children:kt.jsx("div",{className:"IconMarkerBalloonTitle IconMarkerBalloonTitleMoreZoom",children:"・"})})})})};var a1={exports:{}},l1={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dl=$e;function tE(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var nE=typeof Object.is=="function"?Object.is:tE,iE=Dl.useState,rE=Dl.useEffect,oE=Dl.useLayoutEffect,sE=Dl.useDebugValue;function aE(n,o){var l=o(),f=iE({inst:{value:l,getSnapshot:o}}),_=f[0].inst,w=f[1];return oE(function(){_.value=l,_.getSnapshot=o,Of(_)&&w({inst:_})},[n,l,o]),rE(function(){return Of(_)&&w({inst:_}),n(function(){Of(_)&&w({inst:_})})},[n]),sE(l),l}function Of(n){var o=n.getSnapshot;n=n.value;try{var l=o();return!nE(n,l)}catch{return!0}}function lE(n,o){return o()}var uE=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?lE:aE;l1.useSyncExternalStore=Dl.useSyncExternalStore!==void 0?Dl.useSyncExternalStore:uE;a1.exports=l1;var cE=a1.exports;const Mo=new WeakMap,Uf={},ed={},hs=()=>{},Xr=hs(),Nf=Object,Yt=n=>n===Xr,Ao=n=>typeof n=="function",bs=(n,o)=>({...n,...o}),$g="undefined",tp=typeof window!=$g,Om=typeof document!=$g,hE=()=>tp&&typeof window.requestAnimationFrame!=$g,u1=(n,o)=>{const l=Mo.get(n);return[()=>!Yt(o)&&n.get(o)||Uf,f=>{if(!Yt(o)){const _=n.get(o);o in ed||(ed[o]=_),l[5](o,bs(_,f),_||Uf)}},l[6],()=>!Yt(o)&&o in ed?ed[o]:!Yt(o)&&n.get(o)||Uf]},td=new WeakMap;let dE=0;const Ec=n=>{const o=typeof n,l=n&&n.constructor,f=l==Date;let _,w;if(Nf(n)===n&&!f&&l!=RegExp){if(_=td.get(n),_)return _;if(_=++dE+"~",td.set(n,_),l==Array){for(_="@",w=0;w<n.length;w++)_+=Ec(n[w])+",";td.set(n,_)}if(l==Nf){_="#";const I=Nf.keys(n).sort();for(;!Yt(w=I.pop());)Yt(n[w])||(_+=w+":"+Ec(n[w])+",");td.set(n,_)}}else _=f?n.toJSON():o=="symbol"?n.toString():o=="string"?JSON.stringify(n):""+n;return _};let Um=!0;const pE=()=>Um,[Nm,Vm]=tp&&window.addEventListener?[window.addEventListener.bind(window),window.removeEventListener.bind(window)]:[hs,hs],fE=()=>{const n=Om&&document.visibilityState;return Yt(n)||n!=="hidden"},mE=n=>(Om&&document.addEventListener("visibilitychange",n),Nm("focus",n),()=>{Om&&document.removeEventListener("visibilitychange",n),Vm("focus",n)}),gE=n=>{const o=()=>{Um=!0,n()},l=()=>{Um=!1};return Nm("online",o),Nm("offline",l),()=>{Vm("online",o),Vm("offline",l)}},yE={isOnline:pE,isVisible:fE},_E={initFocus:mE,initReconnect:gE},Bv=!Wm.useId,Tc=!tp||"Deno"in window,vE=n=>hE()?window.requestAnimationFrame(n):setTimeout(n,1),Vf=Tc?$e.useEffect:$e.useLayoutEffect,$f=typeof navigator<"u"&&navigator.connection,Fv=!Tc&&$f&&(["slow-2g","2g"].includes($f.effectiveType)||$f.saveData),jg=n=>{if(Ao(n))try{n=n()}catch{n=""}const o=n;return n=typeof n=="string"?n:(Array.isArray(n)?n.length:n)?Ec(n):"",[n,o]};let xE=0;const $m=()=>++xE,c1=0,h1=1,d1=2,wE=3;var Wu={__proto__:null,ERROR_REVALIDATE_EVENT:wE,FOCUS_EVENT:c1,MUTATE_EVENT:d1,RECONNECT_EVENT:h1};async function p1(...n){const[o,l,f,_]=n,w=bs({populateCache:!0,throwOnError:!0},typeof _=="boolean"?{revalidate:_}:_||{});let I=w.populateCache;const u=w.rollbackOnError;let U=w.optimisticData;const D=w.revalidate!==!1,ue=Ce=>typeof u=="function"?u(Ce):u!==!1,ie=w.throwOnError;if(Ao(l)){const Ce=l,ke=[],Pe=o.keys();for(let qe=Pe.next();!qe.done;qe=Pe.next()){const re=qe.value;!/^\$(inf|sub)\$/.test(re)&&Ce(o.get(re)._k)&&ke.push(re)}return Promise.all(ke.map(pe))}return pe(l);async function pe(Ce){const[ke]=jg(Ce);if(!ke)return;const[Pe,qe]=u1(o,ke),[re,te,le]=Mo.get(o),Ee=re[ke],Ze=()=>D&&(delete le[ke],Ee&&Ee[0])?Ee[0](d1).then(()=>Pe().data):Pe().data;if(n.length<3)return Ze();let Fe=f,Ae;const We=$m();te[ke]=[We,0];const bt=!Yt(U),st=Pe(),_t=st.data,mi=st._c,qt=Yt(mi)?_t:mi;if(bt&&(U=Ao(U)?U(qt):U,qe({data:U,_c:qt})),Ao(Fe))try{Fe=Fe(qt)}catch(qn){Ae=qn}if(Fe&&Ao(Fe.then))if(Fe=await Fe.catch(qn=>{Ae=qn}),We!==te[ke][0]){if(Ae)throw Ae;return Fe}else Ae&&bt&&ue(Ae)&&(I=!0,Fe=qt,qe({data:Fe,_c:Xr}));I&&(Ae||(Ao(I)&&(Fe=I(Fe,qt)),qe({data:Fe,_c:Xr}))),te[ke][1]=$m();const Kn=await Ze();if(qe({_c:Xr}),Ae){if(ie)throw Ae;return}return I?Kn:Fe}}const Ov=(n,o)=>{for(const l in n)n[l][0]&&n[l][0](o)},bE=(n,o)=>{if(!Mo.has(n)){const l=bs(_E,o),f={},_=p1.bind(Xr,n);let w=hs;const I={},u=(ue,ie)=>{const pe=I[ue]||[];return I[ue]=pe,pe.push(ie),()=>pe.splice(pe.indexOf(ie),1)},U=(ue,ie,pe)=>{n.set(ue,ie);const Ce=I[ue];if(Ce)for(const ke of Ce)ke(ie,pe)},D=()=>{if(!Mo.has(n)&&(Mo.set(n,[f,{},{},{},_,U,u]),!Tc)){const ue=l.initFocus(setTimeout.bind(Xr,Ov.bind(Xr,f,c1))),ie=l.initReconnect(setTimeout.bind(Xr,Ov.bind(Xr,f,h1)));w=()=>{ue&&ue(),ie&&ie(),Mo.delete(n)}}};return D(),[n,_,D,w]}return[n,Mo.get(n)[4]]},SE=(n,o,l,f,_)=>{const w=l.errorRetryCount,I=_.retryCount,u=~~((Math.random()+.5)*(1<<(I<8?I:8)))*l.errorRetryInterval;!Yt(w)&&I>w||setTimeout(f,u,_)},EE=(n,o)=>Ec(n)==Ec(o),[f1,TE]=bE(new Map),CE=bs({onLoadingSlow:hs,onSuccess:hs,onError:hs,onErrorRetry:SE,onDiscarded:hs,revalidateOnFocus:!0,revalidateOnReconnect:!0,revalidateIfStale:!0,shouldRetryOnError:!0,errorRetryInterval:Fv?1e4:5e3,focusThrottleInterval:5*1e3,dedupingInterval:2*1e3,loadingTimeout:Fv?5e3:3e3,compare:EE,isPaused:()=>!1,cache:f1,mutate:TE,fallback:{}},yE),IE=(n,o)=>{const l=bs(n,o);if(o){const{use:f,fallback:_}=n,{use:w,fallback:I}=o;f&&w&&(l.use=f.concat(w)),_&&I&&(l.fallback=bs(_,I))}return l},kE=$e.createContext({}),m1=tp&&window.__SWR_DEVTOOLS_USE__,PE=m1?window.__SWR_DEVTOOLS_USE__:[],ME=()=>{m1&&(window.__SWR_DEVTOOLS_REACT__=Wm)},AE=n=>Ao(n[1])?[n[0],n[1],n[2]||{}]:[n[0],null,(n[1]===null?n[2]:n[1])||{}],zE=()=>bs(CE,$e.useContext(kE)),DE=n=>(o,l,f)=>n(o,l&&((...w)=>{const[I]=jg(o),[,,,u]=Mo.get(f1),U=u[I];return U?(delete u[I],U):l(...w)}),f),LE=PE.concat(DE),RE=n=>function(...l){const f=zE(),[_,w,I]=AE(l),u=IE(f,I);let U=n;const{use:D}=u,ue=(D||[]).concat(LE);for(let ie=ue.length;ie--;)U=ue[ie](U);return U(_,w||u.fetcher||null,u)},BE=(n,o,l)=>{const f=o[n]||(o[n]=[]);return f.push(l),()=>{const _=f.indexOf(l);_>=0&&(f[_]=f[f.length-1],f.pop())}};ME();const jf={dedupe:!0},FE=(n,o,l)=>{const{cache:f,compare:_,suspense:w,fallbackData:I,revalidateOnMount:u,revalidateIfStale:U,refreshInterval:D,refreshWhenHidden:ue,refreshWhenOffline:ie,keepPreviousData:pe}=l,[Ce,ke,Pe]=Mo.get(f),[qe,re]=jg(n),te=$e.useRef(!1),le=$e.useRef(!1),Ee=$e.useRef(qe),Ze=$e.useRef(o),Fe=$e.useRef(l),Ae=()=>Fe.current,We=()=>Ae().isVisible()&&Ae().isOnline(),[bt,st,_t,mi]=u1(f,qe),qt=$e.useRef({}).current,Kn=Yt(I)?l.fallback[qe]:I,qn=(Pt,Zt)=>{for(const Wt in qt){const me=Wt;if(me==="data"){if(!_(Pt[me],Zt[me])&&(!Yt(Pt[me])||!_(Tn,Zt[me])))return!1}else if(Zt[me]!==Pt[me])return!1}return!0},gi=$e.useMemo(()=>{const Pt=(()=>!qe||!o?!1:Yt(u)?Ae().isPaused()||w?!1:Yt(U)?!0:U:u)(),Zt=dt=>{const un=bs(dt);return delete un._k,Pt?{isValidating:!0,isLoading:!0,...un}:un},Wt=bt(),me=mi(),Rn=Zt(Wt),_i=Wt===me?Rn:Zt(me);let vt=Rn;return[()=>{const dt=Zt(bt());return qn(dt,vt)?(vt.data=dt.data,vt.isLoading=dt.isLoading,vt.isValidating=dt.isValidating,vt.error=dt.error,vt):(vt=dt,dt)},()=>_i]},[f,qe]),En=cE.useSyncExternalStore($e.useCallback(Pt=>_t(qe,(Zt,Wt)=>{qn(Wt,Zt)||Pt()}),[f,qe]),gi[0],gi[1]),Xe=!te.current,ht=Ce[qe]&&Ce[qe].length>0,ct=En.data,It=Yt(ct)?Kn:ct,Bt=En.error,zi=$e.useRef(It),Tn=pe?Yt(ct)?zi.current:ct:It,Di=(()=>ht&&!Yt(Bt)?!1:Xe&&!Yt(u)?u:Ae().isPaused()?!1:w?Yt(It)?!1:U:Yt(It)||U)(),Ut=!!(qe&&o&&Xe&&Di),si=Yt(En.isValidating)?Ut:En.isValidating,ho=Yt(En.isLoading)?Ut:En.isLoading,yi=$e.useCallback(async Pt=>{const Zt=Ze.current;if(!qe||!Zt||le.current||Ae().isPaused())return!1;let Wt,me,Rn=!0;const _i=Pt||{},vt=!Pe[qe]||!_i.dedupe,dt=()=>Bv?!le.current&&qe===Ee.current&&te.current:qe===Ee.current,un={isValidating:!1,isLoading:!1},Qr=()=>{st(un)},po=()=>{const Gt=Pe[qe];Gt&&Gt[1]===me&&delete Pe[qe]},fo={isValidating:!0};Yt(bt().data)&&(fo.isLoading=!0);try{if(vt&&(st(fo),l.loadingTimeout&&Yt(bt().data)&&setTimeout(()=>{Rn&&dt()&&Ae().onLoadingSlow(qe,l)},l.loadingTimeout),Pe[qe]=[Zt(re),$m()]),[Wt,me]=Pe[qe],Wt=await Wt,vt&&setTimeout(po,l.dedupingInterval),!Pe[qe]||Pe[qe][1]!==me)return vt&&dt()&&Ae().onDiscarded(qe),!1;un.error=Xr;const Gt=ke[qe];if(!Yt(Gt)&&(me<=Gt[0]||me<=Gt[1]||Gt[1]===0))return Qr(),vt&&dt()&&Ae().onDiscarded(qe),!1;const Zn=bt().data;un.data=_(Zn,Wt)?Zn:Wt,vt&&dt()&&Ae().onSuccess(Wt,qe,l)}catch(Gt){po();const Zn=Ae(),{shouldRetryOnError:Lr}=Zn;Zn.isPaused()||(un.error=Gt,vt&&dt()&&(Zn.onError(Gt,qe,Zn),(Lr===!0||Ao(Lr)&&Lr(Gt))&&We()&&Zn.onErrorRetry(Gt,qe,Zn,Le=>{const Bn=Ce[qe];Bn&&Bn[0]&&Bn[0](Wu.ERROR_REVALIDATE_EVENT,Le)},{retryCount:(_i.retryCount||0)+1,dedupe:!0})))}return Rn=!1,Qr(),!0},[qe,f]),Jr=$e.useCallback((...Pt)=>p1(f,Ee.current,...Pt),[]);if(Vf(()=>{Ze.current=o,Fe.current=l,Yt(ct)||(zi.current=ct)}),Vf(()=>{if(!qe)return;const Pt=yi.bind(Xr,jf);let Zt=0;const me=BE(qe,Ce,(Rn,_i={})=>{if(Rn==Wu.FOCUS_EVENT){const vt=Date.now();Ae().revalidateOnFocus&&vt>Zt&&We()&&(Zt=vt+Ae().focusThrottleInterval,Pt())}else if(Rn==Wu.RECONNECT_EVENT)Ae().revalidateOnReconnect&&We()&&Pt();else{if(Rn==Wu.MUTATE_EVENT)return yi();if(Rn==Wu.ERROR_REVALIDATE_EVENT)return yi(_i)}});return le.current=!1,Ee.current=qe,te.current=!0,st({_k:re}),Di&&(Yt(It)||Tc?Pt():vE(Pt)),()=>{le.current=!0,me()}},[qe]),Vf(()=>{let Pt;function Zt(){const me=Ao(D)?D(bt().data):D;me&&Pt!==-1&&(Pt=setTimeout(Wt,me))}function Wt(){!bt().error&&(ue||Ae().isVisible())&&(ie||Ae().isOnline())?yi(jf).then(Zt):Zt()}return Zt(),()=>{Pt&&(clearTimeout(Pt),Pt=-1)}},[D,ue,ie,qe]),$e.useDebugValue(Tn),w&&Yt(It)&&qe)throw!Bv&&Tc?new Error("Fallback data is required when using suspense in SSR."):(Ze.current=o,Fe.current=l,le.current=!1,Yt(Bt)?yi(jf):Bt);return{mutate:Jr,get data(){return qt.data=!0,Tn},get error(){return qt.error=!0,Bt},get isValidating(){return qt.isValidating=!0,si},get isLoading(){return qt.isLoading=!0,ho}}},OE=RE(FE);var Ji=63710088e-1,UE={centimeters:Ji*100,centimetres:Ji*100,degrees:Ji/111325,feet:Ji*3.28084,inches:Ji*39.37,kilometers:Ji/1e3,kilometres:Ji/1e3,meters:Ji,metres:Ji,miles:Ji/1609.344,millimeters:Ji*1e3,millimetres:Ji*1e3,nauticalmiles:Ji/1852,radians:1,yards:Ji*1.0936};function NE(n,o,l){l===void 0&&(l={});var f={type:"Feature"};return(l.id===0||l.id)&&(f.id=l.id),l.bbox&&(f.bbox=l.bbox),f.properties=o||{},f.geometry=n,f}function qf(n,o,l){if(l===void 0&&(l={}),!n)throw new Error("coordinates is required");if(!Array.isArray(n))throw new Error("coordinates must be an Array");if(n.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!Uv(n[0])||!Uv(n[1]))throw new Error("coordinates must contain numbers");var f={type:"Point",coordinates:n};return NE(f,o,l)}function VE(n,o){o===void 0&&(o="kilometers");var l=UE[o];if(!l)throw new Error(o+" units is invalid");return n*l}function nd(n){var o=n%360;return o*Math.PI/180}function Uv(n){return!isNaN(n)&&n!==null&&!Array.isArray(n)}function Nv(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Vv(n,o,l){l===void 0&&(l={});var f=Nv(n),_=Nv(o),w=nd(_[1]-f[1]),I=nd(_[0]-f[0]),u=nd(f[1]),U=nd(_[1]),D=Math.pow(Math.sin(w/2),2)+Math.pow(Math.sin(I/2),2)*Math.cos(u)*Math.cos(U);return VE(2*Math.atan2(Math.sqrt(D),Math.sqrt(1-D)),l.units)}const $E=({poi:n})=>{const{mainMap:o}=Ng(),l=$e.useCallback(f=>{o&&o.flyTo({center:[n.longitude,n.latitude],zoom:o.getZoom()})},[o,n]);return kt.jsx("div",{style:{margin:"0 5px 5px",cursor:"pointer"},onClick:l,children:kt.jsx("img",{style:{height:"195px",width:"195px",objectFit:"cover"},src:n.photo+"/raw"})})},jE=({poi:n})=>{const{mainMap:o}=Ng(),l=$e.useCallback(f=>{o&&o.flyTo({center:[n.longitude,n.latitude],zoom:o.getZoom()})},[o,n]);return kt.jsxs("li",{style:{marginTop:"5px"},children:[kt.jsx("a",{target:"_blank",href:"https://scrapbox.io/yuiseki/"+n.title,children:kt.jsx("img",{width:18,height:18,src:"https://scrapbox.io/assets/img/favicon/favicon.ico"})}),kt.jsx("span",{children:" "}),kt.jsx("span",{onClick:l,style:{fontWeight:"bold",cursor:"pointer"},children:n.title}),n.desc&&n.desc.length>0&&kt.jsxs(kt.Fragment,{children:[kt.jsx("span",{children:": "}),kt.jsx("span",{children:n.desc})]})]})};function qE(){const n=$e.useRef(null),[o,l]=$e.useState(void 0),f="https://gyamap.com/project_entries/yuiseki",{data:_}=OE(f,JS),[w,I]=$e.useState(void 0),u=$e.useCallback(()=>{!n||!n.current||l([n.current.getCenter().lng,n.current.getCenter().lat])},[]),U=$e.useCallback(()=>{!n||!n.current||l([n.current.getCenter().lng,n.current.getCenter().lat])},[]);return $e.useEffect(()=>{if(!o||!_)return;const D=_.sort((ue,ie)=>{const pe=qf(o),Ce=qf([ue.longitude,ue.latitude]),ke=qf([ie.longitude,ie.latitude]),Pe=Vv(pe,Ce,{units:"degrees"}),qe=Vv(pe,ke,{units:"degrees"});return Pe-qe});I(D)},[o,_]),kt.jsxs("div",{className:"App",children:[kt.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"20px"},children:[kt.jsx("h3",{style:{margin:"0px",padding:"0px"},children:"Gyamap React"}),kt.jsxs("p",{style:{margin:"0px",paddingLeft:"20px"},children:["このWebサイトは",kt.jsx("a",{target:"_blank",href:"https://ja.wikipedia.org/wiki/%E5%A2%97%E4%BA%95%E4%BF%8A%E4%B9%8B",children:"増井俊之さん"}),"が発明した",kt.jsx("a",{target:"_blank",href:"https://gyamap.com/",children:"Gyamap"}),"をReactで写経したプロトタイプです"]}),kt.jsx("p",{style:{margin:"0px",paddingLeft:"20px"},children:kt.jsx("a",{href:"https://scrapbox.io/Gyamap/%E6%A6%82%E8%A6%81",children:"Gyamapとは"})})]}),kt.jsxs(IS,{children:[kt.jsxs("div",{style:{display:"flex",margin:"20px"},children:[kt.jsxs(Vg,{style:{display:"block",flexGrow:1,minWidth:"400px",maxWidth:"400px",width:"400px",height:"400px"},id:"mainMap",ref:n,mapLib:YS,mapStyle:"https://tile.openstreetmap.jp/styles/osm-bright/style.json",attributionControl:!0,initialViewState:{latitude:35.7084,longitude:139.784,zoom:11},hash:!1,maxZoom:22,maxPitch:85,onLoad:u,onMove:U,children:[_&&_.map(D=>kt.jsx(eE,{icon:"yuiseki_icon.png",...D},D.title)),kt.jsx(XS,{position:"bottom-right",visualizePitch:!0,showZoom:!0,showCompass:!0})]}),kt.jsx("div",{style:{flexGrow:0},children:kt.jsx("div",{style:{display:"flex",flexWrap:"wrap",marginLeft:"5px"},children:w&&w.filter(D=>D.photo&&D.photo.length>0).slice(0,14).map((D,ue)=>kt.jsx($E,{poi:D},D.title))})})]}),kt.jsx("div",{children:kt.jsx("ul",{style:{listStyle:"none",padding:0,margin:"20px"},children:w&&w.map(D=>kt.jsx(jE,{poi:D},D.title))})})]})]})}Zf.createRoot(document.getElementById("root")).render(kt.jsx(Wm.StrictMode,{children:kt.jsx(qE,{})}));
